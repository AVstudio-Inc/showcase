import{r as R,L as ys,f as Dt,q as pt,av as Ln,j as I,aw as Ya,R as ze,g as Ur,w as rt,v as bs,l as Ri,F as mr,o as dr,p as Su,H as Ar,k as Eu,z as xu,ax as Tu,am as Ke,a as Ss,aj as Mu,y as Es,ac as wu,t as Lu,a7 as xs,ay as ku}from"./index-CR7MAnCp.js";import{a as It,u as $t,P as Ts,Q as Au,S as Kt,U as Ru,V as Du,x as Cu,f as kn,c as Iu,b as Ms,J as Pu,B as Bn,D as Ba,e as Ou,W as Fu,O as Nu}from"./editorApp-DLWlunXz.js";import{u as mt,c as Yu,i as Bu,R as ju}from"./confirm-D0g1-wZ1.js";import{g as Xi,B as jt,a as qi,u as Pt,c as Hr,b as zr,d as Xt,e as lr,R as fr,P as Gt,E as Uu,f as Hu,I as zu,h as Gu,i as rn,j as $u,k as ja}from"./index-DN-vgocH.js";import{a as Ji,u as Xn,b as Vu}from"./variablesAPI-BLoTBpai.js";import{i as Zi,u as ws,m as Ls,j as Ku,r as Wu,n as Xu,s as Ua,t as qu}from"./datasourceTools-eZTvAFyf.js";import{P as Ju,f as Zu,h as Qu,u as Mt,i as Wt,j as or,k as Yr,l as Mr,m as Br,e as ks,d as Ha,g as Di}from"./getLocalUrlFromString-DptiwCQQ.js";import{S as ec}from"./index-KEOervAl.js";import{R as za}from"./PlusCircleOutlined-sa3sGDZG.js";import{R as Ga,u as As,g as tc,a as rc}from"./useAddNavigateToWindow-CDeW-InD.js";import{m as nc,S as ic}from"./index.es-BW9NkQwl.js";import{d as Qe,a as yn}from"./dayjs.min-Bxhb2nNt.js";import{M as ac}from"./moveable.esm-BYu0Krn6.js";import{a as Rs,f as sc,h as oc}from"./localActiveAPI-BcvpvDpS.js";import{T as yi}from"./index-CGbxNHJV.js";var lc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M180 176h-60c-4.4 0-8 3.6-8 8v656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V184c0-4.4-3.6-8-8-8zm724 0h-60c-4.4 0-8 3.6-8 8v656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V184c0-4.4-3.6-8-8-8zM785.3 504.3L657.7 403.6a7.23 7.23 0 00-11.7 5.7V476H378v-62.8c0-6-7-9.4-11.7-5.7L238.7 508.3a7.14 7.14 0 000 11.3l127.5 100.8c4.7 3.7 11.7.4 11.7-5.7V548h268v62.8c0 6 7 9.4 11.7 5.7l127.5-100.8c3.8-2.9 3.8-8.5.2-11.4z"}}]},name:"column-width",theme:"outlined"},uc=function(r,i){return R.createElement(ys,Dt(Dt({},r),{},{ref:i,icon:lc}))},cc=R.forwardRef(uc),dc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M859.9 474H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zm-353.6-74.7c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H550V104c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v156h-62.8c-6 0-9.4 7-5.7 11.7l100.8 127.6zm11.4 225.4a7.14 7.14 0 00-11.3 0L405.6 752.3a7.23 7.23 0 005.7 11.7H474v156c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V764h62.8c6 0 9.4-7 5.7-11.7L517.7 624.7z"}}]},name:"vertical-align-middle",theme:"outlined"},fc=function(r,i){return R.createElement(ys,Dt(Dt({},r),{},{ref:i,icon:dc}))},hc=R.forwardRef(fc);const gc=Ln`
from {
  opacity: 0.8;
}

to {
 
}
`,mc=pt.div`
  position: relative;
  /* overflow: hidden; */
  color: ${({theme:e})=>e.colors.textColor};
  width: 100%;
  height: 100%;
  max-height: 100%;
  min-height: 0;
  -webkit-text-size-adjust: 100%;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif;
  container-type: size;


  & * {
    box-sizing: border-box;
    font-display: swap;
  }

  sup,
  sub {
    font-size: 0.5em;
  }

  .text-tiny {
    font-size: 0.3em;
  }

  .text-small {
    font-size: 0.5em;
  }

  .text-big {
    font-size: 1.2em;
  }
  .text-huge {
    font-size: 2em;
  }

  --active-page-background-color: transparent;
  --active-page-background-image: none;
  --active-page-background-filter: none;
  --active-page-background-opacity: 1;
  --active-page-background-backgroundSize: cover;
  --active-page-background-backgroundPosition: center;

  #ProjectBackgroundImage,
  .PageBackgroundImage,
  .PageBackgroundColor,
  .expand {
    position: absolute;
    pointer-events: none;
    /* will-change: opacity; */
    /* transition: opacity 200ms; */
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    background-repeat: no-repeat;
    background-position: 50% 50%;
    background-size: cover;
  }

  #PageBackgroundColor {
    transition: background-color 200ms ease-in;
    background-color: var(--active-page-background-color);
  }

  #PageBackgroundImage {
    background-image: var(--active-page-background-image);
    filter: var(--active-page-background-filter);
    opacity: var(--active-page-background-opacity);
    background-size: var(--active-page-background-backgroundSize);
    background-position: var(--active-page-background-backgroundPosition);
    /* visibility: hidden; */
  }

  #PageBackgroundImage.animateActivePageBg {
    animation-name: ${gc};
    animation-duration: 500ms;
    animation-delay: 300ms;
    animation-fill-mode: both;
    visibility: visible;
  }

  .ql-align-center {
    text-align: center;
  }

  .ql-align-right {
    text-align: right;
  }

  .ql-align-justify {
    text-align: justify;
  }

  .ant-switch-checked:focus {
    box-shadow: none;
  }

  .isDisabled {
    pointer-events: none;
    filter: grayscale(100%);
    opacity: 0.3;
    * {
      color: #fff !important;
      pointer-events: none;
    }
  }
  .isHidden,
  .isHiddenByOrientation {
    &:not(.isReserveSpace) {
      display: none;
    }
    &.isReserveSpace {
      opacity: 0 !important;
      pointer-events: none;
    }
  }

  .hasActions {
    cursor: pointer;
    transition: 200ms;
    &:active {
      transform: scale(0.9);
    }
  }

  #layers {
    z-index: 1000;
    position: fixed;
  }

  [data-visualhidden='true'] {
    clip-path: inset(50%);
  }

  [data-visualhidden='false'] {
  }

  //overlayMask

  --mask-bg-color: rgba(0, 0, 0, 0.5);
  --overlay-background-blur: 0px;
  

  ${({inlineStyles:e})=>e}
`;pt.div`
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;

  video {
    position: relative;
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: 50% 50%;
    mix-blend-mode: screen;
    /* mix-blend-mode: lighten; */
    /* mix-blend-mode: exclusion; */
    /* mix-blend-mode: luminosity; */
    opacity: 0.1;
  }
`;const pc=pt.div`
  left: 0;
  top: 0;
  position: absolute;
  width: 100%;
  height: 100%;
  min-height: 0;
  display: grid;

  grid-template-columns: auto 1fr auto;
  grid-template-rows: auto 1fr auto;
  gap: 0px 0px;
  grid-template-areas:
    'top top top'
    'left content right'
    'bottom bottom bottom';

  .globalslot {
    position: relative;
    z-index: 10;
  }

  .top {
    grid-area: top;
  }

  .right {
    grid-area: right;
    & > div {
      position: relative;
      width: 100%;
      height: 100%;
    }
  }

  .bottom {
    grid-area: bottom;
  }

  .left {
    grid-area: left;
    & > div {
      position: relative;
      width: 100%;
      height: 100%;
    }
  }
  .content {
    /* position: relative;
    z-index: 10; */
    grid-area: content;
    width: 100%;
    height: 100%;
    min-width: 0;
    min-height: 0;
  }

  background-position: 50% 50%;
  background-repeat: no-repeat;
  background-size: cover;
`,vc=pt.div`
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  flex-flow: column;
  align-items: center;
  justify-content: center;
  gap: 0.5em;
  font-weight: normal;
  pointer-events: none;
  overflow: hidden;

  .icon {
    width: 50px;
    height: auto;
  }

  .title {
    font-size: 14px;
  }

  .text {
    opacity: 0.5;
    font-size: 10px;
    text-transform: uppercase;
  }
`,Qi=({text:e,title:r,icon:i,style:s})=>I.jsxs(vc,{style:s,children:[I.jsx("div",{className:"icon",children:i}),I.jsx("div",{className:"title",children:r}),I.jsx("div",{className:"text",children:e})]});Qi.displayName="EmptyElement";var $a={responsive:"style_containerBox_responsive__lw80su2 style_containerBoxBase__lw80su1",adaptive:"style_containerBox_adaptive__lw80su3 style_containerBoxBase__lw80su1"},_c={column:"style_dragIndicator_column__lw80su6 style_dragIndicatorBase__lw80su5",row:"style_dragIndicator_row__lw80su7 style_dragIndicatorBase__lw80su5"};const ea=({bgProps:e})=>{const{useExternalUrl:r=!1,externalUrl:i="",imgId:s,customBackgroundImage:l,color:c="",customBackgroundImageblur:o=0,customBackgroundImageOpacity:h=100,backgroundPosition:g="center",fillType:d="cover",backgroundSizeX:p,backgroundSizeY:w}=e??{};let _="cover";if(d==="fill")_="auto";else if(d==="custom"){const{value:E,unit:b="%"}=p??{},{value:L,unit:A="%"}=w??{},k=E===void 0?"auto":E+b,U=L===void 0?"auto":L+A;_=`${k} ${U}`}else _=d;const S=l?Xi({imgId:s,useExternalUrl:r,externalUrl:i}):{fullImageUrl:"",localImageAttributes:null};return{backgroundColor:c,opacity:String(h/100),blur:`blur(${o}px)`,backgroundSize:_,backgroundPosition:g,backgroundImageUrl:S}},yt=({sizeObj:e,sizePropName:r,defaultValue:i})=>R.useMemo(()=>e?.value!==void 0&&e?.value!==null?{[r]:e.value+(e?.unit||"px")}:i&&i?.value&&i?.unit?{[r]:i.value+i.unit}:{},[e,r,i]),yc=({currentContainerOptions:e,isGlobal:r,globalPosition:i,currentPageContainersFlow:s,renderAsElement:l,showBoundingBox:c,isEditedNow:o})=>{const h=R.useMemo(()=>{if(e){let k={};const{manualMode:U,value:N,unit:P}=e.size||{};if(U){if(r)(i==="top"||i==="bottom")&&(P==="px"?k={height:N+P,minHeight:N+P}:P==="%"&&(k={height:`${N}cqh`,minHeight:`${N}cqh`})),(i==="left"||i==="right")&&(P==="px"?k={width:N+P,minWidth:N+P}:P==="%"&&(k={width:`${N}cqw`,minWidth:`${N}cqw`}));else if(N!==void 0&&P)switch(s){case"column":k={height:N+P,minHeight:N+P};break;case"row":k={width:N+P,minWidth:N+P};break;default:k={};break}}else k={};let G={};const{useBorder:$,...J}=e.border||{};G=$?J:{};let X={};!l&&c&&o&&(X={outline:`1px ${r?"#ee00ff":"hsl(177, 100%, 57%)"} dashed !important`});let Z={};return l&&c&&(Z={pointerEvents:"none"}),{...G,...k,...X,...Z}}return{}},[e,s,i,o,r,l,c]),{globalPadding:g}=yt({sizeObj:e?.padding,sizePropName:"globalPadding"}),d={paddingTop:g,paddingRight:g,paddingBottom:g,paddingLeft:g},p=yt({sizeObj:e?.paddingTop,sizePropName:"paddingTop"}),w=yt({sizeObj:e?.paddingBottom,sizePropName:"paddingBottom"}),_=yt({sizeObj:e?.paddingLeft,sizePropName:"paddingLeft"}),S=yt({sizeObj:e?.paddingRight,sizePropName:"paddingRight"}),E=yt({sizeObj:e.gap,sizePropName:"gap",defaultValue:{value:1,unit:"em"}}),b=e.backgroundElementsBlur?{backdropFilter:`blur(${e.backgroundElementsBlur}px)`,WebkitBackdropFilter:`blur(${e.backgroundElementsBlur}px)`}:{},L=l?{}:{container:"ContainerBox / inline-size"},A=R.useMemo(()=>{const{backgroundColor:k,opacity:U,blur:N,backgroundSize:P,backgroundPosition:G,backgroundImageUrl:$}=ea({bgProps:e?.background});return{"--backgroundColor":k||"transparent","--opacity":U,"--blur":N,"--backgroundSize":P,"--backgroundPosition":G,"--backgroundImage":`url(${$.fullImageUrl??"bad_url"})`}},[e?.background]);return{...h,flexFlow:e.flow,alignItems:e.align,justifyContent:e.distribution,...E,...d,...p,...w,..._,...S,...b,...L,"--selectedContainerOutlineColor":r?"#ce0aff":"#38fff8",...A}},bc=I.jsx("svg",{style:{opacity:.5},version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 226 226",children:I.jsxs("g",{fill:"none",fillRule:"nonzero",stroke:"none",strokeWidth:"1",strokeLinecap:"butt",strokeLinejoin:"miter",strokeMiterlimit:"10",strokeDasharray:"",strokeDashoffset:"0",fontFamily:"none",fontWeight:"none",fontSize:"none",textAnchor:"none",children:[I.jsx("path",{d:"M0,226v-226h226v226z",fill:"none"}),I.jsx("g",{fill:"#ffffff",children:I.jsx("path",{d:"M113,30.13333c-2.147,0 -4.18688,0.47401 -6.03255,1.28008l-71.97865,29.39766c-2.825,1.0848 -4.85547,3.77973 -4.85547,6.98893c0,3.2092 2.03047,5.90413 4.85547,6.98893l72.30235,29.54479c1.75526,0.7232 3.68238,1.13295 5.70885,1.13295c2.02647,0 3.96077,-0.40975 5.72357,-1.13295l72.30234,-29.54479c2.81747,-1.0848 4.84075,-3.77973 4.84075,-6.98893c0,-3.2092 -2.03047,-5.90413 -4.85547,-6.98893l-71.97865,-29.39766c-1.84567,-0.8136 -3.88555,-1.28008 -6.03255,-1.28008zM53.27773,98.53659l-18.28893,7.47448c-2.825,1.0848 -4.85547,3.77973 -4.85547,6.98893c0,3.2092 2.03047,5.90413 4.85547,6.98893l72.30235,29.54479c1.75526,0.7232 3.68238,1.13295 5.70885,1.13295c2.02647,0 3.96077,-0.40975 5.72357,-1.13295l72.30234,-29.54479c2.81747,-1.0848 4.84075,-3.77973 4.84075,-6.98893c0,-3.2092 -2.03047,-5.90413 -4.85547,-6.98893l-18.28894,-7.47448l-48.28984,19.73086c-3.6612,1.50667 -7.50755,2.26588 -11.43242,2.26588c-3.92487,0 -7.77911,-0.76675 -11.41771,-2.26588zM53.27773,143.73659l-18.28893,7.47448c-2.825,1.0848 -4.85547,3.77973 -4.85547,6.98893c0,3.2092 2.03047,5.90413 4.85547,6.98893l72.30235,29.54479c1.75526,0.7232 3.68238,1.13295 5.70885,1.13295c2.02647,0 3.96077,-0.40975 5.72357,-1.13295l72.30234,-29.54479c2.81747,-1.0848 4.84075,-3.77973 4.84075,-6.98893c0,-3.2092 -2.03047,-5.90413 -4.85547,-6.98893l-18.28894,-7.47448l-48.28984,19.73086c-3.6612,1.50667 -7.50755,2.26588 -11.43242,2.26588c-3.92487,0 -7.77911,-0.76675 -11.41771,-2.26588z"})})]})}),Sc=()=>It.getState().envState==="editor"?I.jsx(Qi,{style:{},icon:bc,title:"No elements"}):null,Ds=({isGlobal:e,containerIndex:r,index:i})=>`${e?"globalContainer":"container"}-${r}-element-${i}`;function Cs({object:e,newValue:r,path:i}){const s=i.split("."),l=s.pop();if(!l){console.error("Invalid path:",i);return}let c=e;for(const o of s){if(!(o in c)){console.error("Path not found:",i,e);return}c=c[o]}c[l]=r}function Mn(e){return e.length<=2?e:e.slice(1,-1)}const Ec=({variablesUsed:e})=>{const r=R.useMemo(()=>{if(!e||!Object.keys(e).length)return;const c=new Set;for(const o of Object.values(e))c.add(Mn(o));return Array.from(c)},[e]),i=Ji({varNamesToSubscribe:r}),s=R.useMemo(()=>{if(!i)return;const c=new Map;for(const o of i){const{currentValue:h,defaultValue:g,name:d}=o??{};if(!d)return;const p=h===void 0||h===""?g:h;c.set(d,p)}return c},[i]);return R.useMemo(()=>{if(!s||!e)return;const c={};if(e&&Object.keys(e).length)for(const[o,h]of Object.entries(e)){const g=s.get(Mn(h))??null;c[o]=g}return c},[s,e])},xc=({statesUsed:e})=>{const r=R.useMemo(()=>{if(!e||!Object.keys(e).length)return;const c=new Set;for(const o of Object.values(e))c.add(Mn(o));return c},[e]),i=Zi(c=>{if(r)return c.entries.filter(o=>r.has(o.name))}),s=R.useMemo(()=>{if(!i)return;const c=new Map;for(const{name:o,value:h}of i)c.set(o,h);return c},[i]);return R.useMemo(()=>{if(!s)return;const c={};if(e&&Object.keys(e).length)for(const[o,h]of Object.entries(e)){const g=s.get(Mn(h))??null;c[o]=g}return c},[s,e])},ta=({filter:e,isDynamic:r})=>{const i=R.useMemo(()=>{if(!e?.length||!r)return[];const o=$t.getState().workingProject?.attributes.modificators.data;let h=[];for(const g of e){const{variableId:d,condition:p,field:w}=g;if(d)h.push(d);else if(p==="function"&&w){const _=o?.find(E=>E.attributes.uid===w);if(!_)continue;const S=_.attributes.dynamicDataUsed?.variablesUsed;if(!S)continue;S==="*"?h.push("*"):h=[...h,...S]}}return h.some(g=>g==="*")?["*"]:[...new Set(h)]},[e,r]),s=Ji({varNamesToSubscribe:i}),l=R.useMemo(()=>!e?.length||!r?[]:[...new Set(e.flatMap(h=>h.state?[h.state]:[]))],[e,r]),c=Zi(o=>o.entries.filter(h=>l.includes(h.name)));return{subscribedVariablesFromFilter:s,subscribedStatesFromFilter:c}},Is=({obj:e={},pathArr:r=[]})=>{const i={};if(!e||Object.keys(e).length===0)return i;for(const s of r){if(!s.startsWith("{main."))continue;const c=s.slice(6,-1).split(".");let o=e,h=!0;for(const g of c)if(o&&Object.prototype.hasOwnProperty.call(o,g))o=o[g];else{h=!1;break}h?i[s]=o:i[s]=void 0}return i},Tc=({datasourceUsed:e,filter:r,isDynamic:i=!1,dataset:s,isSkipDatasourcePassValues:l,calculatedParameters:c})=>{const[o,h]=R.useState(),g=R.useMemo(()=>l||!e||!Object.keys(e).length?null:new Set(Object.values(e).map(w=>w)),[e,l]),{subscribedVariablesFromFilter:d,subscribedStatesFromFilter:p}=ta({filter:r,isDynamic:i});return R.useEffect(()=>{if(l||!i||!s||!g||!g.size){h(null);return}const w={},_=ws.getState().getDatasourceCalculatedData(s);if(!_){h(w);return}Ls(r,_,void 0,void 0,void 0,void 0,void 0,c).then(S=>{const E=Is({obj:S,pathArr:Array.from(g)});for(const[b,L]of Object.entries(e??{})){const A=E?.[L]??null;w[b]=A}}).catch(S=>{console.log("Error apply filters to dataset",S)}).finally(()=>{h(w)})},[d,p,i,g,s,r,e,l,c]),o},Mc=({parametersUsed:e,calculatedParameters:r})=>R.useMemo(()=>{if(!e||!Object.keys(e).length)return;const s={};for(const[l,c]of Object.entries(e)){const{currentValue:o,defaultValue:h}=r?.find(({name:g})=>g===Mn(c))??{defaultValue:void 0};s[l]=o??h??null}return s},[r,e]);function ra({propsToFill:e,calculatedParameters:r}){const{variablesUsed:i,datasourceUsed:s,statesUsed:l,parametersUsed:c}=e?.dynamicDataUsed??{},{isDynamic:o,filter:h,dataset:g,type:d}=e??{},p=d==="subpageList"||!!e?.numericPageId,w=Ec({variablesUsed:i}),_=xc({statesUsed:l}),S=Mc({parametersUsed:c,calculatedParameters:r}),E=Tc({isSkipDatasourcePassValues:p,datasourceUsed:s,filter:h,isDynamic:o,dataset:g,calculatedParameters:r});return R.useMemo(()=>{if(!e||E===void 0)return null;const L={...E,..._,...w,...S};if(!Object.keys(L).length)return e;const A=structuredClone(e);for(const[k,U]of Object.entries(L))Cs({object:A,newValue:U,path:k});return A},[E,S,e,_,w])}function wc({propsToFill:e}){const r=$t.getState().workingProject?.attributes?.modificators?.data??[];if(e!=null&&"attachedFunctions"in e&&e.attachedFunctions!==void 0&&e.attachedFunctions?.length>0){const i={};for(const s of e.attachedFunctions)if(s.modificatorId&&s.modificatorId!==void 0&&s.name&&s.name!==void 0){const l=r.find(c=>c.attributes.uid===String(s.modificatorId));if(l&&l!==void 0&&l?.attributes?.function!==void 0)try{const c=Ku(l.attributes.function);i[s.name]=c(e[s.name])}catch(c){console.log(c)}}return{...e,...i}}return e}const Lc=({propsToFill:e})=>{const{attachedFunctions:r=[]}=e??{},i=R.useMemo(()=>{if(!e||!r.length)return[];const c=$t.getState().workingProject?.attributes?.modificators?.data??[];let o=[];for(const h of r){const{modificatorId:g}=h,p=c.find(w=>w.attributes.uid===String(g))?.attributes.dynamicDataUsed?.variablesUsed??[];if(p==="*"){o=p;break}o=[...o,...p]}return o},[r,e]),s=Ji({varNamesToSubscribe:i});return R.useMemo(()=>e?wc({propsToFill:e}):null,[e,s])},bn=pt(jt)`
  cursor: pointer;
  background: rgba(255, 255, 255, 0.1);
  border-radius: ${({theme:e})=>e.borderRadius};
  padding: 1.2em 1.5em;
  white-space: nowrap;
  min-width: min-content;
  min-height: min-content;
  color: inherit;
  font-size: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.3em;
  user-select: none;
  transition: 50ms;
  position: relative;
  z-index: ${({zIndex:e})=>e??1};
  isolation: isolate;
 

  &.ghost {
    background: none;
  }

  &.danger {
    background: none;
    border: 0.5px solid rgba(247, 54, 54, 0.4);
    color: rgba(240, 0, 0, 0.93);
  }

  &.size-large {
    font-size: 1.2em;
  }

  &.size-small {
    font-size: 0.7em;
  }

  &.contentAlign-end {
    justify-content: end;
  }

  &.contentAlign-start {
    justify-content: start;
  }

  &.iconPosition-top {
    flex-flow: column;

    &.contentAlign-end {
      align-items: end;
    }

    &.contentAlign-start {
      align-items: start;
    }
  }

  &.iconPosition-bottom {
    flex-flow: column-reverse;
    &.contentAlign-end {
      align-items: end;
    }

    &.contentAlign-start {
      align-items: start;
    }
  }

  &.iconPosition-right {
    flex-flow: row-reverse;
  }

  &:before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    right: 0;
    bottom: 0;
    transform: scale(0);
    opacity: 0.1;
    transition: 200ms;
    z-index: -1;
    border-radius: inherit;
  }

  &:not([data-isdevmode]) {
    &:active {
    /* scale: 0.85; */
    translate: 1px 1px;
  }
}


  &.isPressed {
    &:not(.ghost):not(.danger) {
      background: ${({theme:e})=>e.colors.primaryColor};
      color: #000;
    }
    &.ghost {
      color: ${({theme:e})=>e.colors.primaryColor};
    }
    &.danger,
    &.element_button.danger {
      background: rgba(255, 84, 46, 0.93);
      color: #fff;
    }
  }

  ${({$isActive:e})=>e&&Ya`
      &:before {
        display: block;
        transform: scale(1);
        opacity: 1;
      }
      color: #212121;
      box-shadow: 0px 69px 112px rgba(186, 255, 237, 0.1), 0px 44.7222px 65.5926px rgba(186, 255, 237, 0.0759259),
        0px 26.5778px 35.6741px rgba(186, 255, 237, 0.0607407), 0px 13.8px 18.2px rgba(186, 255, 237, 0.05),
        0px 5.62222px 9.12593px rgba(186, 255, 237, 0.0392593), 0px 1.27778px 4.40741px rgba(186, 255, 237, 0.0240741);
    `}/* ${({$isEnabled:e})=>!e&&Ya`
      pointer-events: none;
      opacity: 0.5;
    `} */
`,dt=1,Ps=2,Os=4,Yt=8,Ci=16,jn=32,pr=64,Ii={a:{content:dt|Yt,self:!1,type:dt|Yt|jn|pr},address:{invalid:["h1","h2","h3","h4","h5","h6","address","article","aside","section","div","header","footer"],self:!1},audio:{children:["track","source"]},br:{type:dt|Yt,void:!0},body:{content:dt|Ps|Os|Yt|Ci|jn|pr},button:{content:Yt,type:dt|Yt|jn|pr},caption:{content:dt,parent:["table"]},col:{parent:["colgroup"],void:!0},colgroup:{children:["col"],parent:["table"]},details:{children:["summary"],type:dt|jn|pr},dd:{content:dt,parent:["dl"]},dl:{children:["dt","dd"],type:dt},dt:{content:dt,invalid:["footer","header"],parent:["dl"]},figcaption:{content:dt,parent:["figure"]},footer:{invalid:["footer","header"]},header:{invalid:["footer","header"]},hr:{type:dt,void:!0},img:{void:!0},li:{content:dt,parent:["ul","ol","menu"]},main:{self:!1},ol:{children:["li"],type:dt},picture:{children:["source","img"],type:dt|Yt|Ci},rb:{parent:["ruby","rtc"]},rp:{parent:["ruby","rtc"]},rt:{content:Yt,parent:["ruby","rtc"]},rtc:{content:Yt,parent:["ruby"]},ruby:{children:["rb","rp","rt","rtc"]},source:{parent:["audio","video","picture"],void:!0},summary:{content:Yt,parent:["details"]},table:{children:["caption","colgroup","thead","tbody","tfoot","tr"],type:dt},tbody:{parent:["table"],children:["tr"]},td:{content:dt,parent:["tr"]},tfoot:{parent:["table"],children:["tr"]},th:{content:dt,parent:["tr"]},thead:{parent:["table"],children:["tr"]},tr:{parent:["table","tbody","thead","tfoot"],children:["th","td"]},track:{parent:["audio","video"],void:!0},ul:{children:["li"],type:dt},video:{children:["track","source"]},wbr:{type:dt|Yt,void:!0}};function Gr(e){return r=>{Ii[r]={...e,...Ii[r]}}}["address","main","div","figure","p","pre"].forEach(Gr({content:dt,type:dt|pr}));["abbr","b","bdi","bdo","cite","code","data","dfn","em","i","kbd","mark","q","ruby","samp","strong","sub","sup","time","u","var"].forEach(Gr({content:Yt,type:dt|Yt|pr}));["p","pre"].forEach(Gr({content:Yt,type:dt|pr}));["s","small","span","del","ins"].forEach(Gr({content:Yt,type:dt|Yt}));["article","aside","footer","header","nav","section","blockquote"].forEach(Gr({content:dt,type:dt|Ps|pr}));["h1","h2","h3","h4","h5","h6"].forEach(Gr({content:Yt,type:dt|Os|pr}));["audio","canvas","iframe","img","video"].forEach(Gr({type:dt|Yt|Ci|pr}));const Pi=Object.freeze(Ii),kc=["applet","base","body","command","embed","frame","frameset","head","html","link","meta","noscript","object","script","style","title"],Ac=Object.keys(Pi).filter(e=>e!=="canvas"&&e!=="iframe"),_t=1,Rc=2,_n=3,en=4,Fs=5,Va=Object.freeze({alt:_t,cite:_t,class:_t,colspan:_n,controls:en,datetime:_t,default:en,disabled:en,dir:_t,height:_t,href:_t,id:_t,kind:_t,label:_t,lang:_t,loading:_t,loop:en,media:_t,muted:en,poster:_t,rel:_t,role:_t,rowspan:_n,scope:_t,sizes:_t,span:_n,start:_n,style:Fs,src:_t,srclang:_t,srcset:_t,tabindex:_t,target:_t,title:_t,type:_t,width:_t}),Dc=Object.freeze({class:"className",colspan:"colSpan",datetime:"dateTime",rowspan:"rowSpan",srclang:"srcLang",srcset:"srcSet",tabindex:"tabIndex"});function qn(){return qn=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},qn.apply(this,arguments)}function Ns({attributes:e={},className:r,children:i=null,selfClose:s=!1,tagName:l}){const c=l;return s?ze.createElement(c,qn({className:r},e)):ze.createElement(c,qn({className:r},e),i)}class Cc{attribute(r,i){return i}node(r,i){return i}}/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */var Ic=/["'&<>]/,Pc=Oc;function Oc(e){var r=""+e,i=Ic.exec(r);if(!i)return r;var s,l="",c=0,o=0;for(c=i.index;c<r.length;c++){switch(r.charCodeAt(c)){case 34:s="&quot;";break;case 38:s="&amp;";break;case 39:s="&#39;";break;case 60:s="&lt;";break;case 62:s="&gt;";break;default:continue}o!==c&&(l+=r.substring(o,c)),o=c+1,l+=s}return o!==c?l+r.substring(o,c):l}const Fc=Ur(Pc);var Ka={};function xr(e,r,i){return r in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i,e}const Nc=/(url|image|image-set)\(/i;class Yc extends Cc{attribute(r,i){return r==="style"&&Object.keys(i).forEach(s=>{String(i[s]).match(Nc)&&delete i[s]}),i}}const Wa=1,Bc=3,jc=/^<(!doctype|(html|head|body)(\s|>))/i,Uc=/^(aria-|data-|\w+:)/iu,Hc=/{{{(\w+)\/?}}}/;function zc(){if(!(typeof window>"u"||typeof document>"u"))return document.implementation.createHTMLDocument("Interweave")}class Ys{constructor(r,i={},s=[],l=[]){var c;xr(this,"allowed",void 0),xr(this,"banned",void 0),xr(this,"blocked",void 0),xr(this,"container",void 0),xr(this,"content",[]),xr(this,"props",void 0),xr(this,"matchers",void 0),xr(this,"filters",void 0),xr(this,"keyIndex",void 0),this.props=i,this.matchers=s,this.filters=[...l,new Yc],this.keyIndex=-1,this.container=this.createContainer(r||""),this.allowed=new Set((c=i.allowList)!==null&&c!==void 0?c:Ac),this.banned=new Set(kc),this.blocked=new Set(i.blockList)}applyAttributeFilters(r,i){return this.filters.reduce((s,l)=>s!==null&&typeof l.attribute=="function"?l.attribute(r,s):s,i)}applyNodeFilters(r,i){return this.filters.reduce((s,l)=>s!==null&&typeof l.node=="function"?l.node(r,s):s,i)}applyMatchers(r,i){const s={},{props:l}=this;let c=r,o=0,h=null;return this.matchers.forEach(g=>{const d=g.asTag().toLowerCase(),p=this.getTagConfig(d);if(l[g.inverseName]||!this.isTagAllowed(d)||!this.canRenderChild(i,p))return;let w="";for(;c&&(h=g.match(c));){const{index:_,length:S,match:E,valid:b,void:L,...A}=h,k=g.propName+String(o);_>0&&(w+=c.slice(0,_)),b?(w+=L?`{{{${k}/}}}`:`{{{${k}}}}${E}{{{/${k}}}}`,this.keyIndex+=1,o+=1,s[k]={children:E,matcher:g,props:{...l,...A,key:this.keyIndex}}):w+=E,g.greedy?(c=w+c.slice(_+S),w=""):c=c.slice(_+(S||E.length))}g.greedy||(c=w+c)}),o===0?r:this.replaceTokens(c,s)}canRenderChild(r,i){return!r.tagName||!i.tagName||r.void?!1:r.children.length>0?r.children.includes(i.tagName):r.invalid.length>0&&r.invalid.includes(i.tagName)?!1:i.parent.length>0?i.parent.includes(r.tagName):!r.self&&r.tagName===i.tagName?!1:!!(r&&r.content&i.type)}convertLineBreaks(r){const{noHtml:i,disableLineBreaks:s}=this.props;if(i||s||r.match(/<((?:\/[ a-z]+)|(?:[ a-z]+\/))>/gi))return r;let l=r.replace(/\r\n/g,`
`);return l=l.replace(/\n{3,}/g,`


`),l=l.replace(/\n/g,"<br/>"),l}createContainer(r){var i;const l=(typeof Ka<"u"&&Ka.INTERWEAVE_SSR_POLYFILL||zc)();if(!l)return;const c=(i=this.props.containerTagName)!==null&&i!==void 0?i:"body",o=c==="body"||c==="fragment"?l.body:l.createElement(c);return r.match(jc)||(o.innerHTML=this.convertLineBreaks(this.props.escapeHtml?Fc(r):r)),o}extractAttributes(r){const{allowAttributes:i}=this.props,s={};let l=0;return r.nodeType!==Wa||!r.attributes||([...r.attributes].forEach(c=>{const{name:o,value:h}=c,g=o.toLowerCase(),d=Va[g]||Va[o];if(!this.isSafe(r)||!g.match(Uc)&&(!i&&(!d||d===Rc)||g.startsWith("on")||h.replace(/(\s|\0|&#x0([9AD]);)/,"").match(/(javascript|vbscript|livescript|xss):/i)))return;let p=g==="style"?this.extractStyleAttribute(r):h;d===en?p=!0:d===_n?p=Number.parseFloat(String(p)):d!==Fs&&(p=String(p)),s[Dc[g]||g]=this.applyAttributeFilters(g,p),l+=1}),l===0)?null:s}extractStyleAttribute(r){const i={};return Array.from(r.style).forEach(s=>{const l=r.style[s];(typeof l=="string"||typeof l=="number")&&(i[s.replace(/-([a-z])/g,(c,o)=>String(o).toUpperCase())]=l)}),i}getTagConfig(r){const i={children:[],content:0,invalid:[],parent:[],self:!0,tagName:"",type:0,void:!1};return Pi[r]?{...i,...Pi[r],tagName:r}:i}isSafe(r){if(typeof HTMLAnchorElement<"u"&&r instanceof HTMLAnchorElement){const i=r.getAttribute("href");if(i!=null&&i.startsWith("#"))return!0;const s=r.protocol.toLowerCase();return s===":"||s==="http:"||s==="https:"||s==="mailto:"||s==="tel:"}return!0}isTagAllowed(r){return this.banned.has(r)||this.blocked.has(r)?!1:this.props.allowElements||this.allowed.has(r)}parse(){return this.container?this.parseNode(this.container,this.getTagConfig(this.container.nodeName.toLowerCase())):[]}parseNode(r,i){const{noHtml:s,noHtmlExceptMatchers:l,allowElements:c,transform:o,transformOnlyAllowList:h}=this.props;let g=[],d="";return[...r.childNodes].forEach(p=>{if(p.nodeType===Wa){const _=p.nodeName.toLowerCase(),S=this.getTagConfig(_);d&&(g.push(d),d="");const E=this.applyNodeFilters(_,p);if(!E)return;let b;if(o&&!(h&&!this.isTagAllowed(_))){this.keyIndex+=1;const L=this.keyIndex;b=this.parseNode(E,S);const A=o(E,b,S);if(A===null)return;if(typeof A<"u"){g.push(ze.cloneElement(A,{key:L}));return}this.keyIndex=L-1}if(this.banned.has(_))return;if(!(s||l&&_!=="br")&&this.isTagAllowed(_)&&(c||this.canRenderChild(i,S))){var w;this.keyIndex+=1;const L=this.extractAttributes(E),A={tagName:_};L&&(A.attributes=L),S.void&&(A.selfClose=S.void),g.push(ze.createElement(Ns,{...A,key:this.keyIndex},(w=b)!==null&&w!==void 0?w:this.parseNode(E,S)))}else g=[...g,...this.parseNode(E,S.tagName?S:i)]}else if(p.nodeType===Bc){const _=s&&!l?p.textContent:this.applyMatchers(p.textContent||"",i);Array.isArray(_)?g=[...g,..._]:d+=_}}),d&&g.push(d),g}replaceTokens(r,i){if(!r.includes("{{{"))return r;const s=[];let l=r,c=null;for(;c=l.match(Hc);){const[o,h]=c,g=c.index,d=o.includes("/");g>0&&(s.push(l.slice(0,g)),l=l.slice(g));const{children:p,matcher:w,props:_}=i[h];let S;if(d)S=o.length,s.push(w.createElement(p,_));else{const E=l.match(new RegExp(`{{{/${h}}}}`));S=E.index+E[0].length,s.push(w.createElement(this.replaceTokens(l.slice(o.length,E.index),i),_))}l=l.slice(S)}return l.length>0&&s.push(l),s.length===0?"":s.length===1&&typeof s[0]=="string"?s[0]:s}}function Gc(e){var r;const{attributes:i,className:s,containerTagName:l,content:c,emptyContent:o,parsedContent:h,tagName:g,noWrap:d}=e,p=(r=l??g)!==null&&r!==void 0?r:"span",w=p==="fragment"?!0:d;let _;if(h)_=h;else{const S=new Ys(c??"",e).parse();S.length>0&&(_=S)}return _||(_=o),w?ze.createElement(ze.Fragment,null,_):ze.createElement(Ns,{attributes:i,className:s,tagName:p},_)}function $c(e){const{attributes:r,className:i,content:s="",disableFilters:l=!1,disableMatchers:c=!1,emptyContent:o=null,filters:h=[],matchers:g=[],onAfterParse:d=null,onBeforeParse:p=null,tagName:w="span",noWrap:_=!1,...S}=e,E=c?[]:g,b=l?[]:h,L=p?[p]:[],A=d?[d]:[];E.forEach(P=>{P.onBeforeParse&&L.push(P.onBeforeParse.bind(P)),P.onAfterParse&&A.push(P.onAfterParse.bind(P))});const k=L.reduce((P,G)=>G(P,e),s??""),U=new Ys(k,S,E,b),N=A.reduce((P,G)=>G(P,e),U.parse());return ze.createElement(Gc,{attributes:r,className:i,containerTagName:e.containerTagName,emptyContent:o,noWrap:_,parsedContent:N.length===0?void 0:N,tagName:w})}function Vc(e){const r=/(<([\w-]+)\s*[^>]*?\/>)(?!<\/\2\s*>)/g;let i=e,s;for(;s=r.exec(e);){const l=s[1],o=`</${s[2]}>`;i=i.replace(l,`${l}${o}`)}return i}function Kc(e){if(e){const r=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");return Vc(r)}else return e}const Wc=ze.memo(({getTextFromDatasource:e,defaultText:r,filter:i=null})=>{const{subscribedVariablesFromFilter:s,subscribedStatesFromFilter:l}=ta({filter:i,isDynamic:!0}),[c,o]=R.useState();return R.useLayoutEffect(()=>{e.then(h=>{if(h===void 0||h===""){o(null);return}o(g=>{const d=String(h);return d===g?g:d})}).catch(()=>{o(null),console.log("Error getting text value from datasource")})},[s,l,e]),c===void 0?null:c??r}),Xc=ze.memo(({stateVariableName:e,defaultText:r})=>{const[i,s]=ze.useState(r),[l,c]=ze.useState(""),o=Xn(d=>d.calculatedVariables),{calculatedParameters:h}=R.useContext(qi),g=Zi(d=>d.entries);return R.useLayoutEffect(()=>{if(e!=null&&e!==""){const d=e.split(","),p=[],w=[];let _=e;for(const S of d){const[E,b]=S.split("=");E==="variableName"?p.push(b):E==="parameterName"&&w.push(b)}if(w.length>0)for(const S of w){const E=h?.find(b=>b.name===S);if(E){const{currentValue:b,defaultValue:L}=E,A=b===void 0?L:b;_&&_!==void 0&&(_=_.replace(`parameterName=${S}`,A.toString()))}}if(p.length>0)for(const S of p){const E=Object.values(o??{})?.find(b=>b.name===S);if(E){const{currentValue:b,defaultValue:L}=E,A=b===void 0?L:b;_&&_!==void 0&&(_=_.replace(`variableName=${S}`,A.toString()))}}_&&_!==void 0&&c(_?.replace(/,/g,""))}},[h,o,e]),R.useLayoutEffect(()=>{const d=g.find(p=>p.name===l)?.value;d!==void 0&&d!==r&&s(d)},[l,r,g,e]),I.jsx(I.Fragment,{children:i})}),qc=ze.memo(({trueText:e,falseText:r,variableName:i,childrenText:s})=>{const l=Vu(i);if(!l)return s;const{calculatedValue:c,targetVariable:{type:o}}=l;return o==="boolean"?c?e:r:c===""||c===null||c===void 0?s:c}),Jc=ze.memo(({parameterName:e,defaultText:r})=>{const{calculatedParameters:i}=R.useContext(qi),s=R.useMemo(()=>i?.find(o=>o.name===e),[i,e]);if(!s)return r;const{currentValue:l,defaultValue:c}=s;return l??c??r}),Rt=ze.memo(({text:e,style:r,indexInList:i,...s})=>{const l=Kc(String(e??"")),{dataset:c,datasetPath:o,filter:h}=s,g=R.useCallback((d,p)=>{const w=p?.[0];if(d.tagName.toLowerCase()==="state"){const _=d.getAttribute("name");return I.jsx(Xc,{stateVariableName:_,defaultText:w})}if(d.tagName.toLowerCase()==="serial_fb"){const _=d.getAttribute("signal");return I.jsx(Ju,{signalName:_,placeholder:w})}if(d.tagName.toLowerCase()==="analog_fb"){const _=d.getAttribute("signal")||void 0;return I.jsx(Zu,{signalName:_})}if(d.tagName.toLowerCase()==="digital_fb"){const _=d.getAttribute("signal")||void 0,S=d.getAttribute("true")||"",E=d.getAttribute("false")||"";return I.jsx(Qu,{signalName:_,trueText:S,falseText:E})}if(d.tagName.toLowerCase()==="varstring"||d.tagName.toLowerCase()==="varnumber"||d.tagName.toLowerCase()==="varboolean"){const _=d.getAttribute("variableName")||"",S=d.getAttribute("true"),E=d.getAttribute("false");return I.jsx(qc,{trueText:S,falseText:E,childrenText:w||"",variableName:_})}if(d.tagName.toLowerCase()==="datasource"){let _=d.getAttribute("valuePath")||"";_&&(_=_.substring(1,_.length-1));const S=Wu(c,o,h,_,i);return I.jsx(Wc,{filter:h,defaultText:w,getTextFromDatasource:S})}if(d.tagName.toLowerCase()==="parameter"){let _=d.getAttribute("name")||"";return _&&(_=_.substring(1,_.length-1)),I.jsx(Jc,{defaultText:w,parameterName:_})}},[c,o,h,i]);return I.jsx("div",{className:"htmlFromStringTextInnerBox",style:r,children:I.jsx($c,{transform:g,allowAttributes:!0,allowElements:!0,content:l})})}),Et=e=>{let r={};return e?.value!==void 0&&(r={fontSize:e.value+(e?.unit||"px")}),r},Bs=ze.memo(e=>{const{cssClass:r,text:i,index:s,style:l,indexInList:c,iconName:o,iconPosition:h,size:g,actions:d,buttonDesign:p,width:w,height:_,state:S,iconSize:E,textFontSize:b,gap:L,padding:A,paddingTop:k,paddingBottom:U,paddingLeft:N,paddingRight:P,textColor:G,iconColor:$,backgroundColor:J,border:X,dataset:Z,datasetPath:ie,filter:de,textTransform:_e="none",parentArrayIndex:Ee,parentData:Se,iconImageData:le,useImageAsIcon:pe,contentAlign:he="center",allowTextWrap:Te=!1,fontFamily:xe="inherit",boxShadow:ye,boxReflect:ge,staticDevMoveableRef:be,constraintsVertical:fe,constraintsHorizontal:Ue,isStaticElement:Ce,left:ae,top:we,right:Ae,bottom:Oe,deltaCenterX:Fe,deltaCenterY:Ne}=e,Be=Ee,qe=R.useRef(null),Ie=Pt(S,s),Je=Mt({width:w,height:_,constraintsVertical:fe,constraintsHorizontal:Ue,isStaticElement:Ce,left:ae,top:we,right:Ae,bottom:Oe,deltaCenterX:Fe,deltaCenterY:Ne}),We=Et(E),nt=Et(b),ft=yt({sizeObj:L,sizePropName:"gap"}),{globalPadding:j}=yt({sizeObj:A,sizePropName:"globalPadding"}),K=yt({sizeObj:k,sizePropName:"paddingTop"}),B=yt({sizeObj:U,sizePropName:"paddingBottom"}),M=yt({sizeObj:N,sizePropName:"paddingLeft"}),C=yt({sizeObj:P,sizePropName:"paddingRight"}),Y=Hr(X),H=zr(ye),z=Xt(ge),{tapActionsArr:V,isActiveOverlayTrigger:q}=lr({indexInList:c,actions:d,dataset:Z,datasetPath:ie,filter:de,elementRef:qe,parentData:Se,parentIndex:Be}),ne=rt({[`element_${e.type}`]:!0,[`${r}`]:r,ghost:p==="ghost",danger:p==="danger",[`size-${g}`]:g,["iconPosition-"+h]:o||pe,[`contentAlign-${he}`]:!0,isActiveOverlayTrigger:!!q,...Ie}),re={...V},ee=R.useMemo(()=>({...H,...z,...ft,...{paddingTop:j,paddingRight:j,paddingBottom:j,paddingLeft:j},...K,...B,...M,...C,...J?{backgroundColor:J}:{},...Y,...G?{color:G}:{},textTransform:_e,...Te?{whiteSpace:"normal",minWidth:"5px"}:{},...Je,...l}),[J,j,Te,H,z,ft,K,B,M,C,Y,G,_e,Je,l]);return I.jsxs(bn,{ref:se=>{be&&(be.current=se),qe.current=se},...e,...re,style:{...ee,fontFamily:xe},className:ne,children:[o||pe?I.jsx(fr,{style:{...We,color:$||"inherit"},icon:o,iconImageData:le,useImageAsIcon:pe}):null,i?I.jsx(Rt,{indexInList:c,...e,style:nt,text:i}):null]})});Bs.displayName="ButtonElement";const Zc=pt(jt)`
  display: flex;
  align-items: center;
  gap: 0.3em;
line-height: normal;

  &.iconPosition-top {
    flex-flow: column;
  }

  &.iconPosition-bottom {
    flex-flow: column-reverse;
  }

  &.iconPosition-right {
    flex-flow: row-reverse;
  }

  &.size-large {
    font-size: 1.2em;
  }

  &.size-small {
    font-size: 0.7em;
  }


  .htmlFromStringTextInnerBox {
    width: 100%;
    &>span, &>p {
      width: 100%;
    }
  }
`,js=e=>{const{size:r,text:i,cssClass:s,iconName:l,iconPosition:c,state:o,iconSize:h,textFontSize:g,gap:d,actions:p,textColor:w,iconColor:_,textTransform:S="none",iconImageData:E,useImageAsIcon:b,dataset:L,datasetPath:A,filter:k,parentData:U,parentArrayIndex:N,boxReflect:P,allowTextWrap:G=!0,fontFamily:$="inherit",staticDevMoveableRef:J,constraintsVertical:X,constraintsHorizontal:Z,isStaticElement:ie,left:de,top:_e,right:Ee,bottom:Se,width:le,height:pe,index:he,deltaCenterX:Te,deltaCenterY:xe}=e,ye=N,ge=R.useRef(null),be=Pt(o,he),fe=Et(h),Ue=Et(g),Ce=yt({sizeObj:d,sizePropName:"gap"}),{tapActionsArr:ae,isActiveOverlayTrigger:we}=lr({actions:p,dataset:L,datasetPath:A,filter:k,elementRef:ge,parentData:U,parentIndex:ye}),Ae=rt({[`element_${e.type}`]:!0,[`${s}`]:s,[`size-${r}`]:r,["iconPosition-"+c]:l||b,isActiveOverlayTrigger:!!we,...be}),Oe={...ae};let Fe={};w&&(Fe={color:w});const Ne=G?{whiteSpace:"normal",minWidth:"5px"}:{whiteSpace:"nowrap"},Be=Xt(P),qe=Mt({width:le,height:pe,constraintsVertical:X,constraintsHorizontal:Z,isStaticElement:ie,left:de,top:_e,right:Ee,bottom:Se,deltaCenterX:Te,deltaCenterY:xe});return I.jsxs(Zc,{ref:Ie=>{J&&(J.current=Ie),ge.current=Ie},...e,style:{...Ce,...Fe,textTransform:S,fontFamily:$,...Be,...qe},...Oe,className:Ae,children:[l||b?I.jsx(fr,{style:{...fe,color:_||"inherit"},icon:l,iconImageData:E,useImageAsIcon:b}):null,i?I.jsx(Rt,{...e,style:{...Ue,...Ne},text:i}):null]})};js.displayName="TextElement";const Qc=pt(jt)`

display: flex;
align-items: center;
justify-content: center;


  input {
    position: relative;
    color: ${({theme:e})=>e.colors.textColor};
    background: transparent;
    outline: 0;
    border: 1px ${({theme:e})=>e.colors.textColor} solid;
    font-size: 14px;
    border-radius: ${({theme:e})=>e.borderRadius};
    padding: 1.2em 1.5em;
    opacity: 0.5;
    width: 100%;



    &:focus {
      opacity: 1;
      border-color: ${({theme:e})=>e.colors.primaryColor};
    }

    &:disabled {
      filter: saturate(30%);
      cursor: not-allowed;
    }
  }

  &.size-large input {
    font-size: 1.2em;
  }

  &.size-small input {
    font-size: 0.7em;
  }
`,Us=e=>{const{size:r,cssClass:i,width:s,input_signal_s_fb:l,state:c,textFontSize:o,placeholder:h,actions:g,fontFamily:d="inherit",boxShadow:p,boxReflect:w,height:_,constraintsVertical:S,constraintsHorizontal:E,isStaticElement:b,left:L,top:A,right:k,bottom:U,staticDevMoveableRef:N,index:P,deltaCenterX:G,deltaCenterY:$}=e,J=Pt(c,P),{displayAsPassword:X,setFocusOff_signal_d:Z,setFocusOn_signal_d:ie}=c||{},de=Wt(ie),_e=Wt(Z),Ee=or({signalName:l,placeHolder:h||""}),[Se,le]=R.useState(Ee),pe=R.useRef(),he=R.useRef(),Te=R.useRef(Ee),xe=R.useRef(Ee),ye=R.useRef(!1);R.useEffect(()=>{Te.current=Ee,le(Ee)},[Ee]),R.useEffect(()=>{xe.current=Se},[Se]);const ge=Mt({width:s,height:_,constraintsVertical:S,constraintsHorizontal:E,isStaticElement:b,left:L,top:A,right:k,bottom:U,deltaCenterX:G,deltaCenterY:$}),be=R.useRef(null);R.useEffect(()=>{be.current&&de&&be.current.focus()},[be,de]),R.useEffect(()=>{be.current&&_e&&be.current.blur()},[be,_e]);const fe=Et(o),{onBeforeChangeActions:Ue,onAfterChangeActions:Ce,onChangeActions:ae,isActiveOverlayTrigger:we}=lr({actions:g}),Ae=rt({[`element_${e.type}`]:!0,[`${i}`]:i,[`size-${r}`]:r,isActiveOverlayTrigger:!!we,...J});function Oe(Be){function qe(){clearTimeout(pe.current),pe.current=setTimeout(()=>{le(Te.current)},3e3)}if(qe(),le(Be),!ye.current){for(const Ie of Ue)Ie(Be);ye.current=!0}for(const Ie of ae)Ie(Be);Ce.length&&(clearTimeout(he.current),he.current=setTimeout(()=>{for(const Ie of Ce)Ie(xe.current);ye.current=!1},1e3))}const Fe=zr(p),Ne=Xt(w);return I.jsx(Qc,{...e,ref:Be=>{N&&(N.current=Be)},style:{...ge,fontFamily:d},className:Ae,children:I.jsx("input",{style:{...fe,...Fe,...Ne},ref:be,placeholder:h,type:X?"password":"text",value:Se,onChange:Be=>{Oe(Be.target.value)}})})};Us.displayName="InputElement";const ed=pt(jt)`
  position: relative;

  &.showBoundingBox {
    background-repeat: repeat;
    background-position: 50% 50%;
    background-size: 40px auto;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%239C92AC' fill-opacity='0.36'%3E%3Cpath d='M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41zM20 18.6l2.83-2.83 1.41 1.41L21.41 20l2.83 2.83-1.41 1.41L20 21.41l-2.83 2.83-1.41-1.41L18.59 20l-2.83-2.83 1.41-1.41L20 18.59z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
  }
`,Hs=e=>{const{cssClass:r,state:i,width:s,height:l,border:c,staticDevMoveableRef:o,constraintsVertical:h,constraintsHorizontal:g,isStaticElement:d,left:p,top:w,right:_,bottom:S,index:E,deltaCenterX:b,deltaCenterY:L}=e,A=Pt(i,E),k=It($=>$.envState),U=mt($=>$.showBoundingBox),N=Hr(c),P=Mt({width:s,height:l,constraintsVertical:h,constraintsHorizontal:g,isStaticElement:d,left:p,top:w,right:_,bottom:S,deltaCenterX:b,deltaCenterY:L}),G=rt({[`element_${e.type}`]:!0,[`${r}`]:r,showBoundingBox:k!=="live"&&k!=="build"&&U,...A});return I.jsx(ed,{...e,ref:$=>{o&&(o.current=$)},style:{...P,...N},className:G})};Hs.displayName="SpacerElement";const td=pt(jt)`
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.4em;
  position: relative;

  &.size-small {
    font-size: 0.7em;
  }

  .ant-switch {
    background: rgba(0, 0, 0, 0.8);
  }

  .ant-switch-checked {
    background: ${({color:e,theme:r})=>e||r.colors.primaryColor};
  }

  &.reverseOrder {
    flex-direction: row-reverse;
  }
`,zs=e=>{const{size:r,text:i,cssClass:s,state:l,reverseOrder:c,color:o,textFontSize:h,gap:g,textOff:d,textOn:p,actions:w,boxReflect:_,fontFamily:S="inherit",width:E,height:b,constraintsVertical:L,constraintsHorizontal:A,isStaticElement:k,left:U,top:N,right:P,bottom:G,staticDevMoveableRef:$,index:J,deltaCenterX:X,deltaCenterY:Z}=e,ie=mt(we=>we.showBoundingBox),de=Pt(l,J),_e=Wt(l?.checkedState_signal),[Ee,Se]=R.useState(_e),le=R.useRef(),pe=R.useRef(_e),he=Et(h),Te=yt({sizeObj:g,sizePropName:"gap"}),{onBeforeChangeActions:xe,onAfterChangeActions:ye,onChangeActions:ge,isActiveOverlayTrigger:be}=lr({actions:w}),fe=rt({[`element_${e.type}`]:!0,[`${s}`]:s,[`size-${r}`]:r,showBoundingBox:ie,reverseOrder:c,isActiveOverlayTrigger:!!be,...de});R.useEffect(()=>{pe.current=_e,Se(_e)},[_e]);const Ue=we=>{function Ae(){clearTimeout(le.current),le.current=setTimeout(()=>{console.log(pe.current),Se(pe.current)},3e3)}if(Ae(),xe.length)for(const Oe of xe)Oe(we);if(Se(we),ge.length)for(const Oe of ge)Oe(we);if(Se(we),ye.length)for(const Oe of ye)Oe(we)},Ce=Xt(_),ae=Mt({width:E,height:b,constraintsVertical:L,constraintsHorizontal:A,isStaticElement:k,left:U,top:N,right:P,bottom:G,deltaCenterX:X,deltaCenterY:Z});return I.jsxs(td,{...e,ref:we=>{$&&($.current=we)},style:{...Te,fontFamily:S,...Ce,...ae},color:o,className:fe,children:[I.jsx(ec,{checkedChildren:p,unCheckedChildren:d,checked:Ee,size:r==="small"?"small":void 0,className:"antSwitch",onChange:we=>{Ue(we)}}),i?I.jsx(Rt,{...e,style:he,text:i}):null]})};zs.displayName="SwitchElement";var Gs={exports:{}},$s={exports:{}},rd=function(r){return!r||typeof r=="string"?!1:r instanceof Array||Array.isArray(r)||r.length>=0&&(r.splice instanceof Function||Object.getOwnPropertyDescriptor(r,r.length-1)&&r.constructor.name!=="String")},nd=rd,id=Array.prototype.concat,ad=Array.prototype.slice,Xa=$s.exports=function(r){for(var i=[],s=0,l=r.length;s<l;s++){var c=r[s];nd(c)?i=id.call(i,ad.call(c)):i.push(c)}return i};Xa.wrap=function(e){return function(){return e(Xa(arguments))}};var sd=$s.exports,Sn=Ts(),An=sd,Vs=Object.hasOwnProperty,Ks=Object.create(null);for(var bi in Sn)Vs.call(Sn,bi)&&(Ks[Sn[bi]]=bi);var ar=Gs.exports={to:{},get:{}};ar.get=function(e){var r=e.substring(0,3).toLowerCase(),i,s;switch(r){case"hsl":i=ar.get.hsl(e),s="hsl";break;case"hwb":i=ar.get.hwb(e),s="hwb";break;default:i=ar.get.rgb(e),s="rgb";break}return i?{model:s,value:i}:null};ar.get.rgb=function(e){if(!e)return null;var r=/^#([a-f0-9]{3,4})$/i,i=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,s=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,l=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,c=/^(\w+)$/,o=[0,0,0,1],h,g,d;if(h=e.match(i)){for(d=h[2],h=h[1],g=0;g<3;g++){var p=g*2;o[g]=parseInt(h.slice(p,p+2),16)}d&&(o[3]=parseInt(d,16)/255)}else if(h=e.match(r)){for(h=h[1],d=h[3],g=0;g<3;g++)o[g]=parseInt(h[g]+h[g],16);d&&(o[3]=parseInt(d+d,16)/255)}else if(h=e.match(s)){for(g=0;g<3;g++)o[g]=parseInt(h[g+1],0);h[4]&&(h[5]?o[3]=parseFloat(h[4])*.01:o[3]=parseFloat(h[4]))}else if(h=e.match(l)){for(g=0;g<3;g++)o[g]=Math.round(parseFloat(h[g+1])*2.55);h[4]&&(h[5]?o[3]=parseFloat(h[4])*.01:o[3]=parseFloat(h[4]))}else return(h=e.match(c))?h[1]==="transparent"?[0,0,0,0]:Vs.call(Sn,h[1])?(o=Sn[h[1]],o[3]=1,o):null:null;for(g=0;g<3;g++)o[g]=Rr(o[g],0,255);return o[3]=Rr(o[3],0,1),o};ar.get.hsl=function(e){if(!e)return null;var r=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,i=e.match(r);if(i){var s=parseFloat(i[4]),l=(parseFloat(i[1])%360+360)%360,c=Rr(parseFloat(i[2]),0,100),o=Rr(parseFloat(i[3]),0,100),h=Rr(isNaN(s)?1:s,0,1);return[l,c,o,h]}return null};ar.get.hwb=function(e){if(!e)return null;var r=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,i=e.match(r);if(i){var s=parseFloat(i[4]),l=(parseFloat(i[1])%360+360)%360,c=Rr(parseFloat(i[2]),0,100),o=Rr(parseFloat(i[3]),0,100),h=Rr(isNaN(s)?1:s,0,1);return[l,c,o,h]}return null};ar.to.hex=function(){var e=An(arguments);return"#"+Un(e[0])+Un(e[1])+Un(e[2])+(e[3]<1?Un(Math.round(e[3]*255)):"")};ar.to.rgb=function(){var e=An(arguments);return e.length<4||e[3]===1?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"};ar.to.rgb.percent=function(){var e=An(arguments),r=Math.round(e[0]/255*100),i=Math.round(e[1]/255*100),s=Math.round(e[2]/255*100);return e.length<4||e[3]===1?"rgb("+r+"%, "+i+"%, "+s+"%)":"rgba("+r+"%, "+i+"%, "+s+"%, "+e[3]+")"};ar.to.hsl=function(){var e=An(arguments);return e.length<4||e[3]===1?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"};ar.to.hwb=function(){var e=An(arguments),r="";return e.length>=4&&e[3]!==1&&(r=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+r+")"};ar.to.keyword=function(e){return Ks[e.slice(0,3)]};function Rr(e,r,i){return Math.min(Math.max(r,e),i)}function Un(e){var r=Math.round(e).toString(16).toUpperCase();return r.length<2?"0"+r:r}var od=Gs.exports;const tn=od,ir=Au(),Ws=["keyword","gray","hex"],Oi={};for(const e of Object.keys(ir))Oi[[...ir[e].labels].sort().join("")]=e;const Jn={};function Bt(e,r){if(!(this instanceof Bt))return new Bt(e,r);if(r&&r in Ws&&(r=null),r&&!(r in ir))throw new Error("Unknown model: "+r);let i,s;if(e==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof Bt)this.model=e.model,this.color=[...e.color],this.valpha=e.valpha;else if(typeof e=="string"){const l=tn.get(e);if(l===null)throw new Error("Unable to parse color from string: "+e);this.model=l.model,s=ir[this.model].channels,this.color=l.value.slice(0,s),this.valpha=typeof l.value[s]=="number"?l.value[s]:1}else if(e.length>0){this.model=r||"rgb",s=ir[this.model].channels;const l=Array.prototype.slice.call(e,0,s);this.color=Fi(l,s),this.valpha=typeof e[s]=="number"?e[s]:1}else if(typeof e=="number")this.model="rgb",this.color=[e>>16&255,e>>8&255,e&255],this.valpha=1;else{this.valpha=1;const l=Object.keys(e);"alpha"in e&&(l.splice(l.indexOf("alpha"),1),this.valpha=typeof e.alpha=="number"?e.alpha:0);const c=l.sort().join("");if(!(c in Oi))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=Oi[c];const{labels:o}=ir[this.model],h=[];for(i=0;i<o.length;i++)h.push(e[o[i]]);this.color=Fi(h)}if(Jn[this.model])for(s=ir[this.model].channels,i=0;i<s;i++){const l=Jn[this.model][i];l&&(this.color[i]=l(this.color[i]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}Bt.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(e){let r=this.model in tn.to?this:this.rgb();r=r.round(typeof e=="number"?e:1);const i=r.valpha===1?r.color:[...r.color,this.valpha];return tn.to[r.model](i)},percentString(e){const r=this.rgb().round(typeof e=="number"?e:1),i=r.valpha===1?r.color:[...r.color,this.valpha];return tn.to.rgb.percent(i)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){const e={},{channels:r}=ir[this.model],{labels:i}=ir[this.model];for(let s=0;s<r;s++)e[i[s]]=this.color[s];return this.valpha!==1&&(e.alpha=this.valpha),e},unitArray(){const e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,this.valpha!==1&&e.push(this.valpha),e},unitObject(){const e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,this.valpha!==1&&(e.alpha=this.valpha),e},round(e){return e=Math.max(e||0,0),new Bt([...this.color.map(ud(e)),this.valpha],this.model)},alpha(e){return e!==void 0?new Bt([...this.color,Math.max(0,Math.min(1,e))],this.model):this.valpha},red:Tt("rgb",0,Ct(255)),green:Tt("rgb",1,Ct(255)),blue:Tt("rgb",2,Ct(255)),hue:Tt(["hsl","hsv","hsl","hwb","hcg"],0,e=>(e%360+360)%360),saturationl:Tt("hsl",1,Ct(100)),lightness:Tt("hsl",2,Ct(100)),saturationv:Tt("hsv",1,Ct(100)),value:Tt("hsv",2,Ct(100)),chroma:Tt("hcg",1,Ct(100)),gray:Tt("hcg",2,Ct(100)),white:Tt("hwb",1,Ct(100)),wblack:Tt("hwb",2,Ct(100)),cyan:Tt("cmyk",0,Ct(100)),magenta:Tt("cmyk",1,Ct(100)),yellow:Tt("cmyk",2,Ct(100)),black:Tt("cmyk",3,Ct(100)),x:Tt("xyz",0,Ct(95.047)),y:Tt("xyz",1,Ct(100)),z:Tt("xyz",2,Ct(108.833)),l:Tt("lab",0,Ct(100)),a:Tt("lab",1),b:Tt("lab",2),keyword(e){return e!==void 0?new Bt(e):ir[this.model].keyword(this.color)},hex(e){return e!==void 0?new Bt(e):tn.to.hex(this.rgb().round().color)},hexa(e){if(e!==void 0)return new Bt(e);const r=this.rgb().round().color;let i=Math.round(this.valpha*255).toString(16).toUpperCase();return i.length===1&&(i="0"+i),tn.to.hex(r)+i},rgbNumber(){const e=this.rgb().color;return(e[0]&255)<<16|(e[1]&255)<<8|e[2]&255},luminosity(){const e=this.rgb().color,r=[];for(const[i,s]of e.entries()){const l=s/255;r[i]=l<=.04045?l/12.92:((l+.055)/1.055)**2.4}return .2126*r[0]+.7152*r[1]+.0722*r[2]},contrast(e){const r=this.luminosity(),i=e.luminosity();return r>i?(r+.05)/(i+.05):(i+.05)/(r+.05)},level(e){const r=this.contrast(e);return r>=7?"AAA":r>=4.5?"AA":""},isDark(){const e=this.rgb().color;return(e[0]*2126+e[1]*7152+e[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){const e=this.rgb();for(let r=0;r<3;r++)e.color[r]=255-e.color[r];return e},lighten(e){const r=this.hsl();return r.color[2]+=r.color[2]*e,r},darken(e){const r=this.hsl();return r.color[2]-=r.color[2]*e,r},saturate(e){const r=this.hsl();return r.color[1]+=r.color[1]*e,r},desaturate(e){const r=this.hsl();return r.color[1]-=r.color[1]*e,r},whiten(e){const r=this.hwb();return r.color[1]+=r.color[1]*e,r},blacken(e){const r=this.hwb();return r.color[2]+=r.color[2]*e,r},grayscale(){const e=this.rgb().color,r=e[0]*.3+e[1]*.59+e[2]*.11;return Bt.rgb(r,r,r)},fade(e){return this.alpha(this.valpha-this.valpha*e)},opaquer(e){return this.alpha(this.valpha+this.valpha*e)},rotate(e){const r=this.hsl();let i=r.color[0];return i=(i+e)%360,i=i<0?360+i:i,r.color[0]=i,r},mix(e,r){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);const i=e.rgb(),s=this.rgb(),l=r===void 0?.5:r,c=2*l-1,o=i.alpha()-s.alpha(),h=((c*o===-1?c:(c+o)/(1+c*o))+1)/2,g=1-h;return Bt.rgb(h*i.red()+g*s.red(),h*i.green()+g*s.green(),h*i.blue()+g*s.blue(),i.alpha()*l+s.alpha()*(1-l))}};for(const e of Object.keys(ir)){if(Ws.includes(e))continue;const{channels:r}=ir[e];Bt.prototype[e]=function(...i){return this.model===e?new Bt(this):i.length>0?new Bt(i,e):new Bt([...cd(ir[this.model][e].raw(this.color)),this.valpha],e)},Bt[e]=function(...i){let s=i[0];return typeof s=="number"&&(s=Fi(i,r)),new Bt(s,e)}}function ld(e,r){return Number(e.toFixed(r))}function ud(e){return function(r){return ld(r,e)}}function Tt(e,r,i){e=Array.isArray(e)?e:[e];for(const s of e)(Jn[s]||(Jn[s]=[]))[r]=i;return e=e[0],function(s){let l;return s!==void 0?(i&&(s=i(s)),l=this[e](),l.color[r]=s,l):(l=this[e]().color[r],i&&(l=i(l)),l)}}function Ct(e){return function(r){return Math.max(0,Math.min(e,r))}}function cd(e){return Array.isArray(e)?e:[e]}function Fi(e,r){for(let i=0;i<r;i++)typeof e[i]!="number"&&(e[i]=0);return e}var dd=Bt;const nn=Ur(dd),fd=pt(jt)`
  position: relative;
  color: rgba(255, 255, 255, 0.6);
  display: grid;
  grid-template-columns: auto auto 1fr auto auto;
  grid-template-rows: auto auto 1fr auto auto;
  gap: 0px;
  grid-template-areas:
    'top2 top2 top2 top2 top2'
    'top1 top1 top1 top1 top1'
    'left2 left1 center right1 right2'
    'bottom1 bottom1 bottom1 bottom1 bottom1'
    'bottom2 bottom2 bottom2 bottom2 bottom2';

  .sliderBox {
    grid-area: center;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: ${({gap:e})=>e?.value?e.value+(e?.unit||"px"):"15px"};
  }

  .top1,
  .top2,
  .bottom1,
  .bottom2,
  .left1,
  .left2,
  .right1,
  .right2 {
    display: flex;
    align-items: center;
    justify-content: center;
    /* padding: 7.5px; */
  }

  .top1 {
    grid-area: top1;
    padding-bottom: ${({gap:e})=>e?.value?e.value+(e?.unit||"px"):"15px"};
  }
  .top2 {
    grid-area: top2;
    padding-bottom: ${({gap:e})=>e?.value?e.value+(e?.unit||"px"):"15px"};
  }
  .bottom1 {
    grid-area: bottom1;
    padding-top: ${({gap:e})=>e?.value?e.value+(e?.unit||"px"):"15px"};
  }
  .bottom2 {
    grid-area: bottom2;
    padding-top: ${({gap:e})=>e?.value?e.value+(e?.unit||"px"):"15px"};
  }
  .left1 {
    grid-area: left1;
    padding-right: ${({gap:e})=>e?.value?e.value+(e?.unit||"px"):"15px"};
  }
  .left2 {
    grid-area: left2;
    padding-right: ${({gap:e})=>e?.value?e.value+(e?.unit||"px"):"15px"};
  }
  .right1 {
    grid-area: right1;
    padding-left: ${({gap:e})=>e?.value?e.value+(e?.unit||"px"):"15px"};
  }
  .right2 {
    grid-area: right2;
    padding-left: ${({gap:e})=>e?.value?e.value+(e?.unit||"px"):"15px"};
  }

  &.isVertical {
    .sliderBox {
      flex-flow: column-reverse;
    }
  }

  .sliderLabel {
    color: ${({theme:e})=>e.colors.textColor};
  }

  .valueLabel {
    color: ${({theme:e})=>e.colors.textColor};
  }

  .sliderControls > * {
    cursor: pointer;
    &:hover {
      color: #fff;
    }
  }

  .rcslider {
    &.rc-slider-horizontal {
      width: 100%;
      min-width: 70px;
    }

    &.rc-slider-vertical {
      height: 100%;
      min-height: 70px;
    }

    .rc-slider-handle {
      opacity: 1;
      border: 0;
      background: ${({theme:e})=>e.colors.textColor};
      /* border: 1px
        ${({theme:e})=>nn(e.backgroundColor).alpha(.2)} solid; */

      &::after {
        content: '';
        position: absolute;
        left: 50%;
        top: 50%;
        width: 400%;
        /* max-width: 100px;
        max-height: 100px; */
        height: 400%;
        transform: translate(-50%, -50%);
        /* background-color: red; */
      }
    }

    .rc-slider-handle-dragging {
      box-shadow: 0 0 10px 5px rgba(255, 255, 255, 0.2);
      will-change: all;
    }

    .rc-slider-rail {
      background: ${({minBackground:e})=>e};
      will-change: all;
    }

    .rc-slider-track {
      background: ${({maxBackground:e})=>e};
      will-change: all;
    }
  }

  &.hideThumb {
    .rc-slider-handle {
      opacity: 0;
    }
  }

  &.isBarSlider .rcslider {
    .rc-slider-handle {
      opacity: 0;
    }
    .rc-slider-rail,
    .rc-slider-track {
      border-radius: 0px;
    }

    &.rc-slider-vertical {
      .rc-slider-rail,
      .rc-slider-track {
        width: 100%;
        left: 0;
      }
    }
    &.rc-slider-horizontal {
      .rc-slider-rail,
      .rc-slider-track {
        height: 100%;
        top: 0;
      }
    }
  }
`;function Ni(e,r,i){return(e-r)/(i-r)}function na(e,r,i,s){var l=Ni(r,i,s),c={};switch(e){case"rtl":c.right="".concat(l*100,"%"),c.transform="translateX(50%)";break;case"btt":c.bottom="".concat(l*100,"%"),c.transform="translateY(50%)";break;case"ttb":c.top="".concat(l*100,"%"),c.transform="translateY(-50%)";break;default:c.left="".concat(l*100,"%"),c.transform="translateX(-50%)";break}return c}function an(e,r){return Array.isArray(e)?e[r]:e}var $r=R.createContext({min:0,max:0,direction:"ltr",step:1,includedStart:0,includedEnd:0,tabIndex:0,keyboard:!0,styles:{},classNames:{}}),hd=["prefixCls","value","valueIndex","onStartMove","style","render","dragging","onOffsetChange","onChangeComplete","onFocus","onMouseEnter"],qa=R.forwardRef(function(e,r){var i=e.prefixCls,s=e.value,l=e.valueIndex,c=e.onStartMove,o=e.style,h=e.render,g=e.dragging,d=e.onOffsetChange,p=e.onChangeComplete,w=e.onFocus,_=e.onMouseEnter,S=bs(e,hd),E=R.useContext($r),b=E.min,L=E.max,A=E.direction,k=E.disabled,U=E.keyboard,N=E.range,P=E.tabIndex,G=E.ariaLabelForHandle,$=E.ariaLabelledByForHandle,J=E.ariaValueTextFormatterForHandle,X=E.styles,Z=E.classNames,ie="".concat(i,"-handle"),de=function(ge){k||c(ge,l)},_e=function(ge){w?.(ge,l)},Ee=function(ge){_(ge,l)},Se=function(ge){if(!k&&U){var be=null;switch(ge.which||ge.keyCode){case Kt.LEFT:be=A==="ltr"||A==="btt"?-1:1;break;case Kt.RIGHT:be=A==="ltr"||A==="btt"?1:-1;break;case Kt.UP:be=A!=="ttb"?1:-1;break;case Kt.DOWN:be=A!=="ttb"?-1:1;break;case Kt.HOME:be="min";break;case Kt.END:be="max";break;case Kt.PAGE_UP:be=2;break;case Kt.PAGE_DOWN:be=-2;break}be!==null&&(ge.preventDefault(),d(be,l))}},le=function(ge){switch(ge.which||ge.keyCode){case Kt.LEFT:case Kt.RIGHT:case Kt.UP:case Kt.DOWN:case Kt.HOME:case Kt.END:case Kt.PAGE_UP:case Kt.PAGE_DOWN:p?.();break}},pe=na(A,s,b,L),he={};if(l!==null){var Te;he={tabIndex:k?null:an(P,l),role:"slider","aria-valuemin":b,"aria-valuemax":L,"aria-valuenow":s,"aria-disabled":k,"aria-label":an(G,l),"aria-labelledby":an($,l),"aria-valuetext":(Te=an(J,l))===null||Te===void 0?void 0:Te(s),"aria-orientation":A==="ltr"||A==="rtl"?"horizontal":"vertical",onMouseDown:de,onTouchStart:de,onFocus:_e,onMouseEnter:Ee,onKeyDown:Se,onKeyUp:le}}var xe=R.createElement("div",Ri({ref:r,className:rt(ie,mr(mr({},"".concat(ie,"-").concat(l+1),l!==null&&N),"".concat(ie,"-dragging"),g),Z.handle),style:Dt(Dt(Dt({},pe),o),X.handle)},he,S));return h&&(xe=h(xe,{index:l,prefixCls:i,value:s,dragging:g})),xe}),gd=["prefixCls","style","onStartMove","onOffsetChange","values","handleRender","activeHandleRender","draggingIndex","onFocus"],md=R.forwardRef(function(e,r){var i=e.prefixCls,s=e.style,l=e.onStartMove,c=e.onOffsetChange,o=e.values,h=e.handleRender,g=e.activeHandleRender,d=e.draggingIndex,p=e.onFocus,w=bs(e,gd),_=R.useRef({});R.useImperativeHandle(r,function(){return{focus:function(P){var G;(G=_.current[P])===null||G===void 0||G.focus()}}});var S=R.useState(-1),E=dr(S,2),b=E[0],L=E[1],A=function(P,G){L(G),p?.(P)},k=function(P,G){L(G)},U=Dt({prefixCls:i,onStartMove:l,onOffsetChange:c,render:h,onFocus:A,onMouseEnter:k},w);return R.createElement(R.Fragment,null,o.map(function(N,P){return R.createElement(qa,Ri({ref:function($){$?_.current[P]=$:delete _.current[P]},dragging:d===P,style:an(s,P),key:P,value:N,valueIndex:P},U))}),g&&R.createElement(qa,Ri({key:"a11y"},U,{value:o[b],valueIndex:null,dragging:d!==-1,render:g,style:{pointerEvents:"none"},tabIndex:null,"aria-hidden":!0})))}),pd=function(r){var i=r.prefixCls,s=r.style,l=r.children,c=r.value,o=r.onClick,h=R.useContext($r),g=h.min,d=h.max,p=h.direction,w=h.includedStart,_=h.includedEnd,S=h.included,E="".concat(i,"-text"),b=na(p,c,g,d);return R.createElement("span",{className:rt(E,mr({},"".concat(E,"-active"),S&&w<=c&&c<=_)),style:Dt(Dt({},b),s),onMouseDown:function(A){A.stopPropagation()},onClick:function(){o(c)}},l)},vd=function(r){var i=r.prefixCls,s=r.marks,l=r.onClick,c="".concat(i,"-mark");return s.length?R.createElement("div",{className:c},s.map(function(o){var h=o.value,g=o.style,d=o.label;return R.createElement(pd,{key:h,prefixCls:c,style:g,value:h,onClick:l},d)})):null},_d=function(r){var i=r.prefixCls,s=r.value,l=r.style,c=r.activeStyle,o=R.useContext($r),h=o.min,g=o.max,d=o.direction,p=o.included,w=o.includedStart,_=o.includedEnd,S="".concat(i,"-dot"),E=p&&w<=s&&s<=_,b=Dt(Dt({},na(d,s,h,g)),typeof l=="function"?l(s):l);return E&&(b=Dt(Dt({},b),typeof c=="function"?c(s):c)),R.createElement("span",{className:rt(S,mr({},"".concat(S,"-active"),E)),style:b})},yd=function(r){var i=r.prefixCls,s=r.marks,l=r.dots,c=r.style,o=r.activeStyle,h=R.useContext($r),g=h.min,d=h.max,p=h.step,w=R.useMemo(function(){var _=new Set;if(s.forEach(function(E){_.add(E.value)}),l&&p!==null)for(var S=g;S<=d;)_.add(S),S+=p;return Array.from(_)},[g,d,p,l,s]);return R.createElement("div",{className:"".concat(i,"-step")},w.map(function(_){return R.createElement(_d,{prefixCls:i,key:_,value:_,style:c,activeStyle:o})}))},Ja=function(r){var i=r.prefixCls,s=r.style,l=r.start,c=r.end,o=r.index,h=r.onStartMove,g=r.replaceCls,d=R.useContext($r),p=d.direction,w=d.min,_=d.max,S=d.disabled,E=d.range,b=d.classNames,L="".concat(i,"-track"),A=Ni(l,w,_),k=Ni(c,w,_),U=function($){!S&&h&&h($,-1)},N={};switch(p){case"rtl":N.right="".concat(A*100,"%"),N.width="".concat(k*100-A*100,"%");break;case"btt":N.bottom="".concat(A*100,"%"),N.height="".concat(k*100-A*100,"%");break;case"ttb":N.top="".concat(A*100,"%"),N.height="".concat(k*100-A*100,"%");break;default:N.left="".concat(A*100,"%"),N.width="".concat(k*100-A*100,"%")}var P=g||rt(L,mr(mr({},"".concat(L,"-").concat(o+1),o!==null&&E),"".concat(i,"-track-draggable"),h),b.track);return R.createElement("div",{className:P,style:Dt(Dt({},N),s),onMouseDown:U,onTouchStart:U})},bd=function(r){var i=r.prefixCls,s=r.style,l=r.values,c=r.startPoint,o=r.onStartMove,h=R.useContext($r),g=h.included,d=h.range,p=h.min,w=h.styles,_=h.classNames,S=R.useMemo(function(){if(!d){if(l.length===0)return[];var b=c??p,L=l[0];return[{start:Math.min(b,L),end:Math.max(b,L)}]}for(var A=[],k=0;k<l.length-1;k+=1)A.push({start:l[k],end:l[k+1]});return A},[l,d,c,p]);if(!g)return null;var E=_.tracks||w.tracks?R.createElement(Ja,{index:null,prefixCls:i,start:S[0].start,end:S[S.length-1].end,replaceCls:rt(_.tracks,"".concat(i,"-tracks")),style:w.tracks}):null;return R.createElement(R.Fragment,null,E,S.map(function(b,L){var A=b.start,k=b.end;return R.createElement(Ja,{index:L,prefixCls:i,style:Dt(Dt({},an(s,L)),w.track),start:A,end:k,key:L,onStartMove:o})}))};function Za(e){var r="touches"in e?e.touches[0]:e;return{pageX:r.pageX,pageY:r.pageY}}function Sd(e,r,i,s,l,c,o,h,g){var d=R.useState(null),p=dr(d,2),w=p[0],_=p[1],S=R.useState(-1),E=dr(S,2),b=E[0],L=E[1],A=R.useState(i),k=dr(A,2),U=k[0],N=k[1],P=R.useState(i),G=dr(P,2),$=G[0],J=G[1],X=R.useRef(null),Z=R.useRef(null);R.useLayoutEffect(function(){b===-1&&N(i)},[i,b]),R.useEffect(function(){return function(){document.removeEventListener("mousemove",X.current),document.removeEventListener("mouseup",Z.current),document.removeEventListener("touchmove",X.current),document.removeEventListener("touchend",Z.current)}},[]);var ie=function(le,pe){U.some(function(he,Te){return he!==le[Te]})&&(pe!==void 0&&_(pe),N(le),o(le))},de=Su(function(Se,le){if(Se===-1){var pe=$[0],he=$[$.length-1],Te=s-pe,xe=l-he,ye=le*(l-s);ye=Math.max(ye,Te),ye=Math.min(ye,xe);var ge=c(pe+ye);ye=ge-pe;var be=$.map(function(ae){return ae+ye});ie(be)}else{var fe=(l-s)*le,Ue=Ar(U);Ue[Se]=$[Se];var Ce=g(Ue,fe,Se,"dist");ie(Ce.values,Ce.value)}}),_e=function(le,pe,he){le.stopPropagation();var Te=he||i,xe=Te[pe];L(pe),_(xe),J(Te);var ye=Za(le),ge=ye.pageX,be=ye.pageY,fe=function(ae){ae.preventDefault();var we=Za(ae),Ae=we.pageX,Oe=we.pageY,Fe=Ae-ge,Ne=Oe-be,Be=e.current.getBoundingClientRect(),qe=Be.width,Ie=Be.height,Je;switch(r){case"btt":Je=-Ne/Ie;break;case"ttb":Je=Ne/Ie;break;case"rtl":Je=-Fe/qe;break;default:Je=Fe/qe}de(pe,Je)},Ue=function Ce(ae){ae.preventDefault(),document.removeEventListener("mouseup",Ce),document.removeEventListener("mousemove",fe),document.removeEventListener("touchend",Ce),document.removeEventListener("touchmove",fe),X.current=null,Z.current=null,L(-1),h()};document.addEventListener("mouseup",Ue),document.addEventListener("mousemove",fe),document.addEventListener("touchend",Ue),document.addEventListener("touchmove",fe),X.current=fe,Z.current=Ue},Ee=R.useMemo(function(){var Se=Ar(i).sort(function(pe,he){return pe-he}),le=Ar(U).sort(function(pe,he){return pe-he});return Se.every(function(pe,he){return pe===le[he]})?U:i},[i,U]);return[b,w,Ee,_e]}function Ed(e,r,i,s,l,c){var o=R.useCallback(function(S){return Math.max(e,Math.min(r,S))},[e,r]),h=R.useCallback(function(S){if(i!==null){var E=e+Math.round((o(S)-e)/i)*i,b=function(U){return(String(U).split(".")[1]||"").length},L=Math.max(b(i),b(r),b(e)),A=Number(E.toFixed(L));return e<=A&&A<=r?A:null}return null},[i,e,r,o]),g=R.useCallback(function(S){var E=o(S),b=s.map(function(k){return k.value});i!==null&&b.push(h(S)),b.push(e,r);var L=b[0],A=r-e;return b.forEach(function(k){var U=Math.abs(E-k);U<=A&&(L=k,A=U)}),L},[e,r,s,i,o,h]),d=function S(E,b,L){var A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit";if(typeof b=="number"){var k,U=E[L],N=U+b,P=[];s.forEach(function(Z){P.push(Z.value)}),P.push(e,r),P.push(h(U));var G=b>0?1:-1;A==="unit"?P.push(h(U+G*i)):P.push(h(N)),P=P.filter(function(Z){return Z!==null}).filter(function(Z){return b<0?Z<=U:Z>=U}),A==="unit"&&(P=P.filter(function(Z){return Z!==U}));var $=A==="unit"?U:N;k=P[0];var J=Math.abs(k-$);if(P.forEach(function(Z){var ie=Math.abs(Z-$);ie<J&&(k=Z,J=ie)}),k===void 0)return b<0?e:r;if(A==="dist")return k;if(Math.abs(b)>1){var X=Ar(E);return X[L]=k,S(X,b-G,L,A)}return k}else{if(b==="min")return e;if(b==="max")return r}},p=function(E,b,L){var A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",k=E[L],U=d(E,b,L,A);return{value:U,changed:U!==k}},w=function(E){return c===null&&E===0||typeof c=="number"&&E<c},_=function(E,b,L){var A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",k=E.map(g),U=k[L],N=d(k,b,L,A);if(k[L]=N,l===!1){var P=c||0;L>0&&k[L-1]!==U&&(k[L]=Math.max(k[L],k[L-1]+P)),L<k.length-1&&k[L+1]!==U&&(k[L]=Math.min(k[L],k[L+1]-P))}else if(typeof c=="number"||c===null){for(var G=L+1;G<k.length;G+=1)for(var $=!0;w(k[G]-k[G-1])&&$;){var J=p(k,1,G);k[G]=J.value,$=J.changed}for(var X=L;X>0;X-=1)for(var Z=!0;w(k[X]-k[X-1])&&Z;){var ie=p(k,-1,X-1);k[X-1]=ie.value,Z=ie.changed}for(var de=k.length-1;de>0;de-=1)for(var _e=!0;w(k[de]-k[de-1])&&_e;){var Ee=p(k,-1,de-1);k[de-1]=Ee.value,_e=Ee.changed}for(var Se=0;Se<k.length-1;Se+=1)for(var le=!0;w(k[Se+1]-k[Se])&&le;){var pe=p(k,1,Se+1);k[Se+1]=pe.value,le=pe.changed}}return{value:k[L],values:k}};return[g,_]}var Fr=R.forwardRef(function(e,r){var i=e.prefixCls,s=i===void 0?"rc-slider":i,l=e.className,c=e.style,o=e.classNames,h=e.styles,g=e.disabled,d=g===void 0?!1:g,p=e.keyboard,w=p===void 0?!0:p,_=e.autoFocus,S=e.onFocus,E=e.onBlur,b=e.min,L=b===void 0?0:b,A=e.max,k=A===void 0?100:A,U=e.step,N=U===void 0?1:U,P=e.value,G=e.defaultValue,$=e.range,J=e.count,X=e.onChange,Z=e.onBeforeChange,ie=e.onAfterChange,de=e.onChangeComplete,_e=e.allowCross,Ee=_e===void 0?!0:_e,Se=e.pushable,le=Se===void 0?!1:Se,pe=e.draggableTrack,he=e.reverse,Te=e.vertical,xe=e.included,ye=xe===void 0?!0:xe,ge=e.startPoint,be=e.trackStyle,fe=e.handleStyle,Ue=e.railStyle,Ce=e.dotStyle,ae=e.activeDotStyle,we=e.marks,Ae=e.dots,Oe=e.handleRender,Fe=e.activeHandleRender,Ne=e.tabIndex,Be=Ne===void 0?0:Ne,qe=e.ariaLabelForHandle,Ie=e.ariaLabelledByForHandle,Je=e.ariaValueTextFormatterForHandle,We=R.useRef(null),nt=R.useRef(null),ft=R.useMemo(function(){return Te?he?"ttb":"btt":he?"rtl":"ltr"},[he,Te]),j=R.useMemo(function(){return isFinite(L)?L:0},[L]),K=R.useMemo(function(){return isFinite(k)?k:100},[k]),B=R.useMemo(function(){return N!==null&&N<=0?1:N},[N]),M=R.useMemo(function(){return typeof le=="boolean"?le?B:!1:le>=0?le:!1},[le,B]),C=R.useMemo(function(){return Object.keys(we||{}).map(function(it){var Ge=we[it],st={value:Number(it)};return Ge&&Eu(Ge)==="object"&&!R.isValidElement(Ge)&&("label"in Ge||"style"in Ge)?(st.style=Ge.style,st.label=Ge.label):st.label=Ge,st}).filter(function(it){var Ge=it.label;return Ge||typeof Ge=="number"}).sort(function(it,Ge){return it.value-Ge.value})},[we]),Y=Ed(j,K,B,C,Ee,M),H=dr(Y,2),z=H[0],V=H[1],q=Ru(G,{value:P}),ne=dr(q,2),re=ne[0],ee=ne[1],se=R.useMemo(function(){var it=re==null?[]:Array.isArray(re)?re:[re],Ge=dr(it,1),st=Ge[0],ct=st===void 0?j:st,gt=re===null?[]:[ct];if($){if(gt=Ar(it),J||re===void 0){var te=J>=0?J+1:2;for(gt=gt.slice(0,te);gt.length<te;){var vt;gt.push((vt=gt[gt.length-1])!==null&&vt!==void 0?vt:j)}}gt.sort(function(Ht,qt){return Ht-qt})}return gt.forEach(function(Ht,qt){gt[qt]=z(Ht)}),gt},[re,$,j,J,z]),ce=R.useRef(se);ce.current=se;var me=function(Ge){return $?Ge:Ge[0]},ue=function(Ge){var st=Ar(Ge).sort(function(ct,gt){return ct-gt});X&&!Du(st,ce.current,!0)&&X(me(st)),ee(st)},ke=function(){var Ge=me(ce.current);ie?.(Ge),xu(!ie,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),de?.(Ge)},Re=Sd(nt,ft,se,j,K,z,ue,ke,V),Ye=dr(Re,4),oe=Ye[0],Le=Ye[1],$e=Ye[2],Xe=Ye[3],Ze=function(Ge,st){if(!d){var ct=0,gt=K-j;se.forEach(function(qt,Vt){var ur=Math.abs(Ge-qt);ur<=gt&&(gt=ur,ct=Vt)});var te=Ar(se);if(te[ct]=Ge,$&&!se.length&&J===void 0&&te.push(Ge),Z?.(me(te)),ue(te),st){var vt,Ht;(vt=document.activeElement)===null||vt===void 0||(Ht=vt.blur)===null||Ht===void 0||Ht.call(vt),We.current.focus(ct),Xe(st,ct,te)}}},ot=function(Ge){Ge.preventDefault();var st=nt.current.getBoundingClientRect(),ct=st.width,gt=st.height,te=st.left,vt=st.top,Ht=st.bottom,qt=st.right,Vt=Ge.clientX,ur=Ge.clientY,br;switch(ft){case"btt":br=(Ht-ur)/gt;break;case"ttb":br=(ur-vt)/gt;break;case"rtl":br=(qt-Vt)/ct;break;default:br=(Vt-te)/ct}var Kr=j+br*(K-j);Ze(z(Kr),Ge)},ut=R.useState(null),Lt=dr(ut,2),bt=Lt[0],ht=Lt[1],Ot=function(Ge,st){if(!d){var ct=V(se,Ge,st);Z?.(me(se)),ue(ct.values),ht(ct.value)}};R.useEffect(function(){if(bt!==null){var it=se.indexOf(bt);it>=0&&We.current.focus(it)}ht(null)},[bt]);var wt=R.useMemo(function(){return pe&&B===null?!1:pe},[pe,B]),Ft=function(Ge,st){Xe(Ge,st),Z?.(me(ce.current))},St=oe!==-1;R.useEffect(function(){if(!St){var it=se.lastIndexOf(Le);We.current.focus(it)}},[St]);var lt=R.useMemo(function(){return Ar($e).sort(function(it,Ge){return it-Ge})},[$e]),rr=R.useMemo(function(){return $?[lt[0],lt[lt.length-1]]:[j,lt[0]]},[lt,$,j]),Zt=dr(rr,2),Ut=Zt[0],kt=Zt[1];R.useImperativeHandle(r,function(){return{focus:function(){We.current.focus(0)},blur:function(){var Ge,st=document,ct=st.activeElement;(Ge=nt.current)!==null&&Ge!==void 0&&Ge.contains(ct)&&ct?.blur()}}}),R.useEffect(function(){_&&We.current.focus(0)},[]);var Qt=R.useMemo(function(){return{min:j,max:K,direction:ft,disabled:d,keyboard:w,step:B,included:ye,includedStart:Ut,includedEnd:kt,range:$,tabIndex:Be,ariaLabelForHandle:qe,ariaLabelledByForHandle:Ie,ariaValueTextFormatterForHandle:Je,styles:h||{},classNames:o||{}}},[j,K,ft,d,w,B,ye,Ut,kt,$,Be,qe,Ie,Je,h,o]);return R.createElement($r.Provider,{value:Qt},R.createElement("div",{ref:nt,className:rt(s,l,mr(mr(mr(mr({},"".concat(s,"-disabled"),d),"".concat(s,"-vertical"),Te),"".concat(s,"-horizontal"),!Te),"".concat(s,"-with-marks"),C.length)),style:c,onMouseDown:ot},R.createElement("div",{className:rt("".concat(s,"-rail"),o?.rail),style:Dt(Dt({},Ue),h?.rail)}),R.createElement(bd,{prefixCls:s,style:be,values:lt,startPoint:ge,onStartMove:wt?Ft:void 0}),R.createElement(yd,{prefixCls:s,marks:C,dots:Ae,style:Ce,activeStyle:ae}),R.createElement(md,{ref:We,prefixCls:s,style:fe,values:$e,draggingIndex:oe,onStartMove:Ft,onOffsetChange:Ot,onFocus:S,onBlur:E,handleRender:Oe,activeHandleRender:Fe,onChangeComplete:ke}),R.createElement(vd,{prefixCls:s,marks:C,onClick:Ze})))}),xd="dynamicSlidersBg_dynamicSliderBg__12s8ym30";let Qa;function Td({minColor:e,maxColor:r,value:i}){clearTimeout(Qa);const s=document.getElementById("dynamicSlidersBgDiv");if(!s){console.log("DynamicBGSliders div not found");return}const l=-66.5*i/100+"%";s.style.setProperty("--opacity","0.3"),s.style.setProperty("--minColor",e),s.style.setProperty("--maxColor",r),s.style.setProperty("--value",l),Qa=setTimeout(()=>{s.style.setProperty("--opacity","0")},1e3)}const Md=ze.memo(()=>I.jsx("div",{id:"dynamicSlidersBgDiv",className:xd})),Xs=e=>{const{size:r,cssClass:i,state:s,minBackground:l,maxBackground:c,isVertical:o=!1,isBarSlider:h=!1,hideThumb:g=!1,reverse:d=!1,showControls:p=!1,useDynamicBackround:w=!1,labelPosition:_="top",valuePosition:S="bottom",sliderLabelText:E,sliderValueText:b,input_signal_a_fb:L,sliderLabelTextFontSize:A,sliderValueTextFontSize:k,width:U,height:N,minValue:P=0,maxValue:G=100,increment_signal_d:$,decrement_signal_d:J,thumbBackgroundColor:X,thumbBorder:Z,actions:ie,fontFamily:de="inherit",boxReflect:_e,constraintsVertical:Ee,constraintsHorizontal:Se,isStaticElement:le,left:pe,top:he,right:Te,bottom:xe,staticDevMoveableRef:ye,index:ge,deltaCenterX:be,deltaCenterY:fe}=e,Ue=R.useContext(Tu),Ce=Et(A),ae=Et(k),we=nn(Ue.colors.textColor).alpha(.2).string(),Ae=Ue.colors.primaryColor,Oe=Pt(s,ge),Fe=Yr(L),[Ne,Be]=R.useState(Fe),qe=R.useRef(Ne),[Ie,Je]=R.useState(!1);R.useEffect(()=>{Ie||Be(me=>me===Fe?me:Fe)},[Ie,Fe]);const We=Mt({width:U,height:N,constraintsVertical:Ee,constraintsHorizontal:Se,isStaticElement:le,left:pe,top:he,right:Te,bottom:xe,deltaCenterX:be,deltaCenterY:fe}),nt=Xt(_e),ft=Mr({signalName:$}),j=Mr({signalName:J}),{useBorder:K,...B}=Z||{},M=K?B:{},{onBeforeChangeActions:C,onAfterChangeActions:Y,onChangeActions:H,isActiveOverlayTrigger:z}=lr({actions:ie}),V=rt({[`element_${e.type}`]:!0,[`${i}`]:i,[`size-${r}`]:r,isVertical:o,hideThumb:g,isBarSlider:h,isActiveOverlayTrigger:!!z,...Oe}),q=R.useCallback(()=>{w&&Ne!==void 0&&Td({minColor:l||we,maxColor:c||Ae,value:Ne})},[Ae,we,c,l,Ne,w]),ne=R.useRef(),re=R.useRef(),ee=R.useRef(),se=R.useCallback(me=>{const ue=()=>{if(!Ie){console.log("slider runBeforeChangeActions");for(const oe of C)oe(qe.current)}},ke=()=>{console.log("slider runOnChangeActions");for(const oe of H)oe(qe.current)},Re=({runAfter:oe})=>{clearTimeout(re.current),re.current=setTimeout(()=>{console.log("slider runAfterChangeActions"),(async()=>{clearTimeout(ee.current);const $e=Y.map(Xe=>Xe(qe.current));await Promise.all($e),ee.current=setTimeout(()=>{Je(Xe=>Xe&&!1)},1e3)})()},oe)};(({unlockAfter:oe})=>{clearTimeout(ne.current),Je(Le=>Le||!0),Y.length||(ne.current=setTimeout(()=>{Je(Le=>Le&&!1)},oe))})({unlockAfter:3e3}),Be(me),qe.current=me,q(),ue(),ke(),Re({runAfter:1e3})},[Ie,Y,C,H,q]),ce=o?{paddingTop:8,paddingBottom:8}:{paddingLeft:8,paddingRight:8};return I.jsxs(fd,{ref:me=>{ye&&(ye.current=me)},style:{...We,fontFamily:de,...nt,...ce},...e,minBackground:l||we,maxBackground:c||Ae,className:V,children:[I.jsxs("div",{className:"sliderBox",children:[p&&I.jsx("div",{className:"sliderControls",children:d?I.jsx(za,{...ft}):I.jsx(Ga,{...j})}),I.jsx(Fr,{value:Ne,onChange:me=>{se(me)},className:"rcslider",handleStyle:{background:X??"white",...M},reverse:d,vertical:o,min:Number(P),max:Number(G)}),p&&I.jsx("div",{className:"sliderControls",children:d?I.jsx(Ga,{...j}):I.jsx(za,{...ft})})]}),b&&I.jsx("div",{className:`${S}1`,children:I.jsx("div",{style:ae,className:"valueLabel",children:I.jsx(Rt,{...e,text:b})})}),E!==void 0&&I.jsx("div",{className:`${_}2`,children:I.jsx("div",{style:Ce,className:"sliderLabel",children:I.jsx(Rt,{...e,text:E})})})]})};Xs.displayName="SliderElement";const wd=pt(jt)`
  display: flex;
  align-items: center;
  gap: 0.4em;

  overflow: hidden;

  &.size-small {
    font-size: 0.7em;
  }

  /* color: ${({color:e})=>e}; */

  .ant-switch-checked {
    background: ${({color:e})=>e};
  }

  &.reverseOrder {
    flex-direction: row-reverse;
  }

  &.isEditedNow {
   
    &:before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;

      opacity: 0.1;
      background-size: 10px 10px;
      background-image: repeating-linear-gradient(45deg, #0078ff 0, #0078ff 1px, #090e43 0, #090e43 50%);
    }
  }
`,ri=ze.memo(e=>{const{size:r,cssClass:i,state:s,subpageId:l,width:c,height:o,actions:h,inputParameters:g,listIndex:d,parentData:p,parentArrayIndex:w,indexInList:_,datasetPath:S,filter:E,backgroundColor:b,border:L,boxReflect:A,backgroundElementsBlur:k,fontFamily:U="inherit",boxShadow:N,constraintsVertical:P,constraintsHorizontal:G,isStaticElement:$,left:J,top:X,right:Z,bottom:ie,staticDevMoveableRef:de,index:_e,deltaCenterX:Ee,deltaCenterY:Se}=e,le=Pt(s,_e),pe=R.useRef(null),{tapActionsArr:he,isActiveOverlayTrigger:Te}=lr({indexInList:_,actions:h,datasetPath:S,filter:E,elementRef:pe,parentData:p}),xe=rt({[`element_${e.type}`]:!0,[`${i}`]:i,[`size-${r}`]:r,isActiveOverlayTrigger:!!Te,...le}),ye=$t(Ie=>Ie.workingProject?.attributes.pages.data.find(Je=>Je.id===l)),ge=ye?.attributes.parameters,be=R.useMemo(()=>!ge?.length||!g?.length?ge:ge.map(Ie=>{const Je=g.find(ft=>ft.parameterName===Ie.name);if(!Je)return Ie;const{passedValue:We,parameter_signal_fb:nt}=Je;return{...Ie,...nt&&{joinValueSetter_signal_fb:nt},currentValue:We===""?void 0:We}}),[g,ge]),fe=R.useMemo(()=>{if(ye)return{...ye,attributes:{...ye?.attributes,parameters:be}}},[be,ye]),{width:Ue,height:Ce}=fe?.attributes??{},ae=Mt({width:Ue,height:Ce}),we=Mt({width:c,height:o,constraintsVertical:P,constraintsHorizontal:G,isStaticElement:$,left:J,top:X,right:Z,bottom:ie,deltaCenterX:Ee,deltaCenterY:Se,fallbackWidth:ae?.width,fallbackHeight:ae?.height}),Ae={...he};let Oe={};b&&(Oe={backgroundColor:b});const Fe=Hr(L),Ne=zr(N),Be=k?{backdropFilter:`blur(${k}px)`,WebkitBackdropFilter:`blur(${k}px)`}:{},qe=Xt(A);return fe?I.jsx(wd,{ref:Ie=>{de&&(de.current=Ie),pe.current=Ie},...e,style:{...ae,...we,...Oe,...Fe,...Ne,...Be,...qe,fontFamily:U},...Ae,className:xe,children:I.jsx(ni,{data:fe,renderAsElement:!0,listIndex:d,parentData:p})}):null});ri.displayName="SubPageElement";function er(e){return e?e+"px":"1px"}const Ld=Ln`
  from {
    opacity:0;

  }

  to {
    opacity:1;

  }
`,kd=pt(jt)`
  position: relative;
  width: 100%;
  height: 100%;
  /* max-height: 100%;
  max-width: 100%; */
  /* aspect-ratio: 1/1; */

  .box {
    position: relative;
    top: 50%;
    transform: translateY(-50%);
    aspect-ratio: 1/1;
    max-height: 100%;
    /* max-width: 100%; */
    min-width: 50px;
    /* min-height: 50px; */
    overflow: hidden;
    margin: auto;
  }

  .center {
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
    left: 50%;
    top: 50%;
    width: 25%;
    aspect-ratio: 1/1;
    transform: translate(-50%, -50%);
    border-width: ${({thickness:e})=>er(e)};
    border-style: solid;
    border-color: ${({theme:e,color:r})=>r||e.colors.primaryColor};
    border-radius: ${"50%"};
    cursor: pointer;
    z-index: 10;
    &:active {
      border-color: ${({theme:e,pressedColor:r})=>r||e.colors.primaryColor};
      transform: translate(-50%, -50%) scale(0.9);
    }
    transition: 200ms;
  }

  .control {
    animation: ${Ld} 500ms linear;
    animation-fill-mode: backwards;
    aspect-ratio: 1/1;
    width: 30%;
    /* background-color: red; */
    position: absolute;
    cursor: pointer;
    border-width: ${({thickness:e})=>er(e)};
    border-style: solid;
    border-color: ${({theme:e,color:r})=>r||e.colors.primaryColor};

    will-change: transform;
    backface-visibility: hidden;
    transition: 200ms;

    &:active {
      border-color: ${({theme:e,pressedColor:r})=>r||e.colors.primaryColor};
    }

    .inner {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      transform: rotate(-45deg);
    }
  }

  .top {
    left: 50%;
    top: 0;
    transform: translateX(-50%) translateY(20%) rotate(45deg);
    border-width: ${({thickness:e})=>er(e)} 0px 0px ${({thickness:e})=>er(e)};
    border-radius: ${({cornersRaduis:e})=>er(e)} 0px 0px 0px;
    &:active {
      transform: translateX(-50%) translateY(20%) rotate(45deg) scale(0.9);
    }
    animation-delay: 100ms;
  }

  .bottom {
    left: 50%;
    bottom: 0;
    transform: translateX(-50%) translateY(-20%) rotate(45deg);
    border-width: 0px ${({thickness:e})=>er(e)} ${({thickness:e})=>er(e)} 0px;
    border-radius: 0px 0px ${({cornersRaduis:e})=>er(e)} 0px;
    &:active {
      transform: translateX(-50%) translateY(-20%) rotate(45deg) scale(0.9);
    }
    animation-delay: 300ms;
  }

  .right {
    top: 50%;
    right: 0;
    transform: translateY(-50%) translateX(-20%) rotate(45deg);
    border-width: ${({thickness:e})=>er(e)} ${({thickness:e})=>er(e)} 0px 0px;
    border-radius: 0px ${({cornersRaduis:e})=>er(e)} 0px 0px;
    &:active {
      transform: translateY(-50%) translateX(-20%) rotate(45deg) scale(0.9);
    }
    animation-delay: 200ms;
  }

  .left {
    top: 50%;
    left: 0;
    transform: translateY(-50%) translateX(20%) rotate(45deg);
    border-width: 0px 0px ${({thickness:e})=>er(e)} ${({thickness:e})=>er(e)};
    border-radius: 0px 0px 0px ${({cornersRaduis:e})=>er(e)};
    &:active {
      transform: translateY(-50%) translateX(20%) rotate(45deg) scale(0.9);
    }
    animation-delay: 400ms;
  }
`,qs=e=>{const{cssClass:r,state:i,thickness:s=1,hideCetralButton:l,width:c,height:o,topText:h,rightText:g,bottomText:d,leftText:p,centerText:w,topButton_signal_d:_,rightButton_signal_d:S,bottomButton_signal_d:E,leftButton_signal_d:b,centerButton_signal_d:L,boxReflect:A,staticDevMoveableRef:k,constraintsVertical:U,constraintsHorizontal:N,isStaticElement:P,left:G,top:$,right:J,bottom:X,index:Z,deltaCenterX:ie,deltaCenterY:de}=e,_e=mt(be=>be.showBoundingBox),Ee=Pt(i,Z),Se=rt({[`element_${e.type}`]:!0,[`${r}`]:r,showBoundingBox:_e,...Ee}),le=Mr({signalName:_}),pe=Mr({signalName:S}),he=Mr({signalName:E}),Te=Mr({signalName:b}),xe=Mr({signalName:L}),ye=Xt(A),ge=Mt({width:c,height:o,constraintsVertical:U,constraintsHorizontal:N,isStaticElement:P,left:G,top:$,right:J,bottom:X,deltaCenterX:ie,deltaCenterY:de});return I.jsx(kd,{ref:be=>{k&&(k.current=be)},thickness:s,...e,style:{...ge,...ye},className:Se,children:I.jsxs("div",{className:"box",children:[!l&&I.jsx("div",{...xe,className:"center",children:w}),I.jsx("div",{...le,className:"top control",children:I.jsx("div",{className:"inner",children:h})}),I.jsx("div",{...pe,className:"right control",children:I.jsx("div",{className:"inner",children:g})}),I.jsx("div",{...he,className:"bottom control",children:I.jsx("div",{className:"inner",children:d})}),I.jsx("div",{...Te,className:"left control",children:I.jsx("div",{className:"inner",children:p})})]})})};qs.displayName="DpadElement";const Ad=pt(jt)`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  grid-auto-rows: 1fr;

  .el {
    font-size: inherit;
    display: flex;
    flex-flow: column;
    gap: 0.5em;

    .letters {
      text-transform: uppercase;
      font-size: 0.8em;
      /* opacity: 0.6; */
      display: ${({hideLetters:e})=>e?"none":"block"};
      min-height: 1em;

      /* &:empty {
        display: none;
      } */
    }
  }
`,Rd=["1","2","3","4","5","6","7","8","9","Extra1","0","Extra2"],Js=e=>{const{size:r,cssClass:i,state:s,textFontSize:l,lettersFontSize:c,gap:o,width:h,height:g,fontFamily:d="inherit",textColor:p,lettersColor:w,backgroundColor:_,border:S,boxReflect:E,staticDevMoveableRef:b,constraintsVertical:L,constraintsHorizontal:A,isStaticElement:k,left:U,top:N,right:P,bottom:G,index:$,deltaCenterX:J,deltaCenterY:X}=e,Z=Pt(s,$),ie=rt({[`element_${e.type}`]:!0,[`${i}`]:i,[`size-${r}`]:r,...Z}),de=Et(l),_e=Et(c),Ee=Xt(E),Se=yt({sizeObj:o?.value===void 0||o?.value===null?{value:10,unit:"px"}:o,sizePropName:"gap"}),le=Hr(S),pe=Mt({width:h,height:g,constraintsVertical:L,constraintsHorizontal:A,isStaticElement:k,left:U,top:N,right:P,bottom:G,deltaCenterX:J,deltaCenterY:X});return I.jsx(Ad,{ref:he=>{b&&(b.current=he)},...e,style:{...Se,...pe,...Ee,fontFamily:d},className:ie,children:Rd.map(he=>{let Te="";switch(he){case"Extra1":Te="✱";break;case"Extra2":Te="#";break;default:Te=he;break}let xe="";switch(he){case"2":xe="abc";break;case"3":xe="def";break;case"4":xe="ghi";break;case"5":xe="jkl";break;case"6":xe="mno";break;case"7":xe="pqrs";break;case"8":xe="tuv";break;case"9":xe="wxyz";break;case"0":xe="+";break;default:xe="";break}const ye=_?{backgroundColor:_}:{};return I.jsxs(bn,{onClick:()=>{Br(e[`button${he}_signal_d`])},className:"element_button el",style:{...ye,...le},children:[I.jsx("span",{style:{color:p||"inherit",...de},children:e[`button${he}Text`]||Te}),I.jsx("span",{style:{color:w||"inherit",opacity:w?1:.6,..._e},className:"letters",children:e[`button${he}SubText`]||xe})]},he)})})};Js.displayName="KeypadElement";const Dd=pt(jt)`
  display: flex;
  align-items: center;
  justify-content: center;
  flex-flow: column;
  gap: 1em;

  .react-clock {
    aspect-ratio: 1/1;
    height: auto !important;
  }

  .react-clock__face {
    border-color: transparent;
  }
  .react-clock__mark__body {
    background-color: ${({theme:e,minuteMarkColor:r})=>r||e.colors.textColor};
  }
  .react-clock__hour-mark__body {
    background-color: ${({theme:e,hourMarkColor:r})=>r||e.colors.primaryColor};
  }
  .react-clock__hour-hand div {
    background-color: ${({theme:e,hourHandColor:r})=>r||e.colors.textColor};
  }
  .react-clock__minute-hand div {
    background-color: ${({theme:e,minuteHandColor:r})=>r||e.colors.textColor};
  }
  .react-clock__second-hand div {
    background-color: ${({secondHandColor:e})=>e||"red"};
  }
`;function Zs(e){var r,i,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var l=e.length;for(r=0;r<l;r++)e[r]&&(i=Zs(e[r]))&&(s&&(s+=" "),s+=i)}else for(i in e)e[i]&&(s&&(s+=" "),s+=i);return s}function Cd(){for(var e,r,i=0,s="",l=arguments.length;i<l;i++)(e=arguments[i])&&(r=Zs(e))&&(s&&(s+=" "),s+=r);return s}function es(e){if(e instanceof Date)return e.getHours();if(typeof e=="string"){var r=e.split(":");if(r.length>=2){var i=r[0];if(i){var s=parseInt(i,10);if(!isNaN(s))return s}}}throw new Error("Failed to get hours from date: ".concat(e,"."))}function Si(e){if(e instanceof Date)return e.getMinutes();if(typeof e=="string"){var r=e.split(":");if(r.length>=2){var i=r[1]||"0",s=parseInt(i,10);if(!isNaN(s))return s}}throw new Error("Failed to get minutes from date: ".concat(e,"."))}function Ei(e){if(e instanceof Date)return e.getSeconds();if(typeof e=="string"){var r=e.split(":");if(r.length>=2){var i=r[2]||"0",s=parseInt(i,10);if(!isNaN(s))return s}}throw new Error("Failed to get seconds from date: ".concat(e,"."))}function xi(e){if(e instanceof Date)return e.getMilliseconds();if(typeof e=="string"){var r=e.split(":");if(r.length>=2){var i=r[2]||"0",s=i.split(".")[1]||"0",l=parseInt(s,10);if(!isNaN(l))return l}}throw new Error("Failed to get seconds from date: ".concat(e,"."))}function Ti(e){var r=e.angle,i=r===void 0?0:r,s=e.name,l=e.length,c=l===void 0?100:l,o=e.oppositeLength,h=o===void 0?10:o,g=e.width,d=g===void 0?1:g;return ze.createElement("div",{className:"react-clock__hand react-clock__".concat(s,"-hand"),style:{transform:"rotate(".concat(i,"deg)")}},ze.createElement("div",{className:"react-clock__hand__body react-clock__".concat(s,"-hand__body"),style:{width:"".concat(d,"px"),top:"".concat(50-c/2,"%"),bottom:"".concat(50-h/2,"%")}}))}function Qs(e){var r=e.angle,i=r===void 0?0:r,s=e.length,l=s===void 0?10:s,c=e.name,o=e.width,h=o===void 0?1:o,g=e.number;return ze.createElement("div",{className:"react-clock__mark react-clock__".concat(c,"-mark"),style:{transform:"rotate(".concat(i,"deg)")}},ze.createElement("div",{className:"react-clock__mark__body react-clock__".concat(c,"-mark__body"),style:{width:"".concat(h,"px"),top:0,bottom:"".concat(100-l/2,"%")}}),g?ze.createElement("div",{className:"react-clock__mark__number",style:{transform:"rotate(-".concat(i,"deg)"),top:"".concat(l/2,"%")}},g):null)}var Yi=function(){return Yi=Object.assign||function(e){for(var r,i=1,s=arguments.length;i<s;i++){r=arguments[i];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},Yi.apply(this,arguments)},Id=R.memo(function(r){return ze.createElement(Qs,Yi({},r))});const Pd=(e,r,i,s)=>{if(i==="length"||i==="prototype"||i==="arguments"||i==="caller")return;const l=Object.getOwnPropertyDescriptor(e,i),c=Object.getOwnPropertyDescriptor(r,i);!Od(l,c)&&s||Object.defineProperty(e,i,c)},Od=function(e,r){return e===void 0||e.configurable||e.writable===r.writable&&e.enumerable===r.enumerable&&e.configurable===r.configurable&&(e.writable||e.value===r.value)},Fd=(e,r)=>{const i=Object.getPrototypeOf(r);i!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,i)},Nd=(e,r)=>`/* Wrapped ${e}*/
${r}`,Yd=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),Bd=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),jd=(e,r,i)=>{const s=i===""?"":`with ${i.trim()}() `,l=Nd.bind(null,s,r.toString());Object.defineProperty(l,"name",Bd),Object.defineProperty(e,"toString",{...Yd,value:l})},Ud=(e,r,{ignoreNonConfigurable:i=!1}={})=>{const{name:s}=e;for(const l of Reflect.ownKeys(r))Pd(e,r,l,i);return Fd(e,r),jd(e,r,s),e};var Hd=Ud,Bi={exports:{}},zd=()=>{const e={};return e.promise=new Promise((r,i)=>{e.resolve=r,e.reject=i}),e};(function(e,r){var i=Ke&&Ke.__awaiter||function(o,h,g,d){return new(g||(g=Promise))(function(p,w){function _(b){try{E(d.next(b))}catch(L){w(L)}}function S(b){try{E(d.throw(b))}catch(L){w(L)}}function E(b){b.done?p(b.value):new g(function(L){L(b.value)}).then(_,S)}E((d=d.apply(o,h||[])).next())})},s=Ke&&Ke.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(r,"__esModule",{value:!0});const l=s(zd);function c(o,h="maxAge"){let g,d,p;const w=()=>i(this,void 0,void 0,function*(){if(g!==void 0)return;const E=b=>i(this,void 0,void 0,function*(){p=l.default();const L=b[1][h]-Date.now();if(L<=0){o.delete(b[0]),p.resolve();return}return g=b[0],d=setTimeout(()=>{o.delete(b[0]),p&&p.resolve()},L),typeof d.unref=="function"&&d.unref(),p.promise});try{for(const b of o)yield E(b)}catch{}g=void 0}),_=()=>{g=void 0,d!==void 0&&(clearTimeout(d),d=void 0),p!==void 0&&(p.reject(void 0),p=void 0)},S=o.set.bind(o);return o.set=(E,b)=>{o.has(E)&&o.delete(E);const L=S(E,b);return g&&g===E&&_(),w(),L},w(),o}r.default=c,e.exports=c,e.exports.default=c})(Bi,Bi.exports);var Gd=Bi.exports;const $d=Hd,Vd=Gd,Mi=new WeakMap,eo=new WeakMap,Zn=(e,{cacheKey:r,cache:i=new Map,maxAge:s}={})=>{typeof s=="number"&&Vd(i);const l=function(...c){const o=r?r(c):c[0],h=i.get(o);if(h)return h.data;const g=e.apply(this,c);return i.set(o,{data:g,maxAge:s?Date.now()+s:Number.POSITIVE_INFINITY}),g};return $d(l,e,{ignoreNonConfigurable:!0}),eo.set(l,i),l};Zn.decorator=(e={})=>(r,i,s)=>{const l=r[i];if(typeof l!="function")throw new TypeError("The decorated value must be a function");delete s.value,delete s.writable,s.get=function(){if(!Mi.has(this)){const c=Zn(l,e);return Mi.set(this,c),c}return Mi.get(this)}};Zn.clear=e=>{const r=eo.get(e);if(!r)throw new TypeError("Can't clear a function that was not memoized!");if(typeof r.clear!="function")throw new TypeError("The cache Map can't be cleared!");r.clear()};var Kd=Zn;const to=Ur(Kd);function Wd(e){return typeof e=="string"}function Xd(e,r,i){return i.indexOf(e)===r}function qd(e){return e.toLowerCase()===e}function ts(e){return e.indexOf(",")===-1?e:e.split(",")}function ji(e){if(!e)return e;if(e==="C"||e==="posix"||e==="POSIX")return"en-US";if(e.indexOf(".")!==-1){var r=e.split(".")[0],i=r===void 0?"":r;return ji(i)}if(e.indexOf("@")!==-1){var s=e.split("@")[0],i=s===void 0?"":s;return ji(i)}if(e.indexOf("-")===-1||!qd(e))return e;var l=e.split("-"),c=l[0],o=l[1],h=o===void 0?"":o;return"".concat(c,"-").concat(h.toUpperCase())}function Jd(e){var r=e===void 0?{}:e,i=r.useFallbackLocale,s=i===void 0?!0:i,l=r.fallbackLocale,c=l===void 0?"en-US":l,o=[];if(typeof navigator<"u"){for(var h=navigator.languages||[],g=[],d=0,p=h;d<p.length;d++){var w=p[d];g=g.concat(ts(w))}var _=navigator.language,S=_&&ts(_);o=o.concat(g,S)}return s&&o.push(c),o.filter(Wd).map(ji).filter(Xd)}var Zd=to(Jd,{cacheKey:JSON.stringify});function Qd(e){return Zd(e)[0]||null}var ef=to(Qd,{cacheKey:JSON.stringify});function tf(e,r){return r.toLocaleString(e||ef()||void 0)}var Ui=function(){return Ui=Object.assign||function(e){for(var r,i=1,s=arguments.length;i<s;i++){r=arguments[i];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},Ui.apply(this,arguments)},rf=function(e,r){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(i[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(e);l<s.length;l++)r.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(e,s[l])&&(i[s[l]]=e[s[l]]);return i},nf=R.memo(function(r){var i=r.formatHour,s=i===void 0?tf:i,l=r.locale,c=r.number,o=rf(r,["formatHour","locale","number"]);return ze.createElement(Qs,Ui({number:c?s(l,c):null},o))});function ro(e,r){return function(i,s,l){var c=i,o=s,h=c[o];if(typeof h<"u"){if(typeof h!="number")return new Error("Invalid prop `".concat(s,"` of type `").concat(typeof h,"` supplied to `").concat(l,"`, expected `number`."));if(h<e||h>r)return new Error("Invalid prop `".concat(s,"` of type `").concat(typeof h,"` supplied to `").concat(l,"`, length must be between ").concat(e," and ").concat(r,"."))}return null}}var $n=ro(0,100),wi=ro(-100,100),Vn=function(r,i,s){var l=r,c=i,o=l[c];if(typeof o<"u"){if(typeof o!="number")return new Error("Invalid prop `".concat(i,"` of type `").concat(typeof o,"` supplied to `").concat(s,"`, expected `number`."));if(o<0)return new Error("Invalid prop `".concat(i,"` of type `").concat(typeof o,"` supplied to `").concat(s,"`, width must be greater or equal to 0."))}return null},rs=$n,ns=Vn,no=function(r){var i=r.className,s=r.formatHour,l=r.hourHandLength,c=l===void 0?50:l,o=r.hourHandOppositeLength,h=r.hourHandWidth,g=h===void 0?4:h,d=r.hourMarksLength,p=d===void 0?10:d,w=r.hourMarksWidth,_=w===void 0?3:w,S=r.locale,E=r.minuteHandLength,b=E===void 0?70:E,L=r.minuteHandOppositeLength,A=r.minuteHandWidth,k=A===void 0?2:A,U=r.minuteMarksLength,N=U===void 0?6:U,P=r.minuteMarksWidth,G=P===void 0?1:P,$=r.renderHourMarks,J=$===void 0?!0:$,X=r.renderMinuteHand,Z=X===void 0?!0:X,ie=r.renderMinuteMarks,de=ie===void 0?!0:ie,_e=r.renderNumbers,Ee=r.renderSecondHand,Se=Ee===void 0?!0:Ee,le=r.secondHandLength,pe=le===void 0?90:le,he=r.secondHandOppositeLength,Te=r.secondHandWidth,xe=Te===void 0?1:Te,ye=r.size,ge=ye===void 0?150:ye,be=r.useMillisecondPrecision,fe=r.value;function Ue(){if(!de)return null;for(var Fe=[],Ne=1;Ne<=60;Ne+=1){var Be=J&&!(Ne%5);Be||Fe.push(ze.createElement(Id,{key:"minute_".concat(Ne),angle:Ne*6,length:N,name:"minute",width:G}))}return Fe}function Ce(){if(!J)return null;for(var Fe=[],Ne=1;Ne<=12;Ne+=1)Fe.push(ze.createElement(nf,{key:"hour_".concat(Ne),angle:Ne*30,formatHour:s,length:p,locale:S,name:"hour",number:_e?Ne:void 0,width:_}));return Fe}function ae(){return ze.createElement("div",{className:"react-clock__face"},Ue(),Ce())}function we(){var Fe=fe?es(fe)*30+Si(fe)/2+Ei(fe)/120+(be?xi(fe)/12e4:0):0;return ze.createElement(Ti,{angle:Fe,length:c,name:"hour",oppositeLength:o,width:g})}function Ae(){if(!Z)return null;var Fe=fe?es(fe)*360+Si(fe)*6+Ei(fe)/10+(be?xi(fe)/1e4:0):0;return ze.createElement(Ti,{angle:Fe,length:b,name:"minute",oppositeLength:L,width:k})}function Oe(){if(!Se)return null;var Fe=fe?Si(fe)*360+Ei(fe)*6+(be?xi(fe)*.006:0):0;return ze.createElement(Ti,{angle:Fe,length:pe,name:"second",oppositeLength:he,width:xe})}return ze.createElement("time",{className:Cd("react-clock",i),dateTime:fe instanceof Date?fe.toISOString():fe||void 0,style:{width:ge,height:ge}},ae(),we(),Ae(),Oe())};no.propTypes={className:Gt.oneOfType([Gt.string,Gt.arrayOf(Gt.string)]),formatHour:Gt.func,hourHandLength:$n,hourHandOppositeLength:wi,hourHandWidth:Vn,hourMarksLength:rs,hourMarksWidth:ns,locale:Gt.string,minuteHandLength:$n,minuteHandOppositeLength:wi,minuteHandWidth:Vn,minuteMarksLength:rs,minuteMarksWidth:ns,renderHourMarks:Gt.bool,renderMinuteHand:Gt.bool,renderMinuteMarks:Gt.bool,renderNumbers:Gt.bool,renderSecondHand:Gt.bool,secondHandLength:$n,secondHandOppositeLength:wi,secondHandWidth:Vn,size:Gt.oneOfType([Gt.number,Gt.string]),value:Gt.oneOfType([Gt.string,Gt.instanceOf(Date)])};const io=e=>{const{text:r,cssClass:i,state:s,textFontSize:l,gap:c,width:o,height:h,labelPosition:g,fontFamily:d="inherit",boxReflect:p,staticDevMoveableRef:w,constraintsVertical:_,constraintsHorizontal:S,isStaticElement:E,left:b,top:L,right:A,bottom:k,index:U,deltaCenterX:N,deltaCenterY:P}=e,G=Pt(s,U),$=mt(le=>le.showBoundingBox),J=rt({[`element_${e.type}`]:!0,[`${i}`]:i,showBoundingBox:$,...G}),X=yt({sizeObj:c,sizePropName:"gap"}),Z=Et(l),ie=Mt({width:o,height:h,constraintsVertical:_,constraintsHorizontal:S,isStaticElement:E,left:b,top:L,right:A,bottom:k,deltaCenterX:N,deltaCenterY:P}),de={flexFlow:g==="bottom"?"column":"column-reverse"},_e=Xt(p),[Ee,Se]=R.useState(new Date);return R.useEffect(()=>{const le=setInterval(()=>{Se(new Date)},1e3);return()=>{clearInterval(le)}},[]),I.jsxs(Dd,{...e,ref:le=>{w&&(w.current=le)},style:{...ie,...X,...de,fontFamily:d,..._e},className:J,children:[I.jsx(no,{size:"90%",renderNumbers:!1,value:Ee}),r?I.jsx(Rt,{...e,style:Z,text:r}):null]})};io.displayName="ClockWidget";const ao=""+new URL("poster-Ow2yuuT1.png",import.meta.url).href,af=pt(jt)`
  position: relative;
  width: 100%;
  border-radius: ${({theme:e})=>e.borderRadius};
  display: flex;
  background: rgba(17, 19, 22, 0.25);
  border: 0.5px rgba(255, 255, 255, 0.1) solid;

  .sidebar {
    padding: 1.3em;
    position: relative;
    min-width: 250px;
    border-radius: 0 ${({theme:e})=>e.borderRadius}
      ${({theme:e})=>e.borderRadius} 0;
    background: rgba(77, 78, 86, 0.25);
    border-left: 0.5px rgba(255, 255, 255, 0.1) solid;
    display: flex;
    flex-flow: column;
    gap: 1em;

    .headline {
      display: flex;
      align-items: center;

      .text {
        color: ${({theme:e})=>nn(e.colors.textColor).alpha(.5)};
        font-weight: 250;
        flex: 1;
        text-align: center;
      }
    }

    .sideContent {
      position: relative;
      flex: 1;

      .playerScroller {
        position: absolute;
        width: 100%;
        height: 100%;
        overflow-y: auto;
        height: 100%;
        max-height: 100%;
      }
    }

    .item {
      padding: 1em 0;
      text-transform: capitalize;
      border-bottom: 0.5px rgba(255, 255, 255, 0.1) dashed;

      display: flex;
      align-items: center;
      gap: 0.5em;

      .poster {
        width: 30px;
        min-width: 30px;
      }

      .label {
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
      }
    }
  }

  .body {
    flex: 1;
    width: 100%;
    /* height: 100%; */
    display: flex;
    flex-flow: column;
    gap: 1em;
    align-items: center;
    padding: 1.5em;
    overflow: hidden;

    .info {
      display: flex;
      flex-flow: column;
      gap: 1em;
      align-items: center;
      justify-content: center;
      flex: 1;
      padding: 1em 0;
    }
  }
  .header {
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.8em;
    color: ${({theme:e})=>nn(e.colors.textColor).alpha(.5)};
    font-weight: 250;

    & > * {
      flex: 1;
      width: 33.333%;
      display: flex;

      &.center {
        justify-content: center;
      }

      &.right {
        text-align: right;
        justify-content: flex-end;
      }
    }
  }
  .title {
    font-size: 2.5em;
  }
  .subTitle {
    color: ${({theme:e})=>nn(e.colors.textColor).alpha(.5)};
    font-weight: 300;

    span:not(:last-child) {
      &::after {
        content: ' • ';
      }
    }
  }
  .poster {
    position: relative;
    width: 150px;
    aspect-ratio: 1/1;
    border-radius: ${({theme:e})=>e.borderRadius};
    overflow: hidden;

    img {
      position: relative;
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: 50% 50%;
    }
  }
  .seekBar {
    padding: 1em 0;
    width: 100%;
    position: relative;
    display: flex;
    align-items: center;
    gap: 1em;

    .timeStamp {
      font-size: 0.8em;
      color: ${({theme:e})=>nn(e.colors.textColor).alpha(.5)};
      font-weight: 300;
    }

    .rc-slider-handle {
      width: 30px;
      height: 30px;
      margin-top: -12px;
      opacity: 0;
      cursor: not-allowed;
    }

    &.isSeekingAvailable {
      cursor: grab;
    }

    .rc-slider-rail {
      background: ${({theme:e})=>e.colors.textColor};
      will-change: all;
    }

    .rc-slider-track {
      background: ${({theme:e})=>e.colors.primaryColor};
      will-change: all;
    }
  }
  .repeatControls {
    display: flex;
    align-items: center;
    gap: 1.5em;
    font-size: 1.5em;
  }
  .controls {
    display: flex;
    align-items: center;
    gap: 1.5em;
    font-size: 1.5em;
  }

  .clickable {
    will-change: transform;
    cursor: pointer;
    transition: 200ms;
    &:active {
      transform: scale(0.8);
    }
  }

  .pressed {
    color: ${({theme:e})=>e.colors.primaryColor};
  }
`,is=({isPressed:e,iconName:r,onClick:i,isAvailable:s,isConnected:l})=>{const c=rt({clickable:!0,pressed:e});return!l||s?I.jsx(fr,{className:c,icon:r,onClick:i}):null},sf=({isPlaying_signal_d_fb:e,isPaused_signal_d_fb:r,togglePlayPause_signal_d:i})=>{const[s,l]=R.useState(!1),c=Wt(e),o=Wt(r);return R.useEffect(()=>{c&&!o?l(!0):!c&&o&&l(!1)},[c,o]),I.jsx(fr,{onClick:()=>{Br(i)},style:{fontSize:"2.5em"},icon:s?"IoPauseCircle":"IoPlayCircle"})};function of(e,r){const s=(r-e)/2;return e+s}function as(e){const r=Math.floor(e/60),i=e%60;return`${r.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}const lf=({seekingAvailable_signal_d_fb:e,nowPlayingLengthSeconds_signal_a_fb:r,nowPlayingPositionSeconds_signal_a_fb:i,nowPlayingPositionGaudgePercent_signal_a_fb:s,pushSeekPercent_signal_a:l})=>{const c=It(A=>A.envState),o=As(A=>A.xPanelStatus),h=Wt(e),g=Yr(r),d=Yr(i),p=Yr(s)/65535*100,w=0,_=100,[S,E]=R.useState(),b=p;R.useEffect(()=>{E(of(w,_))},[]);let L=rt({seekBar:!0,isSeekingAvailable:h});return I.jsxs("div",{className:L,children:[I.jsx("div",{className:"timeStamp",children:as(d)}),I.jsx(Fr,{value:o==="connected"||c==="build"?b:S,onChange:A=>{o==="connected"||c==="build"?h&&ks({signalName:l,value:A*65535/100}):E(A)},className:"seekBarSlider",reverse:!1,vertical:!1,min:w,max:_}),I.jsx("div",{className:"timeStamp",children:as(g)})]})},uf=({data:e,i:r,sourceItemSelector:i})=>{const s=or({signalName:e[`sourceItemImage_${r}_signal_s_fb`],placeHolder:""}),l=or({signalName:e[`sourceItemTitle_${r}_signal_s_fb`],placeHolder:"Source Title"});return I.jsxs("div",{onClick:()=>{e[`sourceItemSelect_${r}_signal_d`]&&Br(e[`sourceItemSelect_${r}_signal_d`]),i&&ks({signalName:i,value:r})},className:"item clickable",children:[I.jsx("div",{className:"poster",children:I.jsx("img",{src:s||ao,alt:"poster"})}),I.jsx("div",{className:"label",children:l})]})},so=e=>{const{cssClass:r,state:i,gap:s,width:l,height:c,headerTextLeft:o,headerTextCenter:h,headerTextRight:g,metaTitle_signal_s_fb:d,metaSubTitle1_signal_s_fb:p,metaSubTitle2_signal_s_fb:w,metaSubTitle3_signal_s_fb:_,isPlaying_signal_d_fb:S,isPaused_signal_d_fb:E,togglePlayPause_signal_d:b,metaImage_signal_s_fb:L,repeatAllAvailable_signal_d_fb:A,repeatAllIsOn_signal_d_fb:k,toggleRepeatMode_signal_d:U,shuffleAvailable_signal_d_fb:N,shuffleIsOn_signal_d_fb:P,toggleShuffleMode_signal_d:G,seekingAvailable_signal_d_fb:$,nowPlayingLengthSeconds_signal_a_fb:J,nowPlayingPositionSeconds_signal_a_fb:X,nowPlayingPositionGaudgePercent_signal_a_fb:Z,pushSeekPercent_signal_a:ie,nextTrackAvailable_signal_d_fb:de,previousTrackAvailable_signal_d_fb:_e,nextTrack_signal_d:Ee,previousTrack_signal_d:Se,pulseSeekForward_signal_d:le,pulseSeekBack_signal_d:pe,sourceBack_signal_d:he,sourceBackVisibility_signal_d_fb:Te,sourceTitle_signal_s_fb:xe,sourceItems:ye,sourceItemSelector_signal_a:ge,staticDevMoveableRef:be,constraintsVertical:fe,constraintsHorizontal:Ue,isStaticElement:Ce,left:ae,top:we,right:Ae,bottom:Oe,index:Fe,deltaCenterX:Ne,deltaCenterY:Be}=e,qe=nc(),Ie=As(Le=>Le.xPanelStatus),Je=mt(Le=>Le.showBoundingBox),We=Ie==="connected",nt=or({signalName:d,placeHolder:"Meta Title"}),ft=or({signalName:p,placeHolder:We?"":"SubTitle 1"}),j=or({signalName:w,placeHolder:We?"":"SubTitle 2"}),K=or({signalName:_,placeHolder:We?"":"SubTitle 3"}),B=or({signalName:L,placeHolder:""}),M=Wt($),C=Pt(i,Fe),Y=rt({[`widget_${e.type}`]:!0,[`${r}`]:r,showBoundingBox:Je,...C}),H=Wt(k),z=Wt(A),V=Wt(P),q=Wt(N),ne=Wt(de),re=Wt(_e),ee=Mr({signalName:le}),se=Mr({signalName:pe}),ce=rt({clickable:!0,isDisabled:!re}),me=rt({clickable:!0,isDisabled:!ne}),ue=rt({clickable:!0,isDisabled:!M}),ke=or({signalName:xe,placeHolder:"Source Title"}),Re=Wt(Te),Ye=yt({sizeObj:s,sizePropName:"gap"}),oe=Mt({width:l,height:c,constraintsVertical:fe,constraintsHorizontal:Ue,isStaticElement:Ce,left:ae,top:we,right:Ae,bottom:Oe,deltaCenterX:Ne,deltaCenterY:Be});return I.jsxs(af,{...e,ref:Le=>{be&&(be.current=Le)},style:{...oe,...Ye},className:Y,children:[I.jsxs("div",{className:"body",children:[I.jsxs("div",{className:"header",children:[I.jsx("div",{className:"left",children:o&&I.jsx(Rt,{...e,text:o})}),I.jsx("div",{className:"center",children:h&&I.jsx(Rt,{...e,text:h})}),I.jsx("div",{className:"right",children:g&&I.jsx(Rt,{...e,text:g})})]}),I.jsxs("div",{className:"info",children:[I.jsx("div",{className:"title",children:nt}),I.jsxs("div",{className:"subTitle",children:[ft?I.jsxs("span",{children:[" ",ft," "]}):null,j?I.jsxs("span",{children:[" ",j," "]}):null,K?I.jsxs("span",{children:[" ",K," "]}):null]}),I.jsx("div",{className:"poster",children:I.jsx("img",{src:B||ao,alt:"poster"})}),I.jsxs("div",{className:"repeatControls",children:[I.jsx(is,{isConnected:We,isAvailable:z,iconName:"IoRepeat",isPressed:H,onClick:()=>{Ha({signalName:U,value:!H})}}),I.jsx(is,{isConnected:We,isAvailable:q,iconName:"IoShuffleOutline",isPressed:V,onClick:()=>{Ha({signalName:G,value:!V})}})]})]}),I.jsx(lf,{seekingAvailable_signal_d_fb:$,nowPlayingLengthSeconds_signal_a_fb:J,nowPlayingPositionSeconds_signal_a_fb:X,nowPlayingPositionGaudgePercent_signal_a_fb:Z,pushSeekPercent_signal_a:ie}),I.jsxs("div",{className:"controls",children:[I.jsx(fr,{className:ce,icon:"IoPlaySkipBackOutline",onClick:()=>{Br(Se)}}),(!We||M)&&I.jsx(fr,{...se,className:ue,icon:"IoPlayBackOutline"}),I.jsx(sf,{isPlaying_signal_d_fb:S,isPaused_signal_d_fb:E,togglePlayPause_signal_d:b}),(!We||M)&&I.jsx(fr,{...ee,className:ue,icon:"IoPlayForwardOutline"}),I.jsx(fr,{className:me,icon:"IoPlaySkipForwardOutline",onClick:()=>{Br(Ee)}})]})]}),I.jsxs("div",{className:"sidebar",children:[I.jsxs("div",{className:"headline",children:[Re&&I.jsx(fr,{onClick:()=>{Br(he)},className:"clickable",style:{fontSize:"1.2em"},icon:"IoArrowUndoCircle"}),I.jsx("div",{className:"text",children:ke})]}),I.jsx("div",{className:"sideContent",children:I.jsx("div",{ref:qe.ref,className:"playerScroller",children:I.jsx("div",{children:ye?.map((Le,$e)=>I.jsx(uf,{sourceItemSelector:ge,data:Le,i:$e},$e))})})})]})]})};so.displayName="PlayerWidget";const oo=({elements:e,batchSize:r=10})=>{const[i,s]=R.useState([]),l=R.useRef(0);return R.useEffect(()=>{const c=()=>{const o=e.slice(l.current,l.current+r).map((h,g)=>I.jsx(ze.Fragment,{children:h},l.current+g));s(h=>[...h,...o]),l.current+=r,l.current<e.length&&requestAnimationFrame(c)};l.current=0,s([]),requestAnimationFrame(c)},[e,r]),I.jsx(I.Fragment,{children:i})},cf=ze.memo(({listNumberOfItems:e,staticListOverrides:r,listData:i})=>{const s=R.useMemo(()=>{if(!i)return null;const l=i?.[0]??{};"cssClass"in l&&(l.cssClass=null);const c=Object.keys(r||{});return new Array(e).fill(l).map((g,d)=>{const p=d+1;return c.includes(String(p))&&(g={...g,...r?.[p]}),g?.width?.width?.unit==="%"&&(g.width.width.unit="cqw"),g?.height?.height?.unit==="%"&&(g.height.height.unit="cqh"),I.jsx(ri,{indexInList:p,...g},d)})},[i,e,r]);return s&&s?.length>30?I.jsx(oo,{elements:s}):s}),df=ze.memo(({listData:e})=>{const r=R.useMemo(()=>e?e.map((s,l)=>(s?.width?.width?.unit==="%"&&(s.width.width.unit="cqw"),s?.height?.height?.unit==="%"&&(s.height.height.unit="cqh"),I.jsx(ri,{...s},l))):null,[e]);return r&&r?.length>30?I.jsx(oo,{elements:r}):r}),ff=({listColumns:e,listElementsFlow:r,listForceFillHeight:i,listForceFillWidth:s,listRows:l,listVerticalPosition:c,listWidth:o,listHeight:h,constraintsVertical:g,constraintsHorizontal:d,isStaticElement:p,left:w,top:_,right:S,bottom:E,listGap:b,listPadding:L,listBackgroundColor:A,listBorder:k,listHorisontalPosition:U})=>{const N=Mt({width:o,height:h,replacePercentWithContainerUnits:!0,constraintsVertical:g,constraintsHorizontal:d,isStaticElement:p,left:w,top:_,right:S,bottom:E}),P=R.useMemo(()=>{let Se=structuredClone(N);const{width:le,height:pe}=Se;return le!=="auto"&&pe!=="auto"?Se={...Se,containerType:"size"}:le!=="auto"&&(Se={...Se,containerType:"inline-size"}),Se},[N]),G=yt({sizeObj:b,sizePropName:"gap"}),$=yt({sizeObj:L,sizePropName:"padding"}),J=A?{backgroundColor:A}:{},{useBorder:X,...Z}=k||{},ie=X?Z:{},de=R.useMemo(()=>c?{alignContent:{top:"start",bottom:"end","space-between":"space-between","space-around":"space-around"}[c]}:{},[c]),_e=R.useMemo(()=>U?{justifyContent:{left:"start",right:"end","space-between":"space-between","space-around":"space-around"}[U]}:{},[U]),Ee=R.useMemo(()=>r==="column"?{gridAutoFlow:r,gridAutoColumns:s?"1fr":"min-content",gridTemplateRows:`repeat(${l||1}, ${i?"1fr":"min-content"})`}:{gridAutoFlow:r,gridAutoRows:i?"1fr":"min-content",gridTemplateColumns:`repeat(${e||1}, ${s?"1fr":"min-content"})`},[e,r,i,s,l]);return{listWidthHeightStyles:P,listBackgroundColorStyles:J,listBorderStyles:ie,listPaddingElStyles:$,listGapStyles:G,listContainerGridStyles:Ee,verticalPositionStyles:de,horisontalPositionStyles:_e}},hf=async({initialSubpage:e,calculatedParameters:r=[]})=>{const{isDynamic:i,dataset:s,datasetPath:l,name:c,filter:o,parentArrayIndex:h,parentData:g={dataset:null,datasetPath:null,datasetFilter:null,datasetReturningField:null}}=e;if(!i||!s||!l)return[e];if(i&&!s)return console.log("No Ds uid found for dynamic element: ",c,s),[];const d=ws.getState().getDatasourceCalculatedData,p=d(s);if(!p)return console.log("No datasourceData found in cache store: ",c,s),[];let w=Xu(p,l);if(!w)return console.log("No list data after getValueFromPath: ",c,s),[];if(o?.length){const L=Object.values(Xn.getState().calculatedVariables??{}),A=$t.getState().workingProject?.attributes?.modificators;if(w=await Ls(o,w,h,g,e,L,A,r),!w)return console.log("No list data after applyFiltersToDatasetArray: ",c,s),[]}const{datasourceUsed:_={}}=e?.dynamicDataUsed??{},S=[],E=Array.from(new Set(Object.values(_??{}).map(L=>L)))??[],b=({elementPropsToBeFilled:L,dsSlice:A})=>{const k=Is({obj:A,pathArr:E});for(const[U,N]of Object.entries(_))Cs({object:L,newValue:k[N],path:U})};if(Array.isArray(w)&&w.length===0)for(const L of w){const A=Ua(e,L);b({elementPropsToBeFilled:A,dsSlice:L}),S.push(A)}else for(const L in w)if(Object.prototype.hasOwnProperty.call(w,L)){const A=Ua(e,w);b({elementPropsToBeFilled:A,dsSlice:w[L]}),S.push(A)}return S},lo=ze.memo(e=>{const{listWidth:r,listHeight:i,listGap:s={value:5,unit:"px"},listPadding:l,listBackgroundColor:c,listBorder:o,listElementsFlow:h,listRows:g=1,listColumns:d=1,listVerticalPosition:p,listHorisontalPosition:w,isDynamic:_=!1,listNumberOfItems:S,data:E,listState:b,staticListOverrides:L,cssClass:A,listForceFillHeight:k,listForceFillWidth:U,listEmptyText:N,constraintsVertical:P,constraintsHorizontal:G,isStaticElement:$,left:J,top:X,right:Z,bottom:ie,staticDevMoveableRef:de,calculatedParameters:_e}=e,{listWidthHeightStyles:Ee,listBackgroundColorStyles:Se,listBorderStyles:le,listPaddingElStyles:pe,listGapStyles:he,listContainerGridStyles:Te,verticalPositionStyles:xe,horisontalPositionStyles:ye}=ff({listColumns:d,listElementsFlow:h,listForceFillHeight:k,listForceFillWidth:U,listRows:g,listVerticalPosition:p,listWidth:r,listHeight:i,constraintsVertical:P,constraintsHorizontal:G,isStaticElement:$,left:J,top:X,right:Z,bottom:ie,listGap:s,listPadding:l,listBackgroundColor:c,listBorder:o,listHorisontalPosition:w}),{filter:ge}=E,{subscribedVariablesFromFilter:be,subscribedStatesFromFilter:fe}=ta({filter:ge,isDynamic:_}),[Ue,Ce]=R.useState(),[ae,we]=R.useState(!1);R.useEffect(()=>{hf({initialSubpage:E,calculatedParameters:_e}).then(Je=>{Ce(Je)})},[be,E,fe,_e]);const Ae=Pt(b,null),Oe=rt({[`${A}`]:A,listForceFillWidth:U,listForceFillHeight:k,...Ae}),Fe=R.useCallback(Je=>{Ie.current=!0;const We=Je.target.tagName.toLowerCase();(We==="circle"||We==="path")&&(console.log("The target is a circle element"),we(!0))},[]),Ne=R.useCallback(Je=>{qe.current&&Je.stopPropagation(),qe.current=!1,Ie.current=!1,we(!1)},[]),Be=R.useCallback(()=>{Ie.current&&(qe.current=!0)},[]),qe=R.useRef(!1),Ie=R.useRef(!1);return I.jsx(Uu,{...e,ref:Je=>{de&&(de.current=Je)},style:{...Ee,...Se,...le,...pe},className:Oe,children:I.jsx(ic,{onScroll:Be,onTouchStartCapture:Fe,onTouchEndCapture:Ne,mouseScroll:{activationDistance:50,ignoreElements:'[class*="rc-slider"], path, circle'},style:{overflow:ae?"hidden":"auto"},className:"listScroller",children:I.jsx("div",{style:{...he,...Te,...xe,...ye},"data-list-empty-text":N,className:"grid",children:_?I.jsx(df,{listData:Ue}):I.jsx(cf,{listNumberOfItems:S,staticListOverrides:L,listData:Ue})})})})});lo.displayName="SubpageListElement";const gf=pt(jt)`
  gap: 0.4em;
  display: flex;
    align-items: center;
    justify-content: center;


  .antCheckbox {
    color: inherit;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
   
    &:after {
        display: none !important;
      }

    .ant-checkbox {
      top: 0;
    }

    .tapcatcher {
      position: absolute;
      top: -25px;
      left: -25px;
      width: calc(100% + 50px);
      height: calc(100% + 50px);
      /* background-color: rgba(0, 0, 0, 0.5); */
    }

    .ant-checkbox-inner {
      border-color: transparent;
    }

    & .ant-checkbox-checked {
      &:after {
        border-color: ${({theme:e,color:r})=>r||e.colors.primaryColor};
      }
      .ant-checkbox-inner {
        background-color: ${({theme:e,color:r})=>r||e.colors.primaryColor};
        border-color: ${({theme:e,color:r})=>r||e.colors.primaryColor};

        &:after {
          border-color: ${({tickColor:e})=>e||"rgba(0, 0, 0, 0.75)"};
        }
      }
    }
  }
`,uo=e=>{const{text:r,cssClass:i,state:s,textFontSize:l,gap:c,actions:o,fontFamily:h="inherit",boxReflect:g,width:d,height:p,constraintsVertical:w,constraintsHorizontal:_,isStaticElement:S,left:E,top:b,right:L,bottom:A,staticDevMoveableRef:k,index:U,deltaCenterX:N,deltaCenterY:P,labelPosition:G="right"}=e,$=Pt(s,U),J=Wt(s?.checkedState_signal),[X,Z]=R.useState(J),ie=R.useRef(),de=R.useRef(J);R.useEffect(()=>{de.current=J,Z(J)},[J]);const _e=Et(l),Ee=yt({sizeObj:c,sizePropName:"gap"}),{onBeforeChangeActions:Se,onAfterChangeActions:le,onChangeActions:pe,isActiveOverlayTrigger:he}=lr({actions:o}),Te=rt({[`element_${e.type}`]:!0,[`${i}`]:i,isActiveOverlayTrigger:!!he,...$});function xe(fe){function Ue(){clearTimeout(ie.current),ie.current=setTimeout(()=>{Z(de.current)},3e3)}if(Ue(),Se.length)for(const Ce of Se)Ce(fe);if(pe.length)for(const Ce of pe)Ce(fe);if(Z(fe),le.length)for(const Ce of le)Ce(fe)}const ye=Xt(g),ge=Mt({width:d,height:p,constraintsVertical:w,constraintsHorizontal:_,isStaticElement:S,left:E,top:b,right:L,bottom:A,deltaCenterX:N,deltaCenterY:P}),be=R.useMemo(()=>{let fe={flexFlow:"column"};switch(G){case"top":fe={flexFlow:"column-reverse"};break;case"right":fe={flexFlow:"row"};break;case"bottom":fe={flexFlow:"column"};break;case"left":fe={flexFlow:"row-reverse"};break;default:fe={flexFlow:"row"};break}return fe},[G]);return I.jsx(gf,{ref:fe=>{k&&(k.current=fe)},style:{fontFamily:h,...ye,...ge},...e,className:Te,children:I.jsxs(Yu,{checked:X,onChange:fe=>{xe(fe.target.checked)},className:"antCheckbox",style:{...be,...Ee},children:[r?I.jsx(Rt,{...e,style:{..._e},text:r}):null,I.jsx("div",{className:"tapcatcher"})]})})};uo.displayName="CheckboxElement";const mf=pt(jt)`
  position: relative;
  cursor: pointer;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;

  .playIcon {
    height: 40%;
    width: 40%;
    max-width: 120px;
    position: relative;
    object-fit: contain;
    transition: 200ms;

    &:active {
      scale: 0.8;
    }
  }

  video {
    position: absolute;
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: 50% 50%;

    /* &::-webkit-media-controls {
      display: none;
    } */

    &:-webkit-full-page-media {
    }

    &::-webkit-media-controls-panel {
    }

    &::-webkit-media-controls-enclosure {
    }

    &::-webkit-media-controls-play-button {
    }

    &::-webkit-media-controls-volume-slider {
    }

    &::-webkit-media-controls-mute-button {
      /* display: none; */
    }

    &::-webkit-media-controls-timeline-container {
    }

    &::-webkit-media-controls-timeline {
    }

    &::-webkit-media-controls-current-time-display {
    }

    &::-webkit-media-controls-seek-back-button {
    }

    &::-webkit-media-controls-seek-forward-button {
    }

    &::-webkit-media-controls-fullscreen-button {
    }

    &::-webkit-media-controls-return-to-realtime-button {
    }

    &::-webkit-media-controls-toggle-closed-captions-button {
    }

    &::-webkit-media-controls-closed-captions-container {
    }

    &::-webkit-media-controls-closed-captions-track-list {
    }

    &::-webkit-media-controls-fullscreen-volume-slider {
    }

    &::-webkit-media-controls-fullscreen-volume-min-button {
    }

    &::-webkit-media-controls-fullscreen-volume-max-button {
    }

    &::-webkit-media-text-track-container {
    }

    &::-webkit-media-controls {
      overflow: hidden !important;
    }
    &::-webkit-media-controls-enclosure {
      /* width: calc(100% + 32px);
      margin-left: auto; */
    }
  }
`;var co={exports:{}};(function(e,r){typeof window<"u"&&function(s,l){e.exports=l()}(Ke,function(){return function(i){var s={};function l(c){if(s[c])return s[c].exports;var o=s[c]={i:c,l:!1,exports:{}};return i[c].call(o.exports,o,o.exports,l),o.l=!0,o.exports}return l.m=i,l.c=s,l.d=function(c,o,h){l.o(c,o)||Object.defineProperty(c,o,{enumerable:!0,get:h})},l.r=function(c){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},l.t=function(c,o){if(o&1&&(c=l(c)),o&8||o&4&&typeof c=="object"&&c&&c.__esModule)return c;var h=Object.create(null);if(l.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:c}),o&2&&typeof c!="string")for(var g in c)l.d(h,g,function(d){return c[d]}.bind(null,g));return h},l.n=function(c){var o=c&&c.__esModule?function(){return c.default}:function(){return c};return l.d(o,"a",o),o},l.o=function(c,o){return Object.prototype.hasOwnProperty.call(c,o)},l.p="/dist/",l(l.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(i,s,l){var c=Object.prototype.hasOwnProperty,o="~";function h(){}Object.create&&(h.prototype=Object.create(null),new h().__proto__||(o=!1));function g(_,S,E){this.fn=_,this.context=S,this.once=E||!1}function d(_,S,E,b,L){if(typeof E!="function")throw new TypeError("The listener must be a function");var A=new g(E,b||_,L),k=o?o+S:S;return _._events[k]?_._events[k].fn?_._events[k]=[_._events[k],A]:_._events[k].push(A):(_._events[k]=A,_._eventsCount++),_}function p(_,S){--_._eventsCount===0?_._events=new h:delete _._events[S]}function w(){this._events=new h,this._eventsCount=0}w.prototype.eventNames=function(){var S=[],E,b;if(this._eventsCount===0)return S;for(b in E=this._events)c.call(E,b)&&S.push(o?b.slice(1):b);return Object.getOwnPropertySymbols?S.concat(Object.getOwnPropertySymbols(E)):S},w.prototype.listeners=function(S){var E=o?o+S:S,b=this._events[E];if(!b)return[];if(b.fn)return[b.fn];for(var L=0,A=b.length,k=new Array(A);L<A;L++)k[L]=b[L].fn;return k},w.prototype.listenerCount=function(S){var E=o?o+S:S,b=this._events[E];return b?b.fn?1:b.length:0},w.prototype.emit=function(S,E,b,L,A,k){var U=o?o+S:S;if(!this._events[U])return!1;var N=this._events[U],P=arguments.length,G,$;if(N.fn){switch(N.once&&this.removeListener(S,N.fn,void 0,!0),P){case 1:return N.fn.call(N.context),!0;case 2:return N.fn.call(N.context,E),!0;case 3:return N.fn.call(N.context,E,b),!0;case 4:return N.fn.call(N.context,E,b,L),!0;case 5:return N.fn.call(N.context,E,b,L,A),!0;case 6:return N.fn.call(N.context,E,b,L,A,k),!0}for($=1,G=new Array(P-1);$<P;$++)G[$-1]=arguments[$];N.fn.apply(N.context,G)}else{var J=N.length,X;for($=0;$<J;$++)switch(N[$].once&&this.removeListener(S,N[$].fn,void 0,!0),P){case 1:N[$].fn.call(N[$].context);break;case 2:N[$].fn.call(N[$].context,E);break;case 3:N[$].fn.call(N[$].context,E,b);break;case 4:N[$].fn.call(N[$].context,E,b,L);break;default:if(!G)for(X=1,G=new Array(P-1);X<P;X++)G[X-1]=arguments[X];N[$].fn.apply(N[$].context,G)}}return!0},w.prototype.on=function(S,E,b){return d(this,S,E,b,!1)},w.prototype.once=function(S,E,b){return d(this,S,E,b,!0)},w.prototype.removeListener=function(S,E,b,L){var A=o?o+S:S;if(!this._events[A])return this;if(!E)return p(this,A),this;var k=this._events[A];if(k.fn)k.fn===E&&(!L||k.once)&&(!b||k.context===b)&&p(this,A);else{for(var U=0,N=[],P=k.length;U<P;U++)(k[U].fn!==E||L&&!k[U].once||b&&k[U].context!==b)&&N.push(k[U]);N.length?this._events[A]=N.length===1?N[0]:N:p(this,A)}return this},w.prototype.removeAllListeners=function(S){var E;return S?(E=o?o+S:S,this._events[E]&&p(this,E)):(this._events=new h,this._eventsCount=0),this},w.prototype.off=w.prototype.removeListener,w.prototype.addListener=w.prototype.on,w.prefixed=o,w.EventEmitter=w,i.exports=w},"./node_modules/url-toolkit/src/url-toolkit.js":function(i,s,l){(function(c){var o=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,h=/^([^\/?#]*)(.*)$/,g=/(?:\/|^)\.(?=\/)/g,d=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,p={buildAbsoluteURL:function(w,_,S){if(S=S||{},w=w.trim(),_=_.trim(),!_){if(!S.alwaysNormalize)return w;var E=p.parseURL(w);if(!E)throw new Error("Error trying to parse base URL.");return E.path=p.normalizePath(E.path),p.buildURLFromParts(E)}var b=p.parseURL(_);if(!b)throw new Error("Error trying to parse relative URL.");if(b.scheme)return S.alwaysNormalize?(b.path=p.normalizePath(b.path),p.buildURLFromParts(b)):_;var L=p.parseURL(w);if(!L)throw new Error("Error trying to parse base URL.");if(!L.netLoc&&L.path&&L.path[0]!=="/"){var A=h.exec(L.path);L.netLoc=A[1],L.path=A[2]}L.netLoc&&!L.path&&(L.path="/");var k={scheme:L.scheme,netLoc:b.netLoc,path:null,params:b.params,query:b.query,fragment:b.fragment};if(!b.netLoc&&(k.netLoc=L.netLoc,b.path[0]!=="/"))if(!b.path)k.path=L.path,b.params||(k.params=L.params,b.query||(k.query=L.query));else{var U=L.path,N=U.substring(0,U.lastIndexOf("/")+1)+b.path;k.path=p.normalizePath(N)}return k.path===null&&(k.path=S.alwaysNormalize?p.normalizePath(b.path):b.path),p.buildURLFromParts(k)},parseURL:function(w){var _=o.exec(w);return _?{scheme:_[1]||"",netLoc:_[2]||"",path:_[3]||"",params:_[4]||"",query:_[5]||"",fragment:_[6]||""}:null},normalizePath:function(w){for(w=w.split("").reverse().join("").replace(g,"");w.length!==(w=w.replace(d,"")).length;);return w.split("").reverse().join("")},buildURLFromParts:function(w){return w.scheme+w.netLoc+w.path+w.params+w.query+w.fragment}};i.exports=p})()},"./node_modules/webworkify-webpack/index.js":function(i,s,l){function c(S){var E={};function b(A){if(E[A])return E[A].exports;var k=E[A]={i:A,l:!1,exports:{}};return S[A].call(k.exports,k,k.exports,b),k.l=!0,k.exports}b.m=S,b.c=E,b.i=function(A){return A},b.d=function(A,k,U){b.o(A,k)||Object.defineProperty(A,k,{configurable:!1,enumerable:!0,get:U})},b.r=function(A){Object.defineProperty(A,"__esModule",{value:!0})},b.n=function(A){var k=A&&A.__esModule?function(){return A.default}:function(){return A};return b.d(k,"a",k),k},b.o=function(A,k){return Object.prototype.hasOwnProperty.call(A,k)},b.p="/",b.oe=function(A){throw console.error(A),A};var L=b(b.s=ENTRY_MODULE);return L.default||L}var o="[\\.|\\-|\\+|\\w|/|@]+",h="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+o+").*?\\)";function g(S){return(S+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function d(S){return!isNaN(1*S)}function p(S,E,b){var L={};L[b]=[];var A=E.toString(),k=A.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!k)return L;for(var U=k[1],N=new RegExp("(\\\\n|\\W)"+g(U)+h,"g"),P;P=N.exec(A);)P[3]!=="dll-reference"&&L[b].push(P[3]);for(N=new RegExp("\\("+g(U)+'\\("(dll-reference\\s('+o+'))"\\)\\)'+h,"g");P=N.exec(A);)S[P[2]]||(L[b].push(P[1]),S[P[2]]=l(P[1]).m),L[P[2]]=L[P[2]]||[],L[P[2]].push(P[4]);for(var G=Object.keys(L),$=0;$<G.length;$++)for(var J=0;J<L[G[$]].length;J++)d(L[G[$]][J])&&(L[G[$]][J]=1*L[G[$]][J]);return L}function w(S){var E=Object.keys(S);return E.reduce(function(b,L){return b||S[L].length>0},!1)}function _(S,E){for(var b={main:[E]},L={main:[]},A={main:{}};w(b);)for(var k=Object.keys(b),U=0;U<k.length;U++){var N=k[U],P=b[N],G=P.pop();if(A[N]=A[N]||{},!(A[N][G]||!S[N][G])){A[N][G]=!0,L[N]=L[N]||[],L[N].push(G);for(var $=p(S,S[N][G],N),J=Object.keys($),X=0;X<J.length;X++)b[J[X]]=b[J[X]]||[],b[J[X]]=b[J[X]].concat($[J[X]])}}return L}i.exports=function(S,E){E=E||{};var b={main:l.m},L=E.all?{main:Object.keys(b.main)}:_(b,S),A="";Object.keys(L).filter(function(G){return G!=="main"}).forEach(function(G){for(var $=0;L[G][$];)$++;L[G].push($),b[G][$]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",A=A+"var "+G+" = ("+c.toString().replace("ENTRY_MODULE",JSON.stringify($))+")({"+L[G].map(function(J){return""+JSON.stringify(J)+": "+b[G][J].toString()}).join(",")+`});
`}),A=A+"new (("+c.toString().replace("ENTRY_MODULE",JSON.stringify(S))+")({"+L.main.map(function(G){return""+JSON.stringify(G)+": "+b.main[G].toString()}).join(",")+"}))(self);";var k=new window.Blob([A],{type:"text/javascript"});if(E.bare)return k;var U=window.URL||window.webkitURL||window.mozURL||window.msURL,N=U.createObjectURL(k),P=new window.Worker(N);return P.objectURL=N,P}},"./src/crypt/decrypter.js":function(i,s,l){l.r(s);var c=function(){function A(U,N){this.subtle=U,this.aesIV=N}var k=A.prototype;return k.decrypt=function(N,P){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},P,N)},A}(),o=function(){function A(U,N){this.subtle=U,this.key=N}var k=A.prototype;return k.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},A}(),h=o;function g(A){var k=A.byteLength,U=k&&new DataView(A).getUint8(k-1);return U?A.slice(0,k-U):A}var d=function(){function A(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var k=A.prototype;return k.uint8ArrayToUint32Array_=function(N){for(var P=new DataView(N),G=new Uint32Array(4),$=0;$<4;$++)G[$]=P.getUint32($*4);return G},k.initTable=function(){var N=this.sBox,P=this.invSBox,G=this.subMix,$=G[0],J=G[1],X=G[2],Z=G[3],ie=this.invSubMix,de=ie[0],_e=ie[1],Ee=ie[2],Se=ie[3],le=new Uint32Array(256),pe=0,he=0,Te=0;for(Te=0;Te<256;Te++)Te<128?le[Te]=Te<<1:le[Te]=Te<<1^283;for(Te=0;Te<256;Te++){var xe=he^he<<1^he<<2^he<<3^he<<4;xe=xe>>>8^xe&255^99,N[pe]=xe,P[xe]=pe;var ye=le[pe],ge=le[ye],be=le[ge],fe=le[xe]*257^xe*16843008;$[pe]=fe<<24|fe>>>8,J[pe]=fe<<16|fe>>>16,X[pe]=fe<<8|fe>>>24,Z[pe]=fe,fe=be*16843009^ge*65537^ye*257^pe*16843008,de[xe]=fe<<24|fe>>>8,_e[xe]=fe<<16|fe>>>16,Ee[xe]=fe<<8|fe>>>24,Se[xe]=fe,pe?(pe=ye^le[le[le[be^ye]]],he^=le[le[he]]):pe=he=1}},k.expandKey=function(N){for(var P=this.uint8ArrayToUint32Array_(N),G=!0,$=0;$<P.length&&G;)G=P[$]===this.key[$],$++;if(!G){this.key=P;var J=this.keySize=P.length;if(J!==4&&J!==6&&J!==8)throw new Error("Invalid aes key size="+J);var X=this.ksRows=(J+6+1)*4,Z,ie,de=this.keySchedule=new Uint32Array(X),_e=this.invKeySchedule=new Uint32Array(X),Ee=this.sBox,Se=this.rcon,le=this.invSubMix,pe=le[0],he=le[1],Te=le[2],xe=le[3],ye,ge;for(Z=0;Z<X;Z++){if(Z<J){ye=de[Z]=P[Z];continue}ge=ye,Z%J===0?(ge=ge<<8|ge>>>24,ge=Ee[ge>>>24]<<24|Ee[ge>>>16&255]<<16|Ee[ge>>>8&255]<<8|Ee[ge&255],ge^=Se[Z/J|0]<<24):J>6&&Z%J===4&&(ge=Ee[ge>>>24]<<24|Ee[ge>>>16&255]<<16|Ee[ge>>>8&255]<<8|Ee[ge&255]),de[Z]=ye=(de[Z-J]^ge)>>>0}for(ie=0;ie<X;ie++)Z=X-ie,ie&3?ge=de[Z]:ge=de[Z-4],ie<4||Z<=4?_e[ie]=ge:_e[ie]=pe[Ee[ge>>>24]]^he[Ee[ge>>>16&255]]^Te[Ee[ge>>>8&255]]^xe[Ee[ge&255]],_e[ie]=_e[ie]>>>0}},k.networkToHostOrderSwap=function(N){return N<<24|(N&65280)<<8|(N&16711680)>>8|N>>>24},k.decrypt=function(N,P,G,$){for(var J=this.keySize+6,X=this.invKeySchedule,Z=this.invSBox,ie=this.invSubMix,de=ie[0],_e=ie[1],Ee=ie[2],Se=ie[3],le=this.uint8ArrayToUint32Array_(G),pe=le[0],he=le[1],Te=le[2],xe=le[3],ye=new Int32Array(N),ge=new Int32Array(ye.length),be,fe,Ue,Ce,ae,we,Ae,Oe,Fe,Ne,Be,qe,Ie,Je,We=this.networkToHostOrderSwap;P<ye.length;){for(Fe=We(ye[P]),Ne=We(ye[P+1]),Be=We(ye[P+2]),qe=We(ye[P+3]),ae=Fe^X[0],we=qe^X[1],Ae=Be^X[2],Oe=Ne^X[3],Ie=4,Je=1;Je<J;Je++)be=de[ae>>>24]^_e[we>>16&255]^Ee[Ae>>8&255]^Se[Oe&255]^X[Ie],fe=de[we>>>24]^_e[Ae>>16&255]^Ee[Oe>>8&255]^Se[ae&255]^X[Ie+1],Ue=de[Ae>>>24]^_e[Oe>>16&255]^Ee[ae>>8&255]^Se[we&255]^X[Ie+2],Ce=de[Oe>>>24]^_e[ae>>16&255]^Ee[we>>8&255]^Se[Ae&255]^X[Ie+3],ae=be,we=fe,Ae=Ue,Oe=Ce,Ie=Ie+4;be=Z[ae>>>24]<<24^Z[we>>16&255]<<16^Z[Ae>>8&255]<<8^Z[Oe&255]^X[Ie],fe=Z[we>>>24]<<24^Z[Ae>>16&255]<<16^Z[Oe>>8&255]<<8^Z[ae&255]^X[Ie+1],Ue=Z[Ae>>>24]<<24^Z[Oe>>16&255]<<16^Z[ae>>8&255]<<8^Z[we&255]^X[Ie+2],Ce=Z[Oe>>>24]<<24^Z[ae>>16&255]<<16^Z[we>>8&255]<<8^Z[Ae&255]^X[Ie+3],Ie=Ie+3,ge[P]=We(be^pe),ge[P+1]=We(Ce^he),ge[P+2]=We(Ue^Te),ge[P+3]=We(fe^xe),pe=Fe,he=Ne,Te=Be,xe=qe,P=P+4}return $?g(ge.buffer):ge.buffer},k.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},A}(),p=d,w=l("./src/errors.ts"),_=l("./src/utils/logger.js"),S=l("./src/events.js"),E=l("./src/utils/get-self-scope.js"),b=Object(E.getSelfScope)(),L=function(){function A(U,N,P){var G=P===void 0?{}:P,$=G.removePKCS7Padding,J=$===void 0?!0:$;if(this.logEnabled=!0,this.observer=U,this.config=N,this.removePKCS7Padding=J,J)try{var X=b.crypto;X&&(this.subtle=X.subtle||X.webkitSubtle)}catch{}this.disableWebCrypto=!this.subtle}var k=A.prototype;return k.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},k.decrypt=function(N,P,G,$){var J=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(_.logger.log("JS AES decrypt"),this.logEnabled=!1);var X=this.decryptor;X||(this.decryptor=X=new p),X.expandKey(P),$(X.decrypt(N,0,G,this.removePKCS7Padding))}else{this.logEnabled&&(_.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var Z=this.subtle;this.key!==P&&(this.key=P,this.fastAesKey=new h(Z,P)),this.fastAesKey.expandKey().then(function(ie){var de=new c(Z,G);de.decrypt(N,ie).catch(function(_e){J.onWebCryptoError(_e,N,P,G,$)}).then(function(_e){$(_e)})}).catch(function(ie){J.onWebCryptoError(ie,N,P,G,$)})}},k.onWebCryptoError=function(N,P,G,$,J){this.config.enableSoftwareAES?(_.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(P,G,$,J)):(_.logger.error("decrypting error : "+N.message),this.observer.trigger(S.default.ERROR,{type:w.ErrorTypes.MEDIA_ERROR,details:w.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:N.message}))},k.destroy=function(){var N=this.decryptor;N&&(N.destroy(),this.decryptor=void 0)},A}();s.default=L},"./src/demux/demuxer-inline.js":function(i,s,l){l.r(s);var c=l("./src/events.js"),o=l("./src/errors.ts"),h=l("./src/crypt/decrypter.js"),g=l("./src/polyfills/number.js"),d=l("./src/utils/logger.js"),p=l("./src/utils/get-self-scope.js");function w(j,K,B,M){var C,Y,H,z,V,q=navigator.userAgent.toLowerCase(),ne=M,re=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(C=((K[B+2]&192)>>>6)+1,Y=(K[B+2]&60)>>>2,Y>re.length-1){j.trigger(c.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+Y});return}return z=(K[B+2]&1)<<2,z|=(K[B+3]&192)>>>6,d.logger.log("manifest codec:"+M+",ADTS data:type:"+C+",sampleingIndex:"+Y+"["+re[Y]+"Hz],channelConfig:"+z),/firefox/i.test(q)?Y>=6?(C=5,V=new Array(4),H=Y-3):(C=2,V=new Array(2),H=Y):q.indexOf("android")!==-1?(C=2,V=new Array(2),H=Y):(C=5,V=new Array(4),M&&(M.indexOf("mp4a.40.29")!==-1||M.indexOf("mp4a.40.5")!==-1)||!M&&Y>=6?H=Y-3:((M&&M.indexOf("mp4a.40.2")!==-1&&(Y>=6&&z===1||/vivaldi/i.test(q))||!M&&z===1)&&(C=2,V=new Array(2)),H=Y)),V[0]=C<<3,V[0]|=(Y&14)>>1,V[1]|=(Y&1)<<7,V[1]|=z<<3,C===5&&(V[1]|=(H&14)>>1,V[2]=(H&1)<<7,V[2]|=8,V[3]=0),{config:V,samplerate:re[Y],channelCount:z,codec:"mp4a.40."+C,manifestCodec:ne}}function _(j,K){return j[K]===255&&(j[K+1]&246)===240}function S(j,K){return j[K+1]&1?7:9}function E(j,K){return(j[K+3]&3)<<11|j[K+4]<<3|(j[K+5]&224)>>>5}function b(j,K){return!!(K+1<j.length&&_(j,K))}function L(j,K){if(b(j,K)){var B=S(j,K);if(K+B>=j.length)return!1;var M=E(j,K);if(M<=B)return!1;var C=K+M;if(C===j.length||C+1<j.length&&_(j,C))return!0}return!1}function A(j,K,B,M,C){if(!j.samplerate){var Y=w(K,B,M,C);j.config=Y.config,j.samplerate=Y.samplerate,j.channelCount=Y.channelCount,j.codec=Y.codec,j.manifestCodec=Y.manifestCodec,d.logger.log("parsed codec:"+j.codec+",rate:"+Y.samplerate+",nb channel:"+Y.channelCount)}}function k(j){return 1024*9e4/j}function U(j,K,B,M,C){var Y,H,z,V=j.length;if(Y=S(j,K),H=E(j,K),H-=Y,H>0&&K+Y+H<=V)return z=B+M*C,{headerLength:Y,frameLength:H,stamp:z}}function N(j,K,B,M,C){var Y=k(j.samplerate),H=U(K,B,M,C,Y);if(H){var z=H.stamp,V=H.headerLength,q=H.frameLength,ne={unit:K.subarray(B+V,B+V+q),pts:z,dts:z};return j.samples.push(ne),{sample:ne,length:q+V}}}var P=l("./src/demux/id3.js"),G=function(){function j(B,M,C){this.observer=B,this.config=C,this.remuxer=M}var K=j.prototype;return K.resetInitSegment=function(M,C,Y,H){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:C,duration:H,inputTimeScale:9e4}},K.resetTimeStamp=function(){},j.probe=function(M){if(!M)return!1;for(var C=P.default.getID3Data(M,0)||[],Y=C.length,H=M.length;Y<H;Y++)if(L(M,Y))return d.logger.log("ADTS sync word found !"),!0;return!1},K.append=function(M,C,Y,H){for(var z=this._audioTrack,V=P.default.getID3Data(M,0)||[],q=P.default.getTimeStamp(V),ne=Object(g.isFiniteNumber)(q)?q*90:C*9e4,re=0,ee=ne,se=M.length,ce=V.length,me=[{pts:ee,dts:ee,data:V}];ce<se-1;)if(b(M,ce)&&ce+5<se){A(z,this.observer,M,ce,z.manifestCodec);var ue=N(z,M,ce,ne,re);if(ue)ce+=ue.length,ee=ue.sample.pts,re++;else{d.logger.log("Unable to parse AAC frame");break}}else P.default.isHeader(M,ce)?(V=P.default.getID3Data(M,ce),me.push({pts:ee,dts:ee,data:V}),ce+=V.length):ce++;this.remuxer.remux(z,{samples:[]},{samples:me,inputTimeScale:9e4},{samples:[]},C,Y,H)},K.destroy=function(){},j}(),$=G,J=l("./src/demux/mp4demuxer.js"),X={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(K,B,M,C,Y){if(!(M+24>B.length)){var H=this.parseHeader(B,M);if(H&&M+H.frameLength<=B.length){var z=H.samplesPerFrame*9e4/H.sampleRate,V=C+Y*z,q={unit:B.subarray(M,M+H.frameLength),pts:V,dts:V};return K.config=[],K.channelCount=H.channelCount,K.samplerate=H.sampleRate,K.samples.push(q),{sample:q,length:H.frameLength}}}},parseHeader:function(K,B){var M=K[B+1]>>3&3,C=K[B+1]>>1&3,Y=K[B+2]>>4&15,H=K[B+2]>>2&3,z=K[B+2]>>1&1;if(M!==1&&Y!==0&&Y!==15&&H!==3){var V=M===3?3-C:C===3?3:4,q=X.BitratesMap[V*14+Y-1]*1e3,ne=M===3?0:M===2?1:2,re=X.SamplingRateMap[ne*3+H],ee=K[B+3]>>6===3?1:2,se=X.SamplesCoefficients[M][C],ce=X.BytesInSlot[C],me=se*8*ce,ue=parseInt(se*q/re+z,10)*ce;return{sampleRate:re,channelCount:ee,frameLength:ue,samplesPerFrame:me}}},isHeaderPattern:function(K,B){return K[B]===255&&(K[B+1]&224)===224&&(K[B+1]&6)!==0},isHeader:function(K,B){return!!(B+1<K.length&&this.isHeaderPattern(K,B))},probe:function(K,B){if(B+1<K.length&&this.isHeaderPattern(K,B)){var M=4,C=this.parseHeader(K,B),Y=M;C&&C.frameLength&&(Y=C.frameLength);var H=B+Y;if(H===K.length||H+1<K.length&&this.isHeaderPattern(K,H))return!0}return!1}},Z=X,ie=function(){function j(B){this.data=B,this.bytesAvailable=B.byteLength,this.word=0,this.bitsAvailable=0}var K=j.prototype;return K.loadWord=function(){var M=this.data,C=this.bytesAvailable,Y=M.byteLength-C,H=new Uint8Array(4),z=Math.min(4,C);if(z===0)throw new Error("no bytes available");H.set(M.subarray(Y,Y+z)),this.word=new DataView(H.buffer).getUint32(0),this.bitsAvailable=z*8,this.bytesAvailable-=z},K.skipBits=function(M){var C;this.bitsAvailable>M?(this.word<<=M,this.bitsAvailable-=M):(M-=this.bitsAvailable,C=M>>3,M-=C>>3,this.bytesAvailable-=C,this.loadWord(),this.word<<=M,this.bitsAvailable-=M)},K.readBits=function(M){var C=Math.min(this.bitsAvailable,M),Y=this.word>>>32-C;return M>32&&d.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=C,this.bitsAvailable>0?this.word<<=C:this.bytesAvailable>0&&this.loadWord(),C=M-C,C>0&&this.bitsAvailable?Y<<C|this.readBits(C):Y},K.skipLZ=function(){var M;for(M=0;M<this.bitsAvailable;++M)if(this.word&2147483648>>>M)return this.word<<=M,this.bitsAvailable-=M,M;return this.loadWord(),M+this.skipLZ()},K.skipUEG=function(){this.skipBits(1+this.skipLZ())},K.skipEG=function(){this.skipBits(1+this.skipLZ())},K.readUEG=function(){var M=this.skipLZ();return this.readBits(M+1)-1},K.readEG=function(){var M=this.readUEG();return 1&M?1+M>>>1:-1*(M>>>1)},K.readBoolean=function(){return this.readBits(1)===1},K.readUByte=function(){return this.readBits(8)},K.readUShort=function(){return this.readBits(16)},K.readUInt=function(){return this.readBits(32)},K.skipScalingList=function(M){var C=8,Y=8,H,z;for(H=0;H<M;H++)Y!==0&&(z=this.readEG(),Y=(C+z+256)%256),C=Y===0?C:Y},K.readSPS=function(){var M=0,C=0,Y=0,H=0,z,V,q,ne,re,ee,se,ce=this.readUByte.bind(this),me=this.readBits.bind(this),ue=this.readUEG.bind(this),ke=this.readBoolean.bind(this),Re=this.skipBits.bind(this),Ye=this.skipEG.bind(this),oe=this.skipUEG.bind(this),Le=this.skipScalingList.bind(this);if(ce(),z=ce(),me(5),Re(3),ce(),oe(),z===100||z===110||z===122||z===244||z===44||z===83||z===86||z===118||z===128){var $e=ue();if($e===3&&Re(1),oe(),oe(),Re(1),ke())for(ee=$e!==3?8:12,se=0;se<ee;se++)ke()&&(se<6?Le(16):Le(64))}oe();var Xe=ue();if(Xe===0)ue();else if(Xe===1)for(Re(1),Ye(),Ye(),V=ue(),se=0;se<V;se++)Ye();oe(),Re(1),q=ue(),ne=ue(),re=me(1),re===0&&Re(1),Re(1),ke()&&(M=ue(),C=ue(),Y=ue(),H=ue());var Ze=[1,1];if(ke()&&ke()){var ot=ce();switch(ot){case 1:Ze=[1,1];break;case 2:Ze=[12,11];break;case 3:Ze=[10,11];break;case 4:Ze=[16,11];break;case 5:Ze=[40,33];break;case 6:Ze=[24,11];break;case 7:Ze=[20,11];break;case 8:Ze=[32,11];break;case 9:Ze=[80,33];break;case 10:Ze=[18,11];break;case 11:Ze=[15,11];break;case 12:Ze=[64,33];break;case 13:Ze=[160,99];break;case 14:Ze=[4,3];break;case 15:Ze=[3,2];break;case 16:Ze=[2,1];break;case 255:{Ze=[ce()<<8|ce(),ce()<<8|ce()];break}}}return{width:Math.ceil((q+1)*16-M*2-C*2),height:(2-re)*(ne+1)*16-(re?2:4)*(Y+H),pixelRatio:Ze}},K.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},j}(),de=ie,_e=function(){function j(B,M,C,Y){this.decryptdata=C,this.discardEPB=Y,this.decrypter=new h.default(B,M,{removePKCS7Padding:!1})}var K=j.prototype;return K.decryptBuffer=function(M,C){this.decrypter.decrypt(M,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,C)},K.decryptAacSample=function(M,C,Y,H){var z=M[C].unit,V=z.subarray(16,z.length-z.length%16),q=V.buffer.slice(V.byteOffset,V.byteOffset+V.length),ne=this;this.decryptBuffer(q,function(re){re=new Uint8Array(re),z.set(re,16),H||ne.decryptAacSamples(M,C+1,Y)})},K.decryptAacSamples=function(M,C,Y){for(;;C++){if(C>=M.length){Y();return}if(!(M[C].unit.length<32)){var H=this.decrypter.isSync();if(this.decryptAacSample(M,C,Y,H),!H)return}}},K.getAvcEncryptedData=function(M){for(var C=Math.floor((M.length-48)/160)*16+16,Y=new Int8Array(C),H=0,z=32;z<=M.length-16;z+=160,H+=16)Y.set(M.subarray(z,z+16),H);return Y},K.getAvcDecryptedUnit=function(M,C){C=new Uint8Array(C);for(var Y=0,H=32;H<=M.length-16;H+=160,Y+=16)M.set(C.subarray(Y,Y+16),H);return M},K.decryptAvcSample=function(M,C,Y,H,z,V){var q=this.discardEPB(z.data),ne=this.getAvcEncryptedData(q),re=this;this.decryptBuffer(ne.buffer,function(ee){z.data=re.getAvcDecryptedUnit(q,ee),V||re.decryptAvcSamples(M,C,Y+1,H)})},K.decryptAvcSamples=function(M,C,Y,H){for(;;C++,Y=0){if(C>=M.length){H();return}for(var z=M[C].units;!(Y>=z.length);Y++){var V=z[Y];if(!(V.data.length<=48||V.type!==1&&V.type!==5)){var q=this.decrypter.isSync();if(this.decryptAvcSample(M,C,Y,H,V,q),!q)return}}}},j}(),Ee=_e,Se={video:1,audio:2,id3:3,text:4},le=function(){function j(B,M,C,Y){this.observer=B,this.config=C,this.typeSupported=Y,this.remuxer=M,this.sampleAes=null,this.pmtUnknownTypes={}}var K=j.prototype;return K.setDecryptData=function(M){M!=null&&M.key!=null&&M.method==="SAMPLE-AES"?this.sampleAes=new Ee(this.observer,this.config,M,this.discardEPB):this.sampleAes=null},j.probe=function(M){var C=j._syncOffset(M);return C<0?!1:(C&&d.logger.warn("MPEG2-TS detected but first sync word found @ offset "+C+", junk ahead ?"),!0)},j._syncOffset=function(M){for(var C=Math.min(1e3,M.length-564),Y=0;Y<C;){if(M[Y]===71&&M[Y+188]===71&&M[Y+2*188]===71)return Y;Y++}return-1},j.createTrack=function(M,C){return{container:M==="video"||M==="audio"?"video/mp2t":void 0,type:M,id:Se[M],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:M==="video"?0:void 0,isAAC:M==="audio"?!0:void 0,duration:M==="audio"?C:void 0}},K.resetInitSegment=function(M,C,Y,H){this.pmtParsed=!1,this._pmtId=-1,this.pmtUnknownTypes={},this._avcTrack=j.createTrack("video",H),this._audioTrack=j.createTrack("audio",H),this._id3Track=j.createTrack("id3",H),this._txtTrack=j.createTrack("text",H),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=C,this.videoCodec=Y,this._duration=H},K.resetTimeStamp=function(){},K.append=function(M,C,Y,H){var z,V=M.length,q,ne,re,ee,se,ce=!1;this.pmtUnknownTypes={},this.contiguous=Y;var me=this.pmtParsed,ue=this._avcTrack,ke=this._audioTrack,Re=this._id3Track,Ye=ue.pid,oe=ke.pid,Le=Re.pid,$e=this._pmtId,Xe=ue.pesData,Ze=ke.pesData,ot=Re.pesData,ut=this._parsePAT,Lt=this._parsePMT.bind(this),bt=this._parsePES,ht=this._parseAVCPES.bind(this),Ot=this._parseAACPES.bind(this),wt=this._parseMPEGPES.bind(this),Ft=this._parseID3PES.bind(this),St=j._syncOffset(M);for(V-=(V+St)%188,z=St;z<V;z+=188)if(M[z]===71){if(q=!!(M[z+1]&64),ne=((M[z+1]&31)<<8)+M[z+2],re=(M[z+3]&48)>>4,re>1){if(ee=z+5+M[z+4],ee===z+188)continue}else ee=z+4;switch(ne){case Ye:q&&(Xe&&(se=bt(Xe))&&ht(se,!1),Xe={data:[],size:0}),Xe&&(Xe.data.push(M.subarray(ee,z+188)),Xe.size+=z+188-ee);break;case oe:q&&(Ze&&(se=bt(Ze))&&(ke.isAAC?Ot(se):wt(se)),Ze={data:[],size:0}),Ze&&(Ze.data.push(M.subarray(ee,z+188)),Ze.size+=z+188-ee);break;case Le:q&&(ot&&(se=bt(ot))&&Ft(se),ot={data:[],size:0}),ot&&(ot.data.push(M.subarray(ee,z+188)),ot.size+=z+188-ee);break;case 0:q&&(ee+=M[ee]+1),$e=this._pmtId=ut(M,ee);break;case $e:q&&(ee+=M[ee]+1);var lt=Lt(M,ee,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,this.sampleAes!=null);Ye=lt.avc,Ye>0&&(ue.pid=Ye),oe=lt.audio,oe>0&&(ke.pid=oe,ke.isAAC=lt.isAAC),Le=lt.id3,Le>0&&(Re.pid=Le),ce&&!me&&(d.logger.log("reparse from beginning"),ce=!1,z=St-188),me=this.pmtParsed=!0;break;case 17:case 8191:break;default:ce=!0;break}}else this.observer.trigger(c.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});Xe&&(se=bt(Xe))?(ht(se,!0),ue.pesData=null):ue.pesData=Xe,Ze&&(se=bt(Ze))?(ke.isAAC?Ot(se):wt(se),ke.pesData=null):(Ze&&Ze.size&&d.logger.log("last AAC PES packet truncated,might overlap between fragments"),ke.pesData=Ze),ot&&(se=bt(ot))?(Ft(se),Re.pesData=null):Re.pesData=ot,this.sampleAes==null?this.remuxer.remux(ke,ue,Re,this._txtTrack,C,Y,H):this.decryptAndRemux(ke,ue,Re,this._txtTrack,C,Y,H)},K.decryptAndRemux=function(M,C,Y,H,z,V,q){if(M.samples&&M.isAAC){var ne=this;this.sampleAes.decryptAacSamples(M.samples,0,function(){ne.decryptAndRemuxAvc(M,C,Y,H,z,V,q)})}else this.decryptAndRemuxAvc(M,C,Y,H,z,V,q)},K.decryptAndRemuxAvc=function(M,C,Y,H,z,V,q){if(C.samples){var ne=this;this.sampleAes.decryptAvcSamples(C.samples,0,0,function(){ne.remuxer.remux(M,C,Y,H,z,V,q)})}else this.remuxer.remux(M,C,Y,H,z,V,q)},K.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},K._parsePAT=function(M,C){return(M[C+10]&31)<<8|M[C+11]},K._trackUnknownPmt=function(M,C,Y){var H=this.pmtUnknownTypes[M]||0;return H===0&&(this.pmtUnknownTypes[M]=0,C.call(d.logger,Y)),this.pmtUnknownTypes[M]++,H},K._parsePMT=function(M,C,Y,H){var z,V,q,ne,re={audio:-1,avc:-1,id3:-1,isAAC:!0};for(z=(M[C+1]&15)<<8|M[C+2],V=C+3+z-4,q=(M[C+10]&15)<<8|M[C+11],C+=12+q;C<V;){switch(ne=(M[C+1]&31)<<8|M[C+2],M[C]){case 207:if(!H){this._trackUnknownPmt(M[C],d.logger.warn,"ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:re.audio===-1&&(re.audio=ne);break;case 21:re.id3===-1&&(re.id3=ne);break;case 219:if(!H){this._trackUnknownPmt(M[C],d.logger.warn,"H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:re.avc===-1&&(re.avc=ne);break;case 3:case 4:Y?re.audio===-1&&(re.audio=ne,re.isAAC=!1):this._trackUnknownPmt(M[C],d.logger.warn,"MPEG audio found, not supported in this browser");break;case 36:this._trackUnknownPmt(M[C],d.logger.warn,"Unsupported HEVC stream type found");break;default:this._trackUnknownPmt(M[C],d.logger.log,"Unknown stream type:"+M[C]);break}C+=((M[C+3]&15)<<8|M[C+4])+5}return re},K._parsePES=function(M){var C=0,Y,H,z,V,q,ne,re,ee,se,ce=M.data;if(!M||M.size===0)return null;for(;ce[0].length<19&&ce.length>1;){var me=new Uint8Array(ce[0].length+ce[1].length);me.set(ce[0]),me.set(ce[1],ce[0].length),ce[0]=me,ce.splice(1,1)}if(Y=ce[0],z=(Y[0]<<16)+(Y[1]<<8)+Y[2],z===1){if(V=(Y[4]<<8)+Y[5],V&&V>M.size-6||(H=Y[7],H&192&&(re=(Y[9]&14)*536870912+(Y[10]&255)*4194304+(Y[11]&254)*16384+(Y[12]&255)*128+(Y[13]&254)/2,H&64?(ee=(Y[14]&14)*536870912+(Y[15]&255)*4194304+(Y[16]&254)*16384+(Y[17]&255)*128+(Y[18]&254)/2,re-ee>60*9e4&&(d.logger.warn(Math.round((re-ee)/9e4)+"s delta between PTS and DTS, align them"),re=ee)):ee=re),q=Y[8],se=q+9,M.size<=se))return null;M.size-=se,ne=new Uint8Array(M.size);for(var ue=0,ke=ce.length;ue<ke;ue++){Y=ce[ue];var Re=Y.byteLength;if(se)if(se>Re){se-=Re;continue}else Y=Y.subarray(se),Re-=se,se=0;ne.set(Y,C),C+=Re}return V&&(V-=q+3),{data:ne,pts:re,dts:ee,len:V}}else return null},K.pushAccesUnit=function(M,C){if(M.units.length&&M.frame){var Y=C.samples,H=Y.length;if(isNaN(M.pts))if(H){var z=Y[H-1];M.pts=z.pts,M.dts=z.dts}else{C.dropped++;return}!this.config.forceKeyFrameOnDiscontinuity||M.key===!0||C.sps&&(H||this.contiguous)?(M.id=H,Y.push(M)):C.dropped++}M.debug.length&&d.logger.log(M.pts+"/"+M.dts+":"+M.debug)},K._parseAVCPES=function(M,C){var Y=this,H=this._avcTrack,z=this._parseAVCNALu(M.data),V,q=this.avcSample,ne,re=!1,ee,se=this.pushAccesUnit.bind(this),ce=function(ue,ke,Re,Ye){return{key:ue,pts:ke,dts:Re,units:[],debug:Ye}};M.data=null,q&&z.length&&!H.audFound&&(se(q,H),q=this.avcSample=ce(!1,M.pts,M.dts,"")),z.forEach(function(me){switch(me.type){case 1:ne=!0,q||(q=Y.avcSample=ce(!0,M.pts,M.dts,"")),q.frame=!0;var ue=me.data;if(re&&ue.length>4){var ke=new de(ue).readSliceType();(ke===2||ke===4||ke===7||ke===9)&&(q.key=!0)}break;case 5:ne=!0,q||(q=Y.avcSample=ce(!0,M.pts,M.dts,"")),q.key=!0,q.frame=!0;break;case 6:ne=!0,V=new de(Y.discardEPB(me.data)),V.readUByte();for(var Re=0,Ye=0,oe=!1,Le=0;!oe&&V.bytesAvailable>1;){Re=0;do Le=V.readUByte(),Re+=Le;while(Le===255);Ye=0;do Le=V.readUByte(),Ye+=Le;while(Le===255);if(Re===4&&V.bytesAvailable!==0){oe=!0;var $e=V.readUByte();if($e===181){var Xe=V.readUShort();if(Xe===49){var Ze=V.readUInt();if(Ze===1195456820){var ot=V.readUByte();if(ot===3){var ut=V.readUByte(),Lt=V.readUByte(),bt=31&ut,ht=[ut,Lt];for(ee=0;ee<bt;ee++)ht.push(V.readUByte()),ht.push(V.readUByte()),ht.push(V.readUByte());Y._insertSampleInOrder(Y._txtTrack.samples,{type:3,pts:M.pts,bytes:ht})}}}}}else if(Re===5&&V.bytesAvailable!==0){if(oe=!0,Ye>16){var Ot=[];for(ee=0;ee<16;ee++)Ot.push(V.readUByte().toString(16)),(ee===3||ee===5||ee===7||ee===9)&&Ot.push("-");var wt=Ye-16,Ft=new Uint8Array(wt);for(ee=0;ee<wt;ee++)Ft[ee]=V.readUByte();Y._insertSampleInOrder(Y._txtTrack.samples,{pts:M.pts,payloadType:Re,uuid:Ot.join(""),userDataBytes:Ft,userData:Object(P.utf8ArrayToStr)(Ft.buffer)})}}else if(Ye<V.bytesAvailable)for(ee=0;ee<Ye;ee++)V.readUByte()}break;case 7:if(ne=!0,re=!0,!H.sps){V=new de(me.data);var St=V.readSPS();H.width=St.width,H.height=St.height,H.pixelRatio=St.pixelRatio,H.sps=[me.data],H.duration=Y._duration;var lt=me.data.subarray(1,4),rr="avc1.";for(ee=0;ee<3;ee++){var Zt=lt[ee].toString(16);Zt.length<2&&(Zt="0"+Zt),rr+=Zt}H.codec=rr}break;case 8:ne=!0,H.pps||(H.pps=[me.data]);break;case 9:ne=!1,H.audFound=!0,q&&se(q,H),q=Y.avcSample=ce(!1,M.pts,M.dts,"");break;case 12:ne=!1;break;default:ne=!1,q&&(q.debug+="unknown NAL "+me.type+" ");break}if(q&&ne){var Ut=q.units;Ut.push(me)}}),C&&q&&(se(q,H),this.avcSample=null)},K._insertSampleInOrder=function(M,C){var Y=M.length;if(Y>0){if(C.pts>=M[Y-1].pts)M.push(C);else for(var H=Y-1;H>=0;H--)if(C.pts<M[H].pts){M.splice(H,0,C);break}}else M.push(C)},K._getLastNalUnit=function(){var M=this.avcSample,C;if(!M||M.units.length===0){var Y=this._avcTrack,H=Y.samples;M=H[H.length-1]}if(M){var z=M.units;C=z[z.length-1]}return C},K._parseAVCNALu=function(M){var C=0,Y=M.byteLength,H,z,V=this._avcTrack,q=V.naluState||0,ne=q,re=[],ee,se,ce=-1,me;for(q===-1&&(ce=0,me=M[0]&31,q=0,C=1);C<Y;){if(H=M[C++],!q){q=H?0:1;continue}if(q===1){q=H?0:2;continue}if(!H)q=3;else if(H===1){if(ce>=0)ee={data:M.subarray(ce,C-q-1),type:me},re.push(ee);else{var ue=this._getLastNalUnit();if(ue&&(ne&&C<=4-ne&&ue.state&&(ue.data=ue.data.subarray(0,ue.data.byteLength-ne)),z=C-q-1,z>0)){var ke=new Uint8Array(ue.data.byteLength+z);ke.set(ue.data,0),ke.set(M.subarray(0,z),ue.data.byteLength),ue.data=ke}}C<Y?(se=M[C]&31,ce=C,me=se,q=0):q=-1}else q=0}if(ce>=0&&q>=0&&(ee={data:M.subarray(ce,Y),type:me,state:q},re.push(ee)),re.length===0){var Re=this._getLastNalUnit();if(Re){var Ye=new Uint8Array(Re.data.byteLength+M.byteLength);Ye.set(Re.data,0),Ye.set(M,Re.data.byteLength),Re.data=Ye}}return V.naluState=q,re},K.discardEPB=function(M){for(var C=M.byteLength,Y=[],H=1,z,V;H<C-2;)M[H]===0&&M[H+1]===0&&M[H+2]===3?(Y.push(H+2),H+=2):H++;if(Y.length===0)return M;z=C-Y.length,V=new Uint8Array(z);var q=0;for(H=0;H<z;q++,H++)q===Y[0]&&(q++,Y.shift()),V[H]=M[q];return V},K._parseAACPES=function(M){var C=this._audioTrack,Y=M.data,H=M.pts,z=0,V=this.aacOverFlow,q=this.aacLastPTS,ne,re,ee,se,ce;if(V){var me=new Uint8Array(V.byteLength+Y.byteLength);me.set(V,0),me.set(Y,V.byteLength),Y=me}for(ee=z,ce=Y.length;ee<ce-1&&!b(Y,ee);ee++);if(ee){var ue,ke;if(ee<ce-1?(ue="AAC PES did not start with ADTS header,offset:"+ee,ke=!1):(ue="no ADTS header found in AAC PES",ke=!0),d.logger.warn("parsing error:"+ue),this.observer.trigger(c.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:ke,reason:ue}),ke)return}if(A(C,this.observer,Y,ee,this.audioCodec),re=0,ne=k(C.samplerate),V&&q){var Re=q+ne;Math.abs(Re-H)>1&&(d.logger.log("AAC: align PTS for overlapping frames by "+Math.round((Re-H)/90)),H=Re)}for(;ee<ce;)if(b(Y,ee)){if(ee+5<ce){var Ye=N(C,Y,ee,H,re);if(Ye){ee+=Ye.length,se=Ye.sample.pts,re++;continue}}break}else ee++;ee<ce?V=Y.subarray(ee,ce):V=null,this.aacOverFlow=V,this.aacLastPTS=se},K._parseMPEGPES=function(M){for(var C=M.data,Y=C.length,H=0,z=0,V=M.pts;z<Y;)if(Z.isHeader(C,z)){var q=Z.appendFrame(this._audioTrack,C,z,V,H);if(q)z+=q.length,H++;else break}else z++},K._parseID3PES=function(M){this._id3Track.samples.push(M)},j}(),pe=le,he=function(){function j(B,M,C){this.observer=B,this.config=C,this.remuxer=M}var K=j.prototype;return K.resetInitSegment=function(M,C,Y,H){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:C,duration:H,inputTimeScale:9e4}},K.resetTimeStamp=function(){},j.probe=function(M){var C,Y,H=P.default.getID3Data(M,0);if(H&&P.default.getTimeStamp(H)!==void 0){for(C=H.length,Y=Math.min(M.length-1,C+100);C<Y;C++)if(Z.probe(M,C))return d.logger.log("MPEG Audio sync word found !"),!0}return!1},K.append=function(M,C,Y,H){for(var z=P.default.getID3Data(M,0)||[],V=P.default.getTimeStamp(z),q=V!==void 0?90*V:C*9e4,ne=z.length,re=M.length,ee=0,se=0,ce=this._audioTrack,me=[{pts:q,dts:q,data:z}];ne<re;)if(Z.isHeader(M,ne)){var ue=Z.appendFrame(ce,M,ne,q,ee);if(ue)ne+=ue.length,se=ue.sample.pts,ee++;else break}else P.default.isHeader(M,ne)?(z=P.default.getID3Data(M,ne),me.push({pts:se,dts:se,data:z}),ne+=z.length):ne++;this.remuxer.remux(ce,{samples:[]},{samples:me,inputTimeScale:9e4},{samples:[]},C,Y,H)},K.destroy=function(){},j}(),Te=he,xe=function(){function j(){}return j.getSilentFrame=function(B,M){switch(B){case"mp4a.40.2":if(M===1)return new Uint8Array([0,200,0,128,35,128]);if(M===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(M===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(M===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(M===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(M===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(M===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(M===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(M===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}return null},j}(),ye=xe,ge=Math.pow(2,32)-1,be=function(){function j(){}return j.init=function(){j.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var B;for(B in j.types)j.types.hasOwnProperty(B)&&(j.types[B]=[B.charCodeAt(0),B.charCodeAt(1),B.charCodeAt(2),B.charCodeAt(3)]);var M=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),C=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);j.HDLR_TYPES={video:M,audio:C};var Y=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),H=new Uint8Array([0,0,0,0,0,0,0,0]);j.STTS=j.STSC=j.STCO=H,j.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),j.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),j.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),j.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var z=new Uint8Array([105,115,111,109]),V=new Uint8Array([97,118,99,49]),q=new Uint8Array([0,0,0,1]);j.FTYP=j.box(j.types.ftyp,z,q,z,V),j.DINF=j.box(j.types.dinf,j.box(j.types.dref,Y))},j.box=function(B){for(var M=Array.prototype.slice.call(arguments,1),C=8,Y=M.length,H=Y,z;Y--;)C+=M[Y].byteLength;for(z=new Uint8Array(C),z[0]=C>>24&255,z[1]=C>>16&255,z[2]=C>>8&255,z[3]=C&255,z.set(B,4),Y=0,C=8;Y<H;Y++)z.set(M[Y],C),C+=M[Y].byteLength;return z},j.hdlr=function(B){return j.box(j.types.hdlr,j.HDLR_TYPES[B])},j.mdat=function(B){return j.box(j.types.mdat,B)},j.mdhd=function(B,M){M*=B;var C=Math.floor(M/(ge+1)),Y=Math.floor(M%(ge+1));return j.box(j.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,B>>24&255,B>>16&255,B>>8&255,B&255,C>>24,C>>16&255,C>>8&255,C&255,Y>>24,Y>>16&255,Y>>8&255,Y&255,85,196,0,0]))},j.mdia=function(B){return j.box(j.types.mdia,j.mdhd(B.timescale,B.duration),j.hdlr(B.type),j.minf(B))},j.mfhd=function(B){return j.box(j.types.mfhd,new Uint8Array([0,0,0,0,B>>24,B>>16&255,B>>8&255,B&255]))},j.minf=function(B){return B.type==="audio"?j.box(j.types.minf,j.box(j.types.smhd,j.SMHD),j.DINF,j.stbl(B)):j.box(j.types.minf,j.box(j.types.vmhd,j.VMHD),j.DINF,j.stbl(B))},j.moof=function(B,M,C){return j.box(j.types.moof,j.mfhd(B),j.traf(C,M))},j.moov=function(B){for(var M=B.length,C=[];M--;)C[M]=j.trak(B[M]);return j.box.apply(null,[j.types.moov,j.mvhd(B[0].timescale,B[0].duration)].concat(C).concat(j.mvex(B)))},j.mvex=function(B){for(var M=B.length,C=[];M--;)C[M]=j.trex(B[M]);return j.box.apply(null,[j.types.mvex].concat(C))},j.mvhd=function(B,M){M*=B;var C=Math.floor(M/(ge+1)),Y=Math.floor(M%(ge+1)),H=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,B>>24&255,B>>16&255,B>>8&255,B&255,C>>24,C>>16&255,C>>8&255,C&255,Y>>24,Y>>16&255,Y>>8&255,Y&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return j.box(j.types.mvhd,H)},j.sdtp=function(B){var M=B.samples||[],C=new Uint8Array(4+M.length),Y,H;for(H=0;H<M.length;H++)Y=M[H].flags,C[H+4]=Y.dependsOn<<4|Y.isDependedOn<<2|Y.hasRedundancy;return j.box(j.types.sdtp,C)},j.stbl=function(B){return j.box(j.types.stbl,j.stsd(B),j.box(j.types.stts,j.STTS),j.box(j.types.stsc,j.STSC),j.box(j.types.stsz,j.STSZ),j.box(j.types.stco,j.STCO))},j.avc1=function(B){var M=[],C=[],Y,H,z;for(Y=0;Y<B.sps.length;Y++)H=B.sps[Y],z=H.byteLength,M.push(z>>>8&255),M.push(z&255),M=M.concat(Array.prototype.slice.call(H));for(Y=0;Y<B.pps.length;Y++)H=B.pps[Y],z=H.byteLength,C.push(z>>>8&255),C.push(z&255),C=C.concat(Array.prototype.slice.call(H));var V=j.box(j.types.avcC,new Uint8Array([1,M[3],M[4],M[5],255,224|B.sps.length].concat(M).concat([B.pps.length]).concat(C))),q=B.width,ne=B.height,re=B.pixelRatio[0],ee=B.pixelRatio[1];return j.box(j.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,q>>8&255,q&255,ne>>8&255,ne&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),V,j.box(j.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),j.box(j.types.pasp,new Uint8Array([re>>24,re>>16&255,re>>8&255,re&255,ee>>24,ee>>16&255,ee>>8&255,ee&255])))},j.esds=function(B){var M=B.config.length;return new Uint8Array([0,0,0,0,3,23+M,0,1,0,4,15+M,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([M]).concat(B.config).concat([6,1,2]))},j.mp4a=function(B){var M=B.samplerate;return j.box(j.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,B.channelCount,0,16,0,0,0,0,M>>8&255,M&255,0,0]),j.box(j.types.esds,j.esds(B)))},j.mp3=function(B){var M=B.samplerate;return j.box(j.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,B.channelCount,0,16,0,0,0,0,M>>8&255,M&255,0,0]))},j.stsd=function(B){return B.type==="audio"?!B.isAAC&&B.codec==="mp3"?j.box(j.types.stsd,j.STSD,j.mp3(B)):j.box(j.types.stsd,j.STSD,j.mp4a(B)):j.box(j.types.stsd,j.STSD,j.avc1(B))},j.tkhd=function(B){var M=B.id,C=B.duration*B.timescale,Y=B.width,H=B.height,z=Math.floor(C/(ge+1)),V=Math.floor(C%(ge+1));return j.box(j.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,M>>24&255,M>>16&255,M>>8&255,M&255,0,0,0,0,z>>24,z>>16&255,z>>8&255,z&255,V>>24,V>>16&255,V>>8&255,V&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,Y>>8&255,Y&255,0,0,H>>8&255,H&255,0,0]))},j.traf=function(B,M){var C=j.sdtp(B),Y=B.id,H=Math.floor(M/(ge+1)),z=Math.floor(M%(ge+1));return j.box(j.types.traf,j.box(j.types.tfhd,new Uint8Array([0,0,0,0,Y>>24,Y>>16&255,Y>>8&255,Y&255])),j.box(j.types.tfdt,new Uint8Array([1,0,0,0,H>>24,H>>16&255,H>>8&255,H&255,z>>24,z>>16&255,z>>8&255,z&255])),j.trun(B,C.length+16+20+8+16+8+8),C)},j.trak=function(B){return B.duration=B.duration||4294967295,j.box(j.types.trak,j.tkhd(B),j.mdia(B))},j.trex=function(B){var M=B.id;return j.box(j.types.trex,new Uint8Array([0,0,0,0,M>>24,M>>16&255,M>>8&255,M&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},j.trun=function(B,M){var C=B.samples||[],Y=C.length,H=12+16*Y,z=new Uint8Array(H),V,q,ne,re,ee,se;for(M+=8+H,z.set([0,0,15,1,Y>>>24&255,Y>>>16&255,Y>>>8&255,Y&255,M>>>24&255,M>>>16&255,M>>>8&255,M&255],0),V=0;V<Y;V++)q=C[V],ne=q.duration,re=q.size,ee=q.flags,se=q.cts,z.set([ne>>>24&255,ne>>>16&255,ne>>>8&255,ne&255,re>>>24&255,re>>>16&255,re>>>8&255,re&255,ee.isLeading<<2|ee.dependsOn,ee.isDependedOn<<6|ee.hasRedundancy<<4|ee.paddingValue<<1|ee.isNonSync,ee.degradPrio&61440,ee.degradPrio&15,se>>>24&255,se>>>16&255,se>>>8&255,se&255],12+16*V);return j.box(j.types.trun,z)},j.initSegment=function(B){j.types||j.init();var M=j.moov(B),C;return C=new Uint8Array(j.FTYP.byteLength+M.byteLength),C.set(j.FTYP),C.set(M,j.FTYP.byteLength),C},j}(),fe=be,Ue=9e4;function Ce(j,K,B,M){B===void 0&&(B=1),M===void 0&&(M=!1);var C=j*K*B;return M?Math.round(C):C}function ae(j,K){return K===void 0&&(K=!1),Ce(j,1e3,1/Ue,K)}function we(j,K){return K===void 0&&(K=1),Ce(j,Ue,1/K)}var Ae=we(10),Oe=we(.2),Fe=null,Ne=function(){function j(B,M,C,Y){if(this.observer=B,this.config=M,this.typeSupported=C,this.ISGenerated=!1,Fe===null){var H=navigator.userAgent.match(/Chrome\/(\d+)/i);Fe=H?parseInt(H[1]):0}}var K=j.prototype;return K.destroy=function(){},K.resetTimeStamp=function(M){this._initPTS=this._initDTS=M},K.resetInitSegment=function(){this.ISGenerated=!1},K.getVideoStartPts=function(M){var C=!1,Y=M.reduce(function(H,z){var V=z.pts-H;return V<-4294967296?(C=!0,Be(H,z.pts)):V>0?H:z.pts},M[0].pts);return C&&d.logger.debug("PTS rollover detected"),Y},K.remux=function(M,C,Y,H,z,V,q){if(this.ISGenerated||this.generateIS(M,C,z),this.ISGenerated){var ne=M.samples.length,re=C.samples.length,ee=z,se=z;if(ne&&re){var ce=this.getVideoStartPts(C.samples),me=Be(M.samples[0].pts,ce)-ce,ue=me/C.inputTimeScale;ee+=Math.max(0,ue),se+=Math.max(0,-ue)}if(ne){M.timescale||(d.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(M,C,z));var ke=this.remuxAudio(M,ee,V,q);if(re){var Re;ke&&(Re=ke.endPTS-ke.startPTS),C.timescale||(d.logger.warn("regenerate InitSegment as video detected"),this.generateIS(M,C,z)),this.remuxVideo(C,se,V,Re)}}else if(re){var Ye=this.remuxVideo(C,se,V,0,q);Ye&&M.codec&&this.remuxEmptyAudio(M,ee,V,Ye)}}Y.samples.length&&this.remuxID3(Y,z),H.samples.length&&this.remuxText(H,z),this.observer.trigger(c.default.FRAG_PARSED)},K.generateIS=function(M,C,Y){var H=this.observer,z=M.samples,V=C.samples,q=this.typeSupported,ne="audio/mp4",re={},ee={tracks:re},se=this._initPTS===void 0,ce,me;if(se&&(ce=me=1/0),M.config&&z.length&&(M.timescale=M.samplerate,d.logger.log("audio sampling rate : "+M.samplerate),M.isAAC||(q.mpeg?(ne="audio/mpeg",M.codec=""):q.mp3&&(M.codec="mp3")),re.audio={container:ne,codec:M.codec,initSegment:!M.isAAC&&q.mpeg?new Uint8Array:fe.initSegment([M]),metadata:{channelCount:M.channelCount}},se&&(ce=me=z[0].pts-Math.round(M.inputTimeScale*Y))),C.sps&&C.pps&&V.length){var ue=C.inputTimeScale;if(C.timescale=ue,re.video={container:"video/mp4",codec:C.codec,initSegment:fe.initSegment([C]),metadata:{width:C.width,height:C.height}},se){var ke=this.getVideoStartPts(V),Re=Math.round(ue*Y);me=Math.min(me,Be(V[0].dts,ke)-Re),ce=Math.min(ce,ke-Re),this.observer.trigger(c.default.INIT_PTS_FOUND,{initPTS:ce})}}else se&&re.audio&&this.observer.trigger(c.default.INIT_PTS_FOUND,{initPTS:ce});Object.keys(re).length?(H.trigger(c.default.FRAG_PARSING_INIT_SEGMENT,ee),this.ISGenerated=!0,se&&(this._initPTS=ce,this._initDTS=me)):H.trigger(c.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},K.remuxVideo=function(M,C,Y,H){var z=M.timescale,V=M.samples,q=[],ne=V.length,re=this._initPTS,ee=8,se,ce,me,ue,ke,Re=Number.POSITIVE_INFINITY,Ye=Number.NEGATIVE_INFINITY,oe=0,Le=!1,$e=this.nextAvcDts;if(ne!==0){if(!Y){var Xe=C*z,Ze=V[0].pts-Be(V[0].dts,V[0].pts);$e=Xe-Ze}for(var ot=0;ot<ne;ot++){var ut=V[ot];ut.pts=Be(ut.pts-re,$e),ut.dts=Be(ut.dts-re,$e),ut.dts>ut.pts&&(oe=Math.max(Math.min(oe,ut.pts-ut.dts),-1*Oe)),ut.dts<V[ot>0?ot-1:ot].dts&&(Le=!0)}Le&&V.sort(function(Xr,hn){var ci=Xr.dts-hn.dts,di=Xr.pts-hn.pts;return ci||di||Xr.id-hn.id}),ue=V[0].dts,ke=V[ne-1].dts;var Lt=Math.round((ke-ue)/(ne-1));if(oe<0){if(oe<Lt*-2){d.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+ae(-Lt,!0)+" ms");for(var bt=oe,ht=0;ht<ne;ht++)V[ht].dts=bt=Math.max(bt,V[ht].pts-Lt),V[ht].pts=Math.max(bt,V[ht].pts)}else{d.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+ae(oe,!0)+" ms to overcome this issue");for(var Ot=0;Ot<ne;Ot++)V[Ot].dts=V[Ot].dts+oe}ue=V[0].dts,ke=V[ne-1].dts}if(Y){var wt=ue-$e,Ft=wt>Lt,St=wt<-1;if(Ft||St){Ft?d.logger.warn("AVC: "+ae(wt,!0)+" ms ("+wt+"dts) hole between fragments detected, filling it"):d.logger.warn("AVC: "+ae(-wt,!0)+" ms ("+wt+"dts) overlapping between fragments detected"),ue=$e;var lt=V[0].pts-wt;V[0].dts=ue,V[0].pts=lt,d.logger.log("Video: First PTS/DTS adjusted: "+ae(lt,!0)+"/"+ae(ue,!0)+", delta: "+ae(wt,!0)+" ms")}}Fe&&Fe<75&&(ue=Math.max(0,ue));for(var rr=0,Zt=0,Ut=0;Ut<ne;Ut++){for(var kt=V[Ut],Qt=kt.units,it=Qt.length,Ge=0,st=0;st<it;st++)Ge+=Qt[st].data.length;Zt+=Ge,rr+=it,kt.length=Ge,kt.dts=Math.max(kt.dts,ue),kt.pts=Math.max(kt.pts,kt.dts,0),Re=Math.min(kt.pts,Re),Ye=Math.max(kt.pts,Ye)}ke=V[ne-1].dts;var ct=Zt+4*rr+8;try{ce=new Uint8Array(ct)}catch{this.observer.trigger(c.default.ERROR,{type:o.ErrorTypes.MUX_ERROR,details:o.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:ct,reason:"fail allocating video mdat "+ct});return}var gt=new DataView(ce.buffer);gt.setUint32(0,ct),ce.set(fe.types.mdat,4);for(var te=0;te<ne;te++){for(var vt=V[te],Ht=vt.units,qt=0,Vt=void 0,ur=0,br=Ht.length;ur<br;ur++){var Kr=Ht[ur],li=Kr.data,dn=Kr.data.byteLength;gt.setUint32(ee,dn),ee+=4,ce.set(li,ee),ee+=dn,qt+=4+dn}if(te<ne-1)se=V[te+1].dts-vt.dts;else{var Cn=this.config,Ir=vt.dts-V[te>0?te-1:te].dts;if(Cn.stretchShortVideoTrack){var ui=Cn.maxBufferHole,fn=Math.floor(ui*z),Wr=(H?Re+H*z:this.nextAudioPts)-vt.pts;Wr>fn?(se=Wr-Ir,se<0&&(se=Ir),d.logger.log("It is approximately "+ae(Wr,!1)+" ms to the next segment; using duration "+ae(se,!1)+" ms for the last video frame.")):se=Ir}else se=Ir}Vt=Math.round(vt.pts-vt.dts),q.push({size:qt,duration:se,cts:Vt,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:vt.key?2:1,isNonSync:vt.key?0:1}})}this.nextAvcDts=ke+se;var Pr=M.dropped;if(M.nbNalu=0,M.dropped=0,q.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var In=q[0].flags;In.dependsOn=2,In.isNonSync=0}M.samples=q,me=fe.moof(M.sequenceNumber++,ue,M),M.samples=[];var Pn={data1:me,data2:ce,startPTS:Re/z,endPTS:(Ye+se)/z,startDTS:ue/z,endDTS:this.nextAvcDts/z,type:"video",hasAudio:!1,hasVideo:!0,nb:q.length,dropped:Pr};return this.observer.trigger(c.default.FRAG_PARSING_DATA,Pn),Pn}},K.remuxAudio=function(M,C,Y,H){var z=M.inputTimeScale,V=M.timescale,q=z/V,ne=M.isAAC?1024:1152,re=ne*q,ee=this._initPTS,se=!M.isAAC&&this.typeSupported.mpeg,ce,me,ue,ke,Re,Ye,oe=se?0:8,Le=M.samples,$e=[],Xe=this.nextAudioPts;if(Y|=Le.length&&Xe&&(H&&Math.abs(C-Xe/z)<.1||Math.abs(Le[0].pts-Xe-ee)<20*re),Le.forEach(function(Vt){Vt.pts=Vt.dts=Be(Vt.pts-ee,C*z)}),Le=Le.filter(function(Vt){return Vt.pts>=0}),Le.length!==0){if(Y||(H?Xe=Math.max(0,C*z):Xe=Le[0].pts),M.isAAC)for(var Ze=this.config.maxAudioFramesDrift,ot=0,ut=Xe;ot<Le.length;){var Lt=Le[ot],bt=Lt.pts,ht=bt-ut;if(ht<=-Ze*re)Y||ot>0?(d.logger.warn("Dropping 1 audio frame @ "+ae(ut,!0)/1e3+"s due to "+ae(ht,!0)+" ms overlap."),Le.splice(ot,1)):(d.logger.warn("Audio frame @ "+ae(bt,!0)/1e3+"s overlaps nextAudioPts by "+ae(ht,!0)+" ms."),ut=bt+re,ot++);else if(ht>=Ze*re&&ht<Ae&&ut){var Ot=Math.round(ht/re);d.logger.warn("Injecting "+Ot+" audio frames @ "+ae(ut,!0)/1e3+"s due to "+ae(ht,!0)+" ms gap.");for(var wt=0;wt<Ot;wt++){var Ft=Math.max(ut,0);me=ye.getSilentFrame(M.manifestCodec||M.codec,M.channelCount),me||(d.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),me=Lt.unit.subarray()),Le.splice(ot,0,{unit:me,pts:Ft,dts:Ft}),ut+=re,ot++}Lt.pts=Lt.dts=ut,ut+=re,ot++}else Lt.pts=Lt.dts=ut,ut+=re,ot++}for(var St=Le.length,lt=0;St--;)lt+=Le[St].unit.byteLength;for(var rr=0,Zt=Le.length;rr<Zt;rr++){var Ut=Le[rr],kt=Ut.unit,Qt=Ut.pts;if(Ye!==void 0&&ce)ce.duration=Math.round((Qt-Ye)/q);else{var it=Qt-Xe,Ge=0;if(Y&&M.isAAC&&it){if(it>0&&it<Ae)Ge=Math.round((Qt-Xe)/re),d.logger.log(ae(it,!0)+" ms hole between AAC samples detected,filling it"),Ge>0&&(me=ye.getSilentFrame(M.manifestCodec||M.codec,M.channelCount),me||(me=kt.subarray()),lt+=Ge*me.length);else if(it<-12){d.logger.log("drop overlapping AAC sample, expected/parsed/delta: "+ae(Xe,!0)+" ms / "+ae(Qt,!0)+" ms / "+ae(-it,!0)+" ms"),lt-=kt.byteLength;continue}Qt=Xe}if(Re=Qt,lt>0){lt+=oe;try{ue=new Uint8Array(lt)}catch{this.observer.trigger(c.default.ERROR,{type:o.ErrorTypes.MUX_ERROR,details:o.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:lt,reason:"fail allocating audio mdat "+lt});return}if(!se){var st=new DataView(ue.buffer);st.setUint32(0,lt),ue.set(fe.types.mdat,4)}}else return;for(var ct=0;ct<Ge;ct++)me=ye.getSilentFrame(M.manifestCodec||M.codec,M.channelCount),me||(d.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),me=kt.subarray()),ue.set(me,oe),oe+=me.byteLength,ce={size:me.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},$e.push(ce)}ue.set(kt,oe);var gt=kt.byteLength;oe+=gt,ce={size:gt,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},$e.push(ce),Ye=Qt}var te=0;if(St=$e.length,St>=2&&(te=$e[St-2].duration,ce.duration=te),St){this.nextAudioPts=Xe=Ye+q*te,M.samples=$e,se?ke=new Uint8Array:ke=fe.moof(M.sequenceNumber++,Re/q,M),M.samples=[];var vt=Re/z,Ht=Xe/z,qt={data1:ke,data2:ue,startPTS:vt,endPTS:Ht,startDTS:vt,endDTS:Ht,type:"audio",hasAudio:!0,hasVideo:!1,nb:St};return this.observer.trigger(c.default.FRAG_PARSING_DATA,qt),qt}return null}},K.remuxEmptyAudio=function(M,C,Y,H){var z=M.inputTimeScale,V=M.samplerate?M.samplerate:z,q=z/V,ne=this.nextAudioPts,re=(ne!==void 0?ne:H.startDTS*z)+this._initDTS,ee=H.endDTS*z+this._initDTS,se=1024,ce=q*se,me=Math.ceil((ee-re)/ce),ue=ye.getSilentFrame(M.manifestCodec||M.codec,M.channelCount);if(d.logger.warn("remux empty Audio"),!ue){d.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");return}for(var ke=[],Re=0;Re<me;Re++){var Ye=re+Re*ce;ke.push({unit:ue,pts:Ye,dts:Ye})}M.samples=ke,this.remuxAudio(M,C,Y)},K.remuxID3=function(M,C){var Y=M.samples.length;if(Y){for(var H=M.inputTimeScale,z=this._initPTS,V=this._initDTS,q=0;q<Y;q++){var ne=M.samples[q];ne.pts=Be(ne.pts-z,C*H)/H,ne.dts=Be(ne.dts-V,C*H)/H}this.observer.trigger(c.default.FRAG_PARSING_METADATA,{samples:M.samples}),M.samples=[]}},K.remuxText=function(M,C){var Y=M.samples.length,H=M.inputTimeScale,z=this._initPTS;if(Y){for(var V=0;V<Y;V++){var q=M.samples[V];q.pts=Be(q.pts-z,C*H)/H}M.samples.sort(function(ne,re){return ne.pts-re.pts}),this.observer.trigger(c.default.FRAG_PARSING_USERDATA,{samples:M.samples})}M.samples=[]},j}();function Be(j,K){var B;if(K===void 0)return j;for(K<j?B=-8589934592:B=8589934592;Math.abs(j-K)>4294967296;)j+=B;return j}var qe=Ne,Ie=function(){function j(B){this.observer=B}var K=j.prototype;return K.destroy=function(){},K.resetTimeStamp=function(){},K.resetInitSegment=function(){},K.remux=function(M,C,Y,H,z,V,q,ne){var re=this.observer,ee="";M&&(ee+="audio"),C&&(ee+="video"),re.trigger(c.default.FRAG_PARSING_DATA,{data1:ne,startPTS:z,startDTS:z,type:ee,hasAudio:!!M,hasVideo:!!C,nb:1,dropped:0}),re.trigger(c.default.FRAG_PARSED)},j}(),Je=Ie,We=Object(p.getSelfScope)(),nt;try{nt=We.performance.now.bind(We.performance)}catch{d.logger.debug("Unable to use Performance API on this environment"),nt=We.Date.now}var ft=function(){function j(B,M,C,Y){this.observer=B,this.typeSupported=M,this.config=C,this.vendor=Y}var K=j.prototype;return K.destroy=function(){var M=this.demuxer;M&&M.destroy()},K.push=function(M,C,Y,H,z,V,q,ne,re,ee,se,ce){var me=this;if(M.byteLength>0&&C!=null&&C.key!=null&&C.method==="AES-128"){var ue=this.decrypter;ue==null&&(ue=this.decrypter=new h.default(this.observer,this.config));var ke=nt();ue.decrypt(M,C.key.buffer,C.iv.buffer,function(Re){var Ye=nt();me.observer.trigger(c.default.FRAG_DECRYPTED,{stats:{tstart:ke,tdecrypt:Ye}}),me.pushDecrypted(new Uint8Array(Re),C,new Uint8Array(Y),H,z,V,q,ne,re,ee,se,ce)})}else this.pushDecrypted(new Uint8Array(M),C,new Uint8Array(Y),H,z,V,q,ne,re,ee,se,ce)},K.pushDecrypted=function(M,C,Y,H,z,V,q,ne,re,ee,se,ce){var me=this.demuxer,ue=this.remuxer;if(!me||q||ne){for(var ke=this.observer,Re=this.typeSupported,Ye=this.config,oe=[{demux:pe,remux:qe},{demux:J.default,remux:Je},{demux:$,remux:qe},{demux:Te,remux:qe}],Le,$e=0,Xe=oe.length;$e<Xe&&(Le=oe[$e],!Le.demux.probe(M));$e++);if(!Le){ke.trigger(c.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});return}(!ue||!(ue instanceof Le.remux))&&(ue=new Le.remux(ke,Ye,Re,this.vendor)),(!me||!(me instanceof Le.demux))&&(me=new Le.demux(ke,ue,Ye,Re),this.probe=Le.demux.probe),this.demuxer=me,this.remuxer=ue}(q||ne)&&(me.resetInitSegment(Y,H,z,ee),ue.resetInitSegment()),q&&(me.resetTimeStamp(ce),ue.resetTimeStamp(ce)),typeof me.setDecryptData=="function"&&me.setDecryptData(C),me.append(M,V,re,se)},j}();s.default=ft},"./src/demux/demuxer-worker.js":function(i,s,l){l.r(s);var c=l("./src/demux/demuxer-inline.js"),o=l("./src/events.js"),h=l("./src/utils/logger.js"),g=l("./node_modules/eventemitter3/index.js"),d=function(w){var _=new g.EventEmitter;_.trigger=function(b){for(var L=arguments.length,A=new Array(L>1?L-1:0),k=1;k<L;k++)A[k-1]=arguments[k];_.emit.apply(_,[b,b].concat(A))},_.off=function(b){for(var L=arguments.length,A=new Array(L>1?L-1:0),k=1;k<L;k++)A[k-1]=arguments[k];_.removeListener.apply(_,[b].concat(A))};var S=function(b,L){w.postMessage({event:b,data:L})};w.addEventListener("message",function(E){var b=E.data;switch(b.cmd){case"init":var L=JSON.parse(b.config);w.demuxer=new c.default(_,b.typeSupported,L,b.vendor),Object(h.enableLogs)(L.debug),S("init",null);break;case"demux":w.demuxer.push(b.data,b.decryptdata,b.initSegment,b.audioCodec,b.videoCodec,b.timeOffset,b.discontinuity,b.trackSwitch,b.contiguous,b.duration,b.accurateTimeOffset,b.defaultInitPTS);break}}),_.on(o.default.FRAG_DECRYPTED,S),_.on(o.default.FRAG_PARSING_INIT_SEGMENT,S),_.on(o.default.FRAG_PARSED,S),_.on(o.default.ERROR,S),_.on(o.default.FRAG_PARSING_METADATA,S),_.on(o.default.FRAG_PARSING_USERDATA,S),_.on(o.default.INIT_PTS_FOUND,S),_.on(o.default.FRAG_PARSING_DATA,function(E,b){var L=[],A={event:E,data:b};b.data1&&(A.data1=b.data1.buffer,L.push(b.data1.buffer),delete b.data1),b.data2&&(A.data2=b.data2.buffer,L.push(b.data2.buffer),delete b.data2),w.postMessage(A,L)})};s.default=d},"./src/demux/id3.js":function(i,s,l){l.r(s),l.d(s,"utf8ArrayToStr",function(){return d});var c=l("./src/utils/get-self-scope.js"),o=function(){function p(){}return p.isHeader=function(_,S){return S+10<=_.length&&_[S]===73&&_[S+1]===68&&_[S+2]===51&&_[S+3]<255&&_[S+4]<255&&_[S+6]<128&&_[S+7]<128&&_[S+8]<128&&_[S+9]<128},p.isFooter=function(_,S){return S+10<=_.length&&_[S]===51&&_[S+1]===68&&_[S+2]===73&&_[S+3]<255&&_[S+4]<255&&_[S+6]<128&&_[S+7]<128&&_[S+8]<128&&_[S+9]<128},p.getID3Data=function(_,S){for(var E=S,b=0;p.isHeader(_,S);){b+=10;var L=p._readSize(_,S+6);b+=L,p.isFooter(_,S+10)&&(b+=10),S+=b}if(b>0)return _.subarray(E,E+b)},p._readSize=function(_,S){var E=0;return E=(_[S]&127)<<21,E|=(_[S+1]&127)<<14,E|=(_[S+2]&127)<<7,E|=_[S+3]&127,E},p.getTimeStamp=function(_){for(var S=p.getID3Frames(_),E=0;E<S.length;E++){var b=S[E];if(p.isTimeStampFrame(b))return p._readTimeStamp(b)}},p.isTimeStampFrame=function(_){return _&&_.key==="PRIV"&&_.info==="com.apple.streaming.transportStreamTimestamp"},p._getFrameData=function(_){var S=String.fromCharCode(_[0],_[1],_[2],_[3]),E=p._readSize(_,4),b=10;return{type:S,size:E,data:_.subarray(b,b+E)}},p.getID3Frames=function(_){for(var S=0,E=[];p.isHeader(_,S);){var b=p._readSize(_,S+6);S+=10;for(var L=S+b;S+8<L;){var A=p._getFrameData(_.subarray(S)),k=p._decodeFrame(A);k&&E.push(k),S+=A.size+10}p.isFooter(_,S)&&(S+=10)}return E},p._decodeFrame=function(_){return _.type==="PRIV"?p._decodePrivFrame(_):_.type[0]==="W"?p._decodeURLFrame(_):p._decodeTextFrame(_)},p._readTimeStamp=function(_){if(_.data.byteLength===8){var S=new Uint8Array(_.data),E=S[3]&1,b=(S[4]<<23)+(S[5]<<15)+(S[6]<<7)+S[7];return b/=45,E&&(b+=4772185884e-2),Math.round(b)}},p._decodePrivFrame=function(_){if(!(_.size<2)){var S=p._utf8ArrayToStr(_.data,!0),E=new Uint8Array(_.data.subarray(S.length+1));return{key:_.type,info:S,data:E.buffer}}},p._decodeTextFrame=function(_){if(!(_.size<2))if(_.type==="TXXX"){var S=1,E=p._utf8ArrayToStr(_.data.subarray(S),!0);S+=E.length+1;var b=p._utf8ArrayToStr(_.data.subarray(S));return{key:_.type,info:E,data:b}}else{var L=p._utf8ArrayToStr(_.data.subarray(1));return{key:_.type,data:L}}},p._decodeURLFrame=function(_){if(_.type==="WXXX"){if(_.size<2)return;var S=1,E=p._utf8ArrayToStr(_.data.subarray(S),!0);S+=E.length+1;var b=p._utf8ArrayToStr(_.data.subarray(S));return{key:_.type,info:E,data:b}}else{var L=p._utf8ArrayToStr(_.data);return{key:_.type,data:L}}},p._utf8ArrayToStr=function(_,S){S===void 0&&(S=!1);var E=g();if(E){var b=E.decode(_);if(S){var L=b.indexOf("\0");return L!==-1?b.substring(0,L):b}return b.replace(/\0/g,"")}for(var A=_.length,k,U,N,P="",G=0;G<A;){if(k=_[G++],k===0&&S)return P;if(k===0||k===3)continue;switch(k>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:P+=String.fromCharCode(k);break;case 12:case 13:U=_[G++],P+=String.fromCharCode((k&31)<<6|U&63);break;case 14:U=_[G++],N=_[G++],P+=String.fromCharCode((k&15)<<12|(U&63)<<6|(N&63)<<0);break}}return P},p}(),h;function g(){var p=Object(c.getSelfScope)();return!h&&typeof p.TextDecoder<"u"&&(h=new p.TextDecoder("utf-8")),h}var d=o._utf8ArrayToStr;s.default=o},"./src/demux/mp4demuxer.js":function(i,s,l){l.r(s);var c=l("./src/utils/logger.js"),o=l("./src/events.js"),h=Math.pow(2,32)-1,g=function(){function d(w,_){this.observer=w,this.remuxer=_}var p=d.prototype;return p.resetTimeStamp=function(_){this.initPTS=_},p.resetInitSegment=function(_,S,E,b){if(_&&_.byteLength){var L=this.initData=d.parseInitSegment(_);S==null&&(S="mp4a.40.5"),E==null&&(E="avc1.42e01e");var A={};L.audio&&L.video?A.audiovideo={container:"video/mp4",codec:S+","+E,initSegment:b?_:null}:(L.audio&&(A.audio={container:"audio/mp4",codec:S,initSegment:b?_:null}),L.video&&(A.video={container:"video/mp4",codec:E,initSegment:b?_:null})),this.observer.trigger(o.default.FRAG_PARSING_INIT_SEGMENT,{tracks:A})}else S&&(this.audioCodec=S),E&&(this.videoCodec=E)},d.probe=function(_){return d.findBox({data:_,start:0,end:Math.min(_.length,16384)},["moof"]).length>0},d.bin2str=function(_){return String.fromCharCode.apply(null,_)},d.readUint16=function(_,S){_.data&&(S+=_.start,_=_.data);var E=_[S]<<8|_[S+1];return E<0?65536+E:E},d.readUint32=function(_,S){_.data&&(S+=_.start,_=_.data);var E=_[S]<<24|_[S+1]<<16|_[S+2]<<8|_[S+3];return E<0?4294967296+E:E},d.writeUint32=function(_,S,E){_.data&&(S+=_.start,_=_.data),_[S]=E>>24,_[S+1]=E>>16&255,_[S+2]=E>>8&255,_[S+3]=E&255},d.findBox=function(_,S){var E=[],b,L,A,k,U,N,P;if(_.data?(N=_.start,k=_.end,_=_.data):(N=0,k=_.byteLength),!S.length)return null;for(b=N;b<k;)L=d.readUint32(_,b),A=d.bin2str(_.subarray(b+4,b+8)),P=L>1?b+L:k,A===S[0]&&(S.length===1?E.push({data:_,start:b+8,end:P}):(U=d.findBox({data:_,start:b+8,end:P},S.slice(1)),U.length&&(E=E.concat(U)))),b=P;return E},d.parseSegmentIndex=function(_){var S=d.findBox(_,["moov"])[0],E=S?S.end:null,b=0,L=d.findBox(_,["sidx"]),A;if(!L||!L[0])return null;A=[],L=L[0];var k=L.data[0];b=k===0?8:16;var U=d.readUint32(L,b);b+=4;var N=0,P=0;k===0?b+=8:b+=16,b+=2;var G=L.end+P,$=d.readUint16(L,b);b+=2;for(var J=0;J<$;J++){var X=b,Z=d.readUint32(L,X);X+=4;var ie=Z&2147483647,de=(Z&2147483648)>>>31;if(de===1){console.warn("SIDX has hierarchical references (not supported)");return}var _e=d.readUint32(L,X);X+=4,A.push({referenceSize:ie,subsegmentDuration:_e,info:{duration:_e/U,start:G,end:G+ie-1}}),G+=ie,X+=4,b=X}return{earliestPresentationTime:N,timescale:U,version:k,referencesCount:$,references:A,moovEndOffset:E}},d.parseInitSegment=function(_){var S=[],E=d.findBox(_,["moov","trak"]);return E.forEach(function(b){var L=d.findBox(b,["tkhd"])[0];if(L){var A=L.data[L.start],k=A===0?12:20,U=d.readUint32(L,k),N=d.findBox(b,["mdia","mdhd"])[0];if(N){A=N.data[N.start],k=A===0?12:20;var P=d.readUint32(N,k),G=d.findBox(b,["mdia","hdlr"])[0];if(G){var $=d.bin2str(G.data.subarray(G.start+8,G.start+12)),J={soun:"audio",vide:"video"}[$];if(J){var X=d.findBox(b,["mdia","minf","stbl","stsd"]);if(X.length){X=X[0];var Z=d.bin2str(X.data.subarray(X.start+12,X.start+16));c.logger.log("MP4Demuxer:"+J+":"+Z+" found")}S[U]={timescale:P,type:J},S[J]={timescale:P,id:U}}}}}}),S},d.getStartDTS=function(_,S){var E,b,L;return E=d.findBox(S,["moof","traf"]),b=[].concat.apply([],E.map(function(A){return d.findBox(A,["tfhd"]).map(function(k){var U,N,P;return U=d.readUint32(k,4),N=_[U].timescale||9e4,P=d.findBox(A,["tfdt"]).map(function(G){var $,J;return $=G.data[G.start],J=d.readUint32(G,4),$===1&&(J*=Math.pow(2,32),J+=d.readUint32(G,8)),J})[0],P/N})})),L=Math.min.apply(null,b),isFinite(L)?L:0},d.offsetStartDTS=function(_,S,E){d.findBox(S,["moof","traf"]).map(function(b){return d.findBox(b,["tfhd"]).map(function(L){var A=d.readUint32(L,4),k=_[A].timescale||9e4;d.findBox(b,["tfdt"]).map(function(U){var N=U.data[U.start],P=d.readUint32(U,4);if(N===0)d.writeUint32(U,4,P-E*k);else{P*=Math.pow(2,32),P+=d.readUint32(U,8),P-=E*k,P=Math.max(P,0);var G=Math.floor(P/(h+1)),$=Math.floor(P%(h+1));d.writeUint32(U,4,G),d.writeUint32(U,8,$)}})})})},p.append=function(_,S,E,b){var L=this.initData;L||(this.resetInitSegment(_,this.audioCodec,this.videoCodec,!1),L=this.initData);var A,k=this.initPTS;if(k===void 0){var U=d.getStartDTS(L,_);this.initPTS=k=U-S,this.observer.trigger(o.default.INIT_PTS_FOUND,{initPTS:k})}d.offsetStartDTS(L,_,k),A=d.getStartDTS(L,_),this.remuxer.remux(L.audio,L.video,null,null,A,E,b,_)},p.destroy=function(){},d}();s.default=g},"./src/errors.ts":function(i,s,l){l.r(s),l.d(s,"ErrorTypes",function(){return c}),l.d(s,"ErrorDetails",function(){return o});var c;(function(h){h.NETWORK_ERROR="networkError",h.MEDIA_ERROR="mediaError",h.KEY_SYSTEM_ERROR="keySystemError",h.MUX_ERROR="muxError",h.OTHER_ERROR="otherError"})(c||(c={}));var o;(function(h){h.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",h.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",h.KEY_SYSTEM_NO_SESSION="keySystemNoSession",h.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",h.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",h.MANIFEST_LOAD_ERROR="manifestLoadError",h.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",h.MANIFEST_PARSING_ERROR="manifestParsingError",h.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",h.LEVEL_EMPTY_ERROR="levelEmptyError",h.LEVEL_LOAD_ERROR="levelLoadError",h.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",h.LEVEL_SWITCH_ERROR="levelSwitchError",h.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",h.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",h.FRAG_LOAD_ERROR="fragLoadError",h.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",h.FRAG_DECRYPT_ERROR="fragDecryptError",h.FRAG_PARSING_ERROR="fragParsingError",h.REMUX_ALLOC_ERROR="remuxAllocError",h.KEY_LOAD_ERROR="keyLoadError",h.KEY_LOAD_TIMEOUT="keyLoadTimeOut",h.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",h.BUFFER_APPEND_ERROR="bufferAppendError",h.BUFFER_APPENDING_ERROR="bufferAppendingError",h.BUFFER_STALLED_ERROR="bufferStalledError",h.BUFFER_FULL_ERROR="bufferFullError",h.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",h.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",h.INTERNAL_EXCEPTION="internalException"})(o||(o={}))},"./src/events.js":function(i,s,l){l.r(s);var c={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVELS_UPDATED:"hlsLevelsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",CUES_PARSED:"hlsCuesParsed",NON_NATIVE_TEXT_TRACKS_FOUND:"hlsNonNativeTextTracksFound",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"};s.default=c},"./src/hls.ts":function(i,s,l){l.r(s),l.d(s,"default",function(){return Fa});var c={};l.r(c),l.d(c,"newCue",function(){return Rl});var o=l("./node_modules/url-toolkit/src/url-toolkit.js"),h=l("./src/errors.ts"),g=l("./src/polyfills/number.js"),d=l("./src/events.js"),p=l("./src/utils/logger.js"),w={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},_=function(){function y(u){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=u,this.onEvent=this.onEvent.bind(this);for(var a=arguments.length,t=new Array(a>1?a-1:0),n=1;n<a;n++)t[n-1]=arguments[n];this.handledEvents=t,this.useGenericHandler=!0,this.registerListeners()}var m=y.prototype;return m.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},m.onHandlerDestroying=function(){},m.onHandlerDestroyed=function(){},m.isEventHandler=function(){return typeof this.handledEvents=="object"&&this.handledEvents.length&&typeof this.onEvent=="function"},m.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(a){if(w[a])throw new Error("Forbidden event-name: "+a);this.hls.on(a,this.onEvent)},this)},m.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(a){this.hls.off(a,this.onEvent)},this)},m.onEvent=function(a,t){this.onEventGeneric(a,t)},m.onEventGeneric=function(a,t){var n=function(v,x){var T="on"+v.replace("hls","");if(typeof this[T]!="function")throw new Error("Event "+v+" has no generic handler in this "+this.constructor.name+" class (tried "+T+")");return this[T].bind(this,x)};try{n.call(this,a,t).call()}catch(f){p.logger.error("An internal error happened while handling event "+a+'. Error message: "'+f.message+'". Here is a stacktrace:',f),this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.OTHER_ERROR,details:h.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:a,err:f})}},y}(),S=_,E;(function(y){y.MANIFEST="manifest",y.LEVEL="level",y.AUDIO_TRACK="audioTrack",y.SUBTITLE_TRACK="subtitleTrack"})(E||(E={}));var b;(function(y){y.MAIN="main",y.AUDIO="audio",y.SUBTITLE="subtitle"})(b||(b={}));var L=l("./src/demux/mp4demuxer.js");function A(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function k(y,m,u){return m&&A(y.prototype,m),y}var U=function(){function y(m,u){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=m,this.reluri=u}return k(y,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(o.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),y}();function N(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function P(y,m,u){return m&&N(y.prototype,m),y}var G;(function(y){y.AUDIO="audio",y.VIDEO="video"})(G||(G={}));var $=function(){function y(){var u;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=(u={},u[G.AUDIO]=!1,u[G.VIDEO]=!1,u),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var m=y.prototype;return m.setByteRange=function(a,t){var n=a.split("@",2),f=[];n.length===1?f[0]=t?t.byteRangeEndOffset:0:f[0]=parseInt(n[1]),f[1]=parseInt(n[0])+f[0],this._byteRange=f},m.addElementaryStream=function(a){this._elementaryStreams[a]=!0},m.hasElementaryStream=function(a){return this._elementaryStreams[a]===!0},m.createInitializationVector=function(a){for(var t=new Uint8Array(16),n=12;n<16;n++)t[n]=a>>8*(15-n)&255;return t},m.setDecryptDataFromLevelKey=function(a,t){var n=a;return a?.method&&a.uri&&!a.iv&&(n=new U(a.baseuri,a.reluri),n.method=a.method,n.iv=this.createInitializationVector(t)),n},P(y,[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(o.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(a){this._url=a}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var a=this.sn;typeof a!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&p.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),a=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,a)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(g.isFiniteNumber)(this.programDateTime))return null;var a=Object(g.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+a*1e3}},{key:"encrypted",get:function(){return!!(this.decryptdata&&this.decryptdata.uri!==null&&this.decryptdata.key===null)}}]),y}();function J(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function X(y,m,u){return m&&J(y.prototype,m),y}var Z=function(){function y(m){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=m,this.version=null}return X(y,[{key:"hasProgramDateTime",get:function(){return!!(this.fragments[0]&&Object(g.isFiniteNumber)(this.fragments[0].programDateTime))}}]),y}(),ie=/^(\d+)x(\d+)$/,de=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,_e=function(){function y(u){typeof u=="string"&&(u=y.parseAttrList(u));for(var a in u)u.hasOwnProperty(a)&&(this[a]=u[a])}var m=y.prototype;return m.decimalInteger=function(a){var t=parseInt(this[a],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},m.hexadecimalInteger=function(a){if(this[a]){var t=(this[a]||"0x").slice(2);t=(t.length&1?"0":"")+t;for(var n=new Uint8Array(t.length/2),f=0;f<t.length/2;f++)n[f]=parseInt(t.slice(f*2,f*2+2),16);return n}else return null},m.hexadecimalIntegerAsNumber=function(a){var t=parseInt(this[a],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},m.decimalFloatingPoint=function(a){return parseFloat(this[a])},m.enumeratedString=function(a){return this[a]},m.decimalResolution=function(a){var t=ie.exec(this[a]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},y.parseAttrList=function(a){var t,n={};for(de.lastIndex=0;(t=de.exec(a))!==null;){var f=t[2],v='"';f.indexOf(v)===0&&f.lastIndexOf(v)===f.length-1&&(f=f.slice(1,-1)),n[t[1]]=f}return n},y}(),Ee=_e,Se={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function le(y,m){var u=Se[m];return!!u&&u[y.slice(0,4)]===!0}function pe(y,m){return MediaSource.isTypeSupported((m||"video")+'/mp4;codecs="'+y+'"')}var he=/(?:#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)|#EXT-X-SESSION-DATA:([^\n\r]*)[\r\n]+)/g,Te=/#EXT-X-MEDIA:(.*)/g,xe=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),ye=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,ge=/\.(mp4|m4s|m4v|m4a)$/i,be=function(){function y(){}return y.findGroup=function(u,a){for(var t=0;t<u.length;t++){var n=u[t];if(n.id===a)return n}},y.convertAVC1ToAVCOTI=function(u){var a=u.split("."),t;return a.length>2?(t=a.shift()+".",t+=parseInt(a.shift()).toString(16),t+=("000"+parseInt(a.shift()).toString(16)).substr(-4)):t=u,t},y.resolve=function(u,a){return o.buildAbsoluteURL(a,u,{alwaysNormalize:!0})},y.parseMasterPlaylist=function(u,a){var t=[],n={},f=!1;he.lastIndex=0;function v(W,Q){["video","audio"].forEach(function(ve){var Me=W.filter(function(De){return le(De,ve)});if(Me.length){var Pe=Me.filter(function(De){return De.lastIndexOf("avc1",0)===0||De.lastIndexOf("mp4a",0)===0});Q[ve+"Codec"]=Pe.length>0?Pe[0]:Me[0],W=W.filter(function(De){return Me.indexOf(De)===-1})}}),Q.unknownCodecs=W}for(var x;(x=he.exec(u))!=null;)if(x[1]){var T={},D=T.attrs=new Ee(x[1]);T.url=y.resolve(x[2],a);var O=D.decimalResolution("RESOLUTION");O&&(T.width=O.width,T.height=O.height),T.bitrate=D.decimalInteger("AVERAGE-BANDWIDTH")||D.decimalInteger("BANDWIDTH"),T.name=D.NAME,v([].concat((D.CODECS||"").split(/[ ,]+/)),T),T.videoCodec&&T.videoCodec.indexOf("avc1")!==-1&&(T.videoCodec=y.convertAVC1ToAVCOTI(T.videoCodec)),t.push(T)}else if(x[3]){var F=new Ee(x[3]);F["DATA-ID"]&&(f=!0,n[F["DATA-ID"]]=F)}return{levels:t,sessionData:f?n:null}},y.parseMasterPlaylistMedia=function(u,a,t,n){n===void 0&&(n=[]);var f,v=[],x=0;for(Te.lastIndex=0;(f=Te.exec(u))!==null;){var T=new Ee(f[1]);if(T.TYPE===t){var D={attrs:T,id:x++,groupId:T["GROUP-ID"],instreamId:T["INSTREAM-ID"],name:T.NAME||T.LANGUAGE,type:t,default:T.DEFAULT==="YES",autoselect:T.AUTOSELECT==="YES",forced:T.FORCED==="YES",lang:T.LANGUAGE};if(T.URI&&(D.url=y.resolve(T.URI,a)),n.length){var O=y.findGroup(n,D.groupId);D.audioCodec=O?O.codec:n[0].codec}v.push(D)}}return v},y.parseLevelPlaylist=function(u,a,t,n,f){var v=0,x=0,T=new Z(a),D=0,O=null,F=new $,W,Q,ve,Me=null;for(xe.lastIndex=0;(W=xe.exec(u))!==null;){var Pe=W[1];if(Pe){F.duration=parseFloat(Pe);var De=(" "+W[2]).slice(1);F.title=De||null,F.tagList.push(De?["INF",Pe,De]:["INF",Pe])}else if(W[3]){if(Object(g.isFiniteNumber)(F.duration)){var He=v++;F.type=n,F.start=x,ve&&(F.levelkey=ve),F.sn=He,F.level=t,F.cc=D,F.urlId=f,F.baseurl=a,F.relurl=(" "+W[3]).slice(1),Ue(F,O),T.fragments.push(F),O=F,x+=F.duration,F=new $}}else if(W[4]){var Ve=(" "+W[4]).slice(1);O?F.setByteRange(Ve,O):F.setByteRange(Ve)}else if(W[5])F.rawProgramDateTime=(" "+W[5]).slice(1),F.tagList.push(["PROGRAM-DATE-TIME",F.rawProgramDateTime]),Me===null&&(Me=T.fragments.length);else{if(W=W[0].match(ye),!W){p.logger.warn("No matches on slow regex match for level playlist!");continue}for(Q=1;Q<W.length&&!(typeof W[Q]<"u");Q++);var at=(" "+W[Q+1]).slice(1),xt=(" "+W[Q+2]).slice(1);switch(W[Q]){case"#":F.tagList.push(xt?[at,xt]:[at]);break;case"PLAYLIST-TYPE":T.type=at.toUpperCase();break;case"MEDIA-SEQUENCE":v=T.startSN=parseInt(at);break;case"TARGETDURATION":T.targetduration=parseFloat(at);break;case"VERSION":T.version=parseInt(at);break;case"EXTM3U":break;case"ENDLIST":T.live=!1;break;case"DIS":D++,F.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":D=parseInt(at);break;case"KEY":{var nr=at,zt=new Ee(nr),Er=zt.enumeratedString("METHOD"),je=zt.URI,et=zt.hexadecimalInteger("IV"),At=zt.KEYFORMAT||"identity";if(At==="com.apple.streamingkeydelivery"){p.logger.warn("Keyformat com.apple.streamingkeydelivery is not supported");continue}Er&&(ve=new U(a,je),je&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(Er)>=0&&(ve.method=Er,ve.key=null,ve.iv=et));break}case"START":{var Zr=new Ee(at),Qr=Zr.decimalFloatingPoint("TIME-OFFSET");Object(g.isFiniteNumber)(Qr)&&(T.startTimeOffset=Qr);break}case"MAP":{var mn=new Ee(at);F.relurl=mn.URI,mn.BYTERANGE&&F.setByteRange(mn.BYTERANGE),F.baseurl=a,F.level=t,F.type=n,F.sn="initSegment",T.initSegment=F,F=new $,F.rawProgramDateTime=T.initSegment.rawProgramDateTime;break}default:p.logger.warn("line parsed but not handled: "+W);break}}}return F=O,F&&!F.relurl&&(T.fragments.pop(),x-=F.duration),T.totalduration=x,T.averagetargetduration=x/T.fragments.length,T.endSN=v-1,T.startCC=T.fragments[0]?T.fragments[0].cc:0,T.endCC=D,!T.initSegment&&T.fragments.length&&T.fragments.every(function(Yn){return ge.test(Yn.relurl)})&&(p.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),F=new $,F.relurl=T.fragments[0].relurl,F.baseurl=a,F.level=t,F.type=n,F.sn="initSegment",T.initSegment=F,T.needSidxRanges=!0),Me&&fe(T.fragments,Me),T},y}();function fe(y,m){for(var u=y[m],a=m-1;a>=0;a--){var t=y[a];t.programDateTime=u.programDateTime-t.duration*1e3,u=t}}function Ue(y,m){y.rawProgramDateTime?y.programDateTime=Date.parse(y.rawProgramDateTime):m?.programDateTime&&(y.programDateTime=m.endProgramDateTime),Object(g.isFiniteNumber)(y.programDateTime)||(y.programDateTime=null,y.rawProgramDateTime=null)}function Ce(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var ae=window,we=ae.performance,Ae=function(y){Ce(m,y);function m(a){var t;return t=y.call(this,a,d.default.MANIFEST_LOADING,d.default.LEVEL_LOADING,d.default.AUDIO_TRACK_LOADING,d.default.SUBTITLE_TRACK_LOADING)||this,t.loaders={},t}m.canHaveQualityLevels=function(t){return t!==E.AUDIO_TRACK&&t!==E.SUBTITLE_TRACK},m.mapContextToLevelType=function(t){var n=t.type;switch(n){case E.AUDIO_TRACK:return b.AUDIO;case E.SUBTITLE_TRACK:return b.SUBTITLE;default:return b.MAIN}},m.getResponseUrl=function(t,n){var f=t.url;return(f===void 0||f.indexOf("data:")===0)&&(f=n.url),f};var u=m.prototype;return u.createInternalLoader=function(t){var n=this.hls.config,f=n.pLoader,v=n.loader,x=f||v,T=new x(n);return t.loader=T,this.loaders[t.type]=T,T},u.getInternalLoader=function(t){return this.loaders[t.type]},u.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]},u.destroyInternalLoaders=function(){for(var t in this.loaders){var n=this.loaders[t];n&&n.destroy(),this.resetInternalLoader(t)}},u.destroy=function(){this.destroyInternalLoaders(),y.prototype.destroy.call(this)},u.onManifestLoading=function(t){this.load({url:t.url,type:E.MANIFEST,level:0,id:null,responseType:"text"})},u.onLevelLoading=function(t){this.load({url:t.url,type:E.LEVEL,level:t.level,id:t.id,responseType:"text"})},u.onAudioTrackLoading=function(t){this.load({url:t.url,type:E.AUDIO_TRACK,level:null,id:t.id,responseType:"text"})},u.onSubtitleTrackLoading=function(t){this.load({url:t.url,type:E.SUBTITLE_TRACK,level:null,id:t.id,responseType:"text"})},u.load=function(t){var n=this.hls.config;p.logger.debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id);var f=this.getInternalLoader(t);if(f){var v=f.context;if(v&&v.url===t.url)return p.logger.trace("playlist request ongoing"),!1;p.logger.warn("aborting previous loader for type: "+t.type),f.abort()}var x,T,D,O;switch(t.type){case E.MANIFEST:x=n.manifestLoadingMaxRetry,T=n.manifestLoadingTimeOut,D=n.manifestLoadingRetryDelay,O=n.manifestLoadingMaxRetryTimeout;break;case E.LEVEL:x=0,O=0,D=0,T=n.levelLoadingTimeOut;break;default:x=n.levelLoadingMaxRetry,T=n.levelLoadingTimeOut,D=n.levelLoadingRetryDelay,O=n.levelLoadingMaxRetryTimeout;break}f=this.createInternalLoader(t);var F={timeout:T,maxRetry:x,retryDelay:D,maxRetryDelay:O},W={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return p.logger.debug("Calling internal loader delegate for URL: "+t.url),f.load(t,F,W),!0},u.loadsuccess=function(t,n,f,v){if(v===void 0&&(v=null),f.isSidxRequest){this._handleSidxRequest(t,f),this._handlePlaylistLoaded(t,n,f,v);return}if(this.resetInternalLoader(f.type),typeof t.data!="string")throw new Error('expected responseType of "text" for PlaylistLoader');var x=t.data;if(n.tload=we.now(),x.indexOf("#EXTM3U")!==0){this._handleManifestParsingError(t,f,"no EXTM3U delimiter",v);return}x.indexOf("#EXTINF:")>0||x.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(t,n,f,v):this._handleMasterPlaylist(t,n,f,v)},u.loaderror=function(t,n,f){f===void 0&&(f=null),this._handleNetworkError(n,f,!1,t)},u.loadtimeout=function(t,n,f){f===void 0&&(f=null),this._handleNetworkError(n,f,!0)},u._handleMasterPlaylist=function(t,n,f,v){var x=this.hls,T=t.data,D=m.getResponseUrl(t,f),O=be.parseMasterPlaylist(T,D),F=O.levels,W=O.sessionData;if(!F.length){this._handleManifestParsingError(t,f,"no level found in manifest",v);return}var Q=F.map(function(He){return{id:He.attrs.AUDIO,codec:He.audioCodec}}),ve=be.parseMasterPlaylistMedia(T,D,"AUDIO",Q),Me=be.parseMasterPlaylistMedia(T,D,"SUBTITLES"),Pe=be.parseMasterPlaylistMedia(T,D,"CLOSED-CAPTIONS");if(ve.length){var De=!1;ve.forEach(function(He){He.url||(De=!0)}),De===!1&&F[0].audioCodec&&!F[0].attrs.AUDIO&&(p.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),ve.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:{},url:""}))}x.trigger(d.default.MANIFEST_LOADED,{levels:F,audioTracks:ve,subtitles:Me,captions:Pe,url:D,stats:n,networkDetails:v,sessionData:W})},u._handleTrackOrLevelPlaylist=function(t,n,f,v){var x=this.hls,T=f.id,D=f.level,O=f.type,F=m.getResponseUrl(t,f),W=Object(g.isFiniteNumber)(T)?T:0,Q=Object(g.isFiniteNumber)(D)?D:W,ve=m.mapContextToLevelType(f),Me=be.parseLevelPlaylist(t.data,F,Q,ve,W);if(Me.tload=n.tload,!Me.fragments.length){x.trigger(d.default.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:F,reason:"no fragments found in level",level:typeof f.level=="number"?f.level:void 0});return}if(O===E.MANIFEST){var Pe={url:F,details:Me};x.trigger(d.default.MANIFEST_LOADED,{levels:[Pe],audioTracks:[],url:F,stats:n,networkDetails:v,sessionData:null})}if(n.tparsed=we.now(),Me.needSidxRanges){var De=Me.initSegment.url;this.load({url:De,isSidxRequest:!0,type:O,level:D,levelDetails:Me,id:T,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"});return}f.levelDetails=Me,this._handlePlaylistLoaded(t,n,f,v)},u._handleSidxRequest=function(t,n){if(typeof t.data=="string")throw new Error("sidx request must be made with responseType of array buffer");var f=L.default.parseSegmentIndex(new Uint8Array(t.data));if(f){var v=f.references,x=n.levelDetails;v.forEach(function(T,D){var O=T.info;if(x){var F=x.fragments[D];F.byteRange.length===0&&F.setByteRange(String(1+O.end-O.start)+"@"+String(O.start))}}),x&&x.initSegment.setByteRange(String(f.moovEndOffset)+"@0")}},u._handleManifestParsingError=function(t,n,f,v){this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:t.url,reason:f,networkDetails:v})},u._handleNetworkError=function(t,n,f,v){f===void 0&&(f=!1),v===void 0&&(v=null),p.logger.info("A network error occured while loading a "+t.type+"-type playlist");var x,T,D=this.getInternalLoader(t);switch(t.type){case E.MANIFEST:x=f?h.ErrorDetails.MANIFEST_LOAD_TIMEOUT:h.ErrorDetails.MANIFEST_LOAD_ERROR,T=!0;break;case E.LEVEL:x=f?h.ErrorDetails.LEVEL_LOAD_TIMEOUT:h.ErrorDetails.LEVEL_LOAD_ERROR,T=!1;break;case E.AUDIO_TRACK:x=f?h.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:h.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,T=!1;break;default:T=!1}D&&(D.abort(),this.resetInternalLoader(t.type));var O={type:h.ErrorTypes.NETWORK_ERROR,details:x,fatal:T,url:t.url,loader:D,context:t,networkDetails:n};v&&(O.response=v),this.hls.trigger(d.default.ERROR,O)},u._handlePlaylistLoaded=function(t,n,f,v){var x=f.type,T=f.level,D=f.id,O=f.levelDetails;if(!O||!O.targetduration){this._handleManifestParsingError(t,f,"invalid target duration",v);return}var F=m.canHaveQualityLevels(f.type);if(F)this.hls.trigger(d.default.LEVEL_LOADED,{details:O,level:T||0,id:D||0,stats:n,networkDetails:v});else switch(x){case E.AUDIO_TRACK:this.hls.trigger(d.default.AUDIO_TRACK_LOADED,{details:O,id:D,stats:n,networkDetails:v});break;case E.SUBTITLE_TRACK:this.hls.trigger(d.default.SUBTITLE_TRACK_LOADED,{details:O,id:D,stats:n,networkDetails:v});break}},m}(S),Oe=Ae;function Fe(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var Ne=function(y){Fe(m,y);function m(a){var t;return t=y.call(this,a,d.default.FRAG_LOADING)||this,t.loaders={},t}var u=m.prototype;return u.destroy=function(){var t=this.loaders;for(var n in t){var f=t[n];f&&f.destroy()}this.loaders={},y.prototype.destroy.call(this)},u.onFragLoading=function(t){var n=t.frag,f=n.type,v=this.loaders,x=this.hls.config,T=x.fLoader,D=x.loader;n.loaded=0;var O=v[f];O&&(p.logger.warn("abort previous fragment loader for type: "+f),O.abort()),O=v[f]=n.loader=x.fLoader?new T(x):new D(x);var F,W,Q;F={url:n.url,frag:n,responseType:"arraybuffer",progressData:!1};var ve=n.byteRangeStartOffset,Me=n.byteRangeEndOffset;Object(g.isFiniteNumber)(ve)&&Object(g.isFiniteNumber)(Me)&&(F.rangeStart=ve,F.rangeEnd=Me),W={timeout:x.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:x.fragLoadingMaxRetryTimeout},Q={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},O.load(F,W,Q)},u.loadsuccess=function(t,n,f,v){v===void 0&&(v=null);var x=t.data,T=f.frag;T.loader=void 0,this.loaders[T.type]=void 0,this.hls.trigger(d.default.FRAG_LOADED,{payload:x,frag:T,stats:n,networkDetails:v})},u.loaderror=function(t,n,f){f===void 0&&(f=null);var v=n.frag,x=v.loader;x&&x.abort(),this.loaders[v.type]=void 0,this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:n.frag,response:t,networkDetails:f})},u.loadtimeout=function(t,n,f){f===void 0&&(f=null);var v=n.frag,x=v.loader;x&&x.abort(),this.loaders[v.type]=void 0,this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:n.frag,networkDetails:f})},u.loadprogress=function(t,n,f,v){v===void 0&&(v=null);var x=n.frag;x.loaded=t.loaded,this.hls.trigger(d.default.FRAG_LOAD_PROGRESS,{frag:x,stats:t,networkDetails:v})},m}(S),Be=Ne;function qe(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var Ie=function(y){qe(m,y);function m(a){var t;return t=y.call(this,a,d.default.KEY_LOADING)||this,t.loaders={},t.decryptkey=null,t.decrypturl=null,t}var u=m.prototype;return u.destroy=function(){for(var t in this.loaders){var n=this.loaders[t];n&&n.destroy()}this.loaders={},y.prototype.destroy.call(this)},u.onKeyLoading=function(t){var n=t.frag,f=n.type,v=this.loaders[f];if(!n.decryptdata){p.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var x=n.decryptdata.uri;if(x!==this.decrypturl||this.decryptkey===null){var T=this.hls.config;if(v&&(p.logger.warn("abort previous key loader for type:"+f),v.abort()),!x){p.logger.warn("key uri is falsy");return}n.loader=this.loaders[f]=new T.loader(T),this.decrypturl=x,this.decryptkey=null;var D={url:x,frag:n,responseType:"arraybuffer"},O={timeout:T.fragLoadingTimeOut,maxRetry:0,retryDelay:T.fragLoadingRetryDelay,maxRetryDelay:T.fragLoadingMaxRetryTimeout},F={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};n.loader.load(D,O,F)}else this.decryptkey&&(n.decryptdata.key=this.decryptkey,this.hls.trigger(d.default.KEY_LOADED,{frag:n}))},u.loadsuccess=function(t,n,f){var v=f.frag;if(!v.decryptdata){p.logger.error("after key load, decryptdata unset");return}this.decryptkey=v.decryptdata.key=new Uint8Array(t.data),v.loader=void 0,delete this.loaders[v.type],this.hls.trigger(d.default.KEY_LOADED,{frag:v})},u.loaderror=function(t,n){var f=n.frag,v=f.loader;v&&v.abort(),delete this.loaders[f.type],this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:f,response:t})},u.loadtimeout=function(t,n){var f=n.frag,v=f.loader;v&&v.abort(),delete this.loaders[f.type],this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:f})},m}(S),Je=Ie;function We(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var nt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"},ft=function(y){We(m,y);function m(a){var t;return t=y.call(this,a,d.default.BUFFER_APPENDED,d.default.FRAG_BUFFERED,d.default.FRAG_LOADED)||this,t.bufferPadding=.2,t.fragments=Object.create(null),t.timeRanges=Object.create(null),t.config=a.config,t}var u=m.prototype;return u.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,S.prototype.destroy.call(this),y.prototype.destroy.call(this)},u.getBufferedFrag=function(t,n){var f=this.fragments,v=Object.keys(f).filter(function(T){var D=f[T];if(D.body.type!==n||!D.buffered)return!1;var O=D.body;return O.startPTS<=t&&t<=O.endPTS});if(v.length===0)return null;var x=v.pop();return f[x].body},u.detectEvictedFragments=function(t,n){var f=this;Object.keys(this.fragments).forEach(function(v){var x=f.fragments[v];if(!(!x||!x.buffered)){var T=x.range[t];if(T)for(var D=T.time,O=0;O<D.length;O++){var F=D[O];if(!f.isTimeBuffered(F.startPTS,F.endPTS,n)){f.removeFragment(x.body);break}}}})},u.detectPartialFragments=function(t){var n=this,f=this.getFragmentKey(t),v=this.fragments[f];v&&(v.buffered=!0,Object.keys(this.timeRanges).forEach(function(x){if(t.hasElementaryStream(x)){var T=n.timeRanges[x];v.range[x]=n.getBufferedTimes(t.startPTS,t.endPTS,T)}}))},u.getBufferedTimes=function(t,n,f){for(var v=[],x,T,D=!1,O=0;O<f.length;O++)if(x=f.start(O)-this.bufferPadding,T=f.end(O)+this.bufferPadding,t>=x&&n<=T){v.push({startPTS:Math.max(t,f.start(O)),endPTS:Math.min(n,f.end(O))});break}else if(t<T&&n>x)v.push({startPTS:Math.max(t,f.start(O)),endPTS:Math.min(n,f.end(O))}),D=!0;else if(n<=x)break;return{time:v,partial:D}},u.getFragmentKey=function(t){return t.type+"_"+t.level+"_"+t.urlId+"_"+t.sn},u.getPartialFragment=function(t){var n=this,f,v,x,T=null,D=0;return Object.keys(this.fragments).forEach(function(O){var F=n.fragments[O];n.isPartial(F)&&(v=F.body.startPTS-n.bufferPadding,x=F.body.endPTS+n.bufferPadding,t>=v&&t<=x&&(f=Math.min(t-v,x-t),D<=f&&(T=F.body,D=f)))}),T},u.getState=function(t){var n=this.getFragmentKey(t),f=this.fragments[n],v=nt.NOT_LOADED;return f!==void 0&&(f.buffered?this.isPartial(f)===!0?v=nt.PARTIAL:v=nt.OK:v=nt.APPENDING),v},u.isPartial=function(t){return t.buffered===!0&&(t.range.video!==void 0&&t.range.video.partial===!0||t.range.audio!==void 0&&t.range.audio.partial===!0)},u.isTimeBuffered=function(t,n,f){for(var v,x,T=0;T<f.length;T++){if(v=f.start(T)-this.bufferPadding,x=f.end(T)+this.bufferPadding,t>=v&&n<=x)return!0;if(n<=v)return!1}return!1},u.onFragLoaded=function(t){var n=t.frag;!Object(g.isFiniteNumber)(n.sn)||n.bitrateTest||(this.fragments[this.getFragmentKey(n)]={body:n,range:Object.create(null),buffered:!1})},u.onBufferAppended=function(t){var n=this;this.timeRanges=t.timeRanges,Object.keys(this.timeRanges).forEach(function(f){var v=n.timeRanges[f];n.detectEvictedFragments(f,v)})},u.onFragBuffered=function(t){this.detectPartialFragments(t.frag)},u.hasFragment=function(t){var n=this.getFragmentKey(t);return this.fragments[n]!==void 0},u.removeFragment=function(t){var n=this.getFragmentKey(t);delete this.fragments[n]},u.removeAllFragments=function(){this.fragments=Object.create(null)},m}(S),j={search:function(m,u){for(var a=0,t=m.length-1,n=null,f=null;a<=t;){n=(a+t)/2|0,f=m[n];var v=u(f);if(v>0)a=n+1;else if(v<0)t=n-1;else return f}return null}},K=j,B=function(){function y(){}return y.isBuffered=function(u,a){try{if(u){for(var t=u.buffered,n=0;n<t.length;n++)if(a>=t.start(n)&&a<=t.end(n))return!0}}catch{}return!1},y.bufferInfo=function(u,a,t){try{if(u){var n=u.buffered,f=[],v;for(v=0;v<n.length;v++)f.push({start:n.start(v),end:n.end(v)});return this.bufferedInfo(f,a,t)}}catch{}return{len:0,start:a,end:a,nextStart:void 0}},y.bufferedInfo=function(u,a,t){u.sort(function(Me,Pe){var De=Me.start-Pe.start;return De||Pe.end-Me.end});var n=[];if(t)for(var f=0;f<u.length;f++){var v=n.length;if(v){var x=n[v-1].end;u[f].start-x<t?u[f].end>x&&(n[v-1].end=u[f].end):n.push(u[f])}else n.push(u[f])}else n=u;for(var T=0,D,O=a,F=a,W=0;W<n.length;W++){var Q=n[W].start,ve=n[W].end;if(a+t>=Q&&a<ve)O=Q,F=ve,T=F-a;else if(a+t<Q){D=Q;break}}return{len:T,start:O,end:F,nextStart:D}},y}(),M=l("./node_modules/eventemitter3/index.js"),C=l("./node_modules/webworkify-webpack/index.js"),Y=l("./src/demux/demuxer-inline.js");function H(){return window.MediaSource||window.WebKitMediaSource}var z=l("./src/utils/get-self-scope.js");function V(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var q=function(y){V(m,y);function m(){return y.apply(this,arguments)||this}var u=m.prototype;return u.trigger=function(t){for(var n=arguments.length,f=new Array(n>1?n-1:0),v=1;v<n;v++)f[v-1]=arguments[v];this.emit.apply(this,[t,t].concat(f))},m}(M.EventEmitter),ne=Object(z.getSelfScope)(),re=H()||{isTypeSupported:function(){return!1}},ee=function(){function y(u,a){var t=this;this.hls=u,this.id=a;var n=this.observer=new q,f=u.config,v=function(F,W){W=W||{},W.frag=t.frag,W.id=t.id,u.trigger(F,W)};n.on(d.default.FRAG_DECRYPTED,v),n.on(d.default.FRAG_PARSING_INIT_SEGMENT,v),n.on(d.default.FRAG_PARSING_DATA,v),n.on(d.default.FRAG_PARSED,v),n.on(d.default.ERROR,v),n.on(d.default.FRAG_PARSING_METADATA,v),n.on(d.default.FRAG_PARSING_USERDATA,v),n.on(d.default.INIT_PTS_FOUND,v);var x={mp4:re.isTypeSupported("video/mp4"),mpeg:re.isTypeSupported("audio/mpeg"),mp3:re.isTypeSupported('audio/mp4; codecs="mp3"')},T=navigator.vendor;if(f.enableWorker&&typeof Worker<"u"){p.logger.log("demuxing in webworker");var D;try{D=this.w=C("./src/demux/demuxer-worker.js"),this.onwmsg=this.onWorkerMessage.bind(this),D.addEventListener("message",this.onwmsg),D.onerror=function(O){u.trigger(d.default.ERROR,{type:h.ErrorTypes.OTHER_ERROR,details:h.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:O.message+" ("+O.filename+":"+O.lineno+")"}})},D.postMessage({cmd:"init",typeSupported:x,vendor:T,id:a,config:JSON.stringify(f)})}catch(O){p.logger.warn("Error in worker:",O),p.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),D&&ne.URL.revokeObjectURL(D.objectURL),this.demuxer=new Y.default(n,x,f,T),this.w=void 0}}else this.demuxer=new Y.default(n,x,f,T)}var m=y.prototype;return m.destroy=function(){var a=this.w;if(a)a.removeEventListener("message",this.onwmsg),a.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var n=this.observer;n&&(n.removeAllListeners(),this.observer=null)},m.push=function(a,t,n,f,v,x,T,D){var O=this.w,F=Object(g.isFiniteNumber)(v.startPTS)?v.startPTS:v.start,W=v.decryptdata,Q=this.frag,ve=!(Q&&v.cc===Q.cc),Me=!(Q&&v.level===Q.level),Pe=Q&&v.sn===Q.sn+1,De=!Me&&Pe;if(ve&&p.logger.log(this.id+":discontinuity detected"),Me&&p.logger.log(this.id+":switch detected"),this.frag=v,O)O.postMessage({cmd:"demux",data:a,decryptdata:W,initSegment:t,audioCodec:n,videoCodec:f,timeOffset:F,discontinuity:ve,trackSwitch:Me,contiguous:De,duration:x,accurateTimeOffset:T,defaultInitPTS:D},a instanceof ArrayBuffer?[a]:[]);else{var He=this.demuxer;He&&He.push(a,W,t,n,f,F,ve,Me,De,x,T,D)}},m.onWorkerMessage=function(a){var t=a.data,n=this.hls;switch(t.event){case"init":ne.URL.revokeObjectURL(this.w.objectURL);break;case d.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data);break}},y}(),se=ee;function ce(y,m,u){switch(m){case"audio":y.audioGroupIds||(y.audioGroupIds=[]),y.audioGroupIds.push(u);break;case"text":y.textGroupIds||(y.textGroupIds=[]),y.textGroupIds.push(u);break}}function me(y,m,u){var a=y[m],t=y[u],n=t.startPTS;if(Object(g.isFiniteNumber)(n))u>m?(a.duration=n-a.start,a.duration<0&&p.logger.warn("negative duration computed for frag "+a.sn+",level "+a.level+", there should be some duration drift between playlist and fragment!")):(t.duration=a.start-n,t.duration<0&&p.logger.warn("negative duration computed for frag "+t.sn+",level "+t.level+", there should be some duration drift between playlist and fragment!"));else if(u>m){var f=a.cc===t.cc;t.start=a.start+(f&&a.minEndPTS?a.minEndPTS-a.start:a.duration)}else t.start=Math.max(a.start-t.duration,0)}function ue(y,m,u,a,t,n){var f=u,v=a;if(Object(g.isFiniteNumber)(m.startPTS)){var x=Math.abs(m.startPTS-u);Object(g.isFiniteNumber)(m.deltaPTS)?m.deltaPTS=Math.max(x,m.deltaPTS):m.deltaPTS=x,f=Math.max(u,m.startPTS),u=Math.min(u,m.startPTS),v=Math.min(a,m.endPTS),a=Math.max(a,m.endPTS),t=Math.min(t,m.startDTS),n=Math.max(n,m.endDTS)}var T=u-m.start;m.start=m.startPTS=u,m.maxStartPTS=f,m.endPTS=a,m.minEndPTS=v,m.startDTS=t,m.endDTS=n,m.duration=a-u;var D=m.sn;if(!y||D<y.startSN||D>y.endSN)return 0;var O,F,W;for(O=D-y.startSN,F=y.fragments,F[O]=m,W=O;W>0;W--)me(F,W,W-1);for(W=O;W<F.length-1;W++)me(F,W,W+1);return y.PTSKnown=!0,T}function ke(y,m){m.initSegment&&y.initSegment&&(m.initSegment=y.initSegment);var u=0,a;if(Ye(y,m,function(f,v){u=f.cc-v.cc,Object(g.isFiniteNumber)(f.startPTS)&&(v.start=v.startPTS=f.startPTS,v.endPTS=f.endPTS,v.duration=f.duration,v.backtracked=f.backtracked,v.dropped=f.dropped,a=v),m.PTSKnown=!0}),!!m.PTSKnown){if(u){p.logger.log("discontinuity sliding from playlist, take drift into account");for(var t=m.fragments,n=0;n<t.length;n++)t[n].cc+=u}a?ue(m,a,a.startPTS,a.endPTS,a.startDTS,a.endDTS):oe(y,m),m.PTSKnown=y.PTSKnown}}function Re(y,m,u){u===void 0&&(u=0);var a=-1;Ye(y,m,function(f,v,x){v.start=f.start,a=x});var t=m.fragments;if(a<0){t.forEach(function(f){f.start+=u});return}for(var n=a+1;n<t.length;n++)t[n].start=t[n-1].start+t[n-1].duration}function Ye(y,m,u){if(!(!y||!m))for(var a=Math.max(y.startSN,m.startSN)-m.startSN,t=Math.min(y.endSN,m.endSN)-m.startSN,n=m.startSN-y.startSN,f=a;f<=t;f++){var v=y.fragments[n+f],x=m.fragments[f];if(!v||!x)break;u(v,x,f)}}function oe(y,m){var u=m.startSN-y.startSN,a=y.fragments,t=m.fragments;if(!(u<0||u>a.length))for(var n=0;n<t.length;n++)t[n].start+=a[u].start}function Le(y,m,u){var a=1e3*(m.averagetargetduration?m.averagetargetduration:m.targetduration),t=a/2;return y&&m.endSN===y.endSN&&(a=t),u&&(a=Math.max(t,a-(window.performance.now()-u))),Math.round(a)}var $e={toString:function(m){for(var u="",a=m.length,t=0;t<a;t++)u+="["+m.start(t).toFixed(3)+","+m.end(t).toFixed(3)+"]";return u}},Xe=$e;function Ze(y,m){for(var u=null,a=0;a<y.length;a+=1){var t=y[a];if(t&&t.cc===m){u=t;break}}return u}function ot(y,m){return K.search(y,function(u){return u.cc<m?1:u.cc>m?-1:0})}function ut(y,m,u){var a=!1;return m&&m.details&&u&&(u.endCC>u.startCC||y&&y.cc<u.startCC)&&(a=!0),a}function Lt(y,m){var u=y.fragments,a=m.fragments;if(!a.length||!u.length){p.logger.log("No fragments to align");return}var t=Ze(u,a[0].cc);if(!t||t&&!t.startPTS){p.logger.log("No frag in previous level to align on");return}return t}function bt(y,m){m.fragments.forEach(function(u){if(u){var a=u.start+y;u.start=u.startPTS=a,u.endPTS=a+u.duration}}),m.PTSKnown=!0}function ht(y,m,u){Ot(y,u,m),!u.PTSKnown&&m&&wt(u,m.details)}function Ot(y,m,u){if(ut(y,u,m)){var a=Lt(u.details,m);a&&(p.logger.log("Adjusting PTS using last level due to CC increase within current level"),bt(a.start,m))}}function wt(y,m){if(m&&m.fragments.length){if(!y.hasProgramDateTime||!m.hasProgramDateTime)return;var u=m.fragments[0].programDateTime,a=y.fragments[0].programDateTime,t=(a-u)/1e3+m.fragments[0].start;Object(g.isFiniteNumber)(t)&&(p.logger.log("adjusting PTS using programDateTime delta, sliding:"+t.toFixed(3)),bt(t,y))}}function Ft(y,m,u){if(m===null||!Array.isArray(y)||!y.length||!Object(g.isFiniteNumber)(m))return null;var a=y[0].programDateTime;if(m<(a||0))return null;var t=y[y.length-1].endProgramDateTime;if(m>=(t||0))return null;u=u||0;for(var n=0;n<y.length;++n){var f=y[n];if(rr(m,u,f))return f}return null}function St(y,m,u,a){u===void 0&&(u=0),a===void 0&&(a=0);var t=null;if(y?t=m[y.sn-m[0].sn+1]:u===0&&m[0].start===0&&(t=m[0]),t&&lt(u,a,t)===0)return t;var n=K.search(m,lt.bind(null,u,a));return n||t}function lt(y,m,u){y===void 0&&(y=0),m===void 0&&(m=0);var a=Math.min(m,u.duration+(u.deltaPTS?u.deltaPTS:0));return u.start+u.duration-a<=y?1:u.start-a>y&&u.start?-1:0}function rr(y,m,u){var a=Math.min(m,u.duration+(u.deltaPTS?u.deltaPTS:0))*1e3,t=u.endProgramDateTime||0;return t-a>y}var Zt=250,Ut=2,kt=.1,Qt=.05,it=function(){function y(u,a,t,n){this.config=u,this.media=a,this.fragmentTracker=t,this.hls=n,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var m=y.prototype;return m.poll=function(a){var t=this.config,n=this.media,f=this.stalled,v=n.currentTime,x=n.seeking,T=this.seeking&&!x,D=!this.seeking&&x;if(this.seeking=x,v!==a){if(this.moved=!0,f!==null){if(this.stallReported){var O=self.performance.now()-f;p.logger.warn("playback not stuck anymore @"+v+", after "+Math.round(O)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((D||T)&&(this.stalled=null),!(n.paused||n.ended||n.playbackRate===0||!n.buffered.length)){var F=B.bufferInfo(n,v,0),W=F.len>0,Q=F.nextStart||0;if(!(!W&&!Q)){if(x){var ve=F.len>Ut,Me=!Q||Q-v>Ut&&!this.fragmentTracker.getPartialFragment(v);if(ve||Me)return;this.moved=!1}if(!this.moved&&this.stalled){var Pe=Math.max(Q,F.start||0)-v;if(Pe>0&&Pe<=Ut){this._trySkipBufferHole(null);return}}var De=self.performance.now();if(f===null){this.stalled=De;return}var He=De-f;!x&&He>=Zt&&this._reportStall(F.len);var Ve=B.bufferInfo(n,v,t.maxBufferHole);this._tryFixBufferStall(Ve,He)}}},m._tryFixBufferStall=function(a,t){var n=this.config,f=this.fragmentTracker,v=this.media,x=v.currentTime,T=f.getPartialFragment(x);if(T){var D=this._trySkipBufferHole(T);if(D)return}a.len>n.maxBufferHole&&t>n.highBufferWatchdogPeriod*1e3&&(p.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},m._reportStall=function(a){var t=this.hls,n=this.media,f=this.stallReported;f||(this.stallReported=!0,p.logger.warn("Playback stalling at @"+n.currentTime+" due to low buffer (buffer="+a+")"),t.trigger(d.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:a}))},m._trySkipBufferHole=function(a){for(var t=this.config,n=this.hls,f=this.media,v=f.currentTime,x=0,T=0;T<f.buffered.length;T++){var D=f.buffered.start(T);if(v+t.maxBufferHole>=x&&v<D){var O=Math.max(D+Qt,f.currentTime+kt);return p.logger.warn("skipping hole, adjusting currentTime from "+v+" to "+O),this.moved=!0,this.stalled=null,f.currentTime=O,a&&n.trigger(d.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+v+" to "+O,frag:a}),O}x=f.buffered.end(T)}return 0},m._tryNudgeBuffer=function(){var a=this.config,t=this.hls,n=this.media,f=n.currentTime,v=(this.nudgeRetry||0)+1;if(this.nudgeRetry=v,v<a.nudgeMaxRetry){var x=f+v*a.nudgeOffset;p.logger.warn("Nudging 'currentTime' from "+f+" to "+x),n.currentTime=x,t.trigger(d.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else p.logger.error("Playhead still not moving while enough data buffered @"+f+" after "+a.nudgeMaxRetry+" nudges"),t.trigger(d.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},y}();function Ge(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function st(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var ct=function(y){st(m,y);function m(a){for(var t,n=arguments.length,f=new Array(n>1?n-1:0),v=1;v<n;v++)f[v-1]=arguments[v];return t=y.call.apply(y,[this,a].concat(f))||this,t._boundTick=void 0,t._tickTimer=null,t._tickInterval=null,t._tickCallCount=0,t._boundTick=t.tick.bind(Ge(t)),t}var u=m.prototype;return u.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},u.hasInterval=function(){return!!this._tickInterval},u.hasNextTick=function(){return!!this._tickTimer},u.setInterval=function(t){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,t),!0)},u.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},u.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},u.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},u.doTick=function(){},m}(S);function gt(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var te={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},vt=function(y){gt(m,y);function m(){return y.apply(this,arguments)||this}var u=m.prototype;return u.doTick=function(){},u.startLoad=function(){},u.stopLoad=function(){var t=this.fragCurrent;t&&(t.loader&&t.loader.abort(),this.fragmentTracker.removeFragment(t)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=te.STOPPED},u._streamEnded=function(t,n){var f=this.fragCurrent,v=this.fragmentTracker;if(!n.live&&f&&!f.backtracked&&f.sn===n.endSN&&!t.nextStart){var x=v.getState(f);return x===nt.PARTIAL||x===nt.OK}return!1},u.onMediaSeeking=function(){var t=this.config,n=this.media,f=this.mediaBuffer,v=this.state,x=n?n.currentTime:null,T=B.bufferInfo(f||n,x,this.config.maxBufferHole);if(p.logger.log("media seeking to "+(Object(g.isFiniteNumber)(x)?x.toFixed(3):x)),v===te.FRAG_LOADING){var D=this.fragCurrent;if(T.len===0&&D){var O=t.maxFragLookUpTolerance,F=D.start-O,W=D.start+D.duration+O;x<F||x>W?(D.loader&&(p.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),D.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=te.IDLE):p.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else v===te.ENDED&&(T.len===0&&(this.fragPrevious=null,this.fragCurrent=null),this.state=te.IDLE);n&&(this.lastCurrentTime=x),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=x),this.tick()},u.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},u.onHandlerDestroying=function(){this.stopLoad(),y.prototype.onHandlerDestroying.call(this)},u.onHandlerDestroyed=function(){this.state=te.STOPPED,this.fragmentTracker=null},u.computeLivePosition=function(t,n){var f=this.config.liveSyncDuration!==void 0?this.config.liveSyncDuration:this.config.liveSyncDurationCount*n.targetduration;return t+Math.max(0,n.totalduration-f)},m}(ct);function Ht(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function qt(y,m,u){return m&&Ht(y.prototype,m),y}function Vt(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var ur=100,br=function(y){Vt(m,y);function m(a,t){var n;return n=y.call(this,a,d.default.MEDIA_ATTACHED,d.default.MEDIA_DETACHING,d.default.MANIFEST_LOADING,d.default.MANIFEST_PARSED,d.default.LEVEL_LOADED,d.default.LEVELS_UPDATED,d.default.KEY_LOADED,d.default.FRAG_LOADED,d.default.FRAG_LOAD_EMERGENCY_ABORTED,d.default.FRAG_PARSING_INIT_SEGMENT,d.default.FRAG_PARSING_DATA,d.default.FRAG_PARSED,d.default.ERROR,d.default.AUDIO_TRACK_SWITCHING,d.default.AUDIO_TRACK_SWITCHED,d.default.BUFFER_CREATED,d.default.BUFFER_APPENDED,d.default.BUFFER_FLUSHED)||this,n.fragmentTracker=t,n.config=a.config,n.audioCodecSwap=!1,n._state=te.STOPPED,n.stallReported=!1,n.gapController=null,n.altAudio=!1,n.audioOnly=!1,n.bitrateTest=!1,n}var u=m.prototype;return u.startLoad=function(t){if(this.levels){var n=this.lastCurrentTime,f=this.hls;if(this.stopLoad(),this.setInterval(ur),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var v=f.startLevel;v===-1&&(f.config.testBandwidth?(v=0,this.bitrateTest=!0):v=f.nextAutoLevel),this.level=f.nextLoadLevel=v,this.loadedmetadata=!1}n>0&&t===-1&&(p.logger.log("override startPosition with lastCurrentTime @"+n.toFixed(3)),t=n),this.state=te.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this.forceStartLoad=!0,this.state=te.STOPPED},u.stopLoad=function(){this.forceStartLoad=!1,y.prototype.stopLoad.call(this)},u.doTick=function(){switch(this.state){case te.BUFFER_FLUSHING:this.fragLoadError=0;break;case te.IDLE:this._doTickIdle();break;case te.WAITING_LEVEL:var t=this.levels[this.level];t&&t.details&&(this.state=te.IDLE);break;case te.FRAG_LOADING_WAITING_RETRY:var n=window.performance.now(),f=this.retryDate;(!f||n>=f||this.media&&this.media.seeking)&&(p.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=te.IDLE);break}this._checkBuffer(),this._checkFragmentChanged()},u._doTickIdle=function(){var t=this.hls,n=t.config,f=this.media;if(!(this.levelLastLoaded===void 0||!f&&(this.startFragRequested||!n.startFragPrefetch))){if(this.altAudio&&this.audioOnly){this.demuxer.frag=null;return}var v;this.loadedmetadata?v=f.currentTime:v=this.nextLoadPosition;var x=t.nextLoadLevel,T=this.levels[x];if(T){var D=T.bitrate,O;D?O=Math.max(8*n.maxBufferSize/D,n.maxBufferLength):O=n.maxBufferLength,O=Math.min(O,n.maxMaxBufferLength);var F=v<n.maxBufferHole?Math.max(Ut,n.maxBufferHole):n.maxBufferHole,W=B.bufferInfo(this.mediaBuffer?this.mediaBuffer:f,v,F),Q=W.len;if(!(Q>=O)){p.logger.trace("buffer length of "+Q.toFixed(3)+" is below max of "+O.toFixed(3)+". checking for more payload ..."),this.level=t.nextLoadLevel=x;var ve=T.details;if(!ve||ve.live&&this.levelLastLoaded!==x){this.state=te.WAITING_LEVEL;return}if(this._streamEnded(W,ve)){var Me={};this.altAudio&&(Me.type="video"),this.hls.trigger(d.default.BUFFER_EOS,Me),this.state=te.ENDED;return}this._fetchPayloadOrEos(v,W,ve)}}}},u._fetchPayloadOrEos=function(t,n,f){var v=this.fragPrevious;this.level;var x=f.fragments,T=x.length;if(T!==0){var D=x[0].start,O=x[T-1].start+x[T-1].duration,F=n.end,W;if(f.initSegment&&!f.initSegment.data)W=f.initSegment;else if(f.live){var Q=this.config.initialLiveManifestSize;if(T<Q){p.logger.warn("Can not start playback of a level, reason: not enough fragments "+T+" < "+Q);return}if(W=this._ensureFragmentAtLivePoint(f,F,D,O,v,x),W===null)return}else F<D&&(W=x[0]);W||(W=this._findFragment(D,v,T,x,F,O,f)),W&&(W.encrypted?this._loadKey(W,f):this._loadFragment(W,f,t,F))}},u._ensureFragmentAtLivePoint=function(t,n,f,v,x,T){var D=this.hls.config,O=this.media,F,W=1/0;if(D.liveMaxLatencyDuration!==void 0?W=D.liveMaxLatencyDuration:Object(g.isFiniteNumber)(D.liveMaxLatencyDurationCount)&&(W=D.liveMaxLatencyDurationCount*t.targetduration),n<Math.max(f-D.maxFragLookUpTolerance,v-W)){var Q=this.liveSyncPosition=this.computeLivePosition(f,t);n=Q,O&&!O.paused&&O.readyState&&O.duration>Q&&Q>O.currentTime&&(p.logger.log("buffer end: "+n.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+Q.toFixed(3)),O.currentTime=Q),this.nextLoadPosition=Q}if(t.PTSKnown&&n>v&&O&&O.readyState)return null;if(this.startFragRequested&&!t.PTSKnown&&x)if(t.hasProgramDateTime)p.logger.log("live playlist, switching playlist, load frag with same PDT: "+x.programDateTime),F=Ft(T,x.endProgramDateTime,D.maxFragLookUpTolerance);else{var ve=x.sn+1;if(ve>=t.startSN&&ve<=t.endSN){var Me=T[ve-t.startSN];x.cc===Me.cc&&(F=Me,p.logger.log("live playlist, switching playlist, load frag with next SN: "+F.sn))}F||(F=K.search(T,function(Pe){return x.cc-Pe.cc}),F&&p.logger.log("live playlist, switching playlist, load frag with same CC: "+F.sn))}return F},u._findFragment=function(t,n,f,v,x,T,D){var O=this.hls.config,F;if(x<T){var W=x>T-O.maxFragLookUpTolerance?0:O.maxFragLookUpTolerance;F=St(n,v,x,W)}else F=v[f-1];if(F){var Q=F.sn-D.startSN,ve=n&&F.level===n.level,Me=v[Q-1],Pe=v[Q+1];if(n&&F.sn===n.sn)if(ve&&!F.backtracked)if(F.sn<D.endSN){var De=n.deltaPTS;De&&De>O.maxBufferHole&&n.dropped&&Q?(F=Me,p.logger.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):(F=Pe,this.fragmentTracker.getState(F)!==nt.OK&&p.logger.log("Re-loading fragment with SN: "+F.sn))}else F=null;else F.backtracked&&(Pe&&Pe.backtracked?(p.logger.warn("Already backtracked from fragment "+Pe.sn+", will not backtrack to fragment "+F.sn+". Loading fragment "+Pe.sn),F=Pe):(p.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),F.dropped=0,Me?(F=Me,F.backtracked=!0):Q&&(F=null)))}return F},u._loadKey=function(t,n){p.logger.log("Loading key for "+t.sn+" of ["+n.startSN+"-"+n.endSN+"], level "+this.level),this.state=te.KEY_LOADING,this.hls.trigger(d.default.KEY_LOADING,{frag:t})},u._loadFragment=function(t,n,f,v){var x=this.fragmentTracker.getState(t);this.fragCurrent=t,t.sn!=="initSegment"&&(this.startFragRequested=!0),Object(g.isFiniteNumber)(t.sn)&&!t.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),t.backtracked||x===nt.NOT_LOADED||x===nt.PARTIAL?(t.autoLevel=this.hls.autoLevelEnabled,t.bitrateTest=this.bitrateTest,p.logger.log("Loading "+t.sn+" of ["+n.startSN+"-"+n.endSN+"], level "+this.level+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+parseFloat(f.toFixed(3))+", bufferEnd: "+parseFloat(v.toFixed(3))),this.hls.trigger(d.default.FRAG_LOADING,{frag:t}),this.demuxer||(this.demuxer=new se(this.hls,"main")),this.state=te.FRAG_LOADING):x===nt.APPENDING&&this._reduceMaxBufferLength(t.duration)&&this.fragmentTracker.removeFragment(t)},u.getBufferedFrag=function(t){return this.fragmentTracker.getBufferedFrag(t,b.MAIN)},u.followingBufferedFrag=function(t){return t?this.getBufferedFrag(t.endPTS+.5):null},u._checkFragmentChanged=function(){var t,n,f=this.media;if(f&&f.readyState&&f.seeking===!1&&(n=f.currentTime,n>this.lastCurrentTime&&(this.lastCurrentTime=n),B.isBuffered(f,n)?t=this.getBufferedFrag(n):B.isBuffered(f,n+.1)&&(t=this.getBufferedFrag(n+.1)),t)){var v=t;if(v!==this.fragPlaying){this.hls.trigger(d.default.FRAG_CHANGED,{frag:v});var x=v.level;(!this.fragPlaying||this.fragPlaying.level!==x)&&this.hls.trigger(d.default.LEVEL_SWITCHED,{level:x}),this.fragPlaying=v}}},u.immediateLevelSwitch=function(){if(p.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var t=this.media,n;t?(n=t.paused,n||t.pause()):n=!0,this.previouslyPaused=n}var f=this.fragCurrent;f&&f.loader&&f.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},u.immediateLevelSwitchEnd=function(){var t=this.media;t&&t.buffered.length&&(this.immediateSwitch=!1,t.currentTime>0&&B.isBuffered(t,t.currentTime)&&(t.currentTime-=1e-4),this.previouslyPaused||t.play())},u.nextLevelSwitch=function(){var t=this.media;if(t&&t.readyState){var n,f=this.getBufferedFrag(t.currentTime);if(f&&f.startPTS>1&&this.flushMainBuffer(0,f.startPTS-1),t.paused)n=0;else{var v=this.hls.nextLoadLevel,x=this.levels[v],T=this.fragLastKbps;T&&this.fragCurrent?n=this.fragCurrent.duration*x.bitrate/(1e3*T)+1:n=0}var D=this.getBufferedFrag(t.currentTime+n);if(D){var O=this.followingBufferedFrag(D);if(O){var F=this.fragCurrent;F&&F.loader&&F.loader.abort(),this.fragCurrent=null;var W=Math.max(D.endPTS,O.maxStartPTS+Math.min(this.config.maxFragLookUpTolerance,O.duration));this.flushMainBuffer(W,Number.POSITIVE_INFINITY)}}}},u.flushMainBuffer=function(t,n){this.state=te.BUFFER_FLUSHING;var f={startOffset:t,endOffset:n};this.altAudio&&(f.type="video"),this.hls.trigger(d.default.BUFFER_FLUSHING,f)},u.onMediaAttached=function(t){var n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("seeked",this.onvseeked),n.addEventListener("ended",this.onvended);var f=this.config;this.levels&&f.autoStartLoad&&this.hls.startLoad(f.startPosition),this.gapController=new it(f,n,this.fragmentTracker,this.hls)},u.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(p.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var n=this.levels;n&&n.forEach(function(f){f.details&&f.details.fragments.forEach(function(v){v.backtracked=void 0})}),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("seeked",this.onvseeked),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},u.onMediaSeeked=function(){var t=this.media,n=t?t.currentTime:void 0;Object(g.isFiniteNumber)(n)&&p.logger.log("media seeked to "+n.toFixed(3)),this.tick()},u.onManifestLoading=function(){p.logger.log("trigger BUFFER_RESET"),this.hls.trigger(d.default.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},u.onManifestParsed=function(t){var n=!1,f=!1,v;t.levels.forEach(function(T){v=T.audioCodec,v&&(v.indexOf("mp4a.40.2")!==-1&&(n=!0),v.indexOf("mp4a.40.5")!==-1&&(f=!0))}),this.audioCodecSwitch=n&&f,this.audioCodecSwitch&&p.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=t.altAudio,this.levels=t.levels,this.startFragRequested=!1;var x=this.config;(x.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(x.startPosition)},u.onLevelLoaded=function(t){var n=t.details,f=t.level,v=this.levels[this.levelLastLoaded],x=this.levels[f],T=n.totalduration,D=0;if(p.logger.log("level "+f+" loaded ["+n.startSN+","+n.endSN+"],duration:"+T),n.live||x.details&&x.details.live){var O=x.details;O&&n.fragments.length>0?(ke(O,n),D=n.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(D,O),n.PTSKnown&&Object(g.isFiniteNumber)(D)?p.logger.log("live playlist sliding:"+D.toFixed(3)):(p.logger.log("live playlist - outdated PTS, unknown sliding"),ht(this.fragPrevious,v,n))):(p.logger.log("live playlist - first load, unknown sliding"),n.PTSKnown=!1,ht(this.fragPrevious,v,n))}else n.PTSKnown=!1;if(x.details=n,this.levelLastLoaded=f,this.hls.trigger(d.default.LEVEL_UPDATED,{details:n,level:f}),this.startFragRequested===!1){if(this.startPosition===-1||this.lastCurrentTime===-1){var F=n.startTimeOffset;Object(g.isFiniteNumber)(F)?(F<0&&(p.logger.log("negative start time offset "+F+", count from end of last fragment"),F=D+T+F),p.logger.log("start time offset found in playlist, adjust startPosition to "+F),this.startPosition=F):n.live?(this.startPosition=this.computeLivePosition(D,n),p.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===te.WAITING_LEVEL&&(this.state=te.IDLE),this.tick()},u.onKeyLoaded=function(){this.state===te.KEY_LOADING&&(this.state=te.IDLE,this.tick())},u.onFragLoaded=function(t){var n=this.fragCurrent,f=this.hls,v=this.levels,x=this.media,T=t.frag;if(this.state===te.FRAG_LOADING&&n&&T.type==="main"&&T.level===n.level&&T.sn===n.sn){var D=t.stats,O=v[n.level],F=O.details;if(this.bitrateTest=!1,this.stats=D,p.logger.log("Loaded "+n.sn+" of ["+F.startSN+" ,"+F.endSN+"],level "+n.level),T.bitrateTest&&f.nextLoadLevel)this.state=te.IDLE,this.startFragRequested=!1,D.tparsed=D.tbuffered=window.performance.now(),f.trigger(d.default.FRAG_BUFFERED,{stats:D,frag:n,id:"main"}),this.tick();else if(T.sn==="initSegment")this.state=te.IDLE,D.tparsed=D.tbuffered=window.performance.now(),F.initSegment.data=t.payload,f.trigger(d.default.FRAG_BUFFERED,{stats:D,frag:n,id:"main"}),this.tick();else{p.logger.log("Parsing "+n.sn+" of ["+F.startSN+" ,"+F.endSN+"],level "+n.level+", cc "+n.cc),this.state=te.PARSING,this.pendingBuffering=!0,this.appended=!1,T.bitrateTest&&(T.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:T}));var W=!(x&&x.seeking)&&(F.PTSKnown||!F.live),Q=F.initSegment?F.initSegment.data:[],ve=this._getAudioCodec(O),Me=this.demuxer=this.demuxer||new se(this.hls,"main");Me.push(t.payload,Q,ve,O.videoCodec,n,F.totalduration,W)}}this.fragLoadError=0},u.onFragParsingInitSegment=function(t){var n=this.fragCurrent,f=t.frag;if(n&&t.id==="main"&&f.sn===n.sn&&f.level===n.level&&this.state===te.PARSING){var v=t.tracks,x,T;if(this.audioOnly=v.audio&&!v.video,this.altAudio&&!this.audioOnly&&delete v.audio,T=v.audio,T){var D=this.levels[this.level].audioCodec,O=navigator.userAgent.toLowerCase();D&&this.audioCodecSwap&&(p.logger.log("swapping playlist audio codec"),D.indexOf("mp4a.40.5")!==-1?D="mp4a.40.2":D="mp4a.40.5"),this.audioCodecSwitch&&T.metadata.channelCount!==1&&O.indexOf("firefox")===-1&&(D="mp4a.40.5"),O.indexOf("android")!==-1&&T.container!=="audio/mpeg"&&(D="mp4a.40.2",p.logger.log("Android: force audio codec to "+D)),T.levelCodec=D,T.id=t.id}T=v.video,T&&(T.levelCodec=this.levels[this.level].videoCodec,T.id=t.id),this.hls.trigger(d.default.BUFFER_CODECS,v);for(x in v){T=v[x],p.logger.log("main track:"+x+",container:"+T.container+",codecs[level/parsed]=["+T.levelCodec+"/"+T.codec+"]");var F=T.initSegment;F&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(d.default.BUFFER_APPENDING,{type:x,data:F,parent:"main",content:"initSegment"}))}this.tick()}},u.onFragParsingData=function(t){var n=this,f=this.fragCurrent,v=t.frag;if(f&&t.id==="main"&&v.sn===f.sn&&v.level===f.level&&!(t.type==="audio"&&this.altAudio)&&this.state===te.PARSING){var x=this.levels[this.level],T=f;if(Object(g.isFiniteNumber)(t.endPTS)||(t.endPTS=t.startPTS+f.duration,t.endDTS=t.startDTS+f.duration),t.hasAudio===!0&&T.addElementaryStream(G.AUDIO),t.hasVideo===!0&&T.addElementaryStream(G.VIDEO),p.logger.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),t.type==="video")if(T.dropped=t.dropped,T.dropped)if(T.backtracked)p.logger.warn("Already backtracked on this fragment, appending with the gap",T.sn);else{var D=x.details;if(D&&T.sn===D.startSN)p.logger.warn("missing video frame(s) on first frag, appending with gap",T.sn);else{p.logger.warn("missing video frame(s), backtracking fragment",T.sn),this.fragmentTracker.removeFragment(T),T.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=te.IDLE,this.fragPrevious=T,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.tick();return}}else T.backtracked=!1;var O=ue(x.details,T,t.startPTS,t.endPTS,t.startDTS,t.endDTS),F=this.hls;F.trigger(d.default.LEVEL_PTS_UPDATED,{details:x.details,level:this.level,drift:O,type:t.type,start:t.startPTS,end:t.endPTS}),[t.data1,t.data2].forEach(function(W){W&&W.length&&n.state===te.PARSING&&(n.appended=!0,n.pendingBuffering=!0,F.trigger(d.default.BUFFER_APPENDING,{type:t.type,data:W,parent:"main",content:"data"}))}),this.tick()}},u.onFragParsed=function(t){var n=this.fragCurrent,f=t.frag;n&&t.id==="main"&&f.sn===n.sn&&f.level===n.level&&this.state===te.PARSING&&(this.stats.tparsed=window.performance.now(),this.state=te.PARSED,this._checkAppendedParsed())},u.onAudioTrackSwitching=function(t){var n=this.altAudio,f=!!t.url,v=t.id;if(!f){if(this.mediaBuffer!==this.media){p.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var x=this.fragCurrent;x.loader&&(p.logger.log("switching to main audio track, cancel main fragment load"),x.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=te.IDLE}var T=this.hls;n&&T.trigger(d.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),T.trigger(d.default.AUDIO_TRACK_SWITCHED,{id:v})}},u.onAudioTrackSwitched=function(t){var n=t.id,f=!!this.hls.audioTracks[n].url;if(f){var v=this.videoBuffer;v&&this.mediaBuffer!==v&&(p.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=v)}this.altAudio=f,this.tick()},u.onBufferCreated=function(t){var n=t.tracks,f,v,x=!1;for(var T in n){var D=n[T];D.id==="main"?(v=T,f=D,T==="video"&&(this.videoBuffer=n[T].buffer)):x=!0}x&&f?(p.logger.log("alternate track found, use "+v+".buffered to schedule main fragment loading"),this.mediaBuffer=f.buffer):this.mediaBuffer=this.media},u.onBufferAppended=function(t){if(t.parent==="main"){var n=this.state;(n===te.PARSING||n===te.PARSED)&&(this.pendingBuffering=t.pending>0,this._checkAppendedParsed())}},u._checkAppendedParsed=function(){if(this.state===te.PARSED&&(!this.appended||!this.pendingBuffering)){var t=this.fragCurrent;if(t){var n=this.mediaBuffer?this.mediaBuffer:this.media;p.logger.log("main buffered : "+Xe.toString(n.buffered)),this.fragPrevious=t;var f=this.stats;f.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*f.total/(f.tbuffered-f.tfirst)),this.hls.trigger(d.default.FRAG_BUFFERED,{stats:f,frag:t,id:"main"}),this.state=te.IDLE}(this.loadedmetadata||this.startPosition<=0)&&this.tick()}},u.onError=function(t){var n=t.frag||this.fragCurrent;if(!(n&&n.type!=="main")){var f=!!this.media&&B.isBuffered(this.media,this.media.currentTime)&&B.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case h.ErrorDetails.FRAG_LOAD_ERROR:case h.ErrorDetails.FRAG_LOAD_TIMEOUT:case h.ErrorDetails.KEY_LOAD_ERROR:case h.ErrorDetails.KEY_LOAD_TIMEOUT:if(!t.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var v=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);p.logger.warn("mediaController: frag loading failed, retry in "+v+" ms"),this.retryDate=window.performance.now()+v,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=te.FRAG_LOADING_WAITING_RETRY}else p.logger.error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=te.ERROR;break;case h.ErrorDetails.LEVEL_LOAD_ERROR:case h.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==te.ERROR&&(t.fatal?(this.state=te.ERROR,p.logger.warn("streamController: "+t.details+",switch to "+this.state+" state ...")):!t.levelRetry&&this.state===te.WAITING_LEVEL&&(this.state=te.IDLE));break;case h.ErrorDetails.BUFFER_FULL_ERROR:t.parent==="main"&&(this.state===te.PARSING||this.state===te.PARSED)&&(f?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=te.IDLE):(p.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)));break}}},u._reduceMaxBufferLength=function(t){var n=this.config;return n.maxMaxBufferLength>=t?(n.maxMaxBufferLength/=2,p.logger.warn("main:reduce max buffer length to "+n.maxMaxBufferLength+"s"),!0):!1},u._checkBuffer=function(){var t=this.media;if(!(!t||t.readyState===0)){var n=this.mediaBuffer?this.mediaBuffer:t,f=n.buffered;!this.loadedmetadata&&f.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,f)}},u.onFragLoadEmergencyAborted=function(){this.state=te.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},u.onBufferFlushed=function(){var t=this.mediaBuffer?this.mediaBuffer:this.media;if(t){var n=this.audioOnly?G.AUDIO:G.VIDEO;this.fragmentTracker.detectEvictedFragments(n,t.buffered)}this.state=te.IDLE,this.fragPrevious=null},u.onLevelsUpdated=function(t){this.levels=t.levels},u.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},u._seekToStartPos=function(){var t=this.media,n=t.currentTime,f=this.startPosition;if(n!==f&&f>=0){if(t.seeking){p.logger.log("could not seek to "+f+", already seeking at "+n);return}var v=t.buffered.length?t.buffered.start(0):0,x=v-f;x>0&&x<this.config.maxBufferHole&&(p.logger.log("adjusting start position by "+x+" to match buffer start"),f+=x,this.startPosition=f),p.logger.log("seek to target start position "+f+" from current time "+n+". ready state "+t.readyState),t.currentTime=f}},u._getAudioCodec=function(t){var n=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&(p.logger.log("swapping playlist audio codec"),n&&(n.indexOf("mp4a.40.5")!==-1?n="mp4a.40.2":n="mp4a.40.5")),n},qt(m,[{key:"state",set:function(t){if(this.state!==t){var n=this.state;this._state=t,p.logger.log("main stream-controller: "+n+"->"+t),this.hls.trigger(d.default.STREAM_STATE_TRANSITION,{previousState:n,nextState:t})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var t=this.media;if(t){var n=this.getBufferedFrag(t.currentTime);if(n)return n.level}return-1}},{key:"nextBufferedFrag",get:function(){var t=this.media;return t?this.followingBufferedFrag(this.getBufferedFrag(t.currentTime)):null}},{key:"nextLevel",get:function(){var t=this.nextBufferedFrag;return t?t.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(t){this._liveSyncPosition=t}}]),m}(vt),Kr=br;function li(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function dn(y,m,u){return m&&li(y.prototype,m),y}function Cn(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var Ir,ui=function(y){Cn(m,y);function m(a){var t;return t=y.call(this,a,d.default.MANIFEST_LOADED,d.default.LEVEL_LOADED,d.default.AUDIO_TRACK_SWITCHED,d.default.FRAG_LOADED,d.default.ERROR)||this,t.canload=!1,t.currentLevelIndex=null,t.manualLevelIndex=-1,t.timer=null,Ir=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),t}var u=m.prototype;return u.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},u.clearTimer=function(){this.timer!==null&&(clearTimeout(this.timer),this.timer=null)},u.startLoad=function(){var t=this._levels;this.canload=!0,this.levelRetryCount=0,t&&t.forEach(function(n){n.loadError=0;var f=n.details;f&&f.live&&(n.details=void 0)}),this.timer!==null&&this.loadLevel()},u.stopLoad=function(){this.canload=!1},u.onManifestLoaded=function(t){var n=[],f=[],v,x={},T=null,D=!1,O=!1;if(t.levels.forEach(function(Q){var ve=Q.attrs;Q.loadError=0,Q.fragmentError=!1,D=D||!!Q.videoCodec,O=O||!!Q.audioCodec,Ir&&Q.audioCodec&&Q.audioCodec.indexOf("mp4a.40.34")!==-1&&(Q.audioCodec=void 0),T=x[Q.bitrate],T?T.url.push(Q.url):(Q.url=[Q.url],Q.urlId=0,x[Q.bitrate]=Q,n.push(Q)),ve&&(ve.AUDIO&&ce(T||Q,"audio",ve.AUDIO),ve.SUBTITLES&&ce(T||Q,"text",ve.SUBTITLES))}),D&&O&&(n=n.filter(function(Q){var ve=Q.videoCodec;return!!ve})),n=n.filter(function(Q){var ve=Q.audioCodec,Me=Q.videoCodec;return(!ve||pe(ve,"audio"))&&(!Me||pe(Me,"video"))}),t.audioTracks&&(f=t.audioTracks.filter(function(Q){return!Q.audioCodec||pe(Q.audioCodec,"audio")}),f.forEach(function(Q,ve){Q.id=ve})),n.length>0){v=n[0].bitrate,n.sort(function(Q,ve){return Q.bitrate-ve.bitrate}),this._levels=n;for(var F=0;F<n.length;F++)if(n[F].bitrate===v){this._firstLevel=F,p.logger.log("manifest loaded,"+n.length+" level(s) found, first bitrate:"+v);break}var W=O&&!D;this.hls.trigger(d.default.MANIFEST_PARSED,{levels:n,audioTracks:f,firstLevel:this._firstLevel,stats:t.stats,audio:O,video:D,altAudio:!W&&f.some(function(Q){return!!Q.url})})}else this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},u.setLevelInternal=function(t){var n=this._levels,f=this.hls;if(t>=0&&t<n.length){if(this.clearTimer(),this.currentLevelIndex!==t){p.logger.log("switching to level "+t),this.currentLevelIndex=t;var v=n[t];v.level=t,f.trigger(d.default.LEVEL_SWITCHING,v)}var x=n[t],T=x.details;if(!T||T.live){var D=x.urlId;f.trigger(d.default.LEVEL_LOADING,{url:x.url[D],level:t,id:D})}}else f.trigger(d.default.ERROR,{type:h.ErrorTypes.OTHER_ERROR,details:h.ErrorDetails.LEVEL_SWITCH_ERROR,level:t,fatal:!1,reason:"invalid level idx"})},u.onError=function(t){if(t.fatal){t.type===h.ErrorTypes.NETWORK_ERROR&&this.clearTimer();return}var n=!1,f=!1,v;switch(t.details){case h.ErrorDetails.FRAG_LOAD_ERROR:case h.ErrorDetails.FRAG_LOAD_TIMEOUT:case h.ErrorDetails.KEY_LOAD_ERROR:case h.ErrorDetails.KEY_LOAD_TIMEOUT:v=t.frag.level,f=!0;break;case h.ErrorDetails.LEVEL_LOAD_ERROR:case h.ErrorDetails.LEVEL_LOAD_TIMEOUT:v=t.context.level,n=!0;break;case h.ErrorDetails.REMUX_ALLOC_ERROR:v=t.level,n=!0;break}v!==void 0&&this.recoverLevel(t,v,n,f)},u.recoverLevel=function(t,n,f,v){var x=this,T=this.hls.config,D=t.details,O=this._levels[n],F,W,Q;if(O.loadError++,O.fragmentError=v,f)if(this.levelRetryCount+1<=T.levelLoadingMaxRetry)W=Math.min(Math.pow(2,this.levelRetryCount)*T.levelLoadingRetryDelay,T.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return x.loadLevel()},W),t.levelRetry=!0,this.levelRetryCount++,p.logger.warn("level controller, "+D+", retry in "+W+" ms, current retry count is "+this.levelRetryCount);else{p.logger.error("level controller, cannot recover from "+D+" error"),this.currentLevelIndex=null,this.clearTimer(),t.fatal=!0;return}(f||v)&&(F=O.url.length,F>1&&O.loadError<F?(O.urlId=(O.urlId+1)%F,O.details=void 0,p.logger.warn("level controller, "+D+" for level "+n+": switching to redundant URL-id "+O.urlId)):this.manualLevelIndex===-1?(Q=n===0?this._levels.length-1:n-1,p.logger.warn("level controller, "+D+": switch to "+Q),this.hls.nextAutoLevel=this.currentLevelIndex=Q):v&&(p.logger.warn("level controller, "+D+": reload a fragment"),this.currentLevelIndex=null))},u.onFragLoaded=function(t){var n=t.frag;if(n!==void 0&&n.type==="main"){var f=this._levels[n.level];f!==void 0&&(f.fragmentError=!1,f.loadError=0,this.levelRetryCount=0)}},u.onLevelLoaded=function(t){var n=this,f=t.level,v=t.details;if(f===this.currentLevelIndex){var x=this._levels[f];if(x.fragmentError||(x.loadError=0,this.levelRetryCount=0),v.live){var T=Le(x.details,v,t.stats.trequest);p.logger.log("live playlist, reload in "+Math.round(T)+" ms"),this.timer=setTimeout(function(){return n.loadLevel()},T)}else this.clearTimer()}},u.onAudioTrackSwitched=function(t){var n=this.hls.audioTracks[t.id].groupId,f=this.hls.levels[this.currentLevelIndex];if(f&&f.audioGroupIds){for(var v=-1,x=0;x<f.audioGroupIds.length;x++)if(f.audioGroupIds[x]===n){v=x;break}v!==f.urlId&&(f.urlId=v,this.startLoad())}},u.loadLevel=function(){if(p.logger.debug("call to loadLevel"),this.currentLevelIndex!==null&&this.canload){var t=this._levels[this.currentLevelIndex];if(typeof t=="object"&&t.url.length>0){var n=this.currentLevelIndex,f=t.urlId,v=t.url[f];p.logger.log("Attempt loading level index "+n+" with URL-id "+f),this.hls.trigger(d.default.LEVEL_LOADING,{url:v,level:n,id:f})}}},u.removeLevel=function(t,n){var f=this.levels.filter(function(v,x){return x!==t?!0:v.url.length>1&&n!==void 0?(v.url=v.url.filter(function(T,D){return D!==n}),v.urlId=0,!0):!1}).map(function(v,x){var T=v.details;return T&&T.fragments&&T.fragments.forEach(function(D){D.level=x}),v});this._levels=f,this.hls.trigger(d.default.LEVELS_UPDATED,{levels:f})},dn(m,[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(t){var n=this._levels;n&&(t=Math.min(t,n.length-1),(this.currentLevelIndex!==t||!n[t].details)&&this.setLevelInternal(t))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(t){this.manualLevelIndex=t,this._startLevel===void 0&&(this._startLevel=t),t!==-1&&(this.level=t)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(t){this._firstLevel=t}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var t=this.hls.config.startLevel;return t!==void 0?t:this._firstLevel}else return this._startLevel},set:function(t){this._startLevel=t}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(t){this.level=t,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=t)}}]),m}(S),fn=l("./src/demux/id3.js");function Wr(y,m){var u;try{u=new Event("addtrack")}catch{u=document.createEvent("Event"),u.initEvent("addtrack",!1,!1)}u.track=y,m.dispatchEvent(u)}function Pr(y){if(y?.cues)for(;y.cues.length>0;)y.removeCue(y.cues[0])}function In(y,m){if(m<y[0].endTime)return y[0];if(m>y[y.length-1].endTime)return y[y.length-1];for(var u=0,a=y.length-1;u<=a;){var t=Math.floor((a+u)/2);if(m<y[t].endTime)a=t-1;else if(m>y[t].endTime)u=t+1;else return y[t]}return y[u].endTime-m<m-y[a].endTime?y[u]:y[a]}function Pn(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var Xr=.25,hn=function(y){Pn(m,y);function m(a){var t;return t=y.call(this,a,d.default.MEDIA_ATTACHED,d.default.MEDIA_DETACHING,d.default.FRAG_PARSING_METADATA,d.default.LIVE_BACK_BUFFER_REACHED)||this,t.id3Track=void 0,t.media=void 0,t}var u=m.prototype;return u.destroy=function(){S.prototype.destroy.call(this)},u.onMediaAttached=function(t){this.media=t.media,this.media},u.onMediaDetaching=function(){Pr(this.id3Track),this.id3Track=void 0,this.media=void 0},u.getID3Track=function(t){for(var n=0;n<t.length;n++){var f=t[n];if(f.kind==="metadata"&&f.label==="id3")return Wr(f,this.media),f}return this.media.addTextTrack("metadata","id3")},u.onFragParsingMetadata=function(t){var n=t.frag,f=t.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var v=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,x=0;x<f.length;x++){var T=fn.default.getID3Frames(f[x].data);if(T){var D=Math.max(f[x].pts,0),O=x<f.length-1?f[x+1].pts:n.endPTS;O||(O=n.start+n.duration);var F=O-D;F<=0&&(O=D+Xr);for(var W=0;W<T.length;W++){var Q=T[W];if(!fn.default.isTimeStampFrame(Q)){var ve=new v(D,O,"");ve.value=Q,this.id3Track.addCue(ve)}}}}},u.onLiveBackBufferReached=function(t){var n=t.bufferEnd,f=this.id3Track;if(!(!f||!f.cues||!f.cues.length)){var v=In(f.cues,n);if(v)for(;f.cues[0]!==v;)f.removeCue(f.cues[0])}},m}(S),ci=hn;function di(){var y=H();if(!y)return!1;var m=self.SourceBuffer||self.WebKitSourceBuffer,u=y&&typeof y.isTypeSupported=="function"&&y.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),a=!m||m.prototype&&typeof m.prototype.appendBuffer=="function"&&typeof m.prototype.remove=="function";return!!u&&!!a}var Go=function(){function y(u){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=u?Math.exp(Math.log(.5)/u):0,this.estimate_=0,this.totalWeight_=0}var m=y.prototype;return m.sample=function(a,t){var n=Math.pow(this.alpha_,a);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=a},m.getTotalWeight=function(){return this.totalWeight_},m.getEstimate=function(){if(this.alpha_){var a=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/a}else return this.estimate_},y}(),da=Go,$o=function(){function y(u,a,t,n){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=u,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new da(a),this.fast_=new da(t)}var m=y.prototype;return m.sample=function(a,t){a=Math.max(a,this.minDelayMs_);var n=8*t,f=a/1e3,v=n/f;this.fast_.sample(f,v),this.slow_.sample(f,v)},m.canEstimate=function(){var a=this.fast_;return a&&a.getTotalWeight()>=this.minWeight_},m.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},m.destroy=function(){},y}(),Vo=$o;function Ko(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function Wo(y,m,u){return m&&Ko(y.prototype,m),y}function Xo(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function qo(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var Jo=window,Zo=Jo.performance,Qo=function(y){qo(m,y);function m(a){var t;return t=y.call(this,a,d.default.FRAG_LOADING,d.default.FRAG_LOADED,d.default.FRAG_BUFFERED,d.default.ERROR)||this,t.lastLoadedFragLevel=0,t._nextAutoLevel=-1,t.hls=a,t.timer=null,t._bwEstimator=null,t.onCheck=t._abandonRulesCheck.bind(Xo(t)),t}var u=m.prototype;return u.destroy=function(){this.clearTimer(),S.prototype.destroy.call(this)},u.onFragLoading=function(t){var n=t.frag;if(n.type==="main"&&(this.timer||(this.fragCurrent=n,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var f=this.hls,v=f.config,x=n.level,T=f.levels[x].details.live,D,O;T?(D=v.abrEwmaFastLive,O=v.abrEwmaSlowLive):(D=v.abrEwmaFastVoD,O=v.abrEwmaSlowVoD),this._bwEstimator=new Vo(f,O,D,v.abrEwmaDefaultEstimate)}},u._abandonRulesCheck=function(){var t=this.hls,n=t.media,f=this.fragCurrent;if(f){var v=f.loader;if(!v||v.stats&&v.stats.aborted){p.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}var x=v.stats;if(n&&x&&(!n.paused&&n.playbackRate!==0||!n.readyState)&&f.autoLevel&&f.level){var T=Zo.now()-x.trequest,D=Math.abs(n.playbackRate);if(T>500*f.duration/D){var O=t.levels,F=Math.max(1,x.bw?x.bw/8:x.loaded*1e3/T),W=O[f.level];if(!W)return;var Q=W.realBitrate?Math.max(W.realBitrate,W.bitrate):W.bitrate,ve=x.total?x.total:Math.max(x.loaded,Math.round(f.duration*Q/8)),Me=n.currentTime,Pe=(ve-x.loaded)/F,De=(B.bufferInfo(n,Me,t.config.maxBufferHole).end-Me)/D;if(De<2*f.duration/D&&Pe>De){var He=t.minAutoLevel,Ve,at;for(at=f.level-1;at>He;at--){var xt=O[at].realBitrate?Math.max(O[at].realBitrate,O[at].bitrate):O[at].bitrate,nr=f.duration*xt/(8*.8*F);if(nr<De)break}Ve<Pe&&(p.logger.warn("loading too slow, abort fragment loading and switch to level "+at+":fragLoadedDelay["+at+"]<fragLoadedDelay["+(f.level-1)+"];bufferStarvationDelay:"+Ve.toFixed(1)+"<"+Pe.toFixed(1)+":"+De.toFixed(1)),t.nextLoadLevel=at,this._bwEstimator.sample(T,x.loaded),v.abort(),this.clearTimer(),t.trigger(d.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:f,stats:x}))}}}}},u.onFragLoaded=function(t){var n=t.frag;if(n.type==="main"&&Object(g.isFiniteNumber)(n.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=n.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var f=this.hls.levels[n.level],v=(f.loaded?f.loaded.bytes:0)+t.stats.loaded,x=(f.loaded?f.loaded.duration:0)+t.frag.duration;f.loaded={bytes:v,duration:x},f.realBitrate=Math.round(8*v/x)}if(t.frag.bitrateTest){var T=t.stats;T.tparsed=T.tbuffered=T.tload,this.onFragBuffered(t)}}},u.onFragBuffered=function(t){var n=t.stats,f=t.frag;if(n.aborted!==!0&&f.type==="main"&&Object(g.isFiniteNumber)(f.sn)&&(!f.bitrateTest||n.tload===n.tbuffered)){var v=n.tparsed-n.trequest;p.logger.log("latency/loading/parsing/append/kbps:"+Math.round(n.tfirst-n.trequest)+"/"+Math.round(n.tload-n.tfirst)+"/"+Math.round(n.tparsed-n.tload)+"/"+Math.round(n.tbuffered-n.tparsed)+"/"+Math.round(8*n.loaded/(n.tbuffered-n.trequest))),this._bwEstimator.sample(v,n.loaded),n.bwEstimate=this._bwEstimator.getEstimate(),f.bitrateTest?this.bitrateTestDelay=v/1e3:this.bitrateTestDelay=0}},u.onError=function(t){switch(t.details){case h.ErrorDetails.FRAG_LOAD_ERROR:case h.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},u.clearTimer=function(){clearInterval(this.timer),this.timer=null},u._findBestLevel=function(t,n,f,v,x,T,D,O,F){for(var W=x;W>=v;W--){var Q=F[W];if(Q){var ve=Q.details,Me=ve?ve.totalduration/ve.fragments.length:n,Pe=ve?ve.live:!1,De=void 0;W<=t?De=D*f:De=O*f;var He=F[W].realBitrate?Math.max(F[W].realBitrate,F[W].bitrate):F[W].bitrate,Ve=He*Me/De;if(p.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+W+"/"+Math.round(De)+"/"+He+"/"+Me+"/"+T+"/"+Ve),De>He&&(!Ve||Pe&&!this.bitrateTestDelay||Ve<T))return W}}return-1},Wo(m,[{key:"nextAutoLevel",get:function(){var t=this._nextAutoLevel,n=this._bwEstimator;if(t!==-1&&(!n||!n.canEstimate()))return t;var f=this._nextABRAutoLevel;return t!==-1&&(f=Math.min(t,f)),f},set:function(t){this._nextAutoLevel=t}},{key:"_nextABRAutoLevel",get:function(){var t=this.hls,n=t.maxAutoLevel,f=t.levels,v=t.config,x=t.minAutoLevel,T=t.media,D=this.lastLoadedFragLevel,O=this.fragCurrent?this.fragCurrent.duration:0,F=T?T.currentTime:0,W=T&&T.playbackRate!==0?Math.abs(T.playbackRate):1,Q=this._bwEstimator?this._bwEstimator.getEstimate():v.abrEwmaDefaultEstimate,ve=(B.bufferInfo(T,F,v.maxBufferHole).end-F)/W,Me=this._findBestLevel(D,O,Q,x,n,ve,v.abrBandWidthFactor,v.abrBandWidthUpFactor,f);if(Me>=0)return Me;p.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var Pe=O?Math.min(O,v.maxStarvationDelay):v.maxStarvationDelay,De=v.abrBandWidthFactor,He=v.abrBandWidthUpFactor;if(ve===0){var Ve=this.bitrateTestDelay;if(Ve){var at=O?Math.min(O,v.maxLoadingDelay):v.maxLoadingDelay;Pe=at-Ve,p.logger.trace("bitrate test took "+Math.round(1e3*Ve)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*Pe)+" ms"),De=He=1}}return Me=this._findBestLevel(D,O,Q,x,n,ve+Pe,De,He,f),Math.max(Me,0)}}]),m}(S),el=Qo;function tl(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var fa=H(),rl=function(y){tl(m,y);function m(a){var t;return t=y.call(this,a,d.default.MEDIA_ATTACHING,d.default.MEDIA_DETACHING,d.default.MANIFEST_PARSED,d.default.BUFFER_RESET,d.default.BUFFER_APPENDING,d.default.BUFFER_CODECS,d.default.BUFFER_EOS,d.default.BUFFER_FLUSHING,d.default.LEVEL_PTS_UPDATED,d.default.LEVEL_UPDATED)||this,t._msDuration=null,t._levelDuration=null,t._levelTargetDuration=10,t._live=null,t._objectUrl=null,t._needsFlush=!1,t._needsEos=!1,t.config=void 0,t.audioTimestampOffset=void 0,t.bufferCodecEventsExpected=0,t._bufferCodecEventsTotal=0,t.media=null,t.mediaSource=null,t.segments=[],t.parent=void 0,t.appending=!1,t.appended=0,t.appendError=0,t.flushBufferCounter=0,t.tracks={},t.pendingTracks={},t.sourceBuffer={},t.flushRange=[],t._onMediaSourceOpen=function(){p.logger.log("media source opened"),t.hls.trigger(d.default.MEDIA_ATTACHED,{media:t.media});var n=t.mediaSource;n&&n.removeEventListener("sourceopen",t._onMediaSourceOpen),t.checkPendingTracks()},t._onMediaSourceClose=function(){p.logger.log("media source closed")},t._onMediaSourceEnded=function(){p.logger.log("media source ended")},t._onSBUpdateEnd=function(){if(t.audioTimestampOffset&&t.sourceBuffer.audio){var n=t.sourceBuffer.audio;p.logger.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+t.audioTimestampOffset),n.timestampOffset=t.audioTimestampOffset,delete t.audioTimestampOffset}t._needsFlush&&t.doFlush(),t._needsEos&&t.checkEos(),t.appending=!1;var f=t.parent,v=t.segments.reduce(function(F,W){return W.parent===f?F+1:F},0),x={},T=t.sourceBuffer;for(var D in T){var O=T[D];if(!O)throw Error("handling source buffer update end error: source buffer for "+D+" uninitilized and unable to update buffered TimeRanges.");x[D]=O.buffered}t.hls.trigger(d.default.BUFFER_APPENDED,{parent:f,pending:v,timeRanges:x}),t._needsFlush||t.doAppending(),t.updateMediaElementDuration(),v===0&&t.flushLiveBackBuffer()},t._onSBUpdateError=function(n){p.logger.error("sourceBuffer error:",n),t.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},t.config=a.config,t}var u=m.prototype;return u.destroy=function(){S.prototype.destroy.call(this)},u.onLevelPtsUpdated=function(t){var n=t.type,f=this.tracks.audio;if(n==="audio"&&f&&f.container==="audio/mpeg"){var v=this.sourceBuffer.audio;if(!v)throw Error("Level PTS Updated and source buffer for audio uninitalized");var x=Math.abs(v.timestampOffset-t.start);if(x>.1){var T=v.updating;try{v.abort()}catch(D){p.logger.warn("can not abort audio buffer: "+D)}T?this.audioTimestampOffset=t.start:(p.logger.warn("change mpeg audio timestamp offset from "+v.timestampOffset+" to "+t.start),v.timestampOffset=t.start)}}},u.onManifestParsed=function(t){var n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,p.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},u.onMediaAttaching=function(t){var n=this.media=t.media;if(n&&fa){var f=this.mediaSource=new fa;f.addEventListener("sourceopen",this._onMediaSourceOpen),f.addEventListener("sourceended",this._onMediaSourceEnded),f.addEventListener("sourceclose",this._onMediaSourceClose),n.src=window.URL.createObjectURL(f),this._objectUrl=n.src}},u.onMediaDetaching=function(){p.logger.log("media source detaching");var t=this.mediaSource;if(t){if(t.readyState==="open")try{t.endOfStream()}catch(n){p.logger.warn("onMediaDetaching:"+n.message+" while calling endOfStream")}t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):p.logger.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(d.default.MEDIA_DETACHED)},u.checkPendingTracks=function(){var t=this.bufferCodecEventsExpected,n=this.pendingTracks,f=Object.keys(n).length;(f&&!t||f===2)&&(this.createSourceBuffers(n),this.pendingTracks={},this.doAppending())},u.onBufferReset=function(){var t=this.sourceBuffer;for(var n in t){var f=t[n];try{f&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(f),f.removeEventListener("updateend",this._onSBUpdateEnd),f.removeEventListener("error",this._onSBUpdateError))}catch{}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},u.onBufferCodecs=function(t){var n=this;Object.keys(this.sourceBuffer).length||(Object.keys(t).forEach(function(f){n.pendingTracks[f]=t[f]}),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},u.createSourceBuffers=function(t){var n=this.sourceBuffer,f=this.mediaSource;if(!f)throw Error("createSourceBuffers called when mediaSource was null");for(var v in t)if(!n[v]){var x=t[v];if(!x)throw Error("source buffer exists for track "+v+", however track does not");var T=x.levelCodec||x.codec,D=x.container+";codecs="+T;p.logger.log("creating sourceBuffer("+D+")");try{var O=n[v]=f.addSourceBuffer(D);O.addEventListener("updateend",this._onSBUpdateEnd),O.addEventListener("error",this._onSBUpdateError),this.tracks[v]={buffer:O,codec:T,id:x.id,container:x.container,levelCodec:x.levelCodec}}catch(F){p.logger.error("error while trying to add sourceBuffer:"+F.message),this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:F,mimeType:D})}}this.hls.trigger(d.default.BUFFER_CREATED,{tracks:this.tracks})},u.onBufferAppending=function(t){this._needsFlush||(this.segments?this.segments.push(t):this.segments=[t],this.doAppending())},u.onBufferEos=function(t){for(var n in this.sourceBuffer)if(!t.type||t.type===n){var f=this.sourceBuffer[n];f&&!f.ended&&(f.ended=!0,p.logger.log(n+" sourceBuffer now EOS"))}this.checkEos()},u.checkEos=function(){var t=this.sourceBuffer,n=this.mediaSource;if(!n||n.readyState!=="open"){this._needsEos=!1;return}for(var f in t){var v=t[f];if(v){if(!v.ended)return;if(v.updating){this._needsEos=!0;return}}}p.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{n.endOfStream()}catch{p.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1},u.onBufferFlushing=function(t){t.type?this.flushRange.push({start:t.startOffset,end:t.endOffset,type:t.type}):(this.flushRange.push({start:t.startOffset,end:t.endOffset,type:"video"}),this.flushRange.push({start:t.startOffset,end:t.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},u.flushLiveBackBuffer=function(){if(this._live){var t=this.config.liveBackBufferLength;if(!(!isFinite(t)||t<0)){if(!this.media){p.logger.error("flushLiveBackBuffer called without attaching media");return}for(var n=this.media.currentTime,f=this.sourceBuffer,v=Object.keys(f),x=n-Math.max(t,this._levelTargetDuration),T=v.length-1;T>=0;T--){var D=v[T],O=f[D];if(O){var F=O.buffered;F.length>0&&x>F.start(0)&&this.removeBufferRange(D,O,0,x)&&this.hls.trigger(d.default.LIVE_BACK_BUFFER_REACHED,{bufferEnd:x})}}}}},u.onLevelUpdated=function(t){var n=t.details;n.fragments.length>0&&(this._levelDuration=n.totalduration+n.fragments[0].start,this._levelTargetDuration=n.averagetargetduration||n.targetduration||10,this._live=n.live,this.updateMediaElementDuration())},u.updateMediaElementDuration=function(){var t=this.config,n;if(!(this._levelDuration===null||!this.media||!this.mediaSource||!this.sourceBuffer||this.media.readyState===0||this.mediaSource.readyState!=="open")){for(var f in this.sourceBuffer){var v=this.sourceBuffer[f];if(v&&v.updating===!0)return}n=this.media.duration,this._msDuration===null&&(this._msDuration=this.mediaSource.duration),this._live===!0&&t.liveDurationInfinity===!0?(p.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>n||!Object(g.isFiniteNumber)(n))&&(p.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},u.doFlush=function(){for(;this.flushRange.length;){var t=this.flushRange[0];if(this.flushBuffer(t.start,t.end,t.type))this.flushRange.shift(),this.flushBufferCounter=0;else{this._needsFlush=!0;return}}if(this.flushRange.length===0){this._needsFlush=!1;var n=0,f=this.sourceBuffer;try{for(var v in f){var x=f[v];x&&(n+=x.buffered.length)}}catch{p.logger.error("error while accessing sourceBuffer.buffered")}this.appended=n,this.hls.trigger(d.default.BUFFER_FLUSHED)}},u.doAppending=function(){var t=this.config,n=this.hls,f=this.segments,v=this.sourceBuffer;if(Object.keys(v).length){if(!this.media||this.media.error){this.segments=[],p.logger.error("trying to append although a media error occured, flush segment and abort");return}if(!this.appending){var x=f.shift();if(x)try{var T=v[x.type];if(!T){this._onSBUpdateEnd();return}if(T.updating){f.unshift(x);return}T.ended=!1,this.parent=x.parent,T.appendBuffer(x.data),this.appendError=0,this.appended++,this.appending=!0}catch(O){p.logger.error("error while trying to append buffer:"+O.message),f.unshift(x);var D={type:h.ErrorTypes.MEDIA_ERROR,parent:x.parent,details:"",fatal:!1};O.code===22?(this.segments=[],D.details=h.ErrorDetails.BUFFER_FULL_ERROR):(this.appendError++,D.details=h.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>t.appendErrorMaxRetry&&(p.logger.log("fail "+t.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],D.fatal=!0)),n.trigger(d.default.ERROR,D)}}}},u.flushBuffer=function(t,n,f){var v=this.sourceBuffer;if(!Object.keys(v).length)return!0;var x="null";if(this.media&&(x=this.media.currentTime.toFixed(3)),p.logger.log("flushBuffer,pos/start/end: "+x+"/"+t+"/"+n),this.flushBufferCounter>=this.appended)return p.logger.warn("abort flushing too many retries"),!0;var T=v[f];if(T){if(T.ended=!1,T.updating)return p.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(f,T,t,n))return this.flushBufferCounter++,!1}return p.logger.log("buffer flushed"),!0},u.removeBufferRange=function(t,n,f,v){try{for(var x=0;x<n.buffered.length;x++){var T=n.buffered.start(x),D=n.buffered.end(x),O=Math.max(T,f),F=Math.min(D,v);if(Math.min(F,D)-O>.5){var W="null";return this.media&&(W=this.media.currentTime.toString()),p.logger.log("sb remove "+t+" ["+O+","+F+"], of ["+T+","+D+"], pos:"+W),n.remove(O,F),!0}}}catch(Q){p.logger.warn("removeBufferRange failed",Q)}return!1},m}(S),nl=rl;function ha(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function il(y,m,u){return m&&ha(y.prototype,m),u&&ha(y,u),y}function al(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var sl=function(y){al(m,y);function m(a){var t;return t=y.call(this,a,d.default.FPS_DROP_LEVEL_CAPPING,d.default.MEDIA_ATTACHING,d.default.MANIFEST_PARSED,d.default.LEVELS_UPDATED,d.default.BUFFER_CODECS,d.default.MEDIA_DETACHING)||this,t.autoLevelCapping=Number.POSITIVE_INFINITY,t.firstLevel=null,t.levels=[],t.media=null,t.restrictedLevels=[],t.timer=null,t.clientRect=null,t}var u=m.prototype;return u.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.clientRect=null,this.stopCapping())},u.onFpsDropLevelCapping=function(t){m.isLevelAllowed(t.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(t.droppedLevel)},u.onMediaAttaching=function(t){this.media=t.media instanceof window.HTMLVideoElement?t.media:null},u.onManifestParsed=function(t){var n=this.hls;this.restrictedLevels=[],this.levels=t.levels,this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()},u.onBufferCodecs=function(t){var n=this.hls;n.config.capLevelToPlayerSize&&t.video&&this.startCapping()},u.onLevelsUpdated=function(t){this.levels=t.levels},u.onMediaDetaching=function(){this.stopCapping()},u.detectPlayerSize=function(){if(this.media){var t=this.levels?this.levels.length:0;if(t){var n=this.hls;n.autoLevelCapping=this.getMaxLevel(t-1),n.autoLevelCapping>this.autoLevelCapping&&n.streamController.nextLevelSwitch(),this.autoLevelCapping=n.autoLevelCapping}}},u.getMaxLevel=function(t){var n=this;if(!this.levels)return-1;var f=this.levels.filter(function(v,x){return m.isLevelAllowed(x,n.restrictedLevels)&&x<=t});return this.clientRect=null,m.getMaxLevelByMediaSize(f,this.mediaWidth,this.mediaHeight)},u.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},u.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},u.getDimensions=function(){if(this.clientRect)return this.clientRect;var t=this.media,n={width:0,height:0};if(t){var f=t.getBoundingClientRect();n.width=f.width,n.height=f.height,!n.width&&!n.height&&(n.width=f.right-f.left||t.width||0,n.height=f.bottom-f.top||t.height||0)}return this.clientRect=n,n},m.isLevelAllowed=function(t,n){return n===void 0&&(n=[]),n.indexOf(t)===-1},m.getMaxLevelByMediaSize=function(t,n,f){if(!t||t&&!t.length)return-1;for(var v=function(F,W){return W?F.width!==W.width||F.height!==W.height:!0},x=t.length-1,T=0;T<t.length;T+=1){var D=t[T];if((D.width>=n||D.height>=f)&&v(D,t[T+1])){x=T;break}}return x},il(m,[{key:"mediaWidth",get:function(){return this.getDimensions().width*m.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*m.contentScaleFactor}}],[{key:"contentScaleFactor",get:function(){var t=1;try{t=window.devicePixelRatio}catch{}return t}}]),m}(S),ol=sl;function ll(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var ul=window,cl=ul.performance,dl=function(y){ll(m,y);function m(a){return y.call(this,a,d.default.MEDIA_ATTACHING)||this}var u=m.prototype;return u.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},u.onMediaAttaching=function(t){var n=this.hls.config;if(n.capLevelOnFPSDrop){var f=this.video=t.media instanceof window.HTMLVideoElement?t.media:null;typeof f.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}},u.checkFPS=function(t,n,f){var v=cl.now();if(n){if(this.lastTime){var x=v-this.lastTime,T=f-this.lastDroppedFrames,D=n-this.lastDecodedFrames,O=1e3*T/x,F=this.hls;if(F.trigger(d.default.FPS_DROP,{currentDropped:T,currentDecoded:D,totalDroppedFrames:f}),O>0&&T>F.config.fpsDroppedMonitoringThreshold*D){var W=F.currentLevel;p.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+W),W>0&&(F.autoLevelCapping===-1||F.autoLevelCapping>=W)&&(W=W-1,F.trigger(d.default.FPS_DROP_LEVEL_CAPPING,{level:W,droppedLevel:F.currentLevel}),F.autoLevelCapping=W,F.streamController.nextLevelSwitch())}}this.lastTime=v,this.lastDroppedFrames=f,this.lastDecodedFrames=n}},u.checkFPSInterval=function(){var t=this.video;if(t)if(this.isVideoPlaybackQualityAvailable){var n=t.getVideoPlaybackQuality();this.checkFPS(t,n.totalVideoFrames,n.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)},m}(S),fl=dl,hl=function(){function y(u){u&&u.xhrSetup&&(this.xhrSetup=u.xhrSetup)}var m=y.prototype;return m.destroy=function(){this.abort(),this.loader=null},m.abort=function(){var a=this.loader;a&&a.readyState!==4&&(this.stats.aborted=!0,a.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},m.load=function(a,t,n){this.context=a,this.config=t,this.callbacks=n,this.stats={trequest:window.performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},m.loadInternal=function(){var a,t=this.context;a=this.loader=new window.XMLHttpRequest;var n=this.stats;n.tfirst=0,n.loaded=0;var f=this.xhrSetup;try{if(f)try{f(a,t.url)}catch{a.open("GET",t.url,!0),f(a,t.url)}a.readyState||a.open("GET",t.url,!0)}catch(v){this.callbacks.onError({code:a.status,text:v.message},t,a);return}t.rangeEnd&&a.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),a.onreadystatechange=this.readystatechange.bind(this),a.onprogress=this.loadprogress.bind(this),a.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),a.send()},m.readystatechange=function(a){var t=a.currentTarget,n=t.readyState,f=this.stats,v=this.context,x=this.config;if(!f.aborted&&n>=2)if(window.clearTimeout(this.requestTimeout),f.tfirst===0&&(f.tfirst=Math.max(window.performance.now(),f.trequest)),n===4){var T=t.status;if(T>=200&&T<300){f.tload=Math.max(f.tfirst,window.performance.now());var D,O;v.responseType==="arraybuffer"?(D=t.response,O=D.byteLength):(D=t.responseText,O=D.length),f.loaded=f.total=O;var F={url:t.responseURL,data:D};this.callbacks.onSuccess(F,f,v,t)}else f.retry>=x.maxRetry||T>=400&&T<499?(p.logger.error(T+" while loading "+v.url),this.callbacks.onError({code:T,text:t.statusText},v,t)):(p.logger.warn(T+" while loading "+v.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,x.maxRetryDelay),f.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),x.timeout)},m.loadtimeout=function(){p.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},m.loadprogress=function(a){var t=a.currentTarget,n=this.stats;n.loaded=a.loaded,a.lengthComputable&&(n.total=a.total);var f=this.callbacks.onProgress;f&&f(n,this.context,null,t)},y}(),gl=hl;function ml(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function pl(y,m,u){return m&&ml(y.prototype,m),y}function vl(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var _l=function(y){vl(m,y);function m(a){var t;return t=y.call(this,a,d.default.MANIFEST_LOADING,d.default.MANIFEST_PARSED,d.default.AUDIO_TRACK_LOADED,d.default.AUDIO_TRACK_SWITCHED,d.default.LEVEL_LOADED,d.default.ERROR)||this,t._trackId=-1,t._selectDefaultTrack=!0,t.tracks=[],t.trackIdBlacklist=Object.create(null),t.audioGroupId=null,t}var u=m.prototype;return u.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},u.onManifestParsed=function(t){var n=this.tracks=t.audioTracks||[];this.hls.trigger(d.default.AUDIO_TRACKS_UPDATED,{audioTracks:n}),this._selectAudioGroup(this.hls.nextLoadLevel)},u.onAudioTrackLoaded=function(t){if(t.id>=this.tracks.length){p.logger.warn("Invalid audio track id:",t.id);return}if(p.logger.log("audioTrack "+t.id+" loaded"),this.tracks[t.id].details=t.details,t.details.live&&!this.hasInterval()){var n=t.details.targetduration*1e3;this.setInterval(n)}!t.details.live&&this.hasInterval()&&this.clearInterval()},u.onAudioTrackSwitched=function(t){var n=this.tracks[t.id].groupId;n&&this.audioGroupId!==n&&(this.audioGroupId=n)},u.onLevelLoaded=function(t){this._selectAudioGroup(t.level)},u.onError=function(t){t.type===h.ErrorTypes.NETWORK_ERROR&&(t.fatal&&this.clearInterval(),t.details===h.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(p.logger.warn("Network failure on audio-track id:",t.context.id),this._handleLoadError()))},u._setAudioTrack=function(t){if(this._trackId===t&&this.tracks[this._trackId].details){p.logger.debug("Same id as current audio-track passed, and track details available -> no-op");return}if(t<0||t>=this.tracks.length){p.logger.warn("Invalid id passed to audio-track controller");return}var n=this.tracks[t];p.logger.log("Now switching to audio-track index "+t),this.clearInterval(),this._trackId=t;var f=n.url,v=n.type,x=n.id;this.hls.trigger(d.default.AUDIO_TRACK_SWITCHING,{id:x,type:v,url:f}),this._loadTrackDetailsIfNeeded(n)},u.doTick=function(){this._updateTrack(this._trackId)},u._selectAudioGroup=function(t){var n=this.hls.levels[t];if(!(!n||!n.audioGroupIds)){var f=n.audioGroupIds[n.urlId];this.audioGroupId!==f&&(this.audioGroupId=f,this._selectInitialAudioTrack())}},u._selectInitialAudioTrack=function(){var t=this,n=this.tracks;if(n.length){var f=this.tracks[this._trackId],v=null;if(f&&(v=f.name),this._selectDefaultTrack){var x=n.filter(function(O){return O.default});x.length?n=x:p.logger.warn("No default audio tracks defined")}var T=!1,D=function(){n.forEach(function(F){T||(!t.audioGroupId||F.groupId===t.audioGroupId)&&(!v||v===F.name)&&(t._setAudioTrack(F.id),T=!0)})};D(),T||(v=null,D()),T||(p.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},u._needsTrackLoading=function(t){var n=t.details,f=t.url;return!n||n.live?!!f:!1},u._loadTrackDetailsIfNeeded=function(t){if(this._needsTrackLoading(t)){var n=t.url,f=t.id;p.logger.log("loading audio-track playlist for id: "+f),this.hls.trigger(d.default.AUDIO_TRACK_LOADING,{url:n,id:f})}},u._updateTrack=function(t){if(!(t<0||t>=this.tracks.length)){this.clearInterval(),this._trackId=t,p.logger.log("trying to update audio-track "+t);var n=this.tracks[t];this._loadTrackDetailsIfNeeded(n)}},u._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var t=this._trackId,n=this.tracks[t],f=n.name,v=n.language,x=n.groupId;p.logger.warn("Loading failed on audio track id: "+t+", group-id: "+x+', name/language: "'+f+'" / "'+v+'"');for(var T=t,D=0;D<this.tracks.length;D++)if(!this.trackIdBlacklist[D]){var O=this.tracks[D];if(O.name===f){T=D;break}}if(T===t){p.logger.warn('No fallback audio-track found for name/language: "'+f+'" / "'+v+'"');return}p.logger.log("Attempting audio-track fallback id:",T,"group-id:",this.tracks[T].groupId),this._setAudioTrack(T)},pl(m,[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(t){this._setAudioTrack(t),this._selectDefaultTrack=!1}}]),m}(ct),yl=_l;function bl(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function Sl(y,m,u){return m&&bl(y.prototype,m),y}function El(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var xl=window,gn=xl.performance,ga=100,Tl=function(y){El(m,y);function m(a,t){var n;return n=y.call(this,a,d.default.MEDIA_ATTACHED,d.default.MEDIA_DETACHING,d.default.AUDIO_TRACKS_UPDATED,d.default.AUDIO_TRACK_SWITCHING,d.default.AUDIO_TRACK_LOADED,d.default.KEY_LOADED,d.default.FRAG_LOADED,d.default.FRAG_PARSING_INIT_SEGMENT,d.default.FRAG_PARSING_DATA,d.default.FRAG_PARSED,d.default.ERROR,d.default.BUFFER_RESET,d.default.BUFFER_CREATED,d.default.BUFFER_APPENDED,d.default.BUFFER_FLUSHED,d.default.INIT_PTS_FOUND)||this,n.fragmentTracker=t,n.config=a.config,n.audioCodecSwap=!1,n._state=te.STOPPED,n.initPTS=[],n.waitingFragment=null,n.videoTrackCC=null,n.waitingVideoCC=null,n}var u=m.prototype;return u.onInitPtsFound=function(t){var n=t.id,f=t.frag.cc,v=t.initPTS;n==="main"&&(this.initPTS[f]=v,this.videoTrackCC=f,p.logger.log("InitPTS for cc: "+f+" found from main: "+v),this.state===te.WAITING_INIT_PTS&&this.tick())},u.startLoad=function(t){if(this.tracks){var n=this.lastCurrentTime;this.stopLoad(),this.setInterval(ga),this.fragLoadError=0,n>0&&t===-1?(p.logger.log("audio:override startPosition with lastCurrentTime @"+n.toFixed(3)),this.state=te.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:t,this.state=te.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=t,this.state=te.STOPPED},u.doTick=function(){var t,n,f,v=this.hls,x=v.config;switch(this.state){case te.ERROR:case te.PAUSED:case te.BUFFER_FLUSHING:break;case te.STARTING:this.state=te.WAITING_TRACK,this.loadedmetadata=!1;break;case te.IDLE:var T=this.tracks;if(!T||!this.media&&(this.startFragRequested||!x.startFragPrefetch))break;if(this.loadedmetadata)t=this.media.currentTime;else if(t=this.nextLoadPosition,t===void 0)break;var D=this.mediaBuffer?this.mediaBuffer:this.media,O=this.videoBuffer?this.videoBuffer:this.media,F=t<x.maxBufferHole?Math.max(Ut,x.maxBufferHole):x.maxBufferHole,W=B.bufferInfo(D,t,F),Q=B.bufferInfo(O,t,F),ve=W.len,Me=W.end,Pe=this.fragPrevious,De=Math.min(x.maxBufferLength,x.maxMaxBufferLength),He=Math.max(De,Q.len),Ve=this.audioSwitch,at=this.trackId;if((ve<He||Ve)&&at<T.length){if(f=T[at].details,typeof f>"u"){this.state=te.WAITING_TRACK;break}if(!Ve&&this._streamEnded(W,f)){this.hls.trigger(d.default.BUFFER_EOS,{type:"audio"}),this.state=te.ENDED;return}var xt=f.fragments,nr=xt.length,zt=xt[0].start,Er=xt[nr-1].start+xt[nr-1].duration,je;if(Ve){if(f.live&&!f.PTSKnown)p.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),Me=0;else if(Me=t,f.PTSKnown&&t<zt)if(W.end>zt||W.nextStart)p.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=zt+.05;else return}if(f.initSegment&&!f.initSegment.data)je=f.initSegment;else if(Me<=zt){if(je=xt[0],this.videoTrackCC!==null&&je.cc!==this.videoTrackCC&&(je=ot(xt,this.videoTrackCC)),f.live&&je.loadIdx&&je.loadIdx===this.fragLoadIdx){var et=W.nextStart?W.nextStart:zt;p.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(et+.05)),this.media.currentTime=et+.05;return}}else{var At,Zr=x.maxFragLookUpTolerance,Qr=Pe?xt[Pe.sn-xt[0].sn+1]:void 0;Me<Er?(Me>Er-Zr&&(Zr=0),Qr&&!lt(Me,Zr,Qr)?At=Qr:At=K.search(xt,function(bu){return lt(Me,Zr,bu)})):At=xt[nr-1],At&&(je=At,zt=At.start,Pe&&je.level===Pe.level&&je.sn===Pe.sn&&(je.sn<f.endSN?(je=xt[je.sn+1-f.startSN],this.fragmentTracker.getState(je)!==nt.OK&&p.logger.log("SN just loaded, load next one: "+je.sn)):je=null))}je&&(je.encrypted?(p.logger.log("Loading key for "+je.sn+" of ["+f.startSN+" ,"+f.endSN+"],track "+at),this.state=te.KEY_LOADING,v.trigger(d.default.KEY_LOADING,{frag:je})):(this.fragCurrent=je,(Ve||this.fragmentTracker.getState(je)===nt.NOT_LOADED)&&(p.logger.log("Loading "+je.sn+", cc: "+je.cc+" of ["+f.startSN+" ,"+f.endSN+"],track "+at+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+t+", bufferEnd: "+Me.toFixed(3)),je.sn!=="initSegment"&&(this.startFragRequested=!0),Object(g.isFiniteNumber)(je.sn)&&(this.nextLoadPosition=je.start+je.duration),v.trigger(d.default.FRAG_LOADING,{frag:je}),this.state=te.FRAG_LOADING)))}break;case te.WAITING_TRACK:n=this.tracks[this.trackId],n&&n.details&&(this.state=te.IDLE);break;case te.FRAG_LOADING_WAITING_RETRY:var mn=gn.now(),Yn=this.retryDate;D=this.media;var _u=D&&D.seeking;(!Yn||mn>=Yn||_u)&&(p.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=te.IDLE);break;case te.WAITING_INIT_PTS:var pn=this.waitingFragment;if(pn){var _i=pn.frag.cc;if(this.initPTS[_i]!==void 0)this.waitingFragment=null,this.state=te.FRAG_LOADING,this.onFragLoaded(pn);else if(this.videoTrackCC!==this.waitingVideoCC)p.logger.log("Waiting fragment cc ("+_i+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var Na=B.bufferInfo(this.mediaBuffer,this.media.currentTime,x.maxBufferHole),yu=lt(Na.end,x.maxFragLookUpTolerance,pn.frag);yu<0&&(p.logger.log("Waiting fragment cc ("+_i+") @ "+pn.frag.start+" cancelled because another fragment at "+Na.end+" is needed"),this.clearWaitingFragment())}}else this.state=te.IDLE;break}},u.clearWaitingFragment=function(){var t=this.waitingFragment;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingFragment=null,this.waitingVideoCC=null,this.state=te.IDLE)},u.onMediaAttached=function(t){var n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);var f=this.config;this.tracks&&f.autoStartLoad&&this.startLoad(f.startPosition)},u.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(p.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},u.onAudioTracksUpdated=function(t){p.logger.log("audio tracks updated"),this.tracks=t.audioTracks},u.onAudioTrackSwitching=function(t){var n=!!t.url;this.trackId=t.id,this.fragCurrent=null,this.clearWaitingFragment(),this.state=te.PAUSED,n?this.setInterval(ga):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),n&&(this.audioSwitch=!0,this.state=te.IDLE),this.tick()},u.onAudioTrackLoaded=function(t){var n=t.details,f=t.id,v=this.tracks[f],x=v.details,T=n.totalduration,D=0;if(p.logger.log("track "+f+" loaded ["+n.startSN+","+n.endSN+"],duration:"+T),n.live||x&&x.live?x&&n.fragments.length>0?(ke(x,n),D=n.fragments[0].start,n.PTSKnown?p.logger.log("live audio playlist sliding:"+D.toFixed(3)):p.logger.log("live audio playlist - outdated PTS, unknown sliding")):(n.PTSKnown=!1,p.logger.log("live audio playlist - first load, unknown sliding")):n.PTSKnown=!1,v.details=n,!this.startFragRequested){if(this.startPosition===-1){var O=n.startTimeOffset;Object(g.isFiniteNumber)(O)?(p.logger.log("start time offset found in playlist, adjust startPosition to "+O),this.startPosition=O):n.live?(this.startPosition=this.computeLivePosition(D,n),p.logger.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===te.WAITING_TRACK&&(this.state=te.IDLE),this.tick()},u.onKeyLoaded=function(){this.state===te.KEY_LOADING&&(this.state=te.IDLE,this.tick())},u.onFragLoaded=function(t){var n=this.fragCurrent,f=t.frag;if(this.state===te.FRAG_LOADING&&n&&f.type==="audio"&&f.level===n.level&&f.sn===n.sn){var v=this.tracks[this.trackId],x=v.details,T=x.totalduration,D=n.level,O=n.sn,F=n.cc,W=this.config.defaultAudioCodec||v.audioCodec||"mp4a.40.2",Q=this.stats=t.stats;if(O==="initSegment")this.state=te.IDLE,Q.tparsed=Q.tbuffered=gn.now(),x.initSegment.data=t.payload,this.hls.trigger(d.default.FRAG_BUFFERED,{stats:Q,frag:n,id:"audio"}),this.tick();else{this.state=te.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new se(this.hls,"audio"));var ve=this.initPTS[F],Me=x.initSegment?x.initSegment.data:[];if(ve!==void 0){this.pendingBuffering=!0,p.logger.log("Demuxing "+O+" of ["+x.startSN+" ,"+x.endSN+"],track "+D);var Pe=!1;this.demuxer.push(t.payload,Me,W,null,n,T,Pe,ve)}else p.logger.log("Unknown video PTS for cc "+F+", waiting for video PTS before demuxing audio frag "+O+" of ["+x.startSN+" ,"+x.endSN+"],track "+D),this.waitingFragment=t,this.waitingVideoCC=this.videoTrackCC,this.state=te.WAITING_INIT_PTS}}this.fragLoadError=0},u.onFragParsingInitSegment=function(t){var n=this.fragCurrent,f=t.frag;if(n&&t.id==="audio"&&f.sn===n.sn&&f.level===n.level&&this.state===te.PARSING){var v=t.tracks,x;if(v.video&&delete v.video,x=v.audio,x){x.levelCodec=x.codec,x.id=t.id,this.hls.trigger(d.default.BUFFER_CODECS,v),p.logger.log("audio track:audio,container:"+x.container+",codecs[level/parsed]=["+x.levelCodec+"/"+x.codec+"]");var T=x.initSegment;if(T){var D={type:"audio",data:T,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[D]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(d.default.BUFFER_APPENDING,D))}this.tick()}}},u.onFragParsingData=function(t){var n=this,f=this.fragCurrent,v=t.frag;if(f&&t.id==="audio"&&t.type==="audio"&&v.sn===f.sn&&v.level===f.level&&this.state===te.PARSING){var x=this.trackId,T=this.tracks[x],D=this.hls;Object(g.isFiniteNumber)(t.endPTS)||(t.endPTS=t.startPTS+f.duration,t.endDTS=t.startDTS+f.duration),f.addElementaryStream(G.AUDIO),p.logger.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb),ue(T.details,f,t.startPTS,t.endPTS);var O=this.media,F=!1;if(this.audioSwitch)if(O&&O.readyState){var W=O.currentTime;p.logger.log("switching audio track : currentTime:"+W),W>=t.startPTS&&(p.logger.log("switching audio track : flushing all audio"),this.state=te.BUFFER_FLUSHING,D.trigger(d.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),F=!0,this.audioSwitch=!1,D.trigger(d.default.AUDIO_TRACK_SWITCHED,{id:x}))}else this.audioSwitch=!1,D.trigger(d.default.AUDIO_TRACK_SWITCHED,{id:x});var Q=this.pendingData;if(!Q){p.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),D.trigger(d.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});return}this.audioSwitch||([t.data1,t.data2].forEach(function(ve){ve&&ve.length&&Q.push({type:t.type,data:ve,parent:"audio",content:"data"})}),!F&&Q.length&&(Q.forEach(function(ve){n.state===te.PARSING&&(n.pendingBuffering=!0,n.hls.trigger(d.default.BUFFER_APPENDING,ve))}),this.pendingData=[],this.appended=!0)),this.tick()}},u.onFragParsed=function(t){var n=this.fragCurrent,f=t.frag;n&&t.id==="audio"&&f.sn===n.sn&&f.level===n.level&&this.state===te.PARSING&&(this.stats.tparsed=gn.now(),this.state=te.PARSED,this._checkAppendedParsed())},u.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},u.onBufferCreated=function(t){var n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer,this.loadedmetadata=!0),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer)},u.onBufferAppended=function(t){if(t.parent==="audio"){var n=this.state;(n===te.PARSING||n===te.PARSED)&&(this.pendingBuffering=t.pending>0,this._checkAppendedParsed())}},u._checkAppendedParsed=function(){if(this.state===te.PARSED&&(!this.appended||!this.pendingBuffering)){var t=this.fragCurrent,n=this.stats,f=this.hls;if(t){this.fragPrevious=t,n.tbuffered=gn.now(),f.trigger(d.default.FRAG_BUFFERED,{stats:n,frag:t,id:"audio"});var v=this.mediaBuffer?this.mediaBuffer:this.media;v&&p.logger.log("audio buffered : "+Xe.toString(v.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,f.trigger(d.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=te.IDLE}this.tick()}},u.onError=function(t){var n=t.frag;if(!(n&&n.type!=="audio"))switch(t.details){case h.ErrorDetails.FRAG_LOAD_ERROR:case h.ErrorDetails.FRAG_LOAD_TIMEOUT:var f=t.frag;if(f&&f.type!=="audio")break;if(!t.fatal){var v=this.fragLoadError;v?v++:v=1;var x=this.config;if(v<=x.fragLoadingMaxRetry){this.fragLoadError=v;var T=Math.min(Math.pow(2,v-1)*x.fragLoadingRetryDelay,x.fragLoadingMaxRetryTimeout);p.logger.warn("AudioStreamController: frag loading failed, retry in "+T+" ms"),this.retryDate=gn.now()+T,this.state=te.FRAG_LOADING_WAITING_RETRY}else p.logger.error("AudioStreamController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=te.ERROR}break;case h.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case h.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case h.ErrorDetails.KEY_LOAD_ERROR:case h.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==te.ERROR&&(this.state=t.fatal?te.ERROR:te.IDLE,p.logger.warn("AudioStreamController: "+t.details+" while loading frag, now switching to "+this.state+" state ..."));break;case h.ErrorDetails.BUFFER_FULL_ERROR:if(t.parent==="audio"&&(this.state===te.PARSING||this.state===te.PARSED)){var D=this.mediaBuffer,O=this.media.currentTime,F=D&&B.isBuffered(D,O)&&B.isBuffered(D,O+.5);if(F){var W=this.config;W.maxMaxBufferLength>=W.maxBufferLength&&(W.maxMaxBufferLength/=2,p.logger.warn("AudioStreamController: reduce max buffer length to "+W.maxMaxBufferLength+"s")),this.state=te.IDLE}else p.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=te.BUFFER_FLUSHING,this.hls.trigger(d.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}break}},u.onBufferFlushed=function(){var t=this,n=this.pendingData;n&&n.length?(p.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),n.forEach(function(f){t.hls.trigger(d.default.BUFFER_APPENDING,f)}),this.appended=!0,this.pendingData=[],this.state=te.PARSED):(this.state=te.IDLE,this.fragPrevious=null,this.tick())},Sl(m,[{key:"state",set:function(t){if(this.state!==t){var n=this.state;this._state=t,p.logger.log("audio stream:"+n+"->"+t)}},get:function(){return this._state}}]),m}(vt),Ml=Tl,ma=function(){if(typeof window<"u"&&window.VTTCue)return window.VTTCue;var y="auto",m={"":!0,lr:!0,rl:!0},u={start:!0,middle:!0,end:!0,left:!0,right:!0};function a(v){if(typeof v!="string")return!1;var x=m[v.toLowerCase()];return x?v.toLowerCase():!1}function t(v){if(typeof v!="string")return!1;var x=u[v.toLowerCase()];return x?v.toLowerCase():!1}function n(v){for(var x=1;x<arguments.length;x++){var T=arguments[x];for(var D in T)v[D]=T[D]}return v}function f(v,x,T){var D=this,O={};O.enumerable=!0,D.hasBeenReset=!1;var F="",W=!1,Q=v,ve=x,Me=T,Pe=null,De="",He=!0,Ve="auto",at="start",xt=50,nr="middle",zt=50,Er="middle";Object.defineProperty(D,"id",n({},O,{get:function(){return F},set:function(et){F=""+et}})),Object.defineProperty(D,"pauseOnExit",n({},O,{get:function(){return W},set:function(et){W=!!et}})),Object.defineProperty(D,"startTime",n({},O,{get:function(){return Q},set:function(et){if(typeof et!="number")throw new TypeError("Start time must be set to a number.");Q=et,this.hasBeenReset=!0}})),Object.defineProperty(D,"endTime",n({},O,{get:function(){return ve},set:function(et){if(typeof et!="number")throw new TypeError("End time must be set to a number.");ve=et,this.hasBeenReset=!0}})),Object.defineProperty(D,"text",n({},O,{get:function(){return Me},set:function(et){Me=""+et,this.hasBeenReset=!0}})),Object.defineProperty(D,"region",n({},O,{get:function(){return Pe},set:function(et){Pe=et,this.hasBeenReset=!0}})),Object.defineProperty(D,"vertical",n({},O,{get:function(){return De},set:function(et){var At=a(et);if(At===!1)throw new SyntaxError("An invalid or illegal string was specified.");De=At,this.hasBeenReset=!0}})),Object.defineProperty(D,"snapToLines",n({},O,{get:function(){return He},set:function(et){He=!!et,this.hasBeenReset=!0}})),Object.defineProperty(D,"line",n({},O,{get:function(){return Ve},set:function(et){if(typeof et!="number"&&et!==y)throw new SyntaxError("An invalid number or illegal string was specified.");Ve=et,this.hasBeenReset=!0}})),Object.defineProperty(D,"lineAlign",n({},O,{get:function(){return at},set:function(et){var At=t(et);if(!At)throw new SyntaxError("An invalid or illegal string was specified.");at=At,this.hasBeenReset=!0}})),Object.defineProperty(D,"position",n({},O,{get:function(){return xt},set:function(et){if(et<0||et>100)throw new Error("Position must be between 0 and 100.");xt=et,this.hasBeenReset=!0}})),Object.defineProperty(D,"positionAlign",n({},O,{get:function(){return nr},set:function(et){var At=t(et);if(!At)throw new SyntaxError("An invalid or illegal string was specified.");nr=At,this.hasBeenReset=!0}})),Object.defineProperty(D,"size",n({},O,{get:function(){return zt},set:function(et){if(et<0||et>100)throw new Error("Size must be between 0 and 100.");zt=et,this.hasBeenReset=!0}})),Object.defineProperty(D,"align",n({},O,{get:function(){return Er},set:function(et){var At=t(et);if(!At)throw new SyntaxError("An invalid or illegal string was specified.");Er=At,this.hasBeenReset=!0}})),D.displayState=void 0}return f.prototype.getCueAsHTML=function(){var v=window.WebVTT;return v.convertCueToDOMTree(window,this.text)},f}(),wl=function(){return{decode:function(u){if(!u)return"";if(typeof u!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(u))}}};function pa(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new wl,this.regionList=[]}function Ll(y){function m(a,t,n,f){return(a|0)*3600+(t|0)*60+(n|0)+(f|0)/1e3}var u=y.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return u?u[3]?m(u[1],u[2],u[3].replace(":",""),u[4]):u[1]>59?m(u[1],u[2],0,u[4]):m(0,u[1],u[2],u[4]):null}function va(){this.values=Object.create(null)}va.prototype={set:function(m,u){!this.get(m)&&u!==""&&(this.values[m]=u)},get:function(m,u,a){return a?this.has(m)?this.values[m]:u[a]:this.has(m)?this.values[m]:u},has:function(m){return m in this.values},alt:function(m,u,a){for(var t=0;t<a.length;++t)if(u===a[t]){this.set(m,u);break}},integer:function(m,u){/^-?\d+$/.test(u)&&this.set(m,parseInt(u,10))},percent:function(m,u){return u.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(u=parseFloat(u),u>=0&&u<=100)?(this.set(m,u),!0):!1}};function _a(y,m,u,a){var t=a?y.split(a):[y];for(var n in t)if(typeof t[n]=="string"){var f=t[n].split(u);if(f.length===2){var v=f[0],x=f[1];m(v,x)}}}var fi=new ma(0,0,0),On=fi.align==="middle"?"middle":"center";function kl(y,m,u){var a=y;function t(){var v=Ll(y);if(v===null)throw new Error("Malformed timestamp: "+a);return y=y.replace(/^[^\sa-zA-Z-]+/,""),v}function n(v,x){var T=new va;_a(v,function(F,W){switch(F){case"region":for(var Q=u.length-1;Q>=0;Q--)if(u[Q].id===W){T.set(F,u[Q].region);break}break;case"vertical":T.alt(F,W,["rl","lr"]);break;case"line":var ve=W.split(","),Me=ve[0];T.integer(F,Me),T.percent(F,Me)&&T.set("snapToLines",!1),T.alt(F,Me,["auto"]),ve.length===2&&T.alt("lineAlign",ve[1],["start",On,"end"]);break;case"position":ve=W.split(","),T.percent(F,ve[0]),ve.length===2&&T.alt("positionAlign",ve[1],["start",On,"end","line-left","line-right","auto"]);break;case"size":T.percent(F,W);break;case"align":T.alt(F,W,["start",On,"end","left","right"]);break}},/:/,/\s/),x.region=T.get("region",null),x.vertical=T.get("vertical","");var D=T.get("line","auto");D==="auto"&&fi.line===-1&&(D=-1),x.line=D,x.lineAlign=T.get("lineAlign","start"),x.snapToLines=T.get("snapToLines",!0),x.size=T.get("size",100),x.align=T.get("align",On);var O=T.get("position","auto");O==="auto"&&fi.position===50&&(O=x.align==="start"||x.align==="left"?0:x.align==="end"||x.align==="right"?100:50),x.position=O}function f(){y=y.replace(/^\s+/,"")}if(f(),m.startTime=t(),f(),y.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+a);y=y.substr(3),f(),m.endTime=t(),f(),n(y,m)}function ya(y){return y.replace(/<br(?: \/)?>/gi,`
`)}pa.prototype={parse:function(m){var u=this;m&&(u.buffer+=u.decoder.decode(m,{stream:!0}));function a(){var T=u.buffer,D=0;for(T=ya(T);D<T.length&&T[D]!=="\r"&&T[D]!==`
`;)++D;var O=T.substr(0,D);return T[D]==="\r"&&++D,T[D]===`
`&&++D,u.buffer=T.substr(D),O}function t(T){_a(T,function(D,O){},/:/)}try{var n;if(u.state==="INITIAL"){if(!/\r\n|\n/.test(u.buffer))return this;n=a();var f=n.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!f||!f[0])throw new Error("Malformed WebVTT signature.");u.state="HEADER"}for(var v=!1;u.buffer;){if(!/\r\n|\n/.test(u.buffer))return this;switch(v?v=!1:n=a(),u.state){case"HEADER":/:/.test(n)?t(n):n||(u.state="ID");continue;case"NOTE":n||(u.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){u.state="NOTE";break}if(!n)continue;if(u.cue=new ma(0,0,""),u.state="CUE",n.indexOf("-->")===-1){u.cue.id=n;continue}case"CUE":try{kl(n,u.cue,u.regionList)}catch{u.cue=null,u.state="BADCUE";continue}u.state="CUETEXT";continue;case"CUETEXT":var x=n.indexOf("-->")!==-1;if(!n||x&&(v=!0)){u.oncue&&u.oncue(u.cue),u.cue=null,u.state="ID";continue}u.cue.text&&(u.cue.text+=`
`),u.cue.text+=n;continue;case"BADCUE":n||(u.state="ID");continue}}}catch{u.state==="CUETEXT"&&u.cue&&u.oncue&&u.oncue(u.cue),u.cue=null,u.state=u.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var m=this;try{if(m.buffer+=m.decoder.decode(),(m.cue||m.state==="HEADER")&&(m.buffer+=`

`,m.parse()),m.state==="INITIAL")throw new Error("Malformed WebVTT signature.")}catch(u){throw u}return m.onflush&&m.onflush(),this}};var Al=pa;function Rl(y,m,u,a){for(var t=[],n,f,v,x,T,D=window.VTTCue||TextTrackCue,O=0;O<a.rows.length;O++)if(n=a.rows[O],v=!0,x=0,T="",!n.isEmpty()){for(var F=0;F<n.chars.length;F++)n.chars[F].uchar.match(/\s/)&&v?x++:(T+=n.chars[F].uchar,v=!1);n.cueStartTime=m,m===u&&(u+=1e-4),f=new D(m,u,ya(T.trim())),x>=16?x--:x++,navigator.userAgent.match(/Firefox\//)?f.line=O+1:f.line=O>7?O-2:O+1,f.align="left",f.position=Math.max(0,Math.min(100,100*(x/32))),t.push(f),y&&y.addCue(f)}return t}var ba={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Sa=function(m){var u=m;return ba.hasOwnProperty(m)&&(u=ba[m]),String.fromCharCode(u)},cr=15,Sr=100,Dl={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Cl={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Il={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Pl={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Ol=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],tt;(function(y){y[y.ERROR=0]="ERROR",y[y.TEXT=1]="TEXT",y[y.WARNING=2]="WARNING",y[y.INFO=2]="INFO",y[y.DEBUG=3]="DEBUG",y[y.DATA=3]="DATA"})(tt||(tt={}));var Fl=function(){function y(){this.time=null,this.verboseLevel=tt.ERROR}var m=y.prototype;return m.log=function(a,t){this.verboseLevel>=a&&p.logger.log(this.time+" ["+a+"] "+t)},y}(),Or=function(m){for(var u=[],a=0;a<m.length;a++)u.push(m[a].toString(16));return u},Ea=function(){function y(u,a,t,n,f){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=u||"white",this.underline=a||!1,this.italics=t||!1,this.background=n||"black",this.flash=f||!1}var m=y.prototype;return m.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},m.setStyles=function(a){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var f=t[n];a.hasOwnProperty(f)&&(this[f]=a[f])}},m.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},m.equals=function(a){return this.foreground===a.foreground&&this.underline===a.underline&&this.italics===a.italics&&this.background===a.background&&this.flash===a.flash},m.copy=function(a){this.foreground=a.foreground,this.underline=a.underline,this.italics=a.italics,this.background=a.background,this.flash=a.flash},m.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},y}(),Nl=function(){function y(u,a,t,n,f,v){this.uchar=void 0,this.penState=void 0,this.uchar=u||" ",this.penState=new Ea(a,t,n,f,v)}var m=y.prototype;return m.reset=function(){this.uchar=" ",this.penState.reset()},m.setChar=function(a,t){this.uchar=a,this.penState.copy(t)},m.setPenState=function(a){this.penState.copy(a)},m.equals=function(a){return this.uchar===a.uchar&&this.penState.equals(a.penState)},m.copy=function(a){this.uchar=a.uchar,this.penState.copy(a.penState)},m.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},y}(),Yl=function(){function y(u){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var a=0;a<Sr;a++)this.chars.push(new Nl);this.logger=u,this.pos=0,this.currPenState=new Ea}var m=y.prototype;return m.equals=function(a){for(var t=!0,n=0;n<Sr;n++)if(!this.chars[n].equals(a.chars[n])){t=!1;break}return t},m.copy=function(a){for(var t=0;t<Sr;t++)this.chars[t].copy(a.chars[t])},m.isEmpty=function(){for(var a=!0,t=0;t<Sr;t++)if(!this.chars[t].isEmpty()){a=!1;break}return a},m.setCursor=function(a){this.pos!==a&&(this.pos=a),this.pos<0?(this.logger.log(tt.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>Sr&&(this.logger.log(tt.DEBUG,"Too large cursor position "+this.pos),this.pos=Sr)},m.moveCursor=function(a){var t=this.pos+a;if(a>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},m.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},m.insertChar=function(a){a>=144&&this.backSpace();var t=Sa(a);if(this.pos>=Sr){this.logger.log(tt.ERROR,"Cannot insert "+a.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)},m.clearFromPos=function(a){var t;for(t=a;t<Sr;t++)this.chars[t].reset()},m.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},m.clearToEndOfRow=function(){this.clearFromPos(this.pos)},m.getTextString=function(){for(var a=[],t=!0,n=0;n<Sr;n++){var f=this.chars[n].uchar;f!==" "&&(t=!1),a.push(f)}return t?"":a.join("")},m.setPenStyles=function(a){this.currPenState.setStyles(a);var t=this.chars[this.pos];t.setPenState(this.currPenState)},y}(),hi=function(){function y(u){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var a=0;a<cr;a++)this.rows.push(new Yl(u));this.logger=u,this.currRow=cr-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var m=y.prototype;return m.reset=function(){for(var a=0;a<cr;a++)this.rows[a].clear();this.currRow=cr-1},m.equals=function(a){for(var t=!0,n=0;n<cr;n++)if(!this.rows[n].equals(a.rows[n])){t=!1;break}return t},m.copy=function(a){for(var t=0;t<cr;t++)this.rows[t].copy(a.rows[t])},m.isEmpty=function(){for(var a=!0,t=0;t<cr;t++)if(!this.rows[t].isEmpty()){a=!1;break}return a},m.backSpace=function(){var a=this.rows[this.currRow];a.backSpace()},m.clearToEndOfRow=function(){var a=this.rows[this.currRow];a.clearToEndOfRow()},m.insertChar=function(a){var t=this.rows[this.currRow];t.insertChar(a)},m.setPen=function(a){var t=this.rows[this.currRow];t.setPenStyles(a)},m.moveCursor=function(a){var t=this.rows[this.currRow];t.moveCursor(a)},m.setCursor=function(a){this.logger.log(tt.INFO,"setCursor: "+a);var t=this.rows[this.currRow];t.setCursor(a)},m.setPAC=function(a){this.logger.log(tt.INFO,"pacData = "+JSON.stringify(a));var t=a.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var n=0;n<cr;n++)this.rows[n].clear();var f=this.currRow+1-this.nrRollUpRows,v=this.lastOutputScreen;if(v){var x=v.rows[f].cueStartTime,T=this.logger.time;if(x&&T!==null&&x<T)for(var D=0;D<this.nrRollUpRows;D++)this.rows[t-this.nrRollUpRows+D+1].copy(v.rows[f+D])}}this.currRow=t;var O=this.rows[this.currRow];if(a.indent!==null){var F=a.indent,W=Math.max(F-1,0);O.setCursor(a.indent),a.color=O.chars[W].penState.foreground}var Q={foreground:a.color,underline:a.underline,italics:a.italics,background:"black",flash:!1};this.setPen(Q)},m.setBkgData=function(a){this.logger.log(tt.INFO,"bkgData = "+JSON.stringify(a)),this.backSpace(),this.setPen(a),this.insertChar(32)},m.setRollUpRows=function(a){this.nrRollUpRows=a},m.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(tt.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(tt.TEXT,this.getDisplayText());var a=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(a,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(tt.INFO,"Rolling up")},m.getDisplayText=function(a){a=a||!1;for(var t=[],n="",f=-1,v=0;v<cr;v++){var x=this.rows[v].getTextString();x&&(f=v+1,a?t.push("Row "+f+": '"+x+"'"):t.push(x.trim()))}return t.length>0&&(a?n="["+t.join(" | ")+"]":n=t.join(`
`)),n},m.getTextAndFormat=function(){return this.rows},y}(),xa=function(){function y(u,a,t){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=u,this.outputFilter=a,this.mode=null,this.verbose=0,this.displayedMemory=new hi(t),this.nonDisplayedMemory=new hi(t),this.lastOutputScreen=new hi(t),this.currRollUpRow=this.displayedMemory.rows[cr-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=t}var m=y.prototype;return m.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[cr-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},m.getHandler=function(){return this.outputFilter},m.setHandler=function(a){this.outputFilter=a},m.setPAC=function(a){this.writeScreen.setPAC(a)},m.setBkgData=function(a){this.writeScreen.setBkgData(a)},m.setMode=function(a){a!==this.mode&&(this.mode=a,this.logger.log(tt.INFO,"MODE="+a),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=a)},m.insertChars=function(a){for(var t=0;t<a.length;t++)this.writeScreen.insertChar(a[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(tt.INFO,n+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(tt.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},m.ccRCL=function(){this.logger.log(tt.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},m.ccBS=function(){this.logger.log(tt.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},m.ccAOF=function(){},m.ccAON=function(){},m.ccDER=function(){this.logger.log(tt.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},m.ccRU=function(a){this.logger.log(tt.INFO,"RU("+a+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(a)},m.ccFON=function(){this.logger.log(tt.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},m.ccRDC=function(){this.logger.log(tt.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},m.ccTR=function(){this.logger.log(tt.INFO,"TR"),this.setMode("MODE_TEXT")},m.ccRTD=function(){this.logger.log(tt.INFO,"RTD"),this.setMode("MODE_TEXT")},m.ccEDM=function(){this.logger.log(tt.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},m.ccCR=function(){this.logger.log(tt.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},m.ccENM=function(){this.logger.log(tt.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},m.ccEOC=function(){if(this.logger.log(tt.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var a=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=a,this.writeScreen=this.nonDisplayedMemory,this.logger.log(tt.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},m.ccTO=function(a){this.logger.log(tt.INFO,"TO("+a+") - Tab Offset"),this.writeScreen.moveCursor(a)},m.ccMIDROW=function(a){var t={flash:!1};if(t.underline=a%2===1,t.italics=a>=46,t.italics)t.foreground="white";else{var n=Math.floor(a/2)-16,f=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=f[n]}this.logger.log(tt.INFO,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},m.outputDataUpdate=function(a){a===void 0&&(a=!1);var t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),a&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))},m.cueSplitAtTime=function(a){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,a,this.displayedMemory),this.cueStartTime=a))},y}(),Bl=function(){function y(u,a,t){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var n=new Fl;this.channels=[null,new xa(u,a,n),new xa(u+1,t,n)],this.cmdHistory=Ma(),this.logger=n}var m=y.prototype;return m.getHandler=function(a){return this.channels[a].getHandler()},m.setHandler=function(a,t){this.channels[a].setHandler(t)},m.addData=function(a,t){var n,f,v,x=!1;this.logger.time=a;for(var T=0;T<t.length;T+=2)if(f=t[T]&127,v=t[T+1]&127,!(f===0&&v===0)){if(this.logger.log(tt.DATA,"["+Or([t[T],t[T+1]])+"] -> ("+Or([f,v])+")"),n=this.parseCmd(f,v),n||(n=this.parseMidrow(f,v)),n||(n=this.parsePAC(f,v)),n||(n=this.parseBackgroundAttributes(f,v)),!n&&(x=this.parseChars(f,v),x)){var D=this.currentChannel;if(D&&D>0){var O=this.channels[D];O.insertChars(x)}else this.logger.log(tt.WARNING,"No channel found yet. TEXT-MODE?")}!n&&!x&&this.logger.log(tt.WARNING,"Couldn't parse cleaned data "+Or([f,v])+" orig: "+Or([t[T],t[T+1]]))}},m.parseCmd=function(a,t){var n=this.cmdHistory,f=(a===20||a===28||a===21||a===29)&&t>=32&&t<=47,v=(a===23||a===31)&&t>=33&&t<=35;if(!(f||v))return!1;if(Ta(a,t,n))return qr(null,null,n),this.logger.log(tt.DEBUG,"Repeated command ("+Or([a,t])+") is dropped"),!0;var x=a===20||a===21||a===23?1:2,T=this.channels[x];return a===20||a===21||a===28||a===29?t===32?T.ccRCL():t===33?T.ccBS():t===34?T.ccAOF():t===35?T.ccAON():t===36?T.ccDER():t===37?T.ccRU(2):t===38?T.ccRU(3):t===39?T.ccRU(4):t===40?T.ccFON():t===41?T.ccRDC():t===42?T.ccTR():t===43?T.ccRTD():t===44?T.ccEDM():t===45?T.ccCR():t===46?T.ccENM():t===47&&T.ccEOC():T.ccTO(t-32),qr(a,t,n),this.currentChannel=x,!0},m.parseMidrow=function(a,t){var n=0;if((a===17||a===25)&&t>=32&&t<=47){if(a===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(tt.ERROR,"Mismatch channel in midrow parsing"),!1;var f=this.channels[n];return f?(f.ccMIDROW(t),this.logger.log(tt.DEBUG,"MIDROW ("+Or([a,t])+")"),!0):!1}return!1},m.parsePAC=function(a,t){var n,f=this.cmdHistory,v=(a>=17&&a<=23||a>=25&&a<=31)&&t>=64&&t<=127,x=(a===16||a===24)&&t>=64&&t<=95;if(!(v||x))return!1;if(Ta(a,t,f))return qr(null,null,f),!0;var T=a<=23?1:2;t>=64&&t<=95?n=T===1?Dl[a]:Il[a]:n=T===1?Cl[a]:Pl[a];var D=this.channels[T];return D?(D.setPAC(this.interpretPAC(n,t)),qr(a,t,f),this.currentChannel=T,!0):!1},m.interpretPAC=function(a,t){var n=t,f={color:null,italics:!1,indent:null,underline:!1,row:a};return t>95?n=t-96:n=t-64,f.underline=(n&1)===1,n<=13?f.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(f.italics=!0,f.color="white"):f.indent=Math.floor((n-16)/2)*4,f},m.parseChars=function(a,t){var n,f=null,v=null;if(a>=25?(n=2,v=a-8):(n=1,v=a),v>=17&&v<=19){var x=t;v===17?x=t+80:v===18?x=t+112:x=t+144,this.logger.log(tt.INFO,"Special char '"+Sa(x)+"' in channel "+n),f=[x]}else a>=32&&a<=127&&(f=t===0?[a]:[a,t]);if(f){var T=Or(f);this.logger.log(tt.DEBUG,"Char codes =  "+T.join(",")),qr(a,t,this.cmdHistory)}return f},m.parseBackgroundAttributes=function(a,t){var n=(a===16||a===24)&&t>=32&&t<=47,f=(a===23||a===31)&&t>=45&&t<=47;if(!(n||f))return!1;var v,x={};a===16||a===24?(v=Math.floor((t-32)/2),x.background=Ol[v],t%2===1&&(x.background=x.background+"_semi")):t===45?x.background="transparent":(x.foreground="black",t===47&&(x.underline=!0));var T=a<=23?1:2,D=this.channels[T];return D.setBkgData(x),qr(a,t,this.cmdHistory),!0},m.reset=function(){for(var a=0;a<Object.keys(this.channels).length;a++){var t=this.channels[a];t&&t.reset()}this.cmdHistory=Ma()},m.cueSplitAtTime=function(a){for(var t=0;t<this.channels.length;t++){var n=this.channels[t];n&&n.cueSplitAtTime(a)}},y}();function qr(y,m,u){u.a=y,u.b=m}function Ta(y,m,u){return u.a===y&&u.b===m}function Ma(){return{a:null,b:null}}var wa=Bl,Fn=function(){function y(u,a){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=u,this.trackName=a}var m=y.prototype;return m.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},m.newCue=function(a,t,n){(this.startTime===null||this.startTime>a)&&(this.startTime=a),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)},m.reset=function(){this.cueRanges=[]},y}(),gi=function(m,u,a){return m.substr(0,u.length)===u},jl=function(m){var u=parseInt(m.substr(-3)),a=parseInt(m.substr(-6,2)),t=parseInt(m.substr(-9,2)),n=m.length>9?parseInt(m.substr(0,m.indexOf(":"))):0;if(!Object(g.isFiniteNumber)(u)||!Object(g.isFiniteNumber)(a)||!Object(g.isFiniteNumber)(t)||!Object(g.isFiniteNumber)(n))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+m);return u+=1e3*a,u+=60*1e3*t,u+=60*60*1e3*n,u},mi=function(m){for(var u=5381,a=m.length;a;)u=u*33^m.charCodeAt(--a);return(u>>>0).toString()},Ul=function(m,u,a){var t=m[u],n=m[t.prevCC];if(!n||!n.new&&t.new){m.ccOffset=m.presentationOffset=t.start,t.new=!1;return}for(;n&&n.new;)m.ccOffset+=t.start-n.start,t.new=!1,t=n,n=m[t.prevCC];m.presentationOffset=a},Hl={parse:function(m,u,a,t,n,f){var v=/\r\n|\n\r|\n|\r/g,x=Object(fn.utf8ArrayToStr)(new Uint8Array(m)).trim().replace(v,`
`).split(`
`),T="00:00.000",D=0,O=0,F=0,W=[],Q,ve=!0,Me=!1,Pe=new Al;Pe.oncue=function(De){var He=a[t],Ve=a.ccOffset;He&&He.new&&(O!==void 0?Ve=a.ccOffset=He.start:Ul(a,t,F)),F&&(Ve=F-a.presentationOffset),Me&&(De.startTime+=Ve-O,De.endTime+=Ve-O),De.id=mi(De.startTime.toString())+mi(De.endTime.toString())+mi(De.text),De.text=decodeURIComponent(encodeURIComponent(De.text)),De.endTime>0&&W.push(De)},Pe.onparsingerror=function(De){Q=De},Pe.onflush=function(){if(Q&&f){f(Q);return}n(W)},x.forEach(function(De){if(ve)if(gi(De,"X-TIMESTAMP-MAP=")){ve=!1,Me=!0,De.substr(16).split(",").forEach(function(He){gi(He,"LOCAL:")?T=He.substr(6):gi(He,"MPEGTS:")&&(D=parseInt(He.substr(7)))});try{u+(a[t].start*9e4||0)<0&&(u+=8589934592),D-=u,O=jl(T)/1e3,F=D/9e4}catch(He){Me=!1,Q=He}return}else De===""&&(ve=!1);Pe.parse(De+`
`)}),Pe.flush()}},zl=Hl;function Nn(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function Gl(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var $l=function(y){Gl(m,y);function m(a){var t;if(t=y.call(this,a,d.default.MEDIA_ATTACHING,d.default.MEDIA_DETACHING,d.default.FRAG_PARSING_USERDATA,d.default.FRAG_DECRYPTED,d.default.MANIFEST_LOADING,d.default.MANIFEST_LOADED,d.default.FRAG_LOADED,d.default.INIT_PTS_FOUND)||this,t.media=null,t.config=void 0,t.enabled=!0,t.Cues=void 0,t.textTracks=[],t.tracks=[],t.initPTS=[],t.unparsedVttFrags=[],t.captionsTracks={},t.nonNativeCaptionsTracks={},t.captionsProperties=void 0,t.cea608Parser1=void 0,t.cea608Parser2=void 0,t.lastSn=-1,t.prevCC=-1,t.vttCCs=La(),t.hls=a,t.config=a.config,t.Cues=a.config.cueHandler,t.captionsProperties={textTrack1:{label:t.config.captionsTextTrack1Label,languageCode:t.config.captionsTextTrack1LanguageCode},textTrack2:{label:t.config.captionsTextTrack2Label,languageCode:t.config.captionsTextTrack2LanguageCode},textTrack3:{label:t.config.captionsTextTrack3Label,languageCode:t.config.captionsTextTrack3LanguageCode},textTrack4:{label:t.config.captionsTextTrack4Label,languageCode:t.config.captionsTextTrack4LanguageCode}},t.config.enableCEA708Captions){var n=new Fn(Nn(t),"textTrack1"),f=new Fn(Nn(t),"textTrack2"),v=new Fn(Nn(t),"textTrack3"),x=new Fn(Nn(t),"textTrack4");t.cea608Parser1=new wa(1,n,f),t.cea608Parser2=new wa(3,v,x)}return t}var u=m.prototype;return u.addCues=function(t,n,f,v,x){for(var T=!1,D=x.length;D--;){var O=x[D],F=Kl(O[0],O[1],n,f);if(F>=0&&(O[0]=Math.min(O[0],n),O[1]=Math.max(O[1],f),T=!0,F/(f-n)>.5))return}if(T||x.push([n,f]),this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[t],n,f,v);else{var W=this.Cues.newCue(null,n,f,v);this.hls.trigger(d.default.CUES_PARSED,{type:"captions",cues:W,track:t})}},u.onInitPtsFound=function(t){var n=this,f=t.frag,v=t.id,x=t.initPTS,T=this.unparsedVttFrags;v==="main"&&(this.initPTS[f.cc]=x),T.length&&(this.unparsedVttFrags=[],T.forEach(function(D){n.onFragLoaded(D)}))},u.getExistingTrack=function(t){var n=this.media;if(n)for(var f=0;f<n.textTracks.length;f++){var v=n.textTracks[f];if(v[t])return v}return null},u.createCaptionsTrack=function(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)},u.createNativeTrack=function(t){if(!this.captionsTracks[t]){var n=this.captionsProperties,f=this.captionsTracks,v=this.media,x=n[t],T=x.label,D=x.languageCode,O=this.getExistingTrack(t);if(O)f[t]=O,Pr(f[t]),Wr(f[t],v);else{var F=this.createTextTrack("captions",T,D);F&&(F[t]=!0,f[t]=F)}}},u.createNonNativeTrack=function(t){if(!this.nonNativeCaptionsTracks[t]){var n=this.captionsProperties[t];if(n){var f=n.label,v={_id:t,label:f,kind:"captions",default:n.media?!!n.media.default:!1,closedCaptions:n.media};this.nonNativeCaptionsTracks[t]=v,this.hls.trigger(d.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[v]})}}},u.createTextTrack=function(t,n,f){var v=this.media;if(v)return v.addTextTrack(t,n,f)},u.destroy=function(){y.prototype.destroy.call(this)},u.onMediaAttaching=function(t){this.media=t.media,this._cleanTracks()},u.onMediaDetaching=function(){var t=this.captionsTracks;Object.keys(t).forEach(function(n){Pr(t[n]),delete t[n]}),this.nonNativeCaptionsTracks={}},u.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs=La(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={}},u._cleanTracks=function(){var t=this.media;if(t){var n=t.textTracks;if(n)for(var f=0;f<n.length;f++)Pr(n[f])}},u.onManifestLoaded=function(t){var n=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset()),this.config.enableWebVTT){var f=t.subtitles||[],v=this.tracks&&f&&this.tracks.length===f.length;if(this.tracks=t.subtitles||[],this.config.renderTextTracksNatively){var x=this.media?this.media.textTracks:[];this.tracks.forEach(function(D,O){var F;if(O<x.length){for(var W=null,Q=0;Q<x.length;Q++)if(Vl(x[Q],D)){W=x[Q];break}W&&(F=W)}F||(F=n.createTextTrack("subtitles",D.name,D.lang)),D.default?F.mode=n.hls.subtitleDisplay?"showing":"hidden":F.mode="disabled",n.textTracks.push(F)})}else if(!v&&this.tracks&&this.tracks.length){var T=this.tracks.map(function(D){return{label:D.name,kind:D.type.toLowerCase(),default:D.default,subtitleTrack:D}});this.hls.trigger(d.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:T})}}this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(function(D){var O=/(?:CC|SERVICE)([1-4])/.exec(D.instreamId);if(O){var F="textTrack"+O[1],W=n.captionsProperties[F];W&&(W.label=D.name,D.lang&&(W.languageCode=D.lang),W.media=D)}})},u.onFragLoaded=function(t){var n=t.frag,f=t.payload,v=this.cea608Parser1,x=this.cea608Parser2,T=this.initPTS,D=this.lastSn,O=this.unparsedVttFrags;if(n.type==="main"){var F=n.sn;n.sn!==D+1&&v&&x&&(v.reset(),x.reset()),this.lastSn=F}else if(n.type==="subtitle")if(f.byteLength){if(!Object(g.isFiniteNumber)(T[n.cc])){O.push(t),T.length&&this.hls.trigger(d.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n});return}var W=n.decryptdata;(W==null||W.key==null||W.method!=="AES-128")&&this._parseVTTs(n,f)}else this.hls.trigger(d.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n})},u._parseVTTs=function(t,n){var f=this,v=this.hls,x=this.prevCC,T=this.textTracks,D=this.vttCCs;D[t.cc]||(D[t.cc]={start:t.start,prevCC:x,new:!0},this.prevCC=t.cc),zl.parse(n,this.initPTS[t.cc],D,t.cc,function(O){if(f.config.renderTextTracksNatively){var F=T[t.level];if(F.mode==="disabled"){v.trigger(d.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t});return}O.forEach(function(Q){if(!F.cues.getCueById(Q.id))try{if(F.addCue(Q),!F.cues.getCueById(Q.id))throw new Error("addCue is failed for: "+Q)}catch(Me){p.logger.debug("Failed occurred on adding cues: "+Me);var ve=new window.TextTrackCue(Q.startTime,Q.endTime,Q.text);ve.id=Q.id,F.addCue(ve)}})}else{var W=f.tracks[t.level].default?"default":"subtitles"+t.level;v.trigger(d.default.CUES_PARSED,{type:"subtitles",cues:O,track:W})}v.trigger(d.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},function(O){p.logger.log("Failed to parse VTT cue: "+O),v.trigger(d.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})})},u.onFragDecrypted=function(t){var n=t.frag,f=t.payload;if(n.type==="subtitle"){if(!Object(g.isFiniteNumber)(this.initPTS[n.cc])){this.unparsedVttFrags.push(t);return}this._parseVTTs(n,f)}},u.onFragParsingUserdata=function(t){var n=this.cea608Parser1,f=this.cea608Parser2;if(!(!this.enabled||!(n&&f)))for(var v=0;v<t.samples.length;v++){var x=t.samples[v].bytes;if(x){var T=this.extractCea608Data(x);n.addData(t.samples[v].pts,T[0]),f.addData(t.samples[v].pts,T[1])}}},u.extractCea608Data=function(t){for(var n=t[0]&31,f=2,v=[[],[]],x=0;x<n;x++){var T=t[f++],D=127&t[f++],O=127&t[f++],F=(4&T)!==0,W=3&T;D===0&&O===0||F&&(W===0||W===1)&&(v[W].push(D),v[W].push(O))}return v},m}(S);function Vl(y,m){return y&&y.label===m.name&&!(y.textTrack1||y.textTrack2)}function Kl(y,m,u,a){return Math.min(m,a)-Math.max(y,u)}function La(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}}}var Wl=$l;function Xl(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function ql(y,m,u){return m&&Xl(y.prototype,m),y}function Jl(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var Zl=function(y){Jl(m,y);function m(a){var t;return t=y.call(this,a,d.default.MEDIA_ATTACHED,d.default.MEDIA_DETACHING,d.default.MANIFEST_LOADED,d.default.SUBTITLE_TRACK_LOADED)||this,t.tracks=[],t.trackId=-1,t.media=null,t.stopped=!0,t.subtitleDisplay=!0,t.queuedDefaultTrack=null,t}var u=m.prototype;return u.destroy=function(){S.prototype.destroy.call(this)},u.onMediaAttached=function(t){var n=this;this.media=t.media,this.media&&(Object(g.isFiniteNumber)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){n.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},u.onMediaDetaching=function(){if(this.media){this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(g.isFiniteNumber)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack);var t=pi(this.media.textTracks);t.forEach(function(n){Pr(n)}),this.subtitleTrack=-1,this.media=null}},u.onManifestLoaded=function(t){var n=this,f=t.subtitles||[];this.tracks=f,this.hls.trigger(d.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:f}),f.forEach(function(v){v.default&&(n.media?n.subtitleTrack=v.id:n.queuedDefaultTrack=v.id)})},u.onSubtitleTrackLoaded=function(t){var n=this,f=t.id,v=t.details,x=this.trackId,T=this.tracks,D=T[x];if(f>=T.length||f!==x||!D||this.stopped){this._clearReloadTimer();return}if(p.logger.log("subtitle track "+f+" loaded"),v.live){var O=Le(D.details,v,t.stats.trequest);p.logger.log("Reloading live subtitle playlist in "+O+"ms"),this.timer=setTimeout(function(){n._loadCurrentTrack()},O)}else this._clearReloadTimer()},u.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},u.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},u._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},u._loadCurrentTrack=function(){var t=this.trackId,n=this.tracks,f=this.hls,v=n[t];t<0||!v||v.details&&!v.details.live||(p.logger.log("Loading subtitle track "+t),f.trigger(d.default.SUBTITLE_TRACK_LOADING,{url:v.url,id:t}))},u._toggleTrackModes=function(t){var n=this.media,f=this.subtitleDisplay,v=this.trackId;if(n){var x=pi(n.textTracks);if(t===-1)[].slice.call(x).forEach(function(O){O.mode="disabled"});else{var T=x[v];T&&(T.mode="disabled")}var D=x[t];D&&(D.mode=f?"showing":"hidden")}},u._setSubtitleTrackInternal=function(t){var n=this.hls,f=this.tracks;!Object(g.isFiniteNumber)(t)||t<-1||t>=f.length||(this.trackId=t,p.logger.log("Switching to subtitle track "+t),n.trigger(d.default.SUBTITLE_TRACK_SWITCH,{id:t}),this._loadCurrentTrack())},u._onTextTracksChanged=function(){if(!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var t=-1,n=pi(this.media.textTracks),f=0;f<n.length;f++)if(n[f].mode==="hidden")t=f;else if(n[f].mode==="showing"){t=f;break}this.subtitleTrack=t}},ql(m,[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(t){this.trackId!==t&&(this._toggleTrackModes(t),this._setSubtitleTrackInternal(t))}}]),m}(S);function pi(y){for(var m=[],u=0;u<y.length;u++){var a=y[u];a.kind==="subtitles"&&a.label&&m.push(y[u])}return m}var Ql=Zl,eu=l("./src/crypt/decrypter.js");function tu(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function ru(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var nu=window,ka=nu.performance,vi=500,iu=function(y){ru(m,y);function m(a,t){var n;return n=y.call(this,a,d.default.MEDIA_ATTACHED,d.default.MEDIA_DETACHING,d.default.ERROR,d.default.KEY_LOADED,d.default.FRAG_LOADED,d.default.SUBTITLE_TRACKS_UPDATED,d.default.SUBTITLE_TRACK_SWITCH,d.default.SUBTITLE_TRACK_LOADED,d.default.SUBTITLE_FRAG_PROCESSED,d.default.LEVEL_UPDATED)||this,n.fragmentTracker=t,n.config=a.config,n.state=te.STOPPED,n.tracks=[],n.tracksBuffered=[],n.currentTrackId=-1,n.decrypter=new eu.default(a,a.config),n.lastAVStart=0,n._onMediaSeeking=n.onMediaSeeking.bind(tu(n)),n}var u=m.prototype;return u.startLoad=function(){this.stopLoad(),this.state=te.IDLE;var t=this.tracks[this.currentTrackId];t&&t.details&&(this.setInterval(vi),this.tick())},u.onSubtitleFragProcessed=function(t){var n=t.frag,f=t.success;if(this.fragPrevious=n,this.state=te.IDLE,!!f){var v=this.tracksBuffered[this.currentTrackId];if(v){for(var x,T=n.start,D=0;D<v.length;D++)if(T>=v[D].start&&T<=v[D].end){x=v[D];break}var O=n.start+n.duration;x?x.end=O:(x={start:T,end:O},v.push(x))}}},u.onMediaAttached=function(t){var n=t.media;this.media=n,n.addEventListener("seeking",this._onMediaSeeking),this.state=te.IDLE},u.onMediaDetaching=function(){var t=this;this.media&&(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach(function(n){t.tracksBuffered[n.id]=[]}),this.media=null,this.state=te.STOPPED)},u.onError=function(t){var n=t.frag;!n||n.type!=="subtitle"||(this.fragCurrent&&this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.state=te.IDLE)},u.onSubtitleTracksUpdated=function(t){var n=this;p.logger.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=t.subtitleTracks,this.tracks.forEach(function(f){n.tracksBuffered[f.id]=[]})},u.onSubtitleTrackSwitch=function(t){if(this.currentTrackId=t.id,!this.tracks||!this.tracks.length||this.currentTrackId===-1){this.clearInterval();return}var n=this.tracks[this.currentTrackId];n&&n.details&&this.setInterval(vi)},u.onSubtitleTrackLoaded=function(t){var n=t.id,f=t.details,v=this.currentTrackId,x=this.tracks,T=x[v];n>=x.length||n!==v||!T||(f.live&&Re(T.details,f,this.lastAVStart),T.details=f,this.setInterval(vi))},u.onKeyLoaded=function(){this.state===te.KEY_LOADING&&(this.state=te.IDLE)},u.onFragLoaded=function(t){var n=this.fragCurrent,f=t.frag.decryptdata,v=t.frag,x=this.hls;if(this.state===te.FRAG_LOADING&&n&&t.frag.type==="subtitle"&&n.sn===t.frag.sn&&t.payload.byteLength>0&&f&&f.key&&f.method==="AES-128"){var T=ka.now();this.decrypter.decrypt(t.payload,f.key.buffer,f.iv.buffer,function(D){var O=ka.now();x.trigger(d.default.FRAG_DECRYPTED,{frag:v,payload:D,stats:{tstart:T,tdecrypt:O}})})}},u.onLevelUpdated=function(t){var n=t.details,f=n.fragments;this.lastAVStart=f.length?f[0].start:0},u.doTick=function(){if(!this.media){this.state=te.IDLE;return}switch(this.state){case te.IDLE:{var t=this.config,n=this.currentTrackId,f=this.fragmentTracker,v=this.media,x=this.tracks;if(!x||!x[n]||!x[n].details)break;var T=t.maxBufferHole,D=t.maxFragLookUpTolerance,O=Math.min(t.maxBufferLength,t.maxMaxBufferLength),F=B.bufferedInfo(this._getBuffered(),v.currentTime,T),W=F.end,Q=F.len,ve=x[n].details,Me=ve.fragments,Pe=Me.length,De=Me[Pe-1].start+Me[Pe-1].duration;if(Q>O)return;var He,Ve=this.fragPrevious;W<De?(Ve&&ve.hasProgramDateTime&&(He=Ft(Me,Ve.endProgramDateTime,D)),He||(He=St(Ve,Me,W,D))):He=Me[Pe-1],He&&He.encrypted?(p.logger.log("Loading key for "+He.sn),this.state=te.KEY_LOADING,this.hls.trigger(d.default.KEY_LOADING,{frag:He})):He&&f.getState(He)===nt.NOT_LOADED&&(this.fragCurrent=He,this.state=te.FRAG_LOADING,this.hls.trigger(d.default.FRAG_LOADING,{frag:He}))}}},u.stopLoad=function(){this.lastAVStart=0,this.fragPrevious=null,y.prototype.stopLoad.call(this)},u._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},u.onMediaSeeking=function(){if(this.fragCurrent){var t=this.media?this.media.currentTime:0,n=this.config.maxFragLookUpTolerance,f=this.fragCurrent.start-n,v=this.fragCurrent.start+this.fragCurrent.duration+n;(t<f||t>v)&&(this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.fragmentTracker.removeFragment(this.fragCurrent),this.fragCurrent=null,this.fragPrevious=null,this.state=te.IDLE,this.tick())}},m}(vt),Jr;(function(y){y.WIDEVINE="com.widevine.alpha",y.PLAYREADY="com.microsoft.playready"})(Jr||(Jr={}));var au=function(){return typeof window<"u"&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null}();function su(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function ou(y,m,u){return m&&su(y.prototype,m),y}function lu(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var Aa=3,uu=function(m,u,a){var t={audioCapabilities:[],videoCapabilities:[]};return m.forEach(function(n){t.audioCapabilities.push({contentType:'audio/mp4; codecs="'+n+'"',robustness:a.audioRobustness||""})}),u.forEach(function(n){t.videoCapabilities.push({contentType:'video/mp4; codecs="'+n+'"',robustness:a.videoRobustness||""})}),[t]},cu=function(m,u,a,t){switch(m){case Jr.WIDEVINE:return uu(u,a,t);default:throw new Error("Unknown key-system: "+m)}},du=function(y){lu(m,y);function m(a){var t;return t=y.call(this,a,d.default.MEDIA_ATTACHED,d.default.MEDIA_DETACHED,d.default.MANIFEST_PARSED)||this,t._widevineLicenseUrl=void 0,t._licenseXhrSetup=void 0,t._emeEnabled=void 0,t._requestMediaKeySystemAccess=void 0,t._drmSystemOptions=void 0,t._config=void 0,t._mediaKeysList=[],t._media=null,t._hasSetMediaKeys=!1,t._requestLicenseFailureCount=0,t.mediaKeysPromise=null,t._onMediaEncrypted=function(n){if(p.logger.log('Media is encrypted using "'+n.initDataType+'" init data type'),!t.mediaKeysPromise){p.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),t.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var f=function(x){t._media&&(t._attemptSetMediaKeys(x),t._generateRequestWithPreferredKeySession(n.initDataType,n.initData))};t.mediaKeysPromise.then(f).catch(f)},t._config=a.config,t._widevineLicenseUrl=t._config.widevineLicenseUrl,t._licenseXhrSetup=t._config.licenseXhrSetup,t._emeEnabled=t._config.emeEnabled,t._requestMediaKeySystemAccess=t._config.requestMediaKeySystemAccessFunc,t._drmSystemOptions=a.config.drmSystemOptions,t}var u=m.prototype;return u.getLicenseServerUrl=function(t){switch(t){case Jr.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+t+'"')},u._attemptKeySystemAccess=function(t,n,f){var v=this,x=cu(t,n,f,this._drmSystemOptions);p.logger.log("Requesting encrypted media key-system access");var T=this.requestMediaKeySystemAccess(t,x);this.mediaKeysPromise=T.then(function(D){return v._onMediaKeySystemAccessObtained(t,D)}),T.catch(function(D){p.logger.error('Failed to obtain key-system "'+t+'" access:',D)})},u._onMediaKeySystemAccessObtained=function(t,n){var f=this;p.logger.log('Access for key-system "'+t+'" obtained');var v={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:n,mediaKeySystemDomain:t};this._mediaKeysList.push(v);var x=Promise.resolve().then(function(){return n.createMediaKeys()}).then(function(T){return v.mediaKeys=T,p.logger.log('Media-keys created for key-system "'+t+'"'),f._onMediaKeysCreated(),T});return x.catch(function(T){p.logger.error("Failed to create media-keys:",T)}),x},u._onMediaKeysCreated=function(){var t=this;this._mediaKeysList.forEach(function(n){n.mediaKeysSession||(n.mediaKeysSession=n.mediaKeys.createSession(),t._onNewMediaKeySession(n.mediaKeysSession))})},u._onNewMediaKeySession=function(t){var n=this;p.logger.log("New key-system session "+t.sessionId),t.addEventListener("message",function(f){n._onKeySessionMessage(t,f.message)},!1)},u._onKeySessionMessage=function(t,n){p.logger.log("Got EME message event, creating license request"),this._requestLicense(n,function(f){p.logger.log("Received license data (length: "+(f&&f.byteLength)+"), updating key-session"),t.update(f)})},u._attemptSetMediaKeys=function(t){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var n=this._mediaKeysList[0];if(!n||!n.mediaKeys){p.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}p.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(n.mediaKeys),this._hasSetMediaKeys=!0}},u._generateRequestWithPreferredKeySession=function(t,n){var f=this,v=this._mediaKeysList[0];if(!v){p.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(v.mediaKeysSessionInitialized){p.logger.warn("Key-Session already initialized but requested again");return}var x=v.mediaKeysSession;if(!x){p.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!n){p.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}p.logger.log('Generating key-session request for "'+t+'" init data type'),v.mediaKeysSessionInitialized=!0,x.generateRequest(t,n).then(function(){p.logger.debug("Key-session generation succeeded")}).catch(function(T){p.logger.error("Error generating key-session request:",T),f.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},u._createLicenseXhr=function(t,n,f){var v=new XMLHttpRequest,x=this._licenseXhrSetup;try{if(x)try{x(v,t)}catch{v.open("POST",t,!0),x(v,t)}v.readyState||v.open("POST",t,!0)}catch(T){throw new Error("issue setting up KeySystem license XHR "+T)}return v.responseType="arraybuffer",v.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,v,t,n,f),v},u._onLicenseRequestReadyStageChange=function(t,n,f,v){switch(t.readyState){case 4:if(t.status===200)this._requestLicenseFailureCount=0,p.logger.log("License request succeeded"),t.responseType!=="arraybuffer"&&p.logger.warn("xhr response type was not set to the expected arraybuffer for license request"),v(t.response);else{if(p.logger.error("License Request XHR failed ("+n+"). Status: "+t.status+" ("+t.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>Aa){this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var x=Aa-this._requestLicenseFailureCount+1;p.logger.warn("Retrying license request, "+x+" attempts left"),this._requestLicense(f,v)}break}},u._generateLicenseRequestChallenge=function(t,n){switch(t.mediaKeySystemDomain){case Jr.WIDEVINE:return n}throw new Error("unsupported key-system: "+t.mediaKeySystemDomain)},u._requestLicense=function(t,n){p.logger.log("Requesting content license for key-system");var f=this._mediaKeysList[0];if(!f){p.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var v=this.getLicenseServerUrl(f.mediaKeySystemDomain),x=this._createLicenseXhr(v,t,n);p.logger.log("Sending license request to URL: "+v);var T=this._generateLicenseRequestChallenge(f,t);x.send(T)}catch(D){p.logger.error("Failure requesting DRM license: "+D),this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},u.onMediaAttached=function(t){if(this._emeEnabled){var n=t.media;this._media=n,n.addEventListener("encrypted",this._onMediaEncrypted)}},u.onMediaDetached=function(){var t=this._media,n=this._mediaKeysList;t&&(t.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(n.map(function(f){if(f.mediaKeysSession)return f.mediaKeysSession.close().catch(function(){})})).then(function(){return t.setMediaKeys(null)}).catch(function(){}))},u.onManifestParsed=function(t){if(this._emeEnabled){var n=t.levels.map(function(v){return v.audioCodec}),f=t.levels.map(function(v){return v.videoCodec});this._attemptKeySystemAccess(Jr.WIDEVINE,n,f)}},ou(m,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),m}(S),fu=du;function Ra(y,m){var u=Object.keys(y);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(y);m&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(y,t).enumerable})),u.push.apply(u,a)}return u}function Da(y){for(var m=1;m<arguments.length;m++){var u=arguments[m]!=null?arguments[m]:{};m%2?Ra(Object(u),!0).forEach(function(a){hu(y,a,u[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(u)):Ra(Object(u)).forEach(function(a){Object.defineProperty(y,a,Object.getOwnPropertyDescriptor(u,a))})}return y}function hu(y,m,u){return m in y?Object.defineProperty(y,m,{value:u,enumerable:!0,configurable:!0,writable:!0}):y[m]=u,y}var gu=Da(Da({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:60*1e3*1e3,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:gl,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:el,bufferController:nl,capLevelController:ol,fpsController:fl,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:au,testBandwidth:!0},mu()),{},{subtitleStreamController:iu,subtitleTrackController:Ql,timelineController:Wl,audioStreamController:Ml,audioTrackController:yl,emeController:fu});function mu(){return{cueHandler:c,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function Ca(y,m){var u=Object.keys(y);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(y);m&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(y,t).enumerable})),u.push.apply(u,a)}return u}function Ia(y){for(var m=1;m<arguments.length;m++){var u=arguments[m]!=null?arguments[m]:{};m%2?Ca(Object(u),!0).forEach(function(a){pu(y,a,u[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(u)):Ca(Object(u)).forEach(function(a){Object.defineProperty(y,a,Object.getOwnPropertyDescriptor(u,a))})}return y}function pu(y,m,u){return m in y?Object.defineProperty(y,m,{value:u,enumerable:!0,configurable:!0,writable:!0}):y[m]=u,y}function Nt(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function Pa(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function Oa(y,m,u){return m&&Pa(y.prototype,m),u&&Pa(y,u),y}function vu(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var Fa=function(y){vu(m,y),m.isSupported=function(){return di()},Oa(m,null,[{key:"version",get:function(){return"0.14.17"}},{key:"Events",get:function(){return d.default}},{key:"ErrorTypes",get:function(){return h.ErrorTypes}},{key:"ErrorDetails",get:function(){return h.ErrorDetails}},{key:"DefaultConfig",get:function(){return m.defaultConfig?m.defaultConfig:gu},set:function(t){m.defaultConfig=t}}]);function m(a){var t;a===void 0&&(a={}),t=y.call(this)||this,t.config=void 0,t._autoLevelCapping=void 0,t.abrController=void 0,t.capLevelController=void 0,t.levelController=void 0,t.streamController=void 0,t.networkControllers=void 0,t.audioTrackController=void 0,t.subtitleTrackController=void 0,t.emeController=void 0,t.coreComponents=void 0,t.media=null,t.url=null;var n=m.DefaultConfig;if((a.liveSyncDurationCount||a.liveMaxLatencyDurationCount)&&(a.liveSyncDuration||a.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");t.config=Ia(Ia({},n),a);var f=Nt(t),v=f.config;if(v.liveMaxLatencyDurationCount!==void 0&&v.liveMaxLatencyDurationCount<=v.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(v.liveMaxLatencyDuration!==void 0&&(v.liveSyncDuration===void 0||v.liveMaxLatencyDuration<=v.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(p.enableLogs)(v.debug),t._autoLevelCapping=-1;var x=t.abrController=new v.abrController(Nt(t)),T=new v.bufferController(Nt(t)),D=t.capLevelController=new v.capLevelController(Nt(t)),O=new v.fpsController(Nt(t)),F=new Oe(Nt(t)),W=new Be(Nt(t)),Q=new Je(Nt(t)),ve=new ci(Nt(t)),Me=t.levelController=new ui(Nt(t)),Pe=new ft(Nt(t)),De=t.streamController=new Kr(Nt(t),Pe),He=[Me,De],Ve=v.audioStreamController;Ve&&He.push(new Ve(Nt(t),Pe)),t.networkControllers=He;var at=[F,W,Q,x,T,D,O,ve,Pe];if(Ve=v.audioTrackController,Ve){var xt=new Ve(Nt(t));t.audioTrackController=xt,at.push(xt)}if(Ve=v.subtitleTrackController,Ve){var nr=new Ve(Nt(t));t.subtitleTrackController=nr,He.push(nr)}if(Ve=v.emeController,Ve){var zt=new Ve(Nt(t));t.emeController=zt,at.push(zt)}return Ve=v.subtitleStreamController,Ve&&He.push(new Ve(Nt(t),Pe)),Ve=v.timelineController,Ve&&at.push(new Ve(Nt(t))),t.coreComponents=at,t}var u=m.prototype;return u.destroy=function(){p.logger.log("destroy"),this.trigger(d.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(t){t.destroy()}),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},u.attachMedia=function(t){p.logger.log("attachMedia"),this.media=t,this.trigger(d.default.MEDIA_ATTACHING,{media:t})},u.detachMedia=function(){p.logger.log("detachMedia"),this.trigger(d.default.MEDIA_DETACHING),this.media=null},u.loadSource=function(t){t=o.buildAbsoluteURL(window.location.href,t,{alwaysNormalize:!0}),p.logger.log("loadSource:"+t),this.url=t,this.trigger(d.default.MANIFEST_LOADING,{url:t})},u.startLoad=function(t){t===void 0&&(t=-1),p.logger.log("startLoad("+t+")"),this.networkControllers.forEach(function(n){n.startLoad(t)})},u.stopLoad=function(){p.logger.log("stopLoad"),this.networkControllers.forEach(function(t){t.stopLoad()})},u.swapAudioCodec=function(){p.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},u.recoverMediaError=function(){p.logger.log("recoverMediaError");var t=this.media;this.detachMedia(),t&&this.attachMedia(t)},u.removeLevel=function(t,n){n===void 0&&(n=0),this.levelController.removeLevel(t,n)},Oa(m,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(t){p.logger.log("set currentLevel:"+t),this.loadLevel=t,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(t){p.logger.log("set nextLevel:"+t),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(t){p.logger.log("set loadLevel:"+t),this.levelController.manualLevel=t}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(t){this.levelController.nextLoadLevel=t}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(t){p.logger.log("set firstLevel:"+t),this.levelController.firstLevel=t}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(t){p.logger.log("set startLevel:"+t),t!==-1&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}},{key:"capLevelToPlayerSize",set:function(t){var n=!!t;n!==this.config.capLevelToPlayerSize&&(n?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=n)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(t){p.logger.log("set autoLevelCapping:"+t),this._autoLevelCapping=t}},{key:"bandwidthEstimate",get:function(){var t=this.abrController._bwEstimator;return t?t.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var t=this.levels,n=this.config.minAutoBitrate,f=t?t.length:0,v=0;v<f;v++){var x=t[v].realBitrate?Math.max(t[v].realBitrate,t[v].bitrate):t[v].bitrate;if(x>n)return v}return 0}},{key:"maxAutoLevel",get:function(){var t=this.levels,n=this.autoLevelCapping,f;return n===-1&&t&&t.length?f=t.length-1:f=n,f}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(t){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,t)}},{key:"audioTracks",get:function(){var t=this.audioTrackController;return t?t.audioTracks:[]}},{key:"audioTrack",get:function(){var t=this.audioTrackController;return t?t.audioTrack:-1},set:function(t){var n=this.audioTrackController;n&&(n.audioTrack=t)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1},set:function(t){var n=this.subtitleTrackController;n&&(n.subtitleTrack=t)}},{key:"subtitleDisplay",get:function(){var t=this.subtitleTrackController;return t?t.subtitleDisplay:!1},set:function(t){var n=this.subtitleTrackController;n&&(n.subtitleDisplay=t)}}]),m}(q);Fa.defaultConfig=void 0},"./src/polyfills/number.js":function(i,s,l){l.r(s),l.d(s,"isFiniteNumber",function(){return c}),l.d(s,"MAX_SAFE_INTEGER",function(){return o});var c=Number.isFinite||function(h){return typeof h=="number"&&isFinite(h)},o=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/utils/get-self-scope.js":function(i,s,l){l.r(s),l.d(s,"getSelfScope",function(){return c});function c(){return typeof window>"u"?self:window}},"./src/utils/logger.js":function(i,s,l){l.r(s),l.d(s,"enableLogs",function(){return S}),l.d(s,"logger",function(){return E});var c=l("./src/utils/get-self-scope.js");function o(){}var h={trace:o,debug:o,log:o,warn:o,info:o,error:o},g=h;function d(b,L){return L="["+b+"] > "+L,L}var p=Object(c.getSelfScope)();function w(b){var L=p.console[b];return L?function(){for(var A=arguments.length,k=new Array(A),U=0;U<A;U++)k[U]=arguments[U];k[0]&&(k[0]=d(b,k[0])),L.apply(p.console,k)}:o}function _(b){for(var L=arguments.length,A=new Array(L>1?L-1:0),k=1;k<L;k++)A[k-1]=arguments[k];A.forEach(function(U){g[U]=b[U]?b[U].bind(b):w(U)})}var S=function(L){if(p.console&&L===!0||typeof L=="object"){_(L,"debug","log","info","warn","error");try{g.log()}catch{g=h}}else g=h},E=g}}).default})})(co);var pf=co.exports;const Lr=Ur(pf);var En=function(){return En=Object.assign||function(e){for(var r,i=1,s=arguments.length;i<s;i++){r=arguments[i];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},En.apply(this,arguments)},vf=function(e,r){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(i[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(e);l<s.length;l++)r.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(e,s[l])&&(i[s[l]]=e[s[l]]);return i};function _f(e){var r=e.hlsConfig,i=e.playerRef,s=i===void 0?ze.createRef():i,l=e.src,c=e.autoPlay,o=vf(e,["hlsConfig","playerRef","src","autoPlay"]);return R.useEffect(function(){var h;function g(){h?.destroy();var d=new Lr(En({enableWorker:!1},r));s.current!=null&&d.attachMedia(s.current),d.on(Lr.Events.MEDIA_ATTACHED,function(){d.loadSource(l),d.on(Lr.Events.MANIFEST_PARSED,function(){var p;c&&((p=s?.current)===null||p===void 0||p.play().catch(function(){return console.log("Unable to autoplay prior to user interaction with the dom.")}))})}),d.on(Lr.Events.ERROR,function(p,w){if(w.fatal)switch(w.type){case Lr.ErrorTypes.NETWORK_ERROR:d.startLoad();break;case Lr.ErrorTypes.MEDIA_ERROR:d.recoverMediaError();break;default:g();break}}),h=d}return Lr.isSupported()&&g(),function(){h?.destroy()}},[c,r,s,l]),Lr.isSupported()?ze.createElement("video",En({ref:s},o)):ze.createElement("video",En({ref:s,src:l,autoPlay:c},o))}const fo=e=>{const{cssClass:r,state:i,width:s,height:l,border:c,imgId:o,useExternalUrl:h,externalUrl:g,videoUrl:d="",backgroundColor:p,autoplay:w,muted:_,hideAllControls:S,boxShadow:E,boxReflect:b,constraintsVertical:L,constraintsHorizontal:A,isStaticElement:k,left:U,top:N,right:P,bottom:G,staticDevMoveableRef:$,index:J,deltaCenterX:X,deltaCenterY:Z}=e,ie=Pt(i,J),de=It(Ae=>Ae.envState),_e=de==="live"||de==="preview"||de==="build",Ee=Hr(c),Se=Mt({width:s,height:l,constraintsVertical:L,constraintsHorizontal:A,isStaticElement:k,left:U,top:N,right:P,bottom:G,fallbackHeight:"150px",fallbackWidth:"255px",deltaCenterX:X,deltaCenterY:Z}),le=rt({[`element_${e.type}`]:!0,[`${r}`]:r,...ie}),pe=p?{backgroundColor:p}:{backgroundImage:"radial-gradient(rgba(21, 25, 60, 0.8), rgba(0, 0, 0, 0.8))"},[he,Te]=R.useState(!!w),xe=R.useMemo(()=>{const{fullImageUrl:Ae}=Xi({imgId:o,useExternalUrl:h,externalUrl:g});return Ae},[g,o,h]),ye=R.useMemo(()=>xe?{backgroundImage:`url(${xe})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}:{},[xe]),ge=R.useRef(null);R.useEffect(()=>{let Ae;return he&&!d&&(console.info("%cNo Video URL specified","color:#000; background-color:#f93b10"),Ae=setTimeout(()=>{Te(!1)},500)),he&&!_e&&Te(!1),w&&_e&&Te(!0),()=>{Ae&&clearTimeout(Ae)}},[w,_e,he,d]);const be={src:d,autoPlay:!0,controlsList:"nodownload noplaybackrate",controls:!S,width:"100%",height:"100%",disablePictureInPicture:!0,poster:xe??"",preload:"none",muted:!!_,onError:()=>{setTimeout(()=>{console.info("%cError loading video","color:#000; background-color:#f93b10"),Te(!1)},1e3)}},fe=R.useRef(!1);try{fe.current=!!d?.split(".").slice(-1)[0].toLowerCase()?.includes("m3u")}catch(Ae){fe.current=!1,console.error("Error while trying to get video extension",Ae)}const Ue=()=>fe.current?I.jsx(_f,{playerRef:ge,hlsConfig:{autoStartLoad:!0,debug:!0},...be}):I.jsx("video",{...be}),Ce=zr(E),ae=Xt(b),we=R.useCallback(()=>{_e&&Te(!0)},[_e]);return I.jsx(mf,{onClick:we,...e,ref:Ae=>{$&&($.current=Ae)},style:{borderRadius:"8px",...Se,...ye,...Ee,...pe,...Ce,...ae},className:le,children:he?I.jsx(Ue,{}):I.jsx(fr,{className:"playIcon",icon:"BsFillPlayCircleFill"})})};fo.displayName="VideoElement";const yf=pt(jt)`
  min-width: 150px;
  min-height: 50px;
  position: relative;

  &.isVertical {
    min-height: 150px;
    min-width: 70px;
  }

  .flex {
    position: absolute;
    width: 100%;
    height: 100%;
    overflow: hidden;
    display: flex;
    border-radius: ${({theme:e})=>e.borderRadius};
    background: hsla(0, 0%, 100%, 0.15);

    &.isVertical {
      flex-direction: column-reverse;
    }

    &.reverse {
      flex-direction: row-reverse;
      &.isVertical {
        flex-direction: column;
      }
    }

    .activeBg {
      position: absolute;
      left: 0;
      top: 0;
      width: 50%;
      height: 100%;
      z-index: 1;
      background: rgba(0, 0, 0, 0.8);
      will-change: transform, background;
      transition: background 150ms ease, transform 250ms ease;
    }

    &.isVertical {
      .activeBg {
        width: 100%;
        height: 50%;
        top: auto;
        bottom: 0;
      }
    }

    &.reverse {
      .activeBg {
        left: auto;
        right: 0;
      }
      &.isVertical {
        .activeBg {
          bottom: auto;
          top: 0;
        }
      }
    }

    &.checked {
      .activeBg {
        background: ${({theme:e,stateOnActiveBackground:r})=>r||e.colors.primaryColor};
        transform: translateX(100%);
      }
      &.reverse {
        .activeBg {
          transform: translateX(-100%);
        }
      }

      &.isVertical {
        .activeBg {
          transform: translateY(-100%);
        }
        &.reverse {
          .activeBg {
            transform: translateY(100%);
          }
        }
      }
    }

    .on,
    .off {
      position: relative;
      z-index: 2;
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    &.checked {
      .on {
        color: ${({stateOnActiveTextColor:e})=>e||"#000"};
      }
    }
  }
`,ho=e=>{const{cssClass:r,state:i,textFontSize:s,reverse:l=!1,isVertical:c=!1,onText:o,offText:h,width:g,height:d,actions:p,fontFamily:w="inherit",boxShadow:_,boxReflect:S,staticDevMoveableRef:E,constraintsVertical:b,constraintsHorizontal:L,isStaticElement:A,left:k,top:U,right:N,bottom:P,index:G,deltaCenterX:$,deltaCenterY:J}=e,X=mt(Oe=>Oe.showBoundingBox),Z=Pt(i,G),ie=Wt(i?.checkedState_signal)??!1,[de,_e]=R.useState(ie),Ee=R.useRef(),Se=R.useRef(ie);R.useEffect(()=>{Se.current=ie,_e(ie)},[ie]);const le=Et(s),pe=rt({on:!0}),he=rt({off:!0}),Te=rt({activeBg:!0}),xe=rt({flex:!0,checked:de,reverse:l,isVertical:c}),ye=Mt({width:g,height:d,constraintsVertical:b,constraintsHorizontal:L,isStaticElement:A,left:k,top:U,right:N,bottom:P,fallbackWidth:"120px",fallbackHeight:"50px",deltaCenterX:$,deltaCenterY:J}),{onBeforeChangeActions:ge,onAfterChangeActions:be,onChangeActions:fe,isActiveOverlayTrigger:Ue}=lr({actions:p}),Ce=rt({[`element_${e.type}`]:!0,[`${r}`]:r,showBoundingBox:X,isVertical:c,isActiveOverlayTrigger:!!Ue,...Z});function ae(Oe){function Fe(){clearTimeout(Ee.current),Ee.current=setTimeout(()=>{_e(Se.current)},3e3)}if(Fe(),ge.length)for(const Ne of ge)Ne(Oe);if(fe.length)for(const Ne of fe)Ne(Oe);if(_e(Oe),be.length)for(const Ne of be)Ne(Oe)}const we=zr(_),Ae=Xt(S);return I.jsx(yf,{style:{...ye,fontFamily:w,...we,...Ae},...e,ref:Oe=>{E&&(E.current=Oe)},className:Ce,children:I.jsxs("div",{className:xe,children:[I.jsx("div",{className:Te}),I.jsx("div",{onClick:()=>{ae(!1)},className:he,children:h?I.jsx(Rt,{...e,style:le,text:h}):"OFF"}),I.jsx("div",{onClick:()=>{ae(!0)},className:pe,children:o?I.jsx(Rt,{...e,style:le,text:o}):"ON"})]})})};ho.displayName="ToggleWidget";const bf=pt(jt)`
  position: relative;
  display: flex;
  align-items: center;
justify-content: center;

  .circleSliderOuter {
    position: relative;

    .circleSliderCenterText {
      pointer-events: none;
      position: absolute;
      left: 20%;
      top: 20%;
      width: 60%;
      height: 60%;
      display: flex;
      flex-flow: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      gap: 5%;
      container-type: size;

      & > * {
        position: relative;
        width: 100%;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        text-align: center;
        line-height: 100%;
      }

      .circleSliderPreTitle,
      .circleSliderPreValue {
        line-height: 100%;
        font-size: 10px;
        text-transform: uppercase;
        opacity: 0.7;
      }

      .circleSliderTitle {
        font-size: 30cqw;
        font-weight: 300;
        line-height: 100%;
        p {
          line-height: 100%;
          margin: 0;
          padding: 0;
        }
      }

      .circleSliderSubTitle {
        font-size: 15cqw;
        font-weight: 100;
        display: flex;
        /* gap: 0.3em; */
        justify-content: center;
        font-family: 'Helvetica';
      }

      .circleSliderDescription {
        font-size: max(6cqw, 6px);
        font-weight: 300;
        opacity: 0.7;
        text-transform: uppercase;
      }
    }
  }
`;function Sf(e){const{angle:r,minValue:i,maxValue:s,startAngle:l,endAngle:c}=e;if(c<=l)throw new Error("endAngle must be greater than startAngle");return r<l?i:r>c?s:(r-l)/(c-l)*(s-i)+i}function ss(e){const{value:r,minValue:i,maxValue:s,startAngle:l,endAngle:c}=e;if(c<=l)throw new Error("endAngle must be greater than startAngle");return(r-i)/(s-i)*(c-l)+l}function go(e,r,i){if(i=i||{direction:"ccw",axis:"+x"},r.direction!==i.direction&&(e=e===0?0:360-e),r.axis===i.axis)return e;if(r.axis[1]===i.axis[1])return(180+e)%360;switch(i.direction+r.axis+i.axis){case"ccw+x-y":case"ccw-x+y":case"ccw+y+x":case"ccw-y-x":case"cw+y-x":case"cw-y+x":case"cw-x-y":case"cw+x+y":return(90+e)%360;case"ccw+y-x":case"ccw-y+x":case"ccw+x+y":case"ccw-x-y":case"cw+x-y":case"cw-x+y":case"cw+y+x":case"cw-y-x":return(270+e)%360;default:throw new Error("Unhandled conversion")}}function sn(e,r,i){const l=go(e.degree,e,{direction:"ccw",axis:"+x"})/180*Math.PI;let c,o;l<=Math.PI?l<=Math.PI/2?(o=Math.sin(l)*r,c=Math.cos(l)*r):(o=Math.sin(Math.PI-l)*r,c=Math.cos(Math.PI-l)*r*-1):l<=Math.PI*1.5?(o=Math.sin(l-Math.PI)*r*-1,c=Math.cos(l-Math.PI)*r*-1):(o=Math.sin(2*Math.PI-l)*r*-1,c=Math.cos(2*Math.PI-l)*r);const h=c+i/2,g=i/2-o;return{x:h,y:g}}function Ef(e,r,i){const s=e.x-r/2,l=r/2-e.y;let c=Math.atan2(l,s);c<0&&(c=c+2*Math.PI);const o=c/Math.PI*180;return go(o,{direction:"ccw",axis:"+x"},i)}function vn(e){const{startAngle:r,innerRadius:i,thickness:s,direction:l,angleType:c,svgSize:o}=e;let{endAngle:h}=e;r%360===h%360&&r!==h&&(h=h-.001);const g=h-r>=180,d=i+s,p=sn({degree:r,...c},i,o),w=`
    M ${p.x},${p.y}
  `,_=sn({degree:h,...c},i,o),S=`
    A ${i} ${i} 0
      ${g?"1":"0"}
      ${l==="cw"?"1":"0"}
      ${_.x} ${_.y}
  `,E=sn({degree:h,...c},d,o),b=`
    A ${s/2} ${s/2} 0
      ${g?"1":"0"}
      ${l==="cw"?"0":"1"}
      ${E.x} ${E.y}
  `,L=sn({degree:r,...c},d,o),A=`
    A ${d} ${d} 0
      ${g?"1":"0"}
      ${l==="cw"?"0":"1"}
      ${L.x} ${L.y}
  `,k=`
    A ${s/2} ${s/2} 0
      ${g?"1":"0"}
      ${l==="cw"?"0":"1"}
      ${p.x} ${p.y}
  `;return w+S+b+A+k+" Z"}class Hi extends R.Component{static defaultProps={size:200,minValue:0,maxValue:100,startAngle:0,endAngle:360,angleType:{direction:"cw",axis:"-y"},handleSize:8,arcBackgroundColor:"#aaa",trackWidth:6};svgRef=R.createRef();onMouseEnter=r=>{r.buttons===1&&this.onMouseDown(r)};onMouseDown=r=>{if(this.svgRef.current&&r.target instanceof Element){const s=r.target.tagName;(s==="circle"||s==="path")&&(window.addEventListener("mousemove",this.handleMousePosition),window.addEventListener("mouseleave",this.removeMouseListeners),window.addEventListener("mouseup",this.removeMouseListeners))}};removeMouseListeners=()=>{window.removeEventListener("mousemove",this.handleMousePosition),window.removeEventListener("mouseleave",this.removeMouseListeners),window.removeEventListener("mouseup",this.removeMouseListeners),this.props.onControlFinished&&this.props.onControlFinished()};handleMousePosition=r=>{const i=r.clientX,s=r.clientY;this.processSelection(i,s)};onTouch=r=>{if(r.touches.length>1||r.type==="touchend"&&r.touches.length>0)return;const i=r.changedTouches[0],s=i.clientX,l=i.clientY;if(r.target instanceof Element){const c=r.target.tagName;(c==="circle"||c==="path")&&this.processSelection(s,l)}};processSelection=(r,i)=>{const{size:s,maxValue:l,minValue:c,angleType:o,startAngle:h,endAngle:g,handle1:d,disabled:p,handle2:w,coerceToInt:_}=this.props;if(!d.onChange)return;const S=this.svgRef.current;if(!S)return;const E=S.createSVGPoint();E.x=r,E.y=i;const b=E.matrixTransform(S.getScreenCTM()?.inverse()),L=Ef(b,s,o);let A=Sf({angle:L,minValue:c,maxValue:l,startAngle:h,endAngle:g});_&&(A=Math.round(A)),p||(w&&w.onChange&&Math.abs(A-w.value)<Math.abs(A-d.value)?w.onChange(A):d.onChange(A))};render(){const{size:r,handle1:i,handle2:s,handleSize:l,maxValue:c,minValue:o,startAngle:h,endAngle:g,angleType:d,disabled:p,arcColor:w,arcBackgroundColor:_,outerShadow:S,trackWidth:E=4,startColor:b,endColor:L,handleColor:A,index:k,interpolatedColor:U}=this.props,N=20,P=r/2-E-N,G=ss({value:i.value,minValue:o,maxValue:c,startAngle:h,endAngle:g}),$=s&&ss({value:s.value,minValue:o,maxValue:c,startAngle:h,endAngle:g}),J=sn({degree:G,...d},P+E/2,r),X=$&&sn({degree:$,...d},P+E/2,r),Z=!p&&!!i.onChange,ie=Math.abs((i.value/10||1)-100)-50;return I.jsxs("svg",{className:`circleSlider_${k}`,width:r,height:r,ref:this.svgRef,onMouseDown:this.onMouseDown,onClick:de=>Z&&de.stopPropagation(),onTouchStart:this.onTouch,onTouchEnd:this.onTouch,onTouchMove:this.onTouch,children:[I.jsx("defs",{children:I.jsxs("linearGradient",{id:`linear_${k}`,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[I.jsx("stop",{offset:ie,style:{stopColor:b}}),I.jsx("stop",{offset:"100%",style:{stopColor:L,stopOpacity:1}})]})}),S&&I.jsxs(R.Fragment,{children:[I.jsxs("radialGradient",{id:"outerShadow",children:[I.jsx("stop",{offset:"90%",stopColor:w}),I.jsx("stop",{offset:"100%",stopColor:"white"})]}),I.jsx("circle",{fill:"none",stroke:"url(#outerShadow)",cx:r/2,cy:r/2,r:P+E+N/2-1,strokeWidth:N})]}),$===void 0?I.jsxs(R.Fragment,{children:[I.jsx("path",{d:vn({startAngle:G,endAngle:g,angleType:d,innerRadius:P,thickness:E,svgSize:r,direction:d.direction}),fill:_}),I.jsx("path",{d:vn({startAngle:h,endAngle:G,angleType:d,innerRadius:P,thickness:E,svgSize:r,direction:d.direction}),fill:U||`url(#linear_${k})`})]}):I.jsxs(R.Fragment,{children:[I.jsx("path",{d:vn({startAngle:h,endAngle:G,angleType:d,innerRadius:P,thickness:E,svgSize:r,direction:d.direction}),fill:_}),I.jsx("path",{d:vn({startAngle:$,endAngle:g,angleType:d,innerRadius:P,thickness:E,svgSize:r,direction:d.direction}),fill:_}),I.jsx("path",{d:vn({startAngle:G,endAngle:$,angleType:d,innerRadius:P,thickness:E,svgSize:r,direction:d.direction}),fill:w})]}),Z&&I.jsxs(R.Fragment,{children:[I.jsxs("filter",{id:"handleShadow",x:"-50%",y:"-50%",width:"16",height:"16",children:[I.jsx("feOffset",{result:"offOut",in:"SourceGraphic",dx:"0",dy:"0"}),I.jsx("feColorMatrix",{result:"matrixOut",in:"offOut",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"}),I.jsx("feGaussianBlur",{result:"blurOut",in:"matrixOut",stdDeviation:"5"}),I.jsx("feBlend",{in:"SourceGraphic",in2:"blurOut",mode:"normal"})]}),I.jsx("circle",{r:l,cx:J.x,cy:J.y,fill:A,filter:"url(#handleShadow)",stroke:"transparent","stroke-width":"20"})]}),X&&I.jsx(R.Fragment,{children:I.jsx("circle",{r:l,cx:X.x,cy:X.y,fill:"#ffffff",filter:"url(#handleShadow)"})})]},k)}}class Dp extends R.Component{static defaultProps=Hi.defaultProps;render(){const{size:r}=this.props;return I.jsxs("div",{style:{width:r,height:r,position:"relative"},children:[I.jsx(Hi,{...this.props}),I.jsx("div",{style:{position:"absolute",top:"25%",left:"50%",transform:"translateX(-50%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:this.props.children})]})}}var os=Ts(),xf=Tf,ls={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function Tf(e){var r,i=[],s=1,l;if(typeof e=="string")if(e=e.toLowerCase(),os[e])i=os[e].slice(),l="rgb";else if(e==="transparent")s=0,l="rgb",i=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(e)){var c=e.slice(1),o=c.length,h=o<=4;s=1,h?(i=[parseInt(c[0]+c[0],16),parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16)],o===4&&(s=parseInt(c[3]+c[3],16)/255)):(i=[parseInt(c[0]+c[1],16),parseInt(c[2]+c[3],16),parseInt(c[4]+c[5],16)],o===8&&(s=parseInt(c[6]+c[7],16)/255)),i[0]||(i[0]=0),i[1]||(i[1]=0),i[2]||(i[2]=0),l="rgb"}else if(r=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(e)){var g=r[1],d=g==="rgb",c=g.replace(/a$/,"");l=c;var o=c==="cmyk"?4:c==="gray"?1:3;i=r[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(_,S){if(/%$/.test(_))return S===o?parseFloat(_)/100:c==="rgb"?parseFloat(_)*255/100:parseFloat(_);if(c[S]==="h"){if(/deg$/.test(_))return parseFloat(_);if(ls[_]!==void 0)return ls[_]}return parseFloat(_)}),g===c&&i.push(1),s=d||i[o]===void 0?1:i[o],i=i.slice(0,o)}else e.length>10&&/[0-9](?:\s|\/)/.test(e)&&(i=e.match(/([0-9]+)/g).map(function(p){return parseFloat(p)}),l=e.match(/([a-z])/ig).join("").toLowerCase());else isNaN(e)?Array.isArray(e)||e.length?(i=[e[0],e[1],e[2]],l="rgb",s=e.length===4?e[3]:1):e instanceof Object&&(e.r!=null||e.red!=null||e.R!=null?(l="rgb",i=[e.r||e.red||e.R||0,e.g||e.green||e.G||0,e.b||e.blue||e.B||0]):(l="hsl",i=[e.h||e.hue||e.H||0,e.s||e.saturation||e.S||0,e.l||e.lightness||e.L||e.b||e.brightness]),s=e.a||e.alpha||e.opacity||1,e.opacity!=null&&(s/=100)):(l="rgb",i=[e>>>16,(e&65280)>>>8,e&255]);return{space:l,values:i,alpha:s}}var Mf={},wf=Mf,Lf={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(e){var r=e[0]/360,i=e[1]/100,s=e[2]/100,l,c,o,h,g;if(i===0)return g=s*255,[g,g,g];s<.5?c=s*(1+i):c=s+i-s*i,l=2*s-c,h=[0,0,0];for(var d=0;d<3;d++)o=r+1/3*-(d-1),o<0?o++:o>1&&o--,6*o<1?g=l+(c-l)*6*o:2*o<1?g=c:3*o<2?g=l+(c-l)*(2/3-o)*6:g=l,h[d]=g*255;return h}};wf.hsl=function(e){var r=e[0]/255,i=e[1]/255,s=e[2]/255,l=Math.min(r,i,s),c=Math.max(r,i,s),o=c-l,h,g,d;return c===l?h=0:r===c?h=(i-s)/o:i===c?h=2+(s-r)/o:s===c&&(h=4+(r-i)/o),h=Math.min(h*60,360),h<0&&(h+=360),d=(l+c)/2,c===l?g=0:d<=.5?g=o/(c+l):g=o/(2-c-l),[h,g*100,d*100]};function kf(e,r,i){return e*(1-i)+r*i}var Af=kf,Rf=Df;function Df(e,r,i){return r<i?e<r?r:e>i?i:e:e<i?i:e>r?r:e}const Cf=xf,If=Lf,Pf=Af,Of=Rf;var Ff=Nf;function Nf(e){return e=e.map(function(r){if(r=Cf(r),r.space!="rgb"){if(r.space!="hsl")throw"c.spacespace is not supported.";r.values=If.rgb(r.values)}return r.values.push(r.alpha),r.values}),function(r,i){i=i||Pf,r=Of(r,0,1);var s=(e.length-1)*r,l=Math.floor(s),c=Math.ceil(s);r=s-l;var o=e[l],h=e[c],g=o.map(function(d,p){return d=i(d,h[p],r),p<3&&(d=Math.round(d)),d});return g[3]===1?"rgb("+g.slice(0,3)+")":"rgba("+g+")"}}const Yf=Ur(Ff);function Bf(e,r){var i=R.useRef(null),s=R.useRef(null);s.current=r;var l=R.useRef(null);R.useEffect(function(){c()});var c=R.useCallback(function(){var o=l.current,h=s.current,g=o||(h?h instanceof Element?h:h.current:null);i.current&&i.current.element===g&&i.current.subscriber===e||(i.current&&i.current.cleanup&&i.current.cleanup(),i.current={element:g,subscriber:e,cleanup:g?e(g):void 0})},[e]);return R.useEffect(function(){return function(){i.current&&i.current.cleanup&&(i.current.cleanup(),i.current=null)}},[]),R.useCallback(function(o){l.current=o,c()},[c])}function us(e,r,i){return e[r]?e[r][0]?e[r][0][i]:e[r][i]:r==="contentBoxSize"?e.contentRect[i==="inlineSize"?"width":"height"]:void 0}function mo(e){e===void 0&&(e={});var r=e.onResize,i=R.useRef(void 0);i.current=r;var s=e.round||Math.round,l=R.useRef(),c=R.useState({width:void 0,height:void 0}),o=c[0],h=c[1],g=R.useRef(!1);R.useEffect(function(){return g.current=!1,function(){g.current=!0}},[]);var d=R.useRef({width:void 0,height:void 0}),p=Bf(R.useCallback(function(w){return(!l.current||l.current.box!==e.box||l.current.round!==s)&&(l.current={box:e.box,round:s,instance:new ResizeObserver(function(_){var S=_[0],E=e.box==="border-box"?"borderBoxSize":e.box==="device-pixel-content-box"?"devicePixelContentBoxSize":"contentBoxSize",b=us(S,E,"inlineSize"),L=us(S,E,"blockSize"),A=b?s(b):void 0,k=L?s(L):void 0;if(d.current.width!==A||d.current.height!==k){var U={width:A,height:k};d.current.width=A,d.current.height=k,i.current?i.current(U):g.current||h(U)}})}),l.current.instance.observe(w,{box:e.box}),function(){l.current&&l.current.instance.unobserve(w)}},[e.box,s]),e.ref);return R.useMemo(function(){return{ref:p,width:o.width,height:o.height}},[p,o.width,o.height])}function jf(e,r,i){const l=(r-e)*i/1e3;return e+l}function Uf(e,r,i){if(i<e)return 0;if(i>r)return 1e3;const s=r-e;return(i-e)/s*1e3}const po=ze.memo(e=>{const{cssClass:r,state:i,gap:s,width:l,backgroundColor:c,handleSize:o,trackWidth:h,handleColor:g,startValue:d=0,endValue:p=100,useColorInterpolation:w=!1,textTitle:_,textBeforeValue:S,textAfterValue:E,textDescription:b,value_signal_a:L,valueSignDisplay:A="auto",textTitleSize:k,textValueSize:U,textDescriptionSize:N,useValueFraction:P,useHalfStep:G,actions:$,textPreTitle:J,textPreValue:X,textPreTitleSize:Z,textPreValueSize:ie,fontFamily:de="inherit",boxReflect:_e,staticDevMoveableRef:Ee,height:Se,constraintsVertical:le,constraintsHorizontal:pe,isStaticElement:he,left:Te,top:xe,right:ye,bottom:ge,index:be,deltaCenterX:fe,deltaCenterY:Ue}=e;let{startColor:Ce,endColor:ae}=e;Ce=Ce||"rgb(0, 162, 255)",ae=ae||"rgb(255, 0, 0)";const we=Pt(i,be),Ae=Et(Z),Oe=Et(ie),Fe=Et(k),Ne=Et(U),Be=Et(N),qe=yt({sizeObj:s,sizePropName:"gap"}),Ie=Yr(L),Je=R.useRef(Ie),[We,nt]=R.useState(0),ft=R.useRef(),j=R.useRef(!1),K=R.useRef(),[B,M]=R.useState("0"),C=R.useRef(B);R.useEffect(()=>{let oe=jf(d,p,We);G&&(oe=Math.round(oe*2)/2),oe=Number(oe.toFixed(P?1:0));const Le=new Intl.NumberFormat("en-US",{signDisplay:A,maximumFractionDigits:P?1:0,minimumFractionDigits:P?1:0});M(Le.format(oe))},[p,We,d,G,P,A]),R.useEffect(()=>{C.current=B},[B]);const Y=R.useCallback(({newValue:oe})=>{if(String(oe).length>1&&P){const $e=String(oe).charAt(String(oe).length-1);oe=+(String(oe).slice(0,-1)+"."+$e)}const Le=Uf(d,p,oe);nt(Le)},[p,d,P]);R.useEffect(()=>{Je.current=Ie,Y({newValue:Ie})},[Y,Ie]),R.useEffect(()=>{Y({newValue:Ie})},[]);function H(oe){nt(Le=>Math.abs(oe-Le)>800?Le:oe)}const[z,V]=R.useState();R.useEffect(()=>{if(w){const Le=Yf([Ce,ae])(We/1e3);V(Le)}else V(void 0)},[ae,We,Ce,w]);const{onBeforeChangeActions:q,onAfterChangeActions:ne,onChangeActions:re,isActiveOverlayTrigger:ee}=lr({actions:$}),se=rt({[`element_${e.type}`]:!0,[`${r}`]:r,isActiveOverlayTrigger:!!ee,...we}),ce=()=>{function oe(){clearTimeout(ft.current),ft.current=setTimeout(()=>{Y({newValue:Je.current})},3e3)}oe();const Le=Number(String(B).replace(".",""));if(!j.current){for(const $e of q)$e(Le);j.current=!0}if(re.length)for(const $e of re)$e(Le);ne.length&&(clearTimeout(K.current),K.current=setTimeout(()=>{const $e=Number(String(C.current).replace(".",""));for(const Xe of ne)Xe($e);j.current=!1},1e3))},me=Xt(_e),ue=Mt({width:l,height:Se,constraintsVertical:le,constraintsHorizontal:pe,isStaticElement:he,left:Te,top:xe,right:ye,bottom:ge,deltaCenterX:fe,deltaCenterY:Ue}),{ref:ke,width:Re}=mo(),Ye=R.useRef(Cu());return I.jsx(bf,{...e,ref:oe=>{Ee&&(Ee.current=oe),ke(oe)},className:se,style:{...me,...ue,visibility:Re?"visible":"hidden"},children:I.jsxs("div",{className:"circleSliderOuter",children:[I.jsx(Hi,{interpolatedColor:z,index:Ye.current,handleColor:g||"#fff",startColor:Ce,endColor:ae,minValue:0,maxValue:1e3,size:Re,handleSize:o??10,handle1:{value:We,onChange:oe=>{H(oe),ce()}},arcBackgroundColor:c||"rgba(255, 255, 255, 0.3)",startAngle:50,endAngle:310,trackWidth:h??2}),I.jsxs("div",{style:{...qe,fontFamily:de},className:"circleSliderCenterText",children:[J&&I.jsx("div",{style:{...Ae},className:"circleSliderPreTitle",children:I.jsx(Rt,{...e,text:J})}),_&&I.jsx("div",{style:{...Fe},className:"circleSliderTitle",children:I.jsx(Rt,{...e,text:_})}),X&&I.jsx("div",{style:{...Oe},className:"circleSliderPreValue",children:I.jsx(Rt,{...e,text:X})}),I.jsxs("div",{style:Ne,className:"circleSliderSubTitle",children:[S&&I.jsx(Rt,{...e,text:S}),B,E&&I.jsx(Rt,{...e,text:E})]}),b&&I.jsx("div",{style:{...Be},className:"circleSliderDescription",children:I.jsx(Rt,{...e,text:b})})]})]})})});po.displayName="CircleSliderWidget";const Hf=pt(jt)`
  position: relative;
  text-transform: uppercase;
  font-size: 14px;
  display: flex;
  flex-flow: column;
  gap: 1em;

  .rc-slider {
    border-radius: 0;
    pointer-events: none;
    padding: 0;

    .rc-slider-rail {
      display: none;
    }
    .rc-slider-handle {
      display: none;
    }
    .rc-slider-track {
      pointer-events: auto;
      border: 0;
      border-radius: 0;
      min-height: 20px;
      min-width: 20px;
      background-color: ${({shaderBackgroundColor:e})=>e};
      background-image: ${({shadesFabricImageBg:e})=>`url(${e})`};
      -webkit-backdrop-filter: ${({shaderBackgroundBlur:e})=>`blur(${e}px)`};
      backdrop-filter: ${({shaderBackgroundBlur:e})=>`blur(${e}px)`};
      background-size: 'cover';
      background-repeat: no-repeat;
      background-position: 50% 50%;
    }
  }

  .shadeVerticalSlider {
    width: 100%;
    .rc-slider-track {
      width: 100%;
      right: 0;
      cursor: row-resize;
    }
  }

  .shadeHorisontalSliderLeft,
  .shadeHorisontalSliderRight {
    position: absolute;
    height: 100%;
    width: 50%;
    top: 0;

    &.single {
      width: 100%;
    }

    .rc-slider-track {
      height: 100%;
      cursor: col-resize;
      transform: none;
    }
  }

  .shadeHorisontalSliderLeft {
    left: 0;
  }

  .shadeHorisontalSliderRight {
    right: 0;
  }

  .shadesHeader {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
  }

  .shadesMainContainer {
    position: 'relative';
    overflow: hidden;
    width: 100%;
    height: 100%;
    display: flex;
    flex-flow: ${({shadesOrientation:e})=>e==="vertical"?"row":"column"};
    border-style: solid;
  }

  .shadesBg {
    position: relative;
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;

    .frame {
      position: absolute;
      z-index: 1;
      left: 0;
      top: 0;
      background-color: rgba(0, 0, 0, 0.5);

      &.h {
        width: 100%;
        height: 5px;
        transform: translateY(-50%);
      }

      &.v {
        height: 100%;
        width: 5px;
        transform: translateX(-50%);
      }
    }

    img {
      position: absolute;
      width: 100%;
      height: 100%;
    }
  }

  .shadesSidebar {
    position: relative;
    display: flex;
    align-items: center;
    flex-flow: ${({shadesOrientation:e})=>e==="vertical"?"column":"row"};
    min-width: 2em;
    min-height: 2em;

    & > * {
      flex: 1;
      padding: 0 !important;
      font-size: inherit;
    }
  }
`;function zf({horizontalFramesCount:e,verticalFramesCount:r,horizontalFrameHeight:i,verticalFrameWidth:s,framesBackgroundColor:l}){const c=[],o=[];if(e){const h=100/e;let g=0;for(;g<e;)c.push(I.jsx("div",{style:{top:`${h*g+h/2}%`,...i,backgroundColor:l},className:"frame h"},"h"+g)),g++}if(r){const h=100/r;let g=0;for(;g<r;)o.push(I.jsx("div",{style:{left:`${h*g+h/2}%`,...s,backgroundColor:l},className:"frame v"},"v"+g)),g++}return I.jsxs(I.Fragment,{children:[c,o]})}const vo=e=>{const{cssClass:r,width:i,height:s,actions:l,state:c,imgId:o,useExternalUrl:h,externalUrl:g,fillType:d,fillAlignX:p,fillAlignY:w,shadesOrientation:_="vertical",headerLeftText:S,headerRightText:E,border:b,windowBackgroundColor:L,controlsBackgroundColor:A,headerLeftTextFontSize:k,headerRightTextFontSize:U,controlsFontSize:N,horizontalFramesCount:P,verticalFramesCount:G,verticalFrameSize:$,horizontalFrameSize:J,framesBackgroundColor:X,shaderBackgroundColor:Z,shaderBackgroundBlur:ie,shaderBackgroundImage:de,open_signal_d:_e,close_signal_d:Ee,stop_signal_d:Se,closedValue_signal_a_fb:le,showOpenPercentValue:pe,horisontalShadesMode:he="both",boxShadow:Te,boxReflect:xe,staticDevMoveableRef:ye,constraintsVertical:ge,constraintsHorizontal:be,isStaticElement:fe,left:Ue,top:Ce,right:ae,bottom:we,index:Ae,deltaCenterX:Oe,deltaCenterY:Fe}=e,Ne=yt({sizeObj:J,sizePropName:"height"}),Be=yt({sizeObj:$,sizePropName:"width"}),qe=R.useRef(null),Ie=Et(k),Je=Et(U),We=Et(N),nt=Pt(c,Ae),ft=It(oe=>oe.envState),j=Mt({width:i,height:s,constraintsVertical:ge,constraintsHorizontal:be,isStaticElement:fe,left:Ue,top:Ce,right:ae,bottom:we,fallbackHeight:"200px",fallbackWidth:"300px",deltaCenterX:Oe,deltaCenterY:Fe}),K=Hr(b),B=zr(Te),{onBeforeChangeActions:M,onAfterChangeActions:C,onChangeActions:Y,isActiveOverlayTrigger:H}=lr({actions:l}),z=rt({[`element_${e.type}`]:!0,[`${r}`]:r,showBoundingBox:ft==="editor",isActiveOverlayTrigger:!!H,...nt});function V(oe){let Le;switch(oe){case"open":Le=_e;break;case"stop":Le=Se;break;case"close":Le=Ee;break}if(M.length)for(const $e of M)$e(oe);if(Y.length)for(const $e of Y)$e(oe);if(Br(Le),C.length)for(const $e of C)$e(oe)}const q=Yr(le),ne=R.useRef(!1),re=R.useRef(),[ee,se]=R.useState(ft==="editor"?50:q),ce=R.useRef(ee);function me(oe){if(clearTimeout(re.current),se(oe),Y.length)for(const Le of Y)Le(oe)}function ue(oe){if(ne.current=!0,M.length)for(const Le of M)Le(oe)}function ke(oe){function Le(){clearTimeout(re.current),re.current=setTimeout(()=>{It.getState().envState!=="editor"&&se(ce.current),ne.current=!1},3e3)}if(Le(),C.length)for(const $e of C)$e(oe)}R.useEffect(()=>{ce.current=q,ft==="editor"?se(50):ne.current||se(q)},[ft,q]);const Re=R.useMemo(()=>{if(!de)return;const{fullImageUrl:oe}=Xi({imgId:Number(de),useExternalUrl:h,externalUrl:g});return oe},[g,de,h]),Ye=Xt(xe);return I.jsxs(Hf,{shaderBackgroundBlur:ie,shaderBackgroundColor:Z,shadesFabricImageBg:Re||"",ref:oe=>{ye&&(ye.current=oe),qe.current=oe},...e,shadesOrientation:_,style:{...j,...Ye},className:z,children:[I.jsxs("div",{className:"shadesHeader",children:[I.jsx("div",{style:{...Ie},children:S?I.jsx(Rt,{...e,text:S}):null}),I.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.3em",...Je},children:[pe??!0?ee:"",E?I.jsx(Rt,{...e,text:E}):null]})]}),I.jsxs("div",{className:"shadesMainContainer",style:{...K,...B},children:[I.jsxs("div",{className:"shadesBg",style:{backgroundColor:L||"rgba(0, 0, 0, 0.2)"},children:[I.jsx(Hu,{imgId:o,useExternalUrl:h,externalUrl:g,renderEnvtype:ft,fillType:d,fillAlignX:p,fillAlignY:w}),zf({horizontalFramesCount:P??2,verticalFramesCount:G??3,horizontalFrameHeight:Ne,verticalFrameWidth:Be,framesBackgroundColor:X}),_==="vertical"&&I.jsx(Fr,{ref:null,value:ee,onBeforeChange:oe=>{ue(oe)},onChange:oe=>{me(oe)},onChangeComplete:oe=>{ke(oe)},className:"shadeVerticalSlider",reverse:!0,vertical:!0,min:0,max:100,draggableTrack:!0}),_!=="vertical"&&he==="left"&&I.jsx(Fr,{ref:null,value:ee,onBeforeChange:oe=>{ue(oe)},onChange:oe=>{me(oe)},onChangeComplete:oe=>{ke(oe)},className:"shadeHorisontalSliderLeft single",reverse:!1,vertical:!1,min:0,max:100,draggableTrack:!0}),_!=="vertical"&&he==="right"&&I.jsx(Fr,{ref:null,value:ee,onBeforeChange:oe=>{ue(oe)},onChange:oe=>{me(oe)},onChangeComplete:oe=>{ke(oe)},className:"shadeHorisontalSliderRight single",reverse:!0,vertical:!1,min:0,max:100,draggableTrack:!0}),_!=="vertical"&&he==="both"&&I.jsxs(I.Fragment,{children:[I.jsx(Fr,{ref:null,value:ee,onBeforeChange:oe=>{ue(oe)},onChange:oe=>{me(oe)},onChangeComplete:oe=>{ke(oe)},className:"shadeHorisontalSliderLeft",reverse:!1,vertical:!1,min:0,max:100,draggableTrack:!0}),I.jsx(Fr,{ref:null,value:ee,onBeforeChange:oe=>{ue(oe)},onChange:oe=>{me(oe)},onChangeComplete:oe=>{ke(oe)},className:"shadeHorisontalSliderRight",reverse:!0,vertical:!1,min:0,max:100,draggableTrack:!0})]})]}),I.jsxs("div",{style:{backgroundColor:A??"rgba(0, 0, 0, 0.5)",...We},className:"shadesSidebar",children:[I.jsx(bn,{onClick:()=>V("open"),className:"element_button el ghost",children:_==="horizontal"?I.jsx(cc,{}):I.jsx(Bu,{})}),I.jsx(bn,{onClick:()=>V("stop"),className:"element_button el ghost",children:I.jsx(fr,{icon:"RiStopFill"})}),I.jsx(bn,{onClick:()=>V("close"),className:"element_button el ghost",children:_==="horizontal"?I.jsx(hc,{rotate:90}):I.jsx(ju,{})})]})]})]})};vo.displayName="ShadesWidget";const Gf=pt(jt)`
  position: relative;

  &.isEditor {
    background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M54.627 0l.83.828-1.415 1.415L51.8 0h2.827zM5.373 0l-.83.828L5.96 2.243 8.2 0H5.374zM48.97 0l3.657 3.657-1.414 1.414L46.143 0h2.828zM11.03 0L7.372 3.657 8.787 5.07 13.857 0H11.03zm32.284 0L49.8 6.485 48.384 7.9l-7.9-7.9h2.83zM16.686 0L10.2 6.485 11.616 7.9l7.9-7.9h-2.83zm20.97 0l9.315 9.314-1.414 1.414L34.828 0h2.83zM22.344 0L13.03 9.314l1.414 1.414L25.172 0h-2.83zM32 0l12.142 12.142-1.414 1.414L30 .828 17.272 13.556l-1.414-1.414L28 0h4zM.284 0l28 28-1.414 1.414L0 2.544V0h.284zM0 5.373l25.456 25.455-1.414 1.415L0 8.2V5.374zm0 5.656l22.627 22.627-1.414 1.414L0 13.86v-2.83zm0 5.656l19.8 19.8-1.415 1.413L0 19.514v-2.83zm0 5.657l16.97 16.97-1.414 1.415L0 25.172v-2.83zM0 28l14.142 14.142-1.414 1.414L0 30.828V28zm0 5.657L11.314 44.97 9.9 46.386l-9.9-9.9v-2.828zm0 5.657L8.485 47.8 7.07 49.212 0 42.143v-2.83zm0 5.657l5.657 5.657-1.414 1.415L0 47.8v-2.83zm0 5.657l2.828 2.83-1.414 1.413L0 53.456v-2.83zM54.627 60L30 35.373 5.373 60H8.2L30 38.2 51.8 60h2.827zm-5.656 0L30 41.03 11.03 60h2.828L30 43.858 46.142 60h2.83zm-5.656 0L30 46.686 16.686 60h2.83L30 49.515 40.485 60h2.83zm-5.657 0L30 52.343 22.343 60h2.83L30 55.172 34.828 60h2.83zM32 60l-2-2-2 2h4zM59.716 0l-28 28 1.414 1.414L60 2.544V0h-.284zM60 5.373L34.544 30.828l1.414 1.415L60 8.2V5.374zm0 5.656L37.373 33.656l1.414 1.414L60 13.86v-2.83zm0 5.656l-19.8 19.8 1.415 1.413L60 19.514v-2.83zm0 5.657l-16.97 16.97 1.414 1.415L60 25.172v-2.83zM60 28L45.858 42.142l1.414 1.414L60 30.828V28zm0 5.657L48.686 44.97l1.415 1.415 9.9-9.9v-2.828zm0 5.657L51.515 47.8l1.414 1.413 7.07-7.07v-2.83zm0 5.657l-5.657 5.657 1.414 1.415L60 47.8v-2.83zm0 5.657l-2.828 2.83 1.414 1.413L60 53.456v-2.83zM39.9 16.385l1.414-1.414L30 3.658 18.686 14.97l1.415 1.415 9.9-9.9 9.9 9.9zm-2.83 2.828l1.415-1.414L30 9.313 21.515 17.8l1.414 1.413 7.07-7.07 7.07 7.07zm-2.827 2.83l1.414-1.416L30 14.97l-5.657 5.657 1.414 1.415L30 17.8l4.243 4.242zm-2.83 2.827l1.415-1.414L30 20.626l-2.828 2.83 1.414 1.414L30 23.456l1.414 1.414zM56.87 59.414L58.284 58 30 29.716 1.716 58l1.414 1.414L30 32.544l26.87 26.87z' fill='%239C92AC' fill-opacity='0.2' fill-rule='evenodd'/%3E%3C/svg%3E");
  }
`,_o=e=>{const{cssClass:r,state:i,width:s,height:l,border:c,backgroundColor:o,htmlContent:h,indexInList:g,actions:d,dataset:p,datasetPath:w,filter:_,parentData:S,boxShadow:E,boxReflect:b,staticDevMoveableRef:L,constraintsVertical:A,constraintsHorizontal:k,isStaticElement:U,left:N,top:P,right:G,bottom:$,index:J,deltaCenterX:X,deltaCenterY:Z}=e,ie=Pt(i,J),de=It(be=>be.envState),_e=Hr(c),Ee=Mt({width:s,height:l,constraintsVertical:A,constraintsHorizontal:k,isStaticElement:U,left:N,top:P,right:G,bottom:$,deltaCenterX:X,deltaCenterY:Z}),Se=zr(E),le=o?{backgroundColor:o}:{},pe=R.useRef(null),{tapActionsArr:he,isActiveOverlayTrigger:Te}=lr({indexInList:g,actions:d,dataset:p,datasetPath:w,filter:_,elementRef:pe,parentData:S}),xe=rt({[`element_${e.type}`]:!0,[`${r}`]:r,isEditor:de==="editor",isActiveOverlayTrigger:!!Te,...ie}),ye=R.useRef(null);R.useEffect(()=>{if(ye.current)try{const be=ye.current.contentDocument;if(be){be.open(),be.close(),be.write(h??""),ye.current?.contentWindow&&(ye.current.contentWindow.avgatorStudio=window.avgatorStudio);const fe=be.querySelectorAll("script");for(const Ue of fe){const Ce=be.createElement("script");for(const ae of Ue.attributes)Ce.setAttribute(ae.name,ae.value);Ue.innerHTML&&(Ce.innerHTML=Ue.innerHTML),be.body?.appendChild(Ce)}}}catch(be){console.log(be)}},[h]);const ge=Xt(b);return I.jsx(Gf,{...he,...e,ref:be=>{L&&(L.current=be),pe.current=be},style:{...Ee,..._e,...le,...Se,...ge},className:xe,children:I.jsx("iframe",{ref:ye,width:"100%",height:"100%",title:"htmlBlockElement"})})};_o.displayName="HtmlBlockElement";const $f=pt(jt)`
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
`;var yo={exports:{}};(function(e,r){(function(i,s){e.exports=s()})(Ke,function(){var i="minute",s=/[+-]\d\d(?::?\d\d)?/g,l=/([+-]|\d\d)/g;return function(c,o,h){var g=o.prototype;h.utc=function(b){var L={date:b,utc:!0,args:arguments};return new o(L)},g.utc=function(b){var L=h(this.toDate(),{locale:this.$L,utc:!0});return b?L.add(this.utcOffset(),i):L},g.local=function(){return h(this.toDate(),{locale:this.$L,utc:!1})};var d=g.parse;g.parse=function(b){b.utc&&(this.$u=!0),this.$utils().u(b.$offset)||(this.$offset=b.$offset),d.call(this,b)};var p=g.init;g.init=function(){if(this.$u){var b=this.$d;this.$y=b.getUTCFullYear(),this.$M=b.getUTCMonth(),this.$D=b.getUTCDate(),this.$W=b.getUTCDay(),this.$H=b.getUTCHours(),this.$m=b.getUTCMinutes(),this.$s=b.getUTCSeconds(),this.$ms=b.getUTCMilliseconds()}else p.call(this)};var w=g.utcOffset;g.utcOffset=function(b,L){var A=this.$utils().u;if(A(b))return this.$u?0:A(this.$offset)?w.call(this):this.$offset;if(typeof b=="string"&&(b=function(P){P===void 0&&(P="");var G=P.match(s);if(!G)return null;var $=(""+G[0]).match(l)||["-",0,0],J=$[0],X=60*+$[1]+ +$[2];return X===0?0:J==="+"?X:-X}(b),b===null))return this;var k=Math.abs(b)<=16?60*b:b,U=this;if(L)return U.$offset=k,U.$u=b===0,U;if(b!==0){var N=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(U=this.local().add(k+N,i)).$offset=k,U.$x.$localOffset=N}else U=this.utc();return U};var _=g.format;g.format=function(b){var L=b||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return _.call(this,L)},g.valueOf=function(){var b=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*b},g.isUTC=function(){return!!this.$u},g.toISOString=function(){return this.toDate().toISOString()},g.toString=function(){return this.toDate().toUTCString()};var S=g.toDate;g.toDate=function(b){return b==="s"&&this.$offset?h(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():S.call(this)};var E=g.diff;g.diff=function(b,L,A){if(b&&this.$u===b.$u)return E.call(this,b,L,A);var k=this.local(),U=h(b).local();return E.call(k,U,L,A)}}})})(yo);var Vf=yo.exports;const Kf=Ur(Vf);var bo={exports:{}};(function(e,r){(function(i,s){e.exports=s()})(Ke,function(){var i={year:0,month:1,day:2,hour:3,minute:4,second:5},s={};return function(l,c,o){var h,g=function(_,S,E){E===void 0&&(E={});var b=new Date(_),L=function(A,k){k===void 0&&(k={});var U=k.timeZoneName||"short",N=A+"|"+U,P=s[N];return P||(P=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:A,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:U}),s[N]=P),P}(S,E);return L.formatToParts(b)},d=function(_,S){for(var E=g(_,S),b=[],L=0;L<E.length;L+=1){var A=E[L],k=A.type,U=A.value,N=i[k];N>=0&&(b[N]=parseInt(U,10))}var P=b[3],G=P===24?0:P,$=b[0]+"-"+b[1]+"-"+b[2]+" "+G+":"+b[4]+":"+b[5]+":000",J=+_;return(o.utc($).valueOf()-(J-=J%1e3))/6e4},p=c.prototype;p.tz=function(_,S){_===void 0&&(_=h);var E,b=this.utcOffset(),L=this.toDate(),A=L.toLocaleString("en-US",{timeZone:_}),k=Math.round((L-new Date(A))/1e3/60),U=15*-Math.round(L.getTimezoneOffset()/15)-k;if(!Number(U))E=this.utcOffset(0,S);else if(E=o(A,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(U,!0),S){var N=E.utcOffset();E=E.add(b-N,"minute")}return E.$x.$timezone=_,E},p.offsetName=function(_){var S=this.$x.$timezone||o.tz.guess(),E=g(this.valueOf(),S,{timeZoneName:_}).find(function(b){return b.type.toLowerCase()==="timezonename"});return E&&E.value};var w=p.startOf;p.startOf=function(_,S){if(!this.$x||!this.$x.$timezone)return w.call(this,_,S);var E=o(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return w.call(E,_,S).tz(this.$x.$timezone,!0)},o.tz=function(_,S,E){var b=E&&S,L=E||S||h,A=d(+o(),L);if(typeof _!="string")return o(_).tz(L);var k=function(G,$,J){var X=G-60*$*1e3,Z=d(X,J);if($===Z)return[X,$];var ie=d(X-=60*(Z-$)*1e3,J);return Z===ie?[X,Z]:[G-60*Math.min(Z,ie)*1e3,Math.max(Z,ie)]}(o.utc(_,b).valueOf(),A,L),U=k[0],N=k[1],P=o(U).utcOffset(N);return P.$x.$timezone=L,P},o.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},o.tz.setDefault=function(_){h=_}}})})(bo);var Wf=bo.exports;const Xf=Ur(Wf);var qf={exports:{}};(function(e,r){(function(i,s){e.exports=s()})(Ke,function(){return{name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(i){var s=["th","st","nd","rd"],l=i%100;return"["+i+(s[(l-20)%10]||s[l]||s[0])+"]"}}})})(qf);var Jf={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"pt",weekdays:"domingo_segunda-feira_terça-feira_quarta-feira_quinta-feira_sexta-feira_sábado".split("_"),weekdaysShort:"dom_seg_ter_qua_qui_sex_sab".split("_"),weekdaysMin:"Do_2ª_3ª_4ª_5ª_6ª_Sa".split("_"),months:"janeiro_fevereiro_março_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),ordinal:function(o){return o+"º"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [às] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [às] HH:mm"},relativeTime:{future:"em %s",past:"há %s",s:"alguns segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"}};return l.default.locale(c,null,!0),c})})(Jf);var Zf={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"fr",weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(o){return""+o+(o===1?"er":"")}};return l.default.locale(c,null,!0),c})})(Zf);var Qf={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(g){return g&&typeof g=="object"&&"default"in g?g:{default:g}}var l=s(i),c={s:"ein paar Sekunden",m:["eine Minute","einer Minute"],mm:"%d Minuten",h:["eine Stunde","einer Stunde"],hh:"%d Stunden",d:["ein Tag","einem Tag"],dd:["%d Tage","%d Tagen"],M:["ein Monat","einem Monat"],MM:["%d Monate","%d Monaten"],y:["ein Jahr","einem Jahr"],yy:["%d Jahre","%d Jahren"]};function o(g,d,p){var w=c[p];return Array.isArray(w)&&(w=w[d?0:1]),w.replace("%d",g)}var h={name:"de",weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),months:"Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._März_Apr._Mai_Juni_Juli_Aug._Sept._Okt._Nov._Dez.".split("_"),ordinal:function(g){return g+"."},weekStart:1,yearStart:4,formats:{LTS:"HH:mm:ss",LT:"HH:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},relativeTime:{future:"in %s",past:"vor %s",s:o,m:o,mm:o,h:o,hh:o,d:o,dd:o,M:o,MM:o,y:o,yy:o}};return l.default.locale(h,null,!0),h})})(Qf);var eh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"it",weekdays:"domenica_lunedì_martedì_mercoledì_giovedì_venerdì_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),weekStart:1,monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"tra %s",past:"%s fa",s:"qualche secondo",m:"un minuto",mm:"%d minuti",h:"un' ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},ordinal:function(o){return o+"º"}};return l.default.locale(c,null,!0),c})})(eh);var th={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(E){return E&&typeof E=="object"&&"default"in E?E:{default:E}}var l=s(i),c="января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_"),o="январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),h="янв._февр._мар._апр._мая_июня_июля_авг._сент._окт._нояб._дек.".split("_"),g="янв._февр._март_апр._май_июнь_июль_авг._сент._окт._нояб._дек.".split("_"),d=/D[oD]?(\[[^[\]]*\]|\s)+MMMM?/;function p(E,b,L){var A,k;return L==="m"?b?"минута":"минуту":E+" "+(A=+E,k={mm:b?"минута_минуты_минут":"минуту_минуты_минут",hh:"час_часа_часов",dd:"день_дня_дней",MM:"месяц_месяца_месяцев",yy:"год_года_лет"}[L].split("_"),A%10==1&&A%100!=11?k[0]:A%10>=2&&A%10<=4&&(A%100<10||A%100>=20)?k[1]:k[2])}var w=function(E,b){return d.test(b)?c[E.month()]:o[E.month()]};w.s=o,w.f=c;var _=function(E,b){return d.test(b)?h[E.month()]:g[E.month()]};_.s=g,_.f=h;var S={name:"ru",weekdays:"воскресенье_понедельник_вторник_среда_четверг_пятница_суббота".split("_"),weekdaysShort:"вск_пнд_втр_срд_чтв_птн_сбт".split("_"),weekdaysMin:"вс_пн_вт_ср_чт_пт_сб".split("_"),months:w,monthsShort:_,weekStart:1,yearStart:4,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY г.",LLL:"D MMMM YYYY г., H:mm",LLLL:"dddd, D MMMM YYYY г., H:mm"},relativeTime:{future:"через %s",past:"%s назад",s:"несколько секунд",m:p,mm:p,h:"час",hh:p,d:"день",dd:p,M:"месяц",MM:p,y:"год",yy:p},ordinal:function(E){return E},meridiem:function(E){return E<4?"ночи":E<12?"утра":E<17?"дня":"вечера"}};return l.default.locale(S,null,!0),S})})(th);var rh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"ja",weekdays:"日曜日_月曜日_火曜日_水曜日_木曜日_金曜日_土曜日".split("_"),weekdaysShort:"日_月_火_水_木_金_土".split("_"),weekdaysMin:"日_月_火_水_木_金_土".split("_"),months:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(o){return o+"日"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日 HH:mm",LLLL:"YYYY年M月D日 dddd HH:mm",l:"YYYY/MM/DD",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日(ddd) HH:mm"},meridiem:function(o){return o<12?"午前":"午後"},relativeTime:{future:"%s後",past:"%s前",s:"数秒",m:"1分",mm:"%d分",h:"1時間",hh:"%d時間",d:"1日",dd:"%d日",M:"1ヶ月",MM:"%dヶ月",y:"1年",yy:"%d年"}};return l.default.locale(c,null,!0),c})})(rh);var nh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"zh",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(o,h){return h==="W"?o+"周":o+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s后",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(o,h){var g=100*o+h;return g<600?"凌晨":g<900?"早上":g<1100?"上午":g<1300?"中午":g<1800?"下午":"晚上"}};return l.default.locale(c,null,!0),c})})(nh);var ih={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(d){return d&&typeof d=="object"&&"default"in d?d:{default:d}}var l=s(i),c="يناير_فبراير_مارس_أبريل_مايو_يونيو_يوليو_أغسطس_سبتمبر_أكتوبر_نوفمبر_ديسمبر".split("_"),o={1:"١",2:"٢",3:"٣",4:"٤",5:"٥",6:"٦",7:"٧",8:"٨",9:"٩",0:"٠"},h={"١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9","٠":"0"},g={name:"ar",weekdays:"الأحد_الإثنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysShort:"أحد_إثنين_ثلاثاء_أربعاء_خميس_جمعة_سبت".split("_"),weekdaysMin:"ح_ن_ث_ر_خ_ج_س".split("_"),months:c,monthsShort:c,weekStart:6,meridiem:function(d){return d>12?"م":"ص"},relativeTime:{future:"بعد %s",past:"منذ %s",s:"ثانية واحدة",m:"دقيقة واحدة",mm:"%d دقائق",h:"ساعة واحدة",hh:"%d ساعات",d:"يوم واحد",dd:"%d أيام",M:"شهر واحد",MM:"%d أشهر",y:"عام واحد",yy:"%d أعوام"},preparse:function(d){return d.replace(/[١٢٣٤٥٦٧٨٩٠]/g,function(p){return h[p]}).replace(/،/g,",")},postformat:function(d){return d.replace(/\d/g,function(p){return o[p]}).replace(/,/g,"،")},ordinal:function(d){return d},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/‏M/‏YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"}};return l.default.locale(g,null,!0),g})})(ih);var ah={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"ko",weekdays:"일요일_월요일_화요일_수요일_목요일_금요일_토요일".split("_"),weekdaysShort:"일_월_화_수_목_금_토".split("_"),weekdaysMin:"일_월_화_수_목_금_토".split("_"),months:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),monthsShort:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),ordinal:function(o){return o+"일"},formats:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY년 MMMM D일",LLL:"YYYY년 MMMM D일 A h:mm",LLLL:"YYYY년 MMMM D일 dddd A h:mm",l:"YYYY.MM.DD.",ll:"YYYY년 MMMM D일",lll:"YYYY년 MMMM D일 A h:mm",llll:"YYYY년 MMMM D일 dddd A h:mm"},meridiem:function(o){return o<12?"오전":"오후"},relativeTime:{future:"%s 후",past:"%s 전",s:"몇 초",m:"1분",mm:"%d분",h:"한 시간",hh:"%d시간",d:"하루",dd:"%d일",M:"한 달",MM:"%d달",y:"일 년",yy:"%d년"}};return l.default.locale(c,null,!0),c})})(ah);var sh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"tr",weekdays:"Pazar_Pazartesi_Salı_Çarşamba_Perşembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_Çar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_Ça_Pe_Cu_Ct".split("_"),months:"Ocak_Şubat_Mart_Nisan_Mayıs_Haziran_Temmuz_Ağustos_Eylül_Ekim_Kasım_Aralık".split("_"),monthsShort:"Oca_Şub_Mar_Nis_May_Haz_Tem_Ağu_Eyl_Eki_Kas_Ara".split("_"),weekStart:1,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},relativeTime:{future:"%s sonra",past:"%s önce",s:"birkaç saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gün",dd:"%d gün",M:"bir ay",MM:"%d ay",y:"bir yıl",yy:"%d yıl"},ordinal:function(o){return o+"."}};return l.default.locale(c,null,!0),c})})(sh);var oh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"nl",weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),ordinal:function(o){return"["+o+(o===1||o===8||o>=20?"ste":"de")+"]"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"een minuut",mm:"%d minuten",h:"een uur",hh:"%d uur",d:"een dag",dd:"%d dagen",M:"een maand",MM:"%d maanden",y:"een jaar",yy:"%d jaar"}};return l.default.locale(c,null,!0),c})})(oh);var lh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(_){return _&&typeof _=="object"&&"default"in _?_:{default:_}}var l=s(i);function c(_){return _%10<5&&_%10>1&&~~(_/10)%10!=1}function o(_,S,E){var b=_+" ";switch(E){case"m":return S?"minuta":"minutę";case"mm":return b+(c(_)?"minuty":"minut");case"h":return S?"godzina":"godzinę";case"hh":return b+(c(_)?"godziny":"godzin");case"MM":return b+(c(_)?"miesiące":"miesięcy");case"yy":return b+(c(_)?"lata":"lat")}}var h="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_września_października_listopada_grudnia".split("_"),g="styczeń_luty_marzec_kwiecień_maj_czerwiec_lipiec_sierpień_wrzesień_październik_listopad_grudzień".split("_"),d=/D MMMM/,p=function(_,S){return d.test(S)?h[_.month()]:g[_.month()]};p.s=g,p.f=h;var w={name:"pl",weekdays:"niedziela_poniedziałek_wtorek_środa_czwartek_piątek_sobota".split("_"),weekdaysShort:"ndz_pon_wt_śr_czw_pt_sob".split("_"),weekdaysMin:"Nd_Pn_Wt_Śr_Cz_Pt_So".split("_"),months:p,monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_paź_lis_gru".split("_"),ordinal:function(_){return _+"."},weekStart:1,yearStart:4,relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",m:o,mm:o,h:o,hh:o,d:"1 dzień",dd:"%d dni",M:"miesiąc",MM:o,y:"rok",yy:o},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"}};return l.default.locale(w,null,!0),w})})(lh);var uh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"vi",weekdays:"chủ nhật_thứ hai_thứ ba_thứ tư_thứ năm_thứ sáu_thứ bảy".split("_"),months:"tháng 1_tháng 2_tháng 3_tháng 4_tháng 5_tháng 6_tháng 7_tháng 8_tháng 9_tháng 10_tháng 11_tháng 12".split("_"),weekStart:1,weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),ordinal:function(o){return o},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [năm] YYYY",LLL:"D MMMM [năm] YYYY HH:mm",LLLL:"dddd, D MMMM [năm] YYYY HH:mm",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},relativeTime:{future:"%s tới",past:"%s trước",s:"vài giây",m:"một phút",mm:"%d phút",h:"một giờ",hh:"%d giờ",d:"một ngày",dd:"%d ngày",M:"một tháng",MM:"%d tháng",y:"một năm",yy:"%d năm"}};return l.default.locale(c,null,!0),c})})(uh);var ch={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"sv",weekdays:"söndag_måndag_tisdag_onsdag_torsdag_fredag_lördag".split("_"),weekdaysShort:"sön_mån_tis_ons_tor_fre_lör".split("_"),weekdaysMin:"sö_må_ti_on_to_fr_lö".split("_"),months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekStart:1,yearStart:4,ordinal:function(o){var h=o%10;return"["+o+(h===1||h===2?"a":"e")+"]"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [kl.] HH:mm",LLLL:"dddd D MMMM YYYY [kl.] HH:mm",lll:"D MMM YYYY HH:mm",llll:"ddd D MMM YYYY HH:mm"},relativeTime:{future:"om %s",past:"för %s sedan",s:"några sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en månad",MM:"%d månader",y:"ett år",yy:"%d år"}};return l.default.locale(c,null,!0),c})})(ch);var dh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"id",weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Agt_Sep_Okt_Nov_Des".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),weekStart:1,formats:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},ordinal:function(o){return o+"."}};return l.default.locale(c,null,!0),c})})(dh);var fh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"th",weekdays:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัสบดี_ศุกร์_เสาร์".split("_"),weekdaysShort:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัส_ศุกร์_เสาร์".split("_"),weekdaysMin:"อา._จ._อ._พ._พฤ._ศ._ส.".split("_"),months:"มกราคม_กุมภาพันธ์_มีนาคม_เมษายน_พฤษภาคม_มิถุนายน_กรกฎาคม_สิงหาคม_กันยายน_ตุลาคม_พฤศจิกายน_ธันวาคม".split("_"),monthsShort:"ม.ค._ก.พ._มี.ค._เม.ย._พ.ค._มิ.ย._ก.ค._ส.ค._ก.ย._ต.ค._พ.ย._ธ.ค.".split("_"),formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY เวลา H:mm",LLLL:"วันddddที่ D MMMM YYYY เวลา H:mm"},relativeTime:{future:"อีก %s",past:"%sที่แล้ว",s:"ไม่กี่วินาที",m:"1 นาที",mm:"%d นาที",h:"1 ชั่วโมง",hh:"%d ชั่วโมง",d:"1 วัน",dd:"%d วัน",M:"1 เดือน",MM:"%d เดือน",y:"1 ปี",yy:"%d ปี"},ordinal:function(o){return o+"."}};return l.default.locale(c,null,!0),c})})(fh);var hh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(h){return h&&typeof h=="object"&&"default"in h?h:{default:h}}var l=s(i);function c(h,g,d,p){var w={s:"muutama sekunti",m:"minuutti",mm:"%d minuuttia",h:"tunti",hh:"%d tuntia",d:"päivä",dd:"%d päivää",M:"kuukausi",MM:"%d kuukautta",y:"vuosi",yy:"%d vuotta",numbers:"nolla_yksi_kaksi_kolme_neljä_viisi_kuusi_seitsemän_kahdeksan_yhdeksän".split("_")},_={s:"muutaman sekunnin",m:"minuutin",mm:"%d minuutin",h:"tunnin",hh:"%d tunnin",d:"päivän",dd:"%d päivän",M:"kuukauden",MM:"%d kuukauden",y:"vuoden",yy:"%d vuoden",numbers:"nollan_yhden_kahden_kolmen_neljän_viiden_kuuden_seitsemän_kahdeksan_yhdeksän".split("_")},S=p&&!g?_:w,E=S[d];return h<10?E.replace("%d",S.numbers[h]):E.replace("%d",h)}var o={name:"fi",weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_kesäkuu_heinäkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kesä_heinä_elo_syys_loka_marras_joulu".split("_"),ordinal:function(h){return h+"."},weekStart:1,yearStart:4,relativeTime:{future:"%s päästä",past:"%s sitten",s:c,m:c,mm:c,h:c,hh:c,d:c,dd:c,M:c,MM:c,y:c,yy:c},formats:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM[ta] YYYY",LLL:"D. MMMM[ta] YYYY, [klo] HH.mm",LLLL:"dddd, D. MMMM[ta] YYYY, [klo] HH.mm",l:"D.M.YYYY",ll:"D. MMM YYYY",lll:"D. MMM YYYY, [klo] HH.mm",llll:"ddd, D. MMM YYYY, [klo] HH.mm"}};return l.default.locale(o,null,!0),o})})(hh);var gh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"da",weekdays:"søndag_mandag_tirsdag_onsdag_torsdag_fredag_lørdag".split("_"),weekdaysShort:"søn._man._tirs._ons._tors._fre._lør.".split("_"),weekdaysMin:"sø._ma._ti._on._to._fr._lø.".split("_"),months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj_juni_juli_aug._sept._okt._nov._dec.".split("_"),weekStart:1,yearStart:4,ordinal:function(o){return o+"."},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd [d.] D. MMMM YYYY [kl.] HH:mm"},relativeTime:{future:"om %s",past:"%s siden",s:"få sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en måned",MM:"%d måneder",y:"et år",yy:"%d år"}};return l.default.locale(c,null,!0),c})})(gh);var mh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(g){return g&&typeof g=="object"&&"default"in g?g:{default:g}}var l=s(i),c={s:"מספר שניות",ss:"%d שניות",m:"דקה",mm:"%d דקות",h:"שעה",hh:"%d שעות",hh2:"שעתיים",d:"יום",dd:"%d ימים",dd2:"יומיים",M:"חודש",MM:"%d חודשים",MM2:"חודשיים",y:"שנה",yy:"%d שנים",yy2:"שנתיים"};function o(g,d,p){return(c[p+(g===2?"2":"")]||c[p]).replace("%d",g)}var h={name:"he",weekdays:"ראשון_שני_שלישי_רביעי_חמישי_שישי_שבת".split("_"),weekdaysShort:"א׳_ב׳_ג׳_ד׳_ה׳_ו׳_ש׳".split("_"),weekdaysMin:"א׳_ב׳_ג׳_ד׳_ה׳_ו_ש׳".split("_"),months:"ינואר_פברואר_מרץ_אפריל_מאי_יוני_יולי_אוגוסט_ספטמבר_אוקטובר_נובמבר_דצמבר".split("_"),monthsShort:"ינו_פבר_מרץ_אפר_מאי_יונ_יול_אוג_ספט_אוק_נוב_דצמ".split("_"),relativeTime:{future:"בעוד %s",past:"לפני %s",s:o,m:o,mm:o,h:o,hh:o,d:o,dd:o,M:o,MM:o,y:o,yy:o},ordinal:function(g){return g},format:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [ב]MMMM YYYY",LLL:"D [ב]MMMM YYYY HH:mm",LLLL:"dddd, D [ב]MMMM YYYY HH:mm",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [ב]MMMM YYYY",LLL:"D [ב]MMMM YYYY HH:mm",LLLL:"dddd, D [ב]MMMM YYYY HH:mm",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"}};return l.default.locale(h,null,!0),h})})(mh);var ph={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"el",weekdays:"Κυριακή_Δευτέρα_Τρίτη_Τετάρτη_Πέμπτη_Παρασκευή_Σάββατο".split("_"),weekdaysShort:"Κυρ_Δευ_Τρι_Τετ_Πεμ_Παρ_Σαβ".split("_"),weekdaysMin:"Κυ_Δε_Τρ_Τε_Πε_Πα_Σα".split("_"),months:"Ιανουάριος_Φεβρουάριος_Μάρτιος_Απρίλιος_Μάιος_Ιούνιος_Ιούλιος_Αύγουστος_Σεπτέμβριος_Οκτώβριος_Νοέμβριος_Δεκέμβριος".split("_"),monthsShort:"Ιαν_Φεβ_Μαρ_Απρ_Μαι_Ιουν_Ιουλ_Αυγ_Σεπτ_Οκτ_Νοε_Δεκ".split("_"),ordinal:function(o){return o},weekStart:1,relativeTime:{future:"σε %s",past:"πριν %s",s:"μερικά δευτερόλεπτα",m:"ένα λεπτό",mm:"%d λεπτά",h:"μία ώρα",hh:"%d ώρες",d:"μία μέρα",dd:"%d μέρες",M:"ένα μήνα",MM:"%d μήνες",y:"ένα χρόνο",yy:"%d χρόνια"},formats:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"}};return l.default.locale(c,null,!0),c})})(ph);var vh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(g){return g&&typeof g=="object"&&"default"in g?g:{default:g}}var l=s(i);function c(g){return g>1&&g<5&&~~(g/10)!=1}function o(g,d,p,w){var _=g+" ";switch(p){case"s":return d||w?"pár sekund":"pár sekundami";case"m":return d?"minuta":w?"minutu":"minutou";case"mm":return d||w?_+(c(g)?"minuty":"minut"):_+"minutami";case"h":return d?"hodina":w?"hodinu":"hodinou";case"hh":return d||w?_+(c(g)?"hodiny":"hodin"):_+"hodinami";case"d":return d||w?"den":"dnem";case"dd":return d||w?_+(c(g)?"dny":"dní"):_+"dny";case"M":return d||w?"měsíc":"měsícem";case"MM":return d||w?_+(c(g)?"měsíce":"měsíců"):_+"měsíci";case"y":return d||w?"rok":"rokem";case"yy":return d||w?_+(c(g)?"roky":"let"):_+"lety"}}var h={name:"cs",weekdays:"neděle_pondělí_úterý_středa_čtvrtek_pátek_sobota".split("_"),weekdaysShort:"ne_po_út_st_čt_pá_so".split("_"),weekdaysMin:"ne_po_út_st_čt_pá_so".split("_"),months:"leden_únor_březen_duben_květen_červen_červenec_srpen_září_říjen_listopad_prosinec".split("_"),monthsShort:"led_úno_bře_dub_kvě_čvn_čvc_srp_zář_říj_lis_pro".split("_"),weekStart:1,yearStart:4,ordinal:function(g){return g+"."},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},relativeTime:{future:"za %s",past:"před %s",s:o,m:o,mm:o,h:o,hh:o,d:o,dd:o,M:o,MM:o,y:o,yy:o}};return l.default.locale(h,null,!0),h})})(vh);var _h={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"ro",weekdays:"Duminică_Luni_Marți_Miercuri_Joi_Vineri_Sâmbătă".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sâm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_Sâ".split("_"),months:"Ianuarie_Februarie_Martie_Aprilie_Mai_Iunie_Iulie_August_Septembrie_Octombrie_Noiembrie_Decembrie".split("_"),monthsShort:"Ian._Febr._Mart._Apr._Mai_Iun._Iul._Aug._Sept._Oct._Nov._Dec.".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},relativeTime:{future:"peste %s",past:"acum %s",s:"câteva secunde",m:"un minut",mm:"%d minute",h:"o oră",hh:"%d ore",d:"o zi",dd:"%d zile",M:"o lună",MM:"%d luni",y:"un an",yy:"%d ani"},ordinal:function(o){return o}};return l.default.locale(c,null,!0),c})})(_h);var yh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"hu",weekdays:"vasárnap_hétfő_kedd_szerda_csütörtök_péntek_szombat".split("_"),weekdaysShort:"vas_hét_kedd_sze_csüt_pén_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),months:"január_február_március_április_május_június_július_augusztus_szeptember_október_november_december".split("_"),monthsShort:"jan_feb_márc_ápr_máj_jún_júl_aug_szept_okt_nov_dec".split("_"),ordinal:function(o){return o+"."},weekStart:1,relativeTime:{future:"%s múlva",past:"%s",s:function(o,h,g,d){return"néhány másodperc"+(d||h?"":"e")},m:function(o,h,g,d){return"egy perc"+(d||h?"":"e")},mm:function(o,h,g,d){return o+" perc"+(d||h?"":"e")},h:function(o,h,g,d){return"egy "+(d||h?"óra":"órája")},hh:function(o,h,g,d){return o+" "+(d||h?"óra":"órája")},d:function(o,h,g,d){return"egy "+(d||h?"nap":"napja")},dd:function(o,h,g,d){return o+" "+(d||h?"nap":"napja")},M:function(o,h,g,d){return"egy "+(d||h?"hónap":"hónapja")},MM:function(o,h,g,d){return o+" "+(d||h?"hónap":"hónapja")},y:function(o,h,g,d){return"egy "+(d||h?"év":"éve")},yy:function(o,h,g,d){return o+" "+(d||h?"év":"éve")}},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D. H:mm",LLLL:"YYYY. MMMM D., dddd H:mm"}};return l.default.locale(c,null,!0),c})})(yh);var bh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(g){return g&&typeof g=="object"&&"default"in g?g:{default:g}}var l=s(i);function c(g){return g>1&&g<5&&~~(g/10)!=1}function o(g,d,p,w){var _=g+" ";switch(p){case"s":return d||w?"pár sekúnd":"pár sekundami";case"m":return d?"minúta":w?"minútu":"minútou";case"mm":return d||w?_+(c(g)?"minúty":"minút"):_+"minútami";case"h":return d?"hodina":w?"hodinu":"hodinou";case"hh":return d||w?_+(c(g)?"hodiny":"hodín"):_+"hodinami";case"d":return d||w?"deň":"dňom";case"dd":return d||w?_+(c(g)?"dni":"dní"):_+"dňami";case"M":return d||w?"mesiac":"mesiacom";case"MM":return d||w?_+(c(g)?"mesiace":"mesiacov"):_+"mesiacmi";case"y":return d||w?"rok":"rokom";case"yy":return d||w?_+(c(g)?"roky":"rokov"):_+"rokmi"}}var h={name:"sk",weekdays:"nedeľa_pondelok_utorok_streda_štvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_št_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_št_pi_so".split("_"),months:"január_február_marec_apríl_máj_jún_júl_august_september_október_november_december".split("_"),monthsShort:"jan_feb_mar_apr_máj_jún_júl_aug_sep_okt_nov_dec".split("_"),weekStart:1,yearStart:4,ordinal:function(g){return g+"."},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},relativeTime:{future:"za %s",past:"pred %s",s:o,m:o,mm:o,h:o,hh:o,d:o,dd:o,M:o,MM:o,y:o,yy:o}};return l.default.locale(h,null,!0),h})})(bh);var Sh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(w){return w&&typeof w=="object"&&"default"in w?w:{default:w}}var l=s(i),c="січня_лютого_березня_квітня_травня_червня_липня_серпня_вересня_жовтня_листопада_грудня".split("_"),o="січень_лютий_березень_квітень_травень_червень_липень_серпень_вересень_жовтень_листопад_грудень".split("_"),h=/D[oD]?(\[[^[\]]*\]|\s)+MMMM?/;function g(w,_,S){var E,b;return S==="m"?_?"хвилина":"хвилину":S==="h"?_?"година":"годину":w+" "+(E=+w,b={ss:_?"секунда_секунди_секунд":"секунду_секунди_секунд",mm:_?"хвилина_хвилини_хвилин":"хвилину_хвилини_хвилин",hh:_?"година_години_годин":"годину_години_годин",dd:"день_дні_днів",MM:"місяць_місяці_місяців",yy:"рік_роки_років"}[S].split("_"),E%10==1&&E%100!=11?b[0]:E%10>=2&&E%10<=4&&(E%100<10||E%100>=20)?b[1]:b[2])}var d=function(w,_){return h.test(_)?c[w.month()]:o[w.month()]};d.s=o,d.f=c;var p={name:"uk",weekdays:"неділя_понеділок_вівторок_середа_четвер_п’ятниця_субота".split("_"),weekdaysShort:"ндл_пнд_втр_срд_чтв_птн_сбт".split("_"),weekdaysMin:"нд_пн_вт_ср_чт_пт_сб".split("_"),months:d,monthsShort:"січ_лют_бер_квіт_трав_черв_лип_серп_вер_жовт_лист_груд".split("_"),weekStart:1,relativeTime:{future:"за %s",past:"%s тому",s:"декілька секунд",m:g,mm:g,h:g,hh:g,d:"день",dd:g,M:"місяць",MM:g,y:"рік",yy:g},ordinal:function(w){return w},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY р.",LLL:"D MMMM YYYY р., HH:mm",LLLL:"dddd, D MMMM YYYY р., HH:mm"}};return l.default.locale(p,null,!0),p})})(Sh);var Eh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"bg",weekdays:"неделя_понеделник_вторник_сряда_четвъртък_петък_събота".split("_"),weekdaysShort:"нед_пон_вто_сря_чет_пет_съб".split("_"),weekdaysMin:"нд_пн_вт_ср_чт_пт_сб".split("_"),months:"януари_февруари_март_април_май_юни_юли_август_септември_октомври_ноември_декември".split("_"),monthsShort:"яну_фев_мар_апр_май_юни_юли_авг_сеп_окт_ное_дек".split("_"),weekStart:1,ordinal:function(o){var h=o%100;if(h>10&&h<20)return o+"-ти";var g=o%10;return g===1?o+"-ви":g===2?o+"-ри":g===7||g===8?o+"-ми":o+"-ти"},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},relativeTime:{future:"след %s",past:"преди %s",s:"няколко секунди",m:"минута",mm:"%d минути",h:"час",hh:"%d часа",d:"ден",dd:"%d дена",M:"месец",MM:"%d месеца",y:"година",yy:"%d години"}};return l.default.locale(c,null,!0),c})})(Eh);var xh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"hi",weekdays:"रविवार_सोमवार_मंगलवार_बुधवार_गुरूवार_शुक्रवार_शनिवार".split("_"),months:"जनवरी_फ़रवरी_मार्च_अप्रैल_मई_जून_जुलाई_अगस्त_सितम्बर_अक्टूबर_नवम्बर_दिसम्बर".split("_"),weekdaysShort:"रवि_सोम_मंगल_बुध_गुरू_शुक्र_शनि".split("_"),monthsShort:"जन._फ़र._मार्च_अप्रै._मई_जून_जुल._अग._सित._अक्टू._नव._दिस.".split("_"),weekdaysMin:"र_सो_मं_बु_गु_शु_श".split("_"),ordinal:function(o){return o},formats:{LT:"A h:mm बजे",LTS:"A h:mm:ss बजे",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm बजे",LLLL:"dddd, D MMMM YYYY, A h:mm बजे"},relativeTime:{future:"%s में",past:"%s पहले",s:"कुछ ही क्षण",m:"एक मिनट",mm:"%d मिनट",h:"एक घंटा",hh:"%d घंटे",d:"एक दिन",dd:"%d दिन",M:"एक महीने",MM:"%d महीने",y:"एक वर्ष",yy:"%d वर्ष"}};return l.default.locale(c,null,!0),c})})(xh);var Th={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(g){return g&&typeof g=="object"&&"default"in g?g:{default:g}}var l=s(i),c={1:"১",2:"২",3:"৩",4:"৪",5:"৫",6:"৬",7:"৭",8:"৮",9:"৯",0:"০"},o={"১":"1","২":"2","৩":"3","৪":"4","৫":"5","৬":"6","৭":"7","৮":"8","৯":"9","০":"0"},h={name:"bn",weekdays:"রবিবার_সোমবার_মঙ্গলবার_বুধবার_বৃহস্পতিবার_শুক্রবার_শনিবার".split("_"),months:"জানুয়ারি_ফেব্রুয়ারি_মার্চ_এপ্রিল_মে_জুন_জুলাই_আগস্ট_সেপ্টেম্বর_অক্টোবর_নভেম্বর_ডিসেম্বর".split("_"),weekdaysShort:"রবি_সোম_মঙ্গল_বুধ_বৃহস্পতি_শুক্র_শনি".split("_"),monthsShort:"জানু_ফেব্রু_মার্চ_এপ্রিল_মে_জুন_জুলাই_আগস্ট_সেপ্ট_অক্টো_নভে_ডিসে".split("_"),weekdaysMin:"রবি_সোম_মঙ্গ_বুধ_বৃহঃ_শুক্র_শনি".split("_"),preparse:function(g){return g.replace(/[১২৩৪৫৬৭৮৯০]/g,function(d){return o[d]})},postformat:function(g){return g.replace(/\d/g,function(d){return c[d]})},ordinal:function(g){return g},formats:{LT:"A h:mm সময়",LTS:"A h:mm:ss সময়",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm সময়",LLLL:"dddd, D MMMM YYYY, A h:mm সময়"},relativeTime:{future:"%s পরে",past:"%s আগে",s:"কয়েক সেকেন্ড",m:"এক মিনিট",mm:"%d মিনিট",h:"এক ঘন্টা",hh:"%d ঘন্টা",d:"এক দিন",dd:"%d দিন",M:"এক মাস",MM:"%d মাস",y:"এক বছর",yy:"%d বছর"}};return l.default.locale(h,null,!0),h})})(Th);var Mh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"ta",weekdays:"ஞாயிற்றுக்கிழமை_திங்கட்கிழமை_செவ்வாய்கிழமை_புதன்கிழமை_வியாழக்கிழமை_வெள்ளிக்கிழமை_சனிக்கிழமை".split("_"),months:"ஜனவரி_பிப்ரவரி_மார்ச்_ஏப்ரல்_மே_ஜூன்_ஜூலை_ஆகஸ்ட்_செப்டெம்பர்_அக்டோபர்_நவம்பர்_டிசம்பர்".split("_"),weekdaysShort:"ஞாயிறு_திங்கள்_செவ்வாய்_புதன்_வியாழன்_வெள்ளி_சனி".split("_"),monthsShort:"ஜனவரி_பிப்ரவரி_மார்ச்_ஏப்ரல்_மே_ஜூன்_ஜூலை_ஆகஸ்ட்_செப்டெம்பர்_அக்டோபர்_நவம்பர்_டிசம்பர்".split("_"),weekdaysMin:"ஞா_தி_செ_பு_வி_வெ_ச".split("_"),ordinal:function(o){return o},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, HH:mm",LLLL:"dddd, D MMMM YYYY, HH:mm"},relativeTime:{future:"%s இல்",past:"%s முன்",s:"ஒரு சில விநாடிகள்",m:"ஒரு நிமிடம்",mm:"%d நிமிடங்கள்",h:"ஒரு மணி நேரம்",hh:"%d மணி நேரம்",d:"ஒரு நாள்",dd:"%d நாட்கள்",M:"ஒரு மாதம்",MM:"%d மாதங்கள்",y:"ஒரு வருடம்",yy:"%d ஆண்டுகள்"}};return l.default.locale(c,null,!0),c})})(Mh);var wh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"te",weekdays:"ఆదివారం_సోమవారం_మంగళవారం_బుధవారం_గురువారం_శుక్రవారం_శనివారం".split("_"),months:"జనవరి_ఫిబ్రవరి_మార్చి_ఏప్రిల్_మే_జూన్_జులై_ఆగస్టు_సెప్టెంబర్_అక్టోబర్_నవంబర్_డిసెంబర్".split("_"),weekdaysShort:"ఆది_సోమ_మంగళ_బుధ_గురు_శుక్ర_శని".split("_"),monthsShort:"జన._ఫిబ్ర._మార్చి_ఏప్రి._మే_జూన్_జులై_ఆగ._సెప్._అక్టో._నవ._డిసె.".split("_"),weekdaysMin:"ఆ_సో_మం_బు_గు_శు_శ".split("_"),ordinal:function(o){return o},formats:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},relativeTime:{future:"%s లో",past:"%s క్రితం",s:"కొన్ని క్షణాలు",m:"ఒక నిమిషం",mm:"%d నిమిషాలు",h:"ఒక గంట",hh:"%d గంటలు",d:"ఒక రోజు",dd:"%d రోజులు",M:"ఒక నెల",MM:"%d నెలలు",y:"ఒక సంవత్సరం",yy:"%d సంవత్సరాలు"}};return l.default.locale(c,null,!0),c})})(wh);var Lh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"mr",weekdays:"रविवार_सोमवार_मंगळवार_बुधवार_गुरूवार_शुक्रवार_शनिवार".split("_"),months:"जानेवारी_फेब्रुवारी_मार्च_एप्रिल_मे_जून_जुलै_ऑगस्ट_सप्टेंबर_ऑक्टोबर_नोव्हेंबर_डिसेंबर".split("_"),weekdaysShort:"रवि_सोम_मंगळ_बुध_गुरू_शुक्र_शनि".split("_"),monthsShort:"जाने._फेब्रु._मार्च._एप्रि._मे._जून._जुलै._ऑग._सप्टें._ऑक्टो._नोव्हें._डिसें.".split("_"),weekdaysMin:"र_सो_मं_बु_गु_शु_श".split("_"),ordinal:function(o){return o},formats:{LT:"A h:mm वाजता",LTS:"A h:mm:ss वाजता",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm वाजता",LLLL:"dddd, D MMMM YYYY, A h:mm वाजता"}};return l.default.locale(c,null,!0),c})})(Lh);var kh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"ur",weekdays:"اتوار_پیر_منگل_بدھ_جمعرات_جمعہ_ہفتہ".split("_"),months:"جنوری_فروری_مارچ_اپریل_مئی_جون_جولائی_اگست_ستمبر_اکتوبر_نومبر_دسمبر".split("_"),weekStart:1,weekdaysShort:"اتوار_پیر_منگل_بدھ_جمعرات_جمعہ_ہفتہ".split("_"),monthsShort:"جنوری_فروری_مارچ_اپریل_مئی_جون_جولائی_اگست_ستمبر_اکتوبر_نومبر_دسمبر".split("_"),weekdaysMin:"اتوار_پیر_منگل_بدھ_جمعرات_جمعہ_ہفتہ".split("_"),ordinal:function(o){return o},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd، D MMMM YYYY HH:mm"},relativeTime:{future:"%s بعد",past:"%s قبل",s:"چند سیکنڈ",m:"ایک منٹ",mm:"%d منٹ",h:"ایک گھنٹہ",hh:"%d گھنٹے",d:"ایک دن",dd:"%d دن",M:"ایک ماہ",MM:"%d ماہ",y:"ایک سال",yy:"%d سال"}};return l.default.locale(c,null,!0),c})})(kh);var Ah={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"fa",weekdays:"یک‌شنبه_دوشنبه_سه‌شنبه_چهارشنبه_پنج‌شنبه_جمعه_شنبه".split("_"),weekdaysShort:"یک‌شنبه_دوشنبه_سه‌شنبه_چهارشنبه_پنج‌شنبه_جمعه_شنبه".split("_"),weekdaysMin:"ی_د_س_چ_پ_ج_ش".split("_"),weekStart:6,months:"ژانویه_فوریه_مارس_آوریل_مه_ژوئن_ژوئیه_اوت_سپتامبر_اکتبر_نوامبر_دسامبر".split("_"),monthsShort:"ژانویه_فوریه_مارس_آوریل_مه_ژوئن_ژوئیه_اوت_سپتامبر_اکتبر_نوامبر_دسامبر".split("_"),ordinal:function(o){return o},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},relativeTime:{future:"در %s",past:"%s پیش",s:"چند ثانیه",m:"یک دقیقه",mm:"%d دقیقه",h:"یک ساعت",hh:"%d ساعت",d:"یک روز",dd:"%d روز",M:"یک ماه",MM:"%d ماه",y:"یک سال",yy:"%d سال"}};return l.default.locale(c,null,!0),c})})(Ah);var Rh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"ms",weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekStart:1,formats:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH.mm",LLLL:"dddd, D MMMM YYYY HH.mm"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},ordinal:function(o){return o+"."}};return l.default.locale(c,null,!0),c})})(Rh);var Dh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"gu",weekdays:"રવિવાર_સોમવાર_મંગળવાર_બુધ્વાર_ગુરુવાર_શુક્રવાર_શનિવાર".split("_"),months:"જાન્યુઆરી_ફેબ્રુઆરી_માર્ચ_એપ્રિલ_મે_જૂન_જુલાઈ_ઑગસ્ટ_સપ્ટેમ્બર_ઑક્ટ્બર_નવેમ્બર_ડિસેમ્બર".split("_"),weekdaysShort:"રવિ_સોમ_મંગળ_બુધ્_ગુરુ_શુક્ર_શનિ".split("_"),monthsShort:"જાન્યુ._ફેબ્રુ._માર્ચ_એપ્રિ._મે_જૂન_જુલા._ઑગ._સપ્ટે._ઑક્ટ્._નવે._ડિસે.".split("_"),weekdaysMin:"ર_સો_મં_બુ_ગુ_શુ_શ".split("_"),ordinal:function(o){return o},formats:{LT:"A h:mm વાગ્યે",LTS:"A h:mm:ss વાગ્યે",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm વાગ્યે",LLLL:"dddd, D MMMM YYYY, A h:mm વાગ્યે"},relativeTime:{future:"%s મા",past:"%s પેહલા",s:"અમુક પળો",m:"એક મિનિટ",mm:"%d મિનિટ",h:"એક કલાક",hh:"%d કલાક",d:"એક દિવસ",dd:"%d દિવસ",M:"એક મહિનો",MM:"%d મહિનો",y:"એક વર્ષ",yy:"%d વર્ષ"}};return l.default.locale(c,null,!0),c})})(Dh);var Ch={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"kn",weekdays:"ಭಾನುವಾರ_ಸೋಮವಾರ_ಮಂಗಳವಾರ_ಬುಧವಾರ_ಗುರುವಾರ_ಶುಕ್ರವಾರ_ಶನಿವಾರ".split("_"),months:"ಜನವರಿ_ಫೆಬ್ರವರಿ_ಮಾರ್ಚ್_ಏಪ್ರಿಲ್_ಮೇ_ಜೂನ್_ಜುಲೈ_ಆಗಸ್ಟ್_ಸೆಪ್ಟೆಂಬರ್_ಅಕ್ಟೋಬರ್_ನವೆಂಬರ್_ಡಿಸೆಂಬರ್".split("_"),weekdaysShort:"ಭಾನು_ಸೋಮ_ಮಂಗಳ_ಬುಧ_ಗುರು_ಶುಕ್ರ_ಶನಿ".split("_"),monthsShort:"ಜನ_ಫೆಬ್ರ_ಮಾರ್ಚ್_ಏಪ್ರಿಲ್_ಮೇ_ಜೂನ್_ಜುಲೈ_ಆಗಸ್ಟ್_ಸೆಪ್ಟೆಂ_ಅಕ್ಟೋ_ನವೆಂ_ಡಿಸೆಂ".split("_"),weekdaysMin:"ಭಾ_ಸೋ_ಮಂ_ಬು_ಗು_ಶು_ಶ".split("_"),ordinal:function(o){return o},formats:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},relativeTime:{future:"%s ನಂತರ",past:"%s ಹಿಂದೆ",s:"ಕೆಲವು ಕ್ಷಣಗಳು",m:"ಒಂದು ನಿಮಿಷ",mm:"%d ನಿಮಿಷ",h:"ಒಂದು ಗಂಟೆ",hh:"%d ಗಂಟೆ",d:"ಒಂದು ದಿನ",dd:"%d ದಿನ",M:"ಒಂದು ತಿಂಗಳು",MM:"%d ತಿಂಗಳು",y:"ಒಂದು ವರ್ಷ",yy:"%d ವರ್ಷ"}};return l.default.locale(c,null,!0),c})})(Ch);var Ih={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"ml",weekdays:"ഞായറാഴ്ച_തിങ്കളാഴ്ച_ചൊവ്വാഴ്ച_ബുധനാഴ്ച_വ്യാഴാഴ്ച_വെള്ളിയാഴ്ച_ശനിയാഴ്ച".split("_"),months:"ജനുവരി_ഫെബ്രുവരി_മാർച്ച്_ഏപ്രിൽ_മേയ്_ജൂൺ_ജൂലൈ_ഓഗസ്റ്റ്_സെപ്റ്റംബർ_ഒക്ടോബർ_നവംബർ_ഡിസംബർ".split("_"),weekdaysShort:"ഞായർ_തിങ്കൾ_ചൊവ്വ_ബുധൻ_വ്യാഴം_വെള്ളി_ശനി".split("_"),monthsShort:"ജനു._ഫെബ്രു._മാർ._ഏപ്രി._മേയ്_ജൂൺ_ജൂലൈ._ഓഗ._സെപ്റ്റ._ഒക്ടോ._നവം._ഡിസം.".split("_"),weekdaysMin:"ഞാ_തി_ചൊ_ബു_വ്യാ_വെ_ശ".split("_"),ordinal:function(o){return o},formats:{LT:"A h:mm -നു",LTS:"A h:mm:ss -നു",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm -നു",LLLL:"dddd, D MMMM YYYY, A h:mm -നു"},relativeTime:{future:"%s കഴിഞ്ഞ്",past:"%s മുൻപ്",s:"അൽപ നിമിഷങ്ങൾ",m:"ഒരു മിനിറ്റ്",mm:"%d മിനിറ്റ്",h:"ഒരു മണിക്കൂർ",hh:"%d മണിക്കൂർ",d:"ഒരു ദിവസം",dd:"%d ദിവസം",M:"ഒരു മാസം",MM:"%d മാസം",y:"ഒരു വർഷം",yy:"%d വർഷം"}};return l.default.locale(c,null,!0),c})})(Ih);var Ph={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"si",weekdays:"ඉරිදා_සඳුදා_අඟහරුවාදා_බදාදා_බ්‍රහස්පතින්දා_සිකුරාදා_සෙනසුරාදා".split("_"),months:"දුරුතු_නවම්_මැදින්_බක්_වෙසක්_පොසොන්_ඇසළ_නිකිණි_බිනර_වප්_ඉල්_උඳුවප්".split("_"),weekdaysShort:"ඉරි_සඳු_අඟ_බදා_බ්‍රහ_සිකු_සෙන".split("_"),monthsShort:"දුරු_නව_මැදි_බක්_වෙස_පොසො_ඇස_නිකි_බින_වප්_ඉල්_උඳු".split("_"),weekdaysMin:"ඉ_ස_අ_බ_බ්‍ර_සි_සෙ".split("_"),ordinal:function(o){return o},formats:{LT:"a h:mm",LTS:"a h:mm:ss",L:"YYYY/MM/DD",LL:"YYYY MMMM D",LLL:"YYYY MMMM D, a h:mm",LLLL:"YYYY MMMM D [වැනි] dddd, a h:mm:ss"},relativeTime:{future:"%sකින්",past:"%sකට පෙර",s:"තත්පර කිහිපය",m:"විනාඩිය",mm:"විනාඩි %d",h:"පැය",hh:"පැය %d",d:"දිනය",dd:"දින %d",M:"මාසය",MM:"මාස %d",y:"වසර",yy:"වසර %d"}};return l.default.locale(c,null,!0),c})})(Ph);var Oh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"ne",weekdays:"आइतबार_सोमबार_मङ्गलबार_बुधबार_बिहिबार_शुक्रबार_शनिबार".split("_"),weekdaysShort:"आइत._सोम._मङ्गल._बुध._बिहि._शुक्र._शनि.".split("_"),weekdaysMin:"आ._सो._मं._बु._बि._शु._श.".split("_"),months:"जनवरी_फेब्रुवरी_मार्च_अप्रिल_मे_जुन_जुलाई_अगष्ट_सेप्टेम्बर_अक्टोबर_नोभेम्बर_डिसेम्बर".split("_"),monthsShort:"जन._फेब्रु._मार्च_अप्रि._मई_जुन_जुलाई._अग._सेप्ट._अक्टो._नोभे._डिसे.".split("_"),relativeTime:{future:"%s पछि",past:"%s अघि",s:"सेकेन्ड",m:"एक मिनेट",mm:"%d मिनेट",h:"घन्टा",hh:"%d घन्टा",d:"एक दिन",dd:"%d दिन",M:"एक महिना",MM:"%d महिना",y:"एक वर्ष",yy:"%d वर्ष"},ordinal:function(o){return(""+o).replace(/\d/g,function(h){return"०१२३४५६७८९"[h]})},formats:{LT:"Aको h:mm बजे",LTS:"Aको h:mm:ss बजे",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, Aको h:mm बजे",LLLL:"dddd, D MMMM YYYY, Aको h:mm बजे"}};return l.default.locale(c,null,!0),c})})(Oh);var Fh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"am",weekdays:"እሑድ_ሰኞ_ማክሰኞ_ረቡዕ_ሐሙስ_አርብ_ቅዳሜ".split("_"),weekdaysShort:"እሑድ_ሰኞ_ማክሰ_ረቡዕ_ሐሙስ_አርብ_ቅዳሜ".split("_"),weekdaysMin:"እሑ_ሰኞ_ማክ_ረቡ_ሐሙ_አር_ቅዳ".split("_"),months:"ጃንዋሪ_ፌብሯሪ_ማርች_ኤፕሪል_ሜይ_ጁን_ጁላይ_ኦገስት_ሴፕቴምበር_ኦክቶበር_ኖቬምበር_ዲሴምበር".split("_"),monthsShort:"ጃንዋ_ፌብሯ_ማርች_ኤፕሪ_ሜይ_ጁን_ጁላይ_ኦገስ_ሴፕቴ_ኦክቶ_ኖቬም_ዲሴም".split("_"),weekStart:1,yearStart:4,relativeTime:{future:"በ%s",past:"%s በፊት",s:"ጥቂት ሰከንዶች",m:"አንድ ደቂቃ",mm:"%d ደቂቃዎች",h:"አንድ ሰዓት",hh:"%d ሰዓታት",d:"አንድ ቀን",dd:"%d ቀናት",M:"አንድ ወር",MM:"%d ወራት",y:"አንድ ዓመት",yy:"%d ዓመታት"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"MMMM D ፣ YYYY",LLL:"MMMM D ፣ YYYY HH:mm",LLLL:"dddd ፣ MMMM D ፣ YYYY HH:mm"},ordinal:function(o){return o+"ኛ"}};return l.default.locale(c,null,!0),c})})(Fh);var Nh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"sw",weekdays:"Jumapili_Jumatatu_Jumanne_Jumatano_Alhamisi_Ijumaa_Jumamosi".split("_"),weekdaysShort:"Jpl_Jtat_Jnne_Jtan_Alh_Ijm_Jmos".split("_"),weekdaysMin:"J2_J3_J4_J5_Al_Ij_J1".split("_"),months:"Januari_Februari_Machi_Aprili_Mei_Juni_Julai_Agosti_Septemba_Oktoba_Novemba_Desemba".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ago_Sep_Okt_Nov_Des".split("_"),weekStart:1,ordinal:function(o){return o},relativeTime:{future:"%s baadaye",past:"tokea %s",s:"hivi punde",m:"dakika moja",mm:"dakika %d",h:"saa limoja",hh:"masaa %d",d:"siku moja",dd:"masiku %d",M:"mwezi mmoja",MM:"miezi %d",y:"mwaka mmoja",yy:"miaka %d"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"}};return l.default.locale(c,null,!0),c})})(Nh);var Yh={exports:{}};(function(e,r){(function(i,s){e.exports=s(Qe)})(Ke,function(i){function s(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var l=s(i),c={name:"yo",weekdays:"Àìkú_Ajé_Ìsẹ́gun_Ọjọ́rú_Ọjọ́bọ_Ẹtì_Àbámẹ́ta".split("_"),months:"Sẹ́rẹ́_Èrèlè_Ẹrẹ̀nà_Ìgbé_Èbibi_Òkùdu_Agẹmo_Ògún_Owewe_Ọ̀wàrà_Bélú_Ọ̀pẹ̀̀".split("_"),weekStart:1,weekdaysShort:"Àìk_Ajé_Ìsẹ́_Ọjr_Ọjb_Ẹtì_Àbá".split("_"),monthsShort:"Sẹ́r_Èrl_Ẹrn_Ìgb_Èbi_Òkù_Agẹ_Ògú_Owe_Ọ̀wà_Bél_Ọ̀pẹ̀̀".split("_"),weekdaysMin:"Àì_Aj_Ìs_Ọr_Ọb_Ẹt_Àb".split("_"),ordinal:function(o){return o},formats:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},relativeTime:{future:"ní %s",past:"%s kọjá",s:"ìsẹjú aayá die",m:"ìsẹjú kan",mm:"ìsẹjú %d",h:"wákati kan",hh:"wákati %d",d:"ọjọ́ kan",dd:"ọjọ́ %d",M:"osù kan",MM:"osù %d",y:"ọdún kan",yy:"ọdún %d"}};return l.default.locale(c,null,!0),c})})(Yh);yn.extend(Kf);yn.extend(Xf);const xn=({timeZone:e})=>{if(e)try{return yn().tz(e)}catch{return yn()}else return yn()},Bh=({format:e,style:r,timeZone:i})=>{const[s,l]=R.useState(xn({timeZone:i}));return R.useEffect(()=>{const c=setInterval(()=>{l(xn({timeZone:i}))},1e3);return()=>{clearInterval(c)}},[i]),I.jsxs("div",{style:{...r},children:[" ",s.format(e)]})},jh=({format:e,style:r,locale:i,timeZone:s})=>{const[l,c]=R.useState(xn({timeZone:s}));return R.useEffect(()=>{c(xn({timeZone:s}));const o=setInterval(()=>{c(xn({timeZone:s}))},6e4);return()=>{clearInterval(o)}},[s]),I.jsx("div",{style:{...r},children:l.locale(i).format(e)})},So=e=>{const{cssClass:r,state:i,textFontSize:s,textColor:l,useAmPm:c,showSeconds:o,gap:h,showTime:g=!0,dateColor:d,dateFontSize:p,showDate:w,datePosition:_,locale:S="en",timeZone:E,fontFamily:b="Monaco,Lucida,Courier",boxReflect:L,staticDevMoveableRef:A,width:k,height:U,constraintsVertical:N,constraintsHorizontal:P,isStaticElement:G,left:$,top:J,right:X,bottom:Z,index:ie,deltaCenterX:de,deltaCenterY:_e}=e,Ee=Pt(i,ie),Se=mt(Fe=>Fe.showBoundingBox),le=rt({[`element_${e.type}`]:!0,[`${r}`]:r,showBoundingBox:Se,...Ee}),pe=Et(s),he=Et(p),Te=l?{color:l}:{},xe=d?{color:d}:{};let ye={hours:"HH",minutes:":mm",seconds:"",ampm:""};o&&(ye={...ye,seconds:":ss"}),c&&(ye={...ye,ampm:" A",hours:"hh"});const{hours:ge,minutes:be,seconds:fe,ampm:Ue}=ye,Ce=ge+be+fe+Ue,ae=yt({sizeObj:h,sizePropName:"gap"});let we="row";switch(_){case"before":we="row-reverse";break;case"top":we="column-reverse";break;case"bottom":we="column";break;default:we="row";break}const Ae=Xt(L),Oe=Mt({width:k,height:U,constraintsVertical:N,constraintsHorizontal:P,isStaticElement:G,left:$,top:J,right:X,bottom:Z,deltaCenterX:de,deltaCenterY:_e});return I.jsxs($f,{...e,ref:Fe=>{A&&(A.current=Fe)},style:{gap:"1em",...ae,flexFlow:we,...Ae,...Oe},className:le,children:[g&&I.jsx(Bh,{timeZone:E,style:{...Te,...pe,fontFamily:b},format:Ce}),w?I.jsx(jh,{timeZone:E,locale:S,style:{...xe,...he,fontFamily:b},format:"MMMM, DD"}):null]})};So.displayName="DateTimeWidget";const Uh={button:Bs,text:js,keypad:Js,input:Us,video:fo,htmlblock:_o,image:zu,spacer:Hs,switch:zs,toggle:ho,shades:vo,circleSlider:po,checkbox:uo,dpad:qs,subpage:ri,slider:Xs,clock:io,player:so,subpageList:lo,dateTime:So},Hh=({type:e})=>{try{return Uh[e]}catch{return null}},zh=({elementProps:e,activeModeIndexNumber:r})=>R.useMemo(()=>{if(e?.type!=="subpageList")return e;const{listWidth:s,listHeight:l,listForceFillWidth:c,listForceFillHeight:o,listState:h,listNumberOfItems:g,listPadding:d,listGap:p,listBackgroundColor:w,listBorder:_,listElementsFlow:S,listColumns:E,listRows:b,listVerticalPosition:L,listHorisontalPosition:A,listEmptyText:k,listUseCarousel:U,modes:N,activeModeIndex:P,cssClass:G,name:$,type:J,attachedModificators:X,attachedFunctions:Z,parentData:ie,parentArrayIndex:de,left:_e,top:Ee,right:Se,bottom:le,deltaCenterX:pe,deltaCenterY:he,constraintsHorizontal:Te,constraintsVertical:xe,staticListOverrides:ye,...ge}=e,{dynamicDataUsed:be={}}=e,fe={variablesUsed:{},statesUsed:{},datasourceUsed:{},parametersUsed:{}},Ce=`modes.${r-1}`,ae=`${Ce}.modeProps.`,we=Object.entries(be);for(const[Ae,Oe]of we){const Fe=Ae;if(!Oe)return;const Ne=Object.entries(Oe);for(const[Be,qe]of Ne){if(Be.startsWith("modes.")&&!Be.startsWith(Ce))continue;const Ie=Be.startsWith(ae)?Be.slice(ae.length):Be;fe[Fe][Ie]=qe}}return{...e,data:{...ge,type:"subpage",dynamicDataUsed:fe}}},[r,e]);function Gh(e){return/^\d+$/.test(e)}const $h=e=>{const{index:r,actions:i,modes:s,dataset:l,datasetPath:c,isDynamic:o,dynamic:h,filter:g,returningField:d,attachedModificators:p,left:w,top:_,right:S,bottom:E,constraintsHorizontal:b,constraintsVertical:L,isStaticElement:A,width:k,height:U,data:N,dynamicDataUsed:P,listWidth:G,listHeight:$,name:J,cssClass:X,type:Z,activeModeIndex:ie,...de}=e;return{actions:i,propsInheritedByMode:de,noModeProps:{modes:s,dataset:l,datasetPath:c,isDynamic:o,dynamic:h,filter:g,returningField:d,attachedModificators:p,index:r,left:w,top:_,right:S,bottom:E,width:k,height:U,constraintsHorizontal:b,constraintsVertical:L,isStaticElement:A,data:N,dynamicDataUsed:P,listWidth:G,listHeight:$,name:J,cssClass:X,type:Z,activeModeIndex:ie}}},Vh=({propsToRewrite:e,activeModeIndexNumber:r})=>{const{modes:i}=e,s=i?.[r-1];if(!s)return e;const l=s?.modeProps;if(!l)return e;const c=s.isModeHasOwnActions,{noModeProps:o,actions:h}=$h(e),{actions:g,...d}=l;return{...o,...d,actions:c?g:h}},Kh=({modeIndexForcedByEditor:e,elementProps:r})=>{const{modes:i,activeModeIndex:s}=r??{},l=R.useMemo(()=>{if(e!=null)return e;if(!s||!i?.length)return 0;if(Gh(String(s)))return Number(s);const o=i?.findIndex(h=>h.name===s);return o===-1?0:o+1},[s,e,i]);return{propsWithActualMode:R.useMemo(()=>!r||!l?r:Vh({propsToRewrite:r,activeModeIndexNumber:l}),[r,l]),activeModeIndexNumber:l}},Eo=()=>ze.memo(r=>{const{devProps:i,...s}=r,{modeIndexForcedByEditor:l}=i??{},{calculatedParameters:c}=R.useContext(qi),o=ra({propsToFill:s,calculatedParameters:c}),h=Lc({propsToFill:o}),{propsWithActualMode:g,activeModeIndexNumber:d}=Kh({modeIndexForcedByEditor:l,elementProps:h}),p=R.useMemo(()=>["live","preview"].includes(It.getState().envState??"")?{onContextMenu:k=>{const U=k.ctrlKey||k.metaKey;k.type==="contextmenu"&&k.button===2&&U&&(k.preventDefault(),console.log(`%c${g?.type} Final Props ↴`,"color: yellow; font-weight: bold; background: black; padding: 4px; border: 1px solid yellow; border-radius: 4px; text-transform: uppercase;",{...g,...i}))}}:{},[i,g]),{type:w}=g??{},_=R.useMemo(()=>w?Hh({type:w}):null,[w]),S=zh({elementProps:g,activeModeIndexNumber:d});if(!S||!S?.type)return null;S.type==="subpageList"&&(S.calculatedParameters=c);const{isStaticElement:E}=s,b=E?{"data-static":!0}:{};return _?I.jsx(_,{...b,...S,...i,...p}):I.jsxs("div",{children:["unknown type: ",w]})}),Wh=({containerIndex:e,index:r,isGlobal:i})=>{const{selectedContainerIndex:s,selectedElementIndex:l,selectedIsGlobalContainer:c}=mt(o=>({selectedContainerIndex:o.selectedMenuSection.containerIndex,selectedElementIndex:o.selectedMenuSection.elementIndex,selectedIsGlobalContainer:o.selectedMenuSection.isGlobalContainer}));return s===e&&l===r&&!!c==!!i},Xh=({isEditedNow:e,modes:r})=>{const{selectedModeIndex:i}=mt(c=>({selectedModeIndex:c.selectedMenuSection.modeIndex})),s=!!r?.length;return{modeIndexForcedByEditor:R.useMemo(()=>!e||!s?null:i===void 0?0:i+1,[e,s,i]),isModesExist:s}};var qh={visible:"universalElementWrapper_moveable_visible__1s96mf00"},Jh="universalElementWrapper_selectInformerBox__1s96mf02",Zh="universalElementWrapper_selectedElementType__1s96mf03",Qh="universalElementWrapper_activeElementMode__1s96mf04";const eg=({type:e})=>{const r=$t(i=>i.workingProject?.attributes.theme.data.attributes.devColors.element)??"black";return I.jsx("div",{className:Zh,style:{backgroundColor:r},children:e})},tg={name:"SelectInformerAble",props:["isModesExist","modeIndexForcedByEditor","type"],events:[],render(e,r){const{isModesExist:i,modeIndexForcedByEditor:s,type:l}=e.props;return I.jsxs("div",{className:`moveable-select-informer ${Jh}`,children:[I.jsx(eg,{type:l}),i&&I.jsx("div",{className:Qh,children:s})]},"select-informer")}},rg=({parentContainerElementsCount:e,index:r})=>R.useCallback(()=>{const i=[];for(let s=0;s<e;s++){if(s===r)continue;const l=`.container-0-element-${s}`;i.push(l)}return i},[e,r]),ng=({containerIndex:e,index:r,isEditedNow:i,isGlobal:s,isStaticElement:l,staticDevMoveableRef:c,setAllowResize:o})=>R.useCallback(g=>{g.stopPropagation(),g.preventDefault();const{setMainMenuData:d}=mt.getState();i&&o(w=>!w);const p=Ds({isGlobal:s,containerIndex:e,index:r});d({selectedMenuSection:{key:p,containerIndex:e,elementIndex:r,pageActionIndex:null,isGlobalContainer:!!s,isStaticContainer:!!l,selectedElementRef:c}})},[e,r,i,s,l,o,c]),tr=({property:e,element:r,distance:i,newValue:s})=>{if(s===void 0&&i===void 0)throw new Error("handleUpdateCssValue - no value or distance provided");if(s!==void 0){const l=typeof s=="number"?`${s}px`:s;r.style.setProperty(e,l)}else if(i!==void 0){const l=Number.parseFloat(r.style.getPropertyValue(e))||0;r.style.setProperty(e,`${l+i}px`)}},cs=({element:e,constraintsVertical:r="top",constraintsHorizontal:i="left",axis:s,distance:l,newSize:c,xEdge:o,yEdge:h})=>{s==="horizontal"?tr(i==="both"?{element:e,property:o===1?"right":"left",distance:-l}:{element:e,property:"width",newValue:c}):s==="vertical"&&tr(r==="both"?{element:e,property:h===1?"bottom":"top",distance:-l}:{element:e,property:"height",newValue:c})},ds=({element:e,constraintsVertical:r="top",constraintsHorizontal:i="left",axis:s,distance:l})=>{if(s==="horizontal")switch(i){case"center":tr({element:e,property:"--elementDeltaCenterX",distance:l});break;case"left":tr({element:e,property:"left",distance:l});break;case"right":tr({element:e,property:"right",distance:-l});break;case"both":tr({element:e,property:"left",distance:l}),tr({element:e,property:"right",distance:-l});break}else if(s==="vertical")switch(r){case"center":tr({element:e,property:"--elementDeltaCenterY",distance:l});break;case"top":tr({element:e,property:"top",distance:l});break;case"bottom":tr({element:e,property:"bottom",distance:-l});break;case"both":tr({element:e,property:"top",distance:l}),tr({element:e,property:"bottom",distance:-l});break}},xo=async({pageId:e,type:r,targetHtmlElement:i,moveableActionType:s})=>{const{left:l,top:c,right:o,bottom:h,width:g,height:d,deltaCenterX:p,deltaCenterY:w}=tc({targetHtmlElement:i}),{elementIndex:_,containerIndex:S,isGlobalContainer:E}=mt.getState().selectedMenuSection;if(_==null||S===void 0||S===null)return new Error("failed update element static position:elementIndex or containerIndex is null");let b={left:l+"px",right:o+"px",bottom:h+"px",top:c+"px",deltaCenterX:`${p}px`,deltaCenterY:`${w}px`,[r==="subpageList"?"listWidth":"width"]:{width:{value:g,unit:"px"}},[r==="subpageList"?"listHeight":"height"]:{height:{value:d,unit:"px"}}};if(s==="move"){const{width:L,height:A,...k}=b;b=k}return Rs({action:"update",containerIndex:S,elementIndex:_,dataToUpdate:b,pageId:e,isGlobal:!!E,ignoreModeIndex:!0}).catch(L=>{console.error(L),Ss.error("Failed update element dimensions")})},ig=({isEditedNow:e,constraintsVertical:r="top",constraintsHorizontal:i="left",type:s,setAllowResize:l,pageId:c})=>{const[o,h]=R.useState(!1);R.useEffect(()=>{if(!e){l(!1);return}const w=_=>{_.key==="Escape"&&l(S=>S&&!1)};return document.addEventListener("keydown",w),()=>{document.removeEventListener("keydown",w)}},[e,l]);const g=R.useCallback(w=>{const _=w.inputEvent.shiftKey;h(S=>_!==S?_:S)},[]),d=R.useCallback(w=>{const{width:_,height:S,delta:[E,b],direction:[L,A],target:k}=w;E!==0&&cs({element:k,constraintsVertical:r,constraintsHorizontal:i,axis:"horizontal",distance:E,newSize:_,xEdge:L,yEdge:A}),b!==0&&cs({element:k,constraintsVertical:r,constraintsHorizontal:i,axis:"vertical",distance:b,newSize:S,xEdge:L,yEdge:A})},[i,r]),p=R.useCallback(w=>{h(S=>S&&!1);const{target:_}=w;xo({targetHtmlElement:_,pageId:c,type:s,moveableActionType:"resize"})},[c,s]);return{keepRatio:o,handleStaticResizeStart:g,handleStaticResize:d,handleStaticResizeEnd:p}},ag=({type:e,constraintsVertical:r="top",constraintsHorizontal:i="left",pageId:s})=>{const l=R.useCallback(o=>{const{target:h,delta:[g,d]}=o;g!==0&&ds({element:h,constraintsVertical:r,constraintsHorizontal:i,distance:g,axis:"horizontal"}),d!==0&&ds({element:h,constraintsVertical:r,constraintsHorizontal:i,distance:d,axis:"vertical"})},[i,r]),c=R.useCallback(o=>{const{isDrag:h,target:g}=o;h&&xo({targetHtmlElement:g,pageId:s,type:e,moveableActionType:"move"})},[s,e]);return{handleStaticDrag:l,handleStaticDragEnd:c}},sg=({containerIndex:e,index:r,isGlobal:i})=>({onDragStart:R.useCallback(l=>{const c={sourceContainerIndex:e,sourceElementIndex:r,sourceContainerType:i?"global":"normal"};l.dataTransfer.setData("draggedElement",JSON.stringify(c))},[e,r,i])}),og=({containerIndex:e,isGlobal:r,subpageId:i,index:s})=>R.useCallback(c=>{const{setPageContextMenu:o}=mt.getState();c.preventDefault(),c.stopPropagation(),o({event:c,containerIndex:e,isGlobal:r,elementIndex:s,subpageId:i})},[e,s,r,i]),lg=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ug=(e,r,i)=>{const l={ArrowUp:{deltaX:0,deltaY:-i},ArrowDown:{deltaX:0,deltaY:i},ArrowLeft:{deltaX:-i,deltaY:0},ArrowRight:{deltaX:i,deltaY:0}}[r];l&&e.request("draggable",l,!0)},cg=({moveableInstance:e})=>{const r=mt(i=>i.isStaticEditor);R.useEffect(()=>{if(!r)return;const i=s=>{const{key:l,metaKey:c,ctrlKey:o,target:h}=s,{tagName:g}=h;if(g==="INPUT"||g==="TEXTAREA"||h?.getAttribute("role")==="textbox"||!lg.includes(l)||!e.current)return;s.stopPropagation(),s.preventDefault();const p=c||o?10:1;ug(e.current,l,p)};return window.addEventListener("keydown",i),()=>{window.removeEventListener("keydown",i)}},[e,r])},dg=({isEditedNow:e,devElementUpdateRect:r,staticDevMoveableRef:i})=>{R.useEffect(()=>{const s=i.current;if(!s||!e)return;const l=new MutationObserver(()=>{r()});return l.observe(s,{attributes:!0,childList:!0}),r(),()=>{l.disconnect()}},[r,e,i])},fg=ze.memo(({propsToBePassed:e,parentContainerElementsCount:r})=>{const{pageId:i}=kn(),s=R.useRef(null),l=ze.useRef(null),c=R.useCallback(()=>{l.current?.updateRect()},[]);cg({moveableInstance:l});const{containerIndex:o,index:h,isGlobal:g,modes:d,isStaticElement:p,type:w,constraintsVertical:_,constraintsHorizontal:S}=e,E=Wh({containerIndex:o,index:h,isGlobal:g});dg({isEditedNow:E,devElementUpdateRect:c,staticDevMoveableRef:s});const b=E&&!p,{modeIndexForcedByEditor:L,isModesExist:A}=Xh({isEditedNow:E,modes:d}),[k,U]=R.useState(!1),N=ng({containerIndex:o,index:h,isEditedNow:E,isGlobal:g,isStaticElement:p,staticDevMoveableRef:s,setAllowResize:U}),{keepRatio:P,handleStaticResizeStart:G,handleStaticResize:$,handleStaticResizeEnd:J}=ig({isEditedNow:E,constraintsVertical:_,constraintsHorizontal:S,type:w,setAllowResize:U,pageId:i}),{handleStaticDrag:X,handleStaticDragEnd:Z}=ag({type:w,constraintsVertical:_,constraintsHorizontal:S,pageId:i}),{onDragStart:ie}=sg({containerIndex:o,index:h,isGlobal:g}),de=og({containerIndex:o,isGlobal:g,subpageId:e?.subpageId??e?.data?.subpageId,index:h}),_e=R.useMemo(()=>Eo(),[]),Ee=rg({parentContainerElementsCount:r,index:h}),{vertical:Se=[],horizontal:le=[]}=$t(pe=>pe.workingProject?.attributes.guides)??{};return I.jsxs(I.Fragment,{children:[I.jsx(_e,{devProps:{staticDevMoveableRef:s,"data-isdevmode":!0,"data-iseditednow":E,onClick:N,onDragStart:ie,onContextMenu:de,draggable:b,modeIndexForcedByEditor:L},...e}),E&&I.jsx(ac,{rootContainer:document.querySelector("#editorBody"),viewContainer:document.querySelector("#editorRenderFrame"),className:qh.visible,keepRatio:P,hideDefaultLines:!1,linePadding:10,controlPadding:10,useAccuratePosition:!0,useMutationObserver:!1,useResizeObserver:!1,ref:l,target:s,throttleDrag:0,draggable:!!p,resizable:k,edgeDraggable:!0,throttleResize:0,snappable:!0,isDisplaySnapDigit:!0,isDisplayInnerSnapDigit:!1,snapGap:!0,snapDirections:{top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0},elementSnapDirections:{top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0},snapThreshold:0,elementGuidelines:Ee(),onDrag:X,onDragEnd:Z,onResizeStart:G,onResize:$,onResizeEnd:J,verticalGuidelines:Se,horizontalGuidelines:le,ables:[tg],props:{SelectInformerAble:!0,isModesExist:A,modeIndexForcedByEditor:L,type:w}})]})}),hg=ze.memo(({propsToBePassed:e,renderAsElement:r,parentContainerElementsCount:i})=>{const s=It.getState().envState==="editor",l=!r&&s,c=R.useMemo(()=>Eo(),[]);return l?I.jsx(fg,{propsToBePassed:e,parentContainerElementsCount:i}):I.jsx(c,{...e})}),zi=ze.memo(({containerData:e,isEditedNow:r,showBoundingBox:i,currentPageContainersFlow:s,containerIndex:l,isGlobal:c=!1,globalPosition:o,renderAsElement:h,style:g,parentArrayIndex:d,parentId:p,parentData:w,isStaticPage:_,refHolder:S,currentContainerOptions:E,indicatorNode:b=null,...L})=>{const A=It(J=>J.isLandscape)??!1,k=mt.getState().selectedMenuSection.containerIndex,U=mt.getState().selectedMenuSection.isGlobalContainer,N=k===l&&U===c&&!h&&i,P=R.useMemo(()=>e.elements.map((X,Z)=>{const ie={containerIndex:l,isGlobal:c,parentArrayIndex:d,parentData:w,parentId:p,index:Z,currentPageContainersFlow:s,state:X.state,isLandscape:A,isStaticElement:!!e?.isStatic},de=Ds({isGlobal:c,containerIndex:l,index:Z});return I.jsx(hg,{parentContainerElementsCount:e.elements.length,renderAsElement:!!h,propsToBePassed:{...ie,...X}},de)}),[e.elements,e?.isStatic,l,s,c,A,d,w,p,h]),G=yc({currentContainerOptions:E,isGlobal:c,globalPosition:o,currentPageContainersFlow:s,renderAsElement:h,showBoundingBox:i,isEditedNow:r});if(P==null)return null;const $=rt({container:!c,globalContainer:c,[`${e.cssClass}`]:e.cssClass,renderAsElement:!!h,[$a.adaptive]:_,[$a.responsive]:!_,selectedContainer:N});return I.jsxs("div",{ref:S,"data-container-index":l,"data-is-global":c,style:{...G,...g},className:$,...L,children:[P.length?I.jsx(I.Fragment,{children:P}):I.jsx(Sc,{}),b]})});zi.displayName="Container";function gg(e){const r=e.relatedTarget||document.elementFromPoint(e.clientX,e.clientY);return e.currentTarget.contains(r)}const mg=({dragEnterStatus:e,indicatorOrder:r,containerFlow:i})=>e?I.jsx("div",{style:{order:r},className:_c[i]},r):null,pg=({Component:e,refHolder:r,containerIndex:i,isGlobal:s,containerFlow:l,isStaticContainer:c})=>ze.memo(h=>{const{pageId:g}=kn(),d=R.useRef(null),[p,w]=R.useState(!1),[_,S]=R.useState(-1),E=R.useCallback(()=>{if(r.current&&p===!1){const P=r.current.children,G={};for(let $=0;$<P.length;$++){const X=P[$].getBoundingClientRect();G[$]={boundingBox:X,positions:{topLeft:{x:X.left,y:X.top},topRight:{x:X.right,y:X.top},bottomRight:{x:X.right,y:X.bottom},bottomLeft:{x:X.left,y:X.bottom}}}}d.current=G,w(!0)}},[p]),b=R.useCallback(P=>{if(P.preventDefault(),r.current&&d.current){const G=It.getState().editorZoom??1,$=P.clientX/G,J=P.clientY/G;let X={position:null,index:null},Z=Number.MAX_VALUE;const ie=d.current;for(const[de,_e]of Object.entries(ie)){const Ee=_e.positions;for(const[Se,le]of Object.entries(Ee)){const pe=Math.sqrt(($-le.x)**2+(J-le.y)**2);pe<Z&&(Z=pe,X={position:Se,index:Number.parseInt(de)})}}if(!l)return;l==="column"?S(de=>{const _e=X.position.toLowerCase().includes("top")?X.index-1:X.index;return de===_e?de:_e}):l==="row"&&S(de=>{const _e=X.position?.toLowerCase().includes("left")?X.index-1:X.index;return de===_e?de:_e})}},[]),L=R.useCallback(P=>{gg(P)||(w(!1),d.current=null)},[]),A=R.useCallback(()=>{w(!1),d.current=null},[]),k=R.useCallback(P=>{P.preventDefault();const G=mt.getState().setPageContextMenu;G({event:P,containerIndex:i,isGlobal:s})},[]),U=P=>{const G=P.dataTransfer.getData("draggedElement");try{const $=JSON.parse(G),J={destinationContainerIndex:i,destinationContainerType:s?"global":"normal",destinationElementPosition:_+1};g&&sc({pageId:g,dragDestination:J,draggedElement:$})}catch($){console.log($)}console.log("onDrop fired in container"),w(!1),d.current=null},N=R.useCallback(()=>{let P=`container-${i}-details`;s&&(P=`globalContainer-${i}-details`);const G=mt.getState().setMainMenuData;G({selectedMenuSection:{isGlobalContainer:s||!1,isStaticContainer:c,key:P,containerIndex:i,elementIndex:null,pageActionIndex:null}})},[]);return I.jsx(e,{onDragEnter:E,onDragLeave:L,onDragExit:A,onDrop:U,onDragOver:b,onContextMenu:k,onClick:N,indicatorNode:I.jsx(mg,{containerFlow:l,indicatorOrder:_,dragEnterStatus:p}),...h})}),ia=ze.memo(({containerData:e,isEditedNow:r,showBoundingBox:i,currentPageContainersFlow:s,containerIndex:l,isGlobal:c=!1,globalPosition:o,renderAsElement:h,style:g,parentArrayIndex:d,parentId:p,parentData:w,parameters:_,isStaticPage:S})=>{const E=It(P=>P.envState),b=It(P=>P.isLandscape),L=R.useRef(null),A=e.useOrientation,k=R.useMemo(()=>A&&b?e.landscape:e.portrait,[e.landscape,e.portrait,A,b]),U=R.useMemo(()=>pg({Component:zi,refHolder:L,containerIndex:l,isGlobal:c,containerFlow:k?.flow??"column",isStaticContainer:!!e.isStatic}),[e.isStatic,l,k?.flow,c]),N={renderAsElement:h,containerIndex:l,currentPageContainersFlow:s,globalPosition:o,isGlobal:c,isStaticPage:S,style:g,parentArrayIndex:d,parentId:p,parentData:w,parameters:_,showBoundingBox:i,isEditedNow:r,containerData:e,currentContainerOptions:k};return!h&&E==="editor"?I.jsx(U,{...N,refHolder:L}):I.jsx(zi,{...N,refHolder:L})});ia.displayName="Container";const vg=e=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 226 226",...e},R.createElement("g",{fill:"none",fillRule:"nonzero",stroke:"none",strokeWidth:1,strokeLinecap:"butt",strokeLinejoin:"miter",strokeMiterlimit:10,strokeDasharray:"",strokeDashoffset:0,fontFamily:"none",fontWeight:"none",fontSize:"none",textAnchor:"none"},R.createElement("path",{d:"M0,226v-226h226v226z",fill:"none"}),R.createElement("g",null,R.createElement("path",{d:"M157.14063,197.75h-123.59375c-3.00156,0 -5.29687,-2.29531 -5.29687,-5.29687v-123.59375c0,-3.00156 2.29531,-5.29687 5.29688,-5.29687c3.00156,0 5.29688,2.29531 5.29688,5.29688v118.29688h118.29688c3.00156,0 5.29688,2.29531 5.29688,5.29688c0,3.00156 -2.29531,5.29688 -5.29687,5.29688zM157.14063,171.26563c-3.00156,0 -5.29687,-2.29531 -5.29687,-5.29687v-91.8125h-91.8125c-3.00156,0 -5.29687,-2.29531 -5.29687,-5.29687c0,-3.00156 2.29531,-5.29687 5.29688,-5.29687h97.10938c3.00156,0 5.29688,2.29531 5.29688,5.29688v97.10938c0,3.00156 -2.29531,5.29688 -5.29687,5.29688z",fill:"#fff"}),R.createElement("path",{d:"M157.14063,197.75c-1.4125,0 -2.64844,-0.52969 -3.70781,-1.58906c-2.11875,-2.11875 -2.11875,-5.47344 0,-7.41563l33.72344,-33.72344v-116.17812h-118.29687c-3.00156,0 -5.29687,-2.29531 -5.29687,-5.29687c0,-3.00156 2.29531,-5.29687 5.29688,-5.29687h123.59375c3.00156,0 5.29688,2.29531 5.29688,5.29688v123.59375c0,1.4125 -0.52969,2.825 -1.58906,3.70781l-35.3125,35.3125c-1.05937,1.05938 -2.29531,1.58906 -3.70781,1.58906z",fill:"#fff"}),R.createElement("path",{d:"M157.14063,74.15625c-1.4125,0 -2.64844,-0.52969 -3.70781,-1.58906c-2.11875,-2.11875 -2.11875,-5.47344 0,-7.41563l17.65625,-17.65625c2.11875,-2.11875 5.47344,-2.11875 7.41563,0c2.11875,2.11875 2.11875,5.47344 0,7.41562l-17.65625,17.65625c-1.05938,1.05938 -2.29531,1.58906 -3.70781,1.58906zM33.54688,74.15625c-1.4125,0 -2.64844,-0.52969 -3.70781,-1.58906c-2.11875,-2.11875 -2.11875,-5.47344 0,-7.41563l35.3125,-35.3125c2.11875,-2.11875 5.47344,-2.11875 7.41563,0c2.11875,2.11875 2.11875,5.47344 0,7.41562l-35.3125,35.3125c-1.05938,1.05938 -2.29531,1.58906 -3.70781,1.58906z",fill:"#fff"})))),To=ze.memo(({pageData:e,currentPageContainersFlow:r,renderAsElement:i})=>{const s=mt(d=>d.showBoundingBox),l=mt(d=>d.selectedMenuSection),{containerIndex:c,elementIndex:o,isGlobalContainer:h}=l,g=R.useMemo(()=>e.attributes?.containers?.map((d,p)=>{let w=!1;return!h&&c!==void 0&&c===p&&(w=!0),I.jsx(ia,{isStaticPage:e.attributes.isStatic,parentArrayIndex:e.listIndex,parentData:e.parentData,parentId:e.id,renderAsElement:i,currentPageContainersFlow:r,containerIndex:p,showBoundingBox:s,isEditedNow:w,selectedElementIndex:o,containerData:d,parameters:e.attributes.parameters},"container_"+p)}),[r,h,e.attributes?.containers,e.attributes.isStatic,e.attributes.parameters,e.id,e.listIndex,e.parentData,i,c,o,s]);return e&&g?.length?g:I.jsx(Qi,{icon:I.jsx(vg,{}),title:"No containers created",text:e.attributes.name})});To.displayName="PrintPageContainers";const _g=Mu(e=>({modalsData:{newElement:null},setNewElementModalData:r=>{e(()=>({modalsData:{newElement:r}}))}})),yg=Ln`
  from {
    transform: scale(0);
  }

  to {
    transform: scale(1);
  }
`,bg=pt.div`
  position: absolute;
  left: 0;
  top: 0;
  z-index: 10000;
  border-radius: 3px;
  padding: 10px;
  display: flex;
  flex-flow: column;
  gap: 10px;
  background-color: #ffffff;
  animation: ${yg} 100ms linear;
  border: 0.5px gray dashed;
  will-change: transform;
`,Sg=()=>{const{pageId:e}=kn(),r=Iu(),i=Ms(),{setCloneItemModal:s}=Pu(),l=mt(U=>U.pageContextMenu),c=mt(U=>U.selectedMenuSection),{setPageContextMenu:o}=mt.getState(),{event:{clientX:h,clientY:g},containerIndex:d,elementIndex:p,isGlobal:w,subpageId:_}=l||{event:{}},{setNewElementModalData:S}=_g.getState();R.useEffect(()=>{o(null)},[c,o]),R.useEffect(()=>{function U(){o(null)}function N(P){P.key==="Escape"&&U()}return document.addEventListener("click",U),document.addEventListener("keydown",N),()=>{document.removeEventListener("click",U),document.removeEventListener("keydown",N)}},[o]);function E(){if(!_)return;const U=i.pathname.split("/"),N=U.findIndex(P=>P==="page");r(`${U.slice(0,N+1).join("/")}/${_}`)}const[b,L]=R.useState(null),[A,k]=R.useState({visibility:"hidden"});return R.useEffect(()=>{if(b&&h&&g){const{innerHeight:U,innerWidth:N}=window,P=Math.min(h,N-b.offsetWidth),G=Math.min(g,U-b.offsetHeight);k({left:P,top:G})}},[h,g,b]),l&&d!==void 0?Es.createPortal(I.jsxs(bg,{ref:U=>{L(U)},style:{...A},children:[p!==void 0&&I.jsxs(I.Fragment,{children:[I.jsx(Bn,{danger:!0,onClick:U=>{U.stopPropagation(),Rs({containerIndex:d,elementIndex:p,isGlobal:w,pageId:e,action:"delete"}),o(null)},children:"Delete Element"}),_&&I.jsx(Bn,{onClick:()=>{E()},children:"Edit Subpage"}),I.jsx(Bn,{onClick:U=>{U.stopPropagation(),s({nodeType:"element",containerIndex:d,elementIndex:p,isGlobal:w}),o(null)},children:"Clone Element"}),I.jsx(Ba,{style:{margin:"5px 0"}})]}),I.jsx(Bn,{onClick:U=>{U.stopPropagation();const{clientX:N,clientY:P}=mt.getState().pageContextMenu?.event??{};S({containerIndex:d,isGlobal:!!w,clientX:N,clientY:P}),o(null)},children:"Add Element"}),I.jsx(Ba,{style:{margin:"5px 0"}}),I.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[I.jsx(yi,{style:{margin:0},children:"cmd/ctrl + c"}),I.jsx("small",{style:{fontSize:10},children:"to copy"})]}),I.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[I.jsx(yi,{style:{margin:0},children:"cmd/ctrl + v"}),I.jsx("small",{style:{fontSize:10},children:"to paste"})]}),I.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[I.jsx(yi,{style:{margin:0},children:"del/backspace"}),I.jsx("small",{style:{fontSize:10},children:"to del"})]})]},h),document.body):null};var Eg="page_pageContent__5mn7bk0";const xg=({background:e,renderAsElement:r,isBgCalculated:i})=>{const s=R.useRef(null),{backgroundColor:l,opacity:c,blur:o,backgroundSize:h,backgroundPosition:g,backgroundImageUrl:d}=ea({bgProps:e});return R.useEffect(()=>{if(!i)return;const p=document.getElementById("GuiMainContainer");if(r)if(e?.customBackgroundImage){if(!s.current)return;s.current.style.backgroundImage=`url(${d.fullImageUrl??"bad_url"})`}else s.current&&(s.current.style.backgroundImage="");else{if(!p)return;p.style.setProperty("--active-page-background-image",`url(${d.fullImageUrl??"bad_url"})`),p.style.setProperty("--active-page-background-color",l||"transparent"),p.style.setProperty("--active-page-background-filter",o),p.style.setProperty("--active-page-background-opacity",c),p.style.setProperty("--active-page-background-backgroundSize",h),p.style.setProperty("--active-page-background-backgroundPosition",g)}},[l,d,g,h,o,i,c,e?.customBackgroundImage,r]),r?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"expand",style:{backgroundColor:l,pointerEvents:"none"}}),I.jsx("div",{ref:s,className:"expand",style:{opacity:c,filter:o,backgroundSize:h,backgroundPosition:g,pointerEvents:"none"}})]}):null},Tg=ze.memo(xg),ni=ze.memo(({data:e,renderAsElement:r,listIndex:i,parentData:s,style:l})=>{const c=It(N=>N.isLandscape),o=e.attributes.parameters??[],h=ra({propsToFill:e.attributes,calculatedParameters:o}),g=R.useMemo(()=>h?{...e,attributes:h??{},listIndex:i,parentData:s}:null,[e,i,s,h]),d=g?.attributes?.background!==void 0,p=rt({[Eg]:!0,page:!0,[`${e.attributes.cssClass}`]:!!e.attributes.cssClass,renderAsElement:r}),w=e.attributes.useOrientationFlow,{portraitFlow:_="row",landscapeFlow:S="row",portraitAlign:E="center",landscapeAlign:b="center"}=e.attributes,L=R.useMemo(()=>w?c?{flexFlow:S,alignItems:b}:{flexFlow:_,alignItems:E}:{flexFlow:_,alignItems:E},[w,c,b,S,E,_]),A=mt(N=>N.showBoundingBox),{onLoadActions:k,onExitActions:U}=lr({actions:g?.attributes.actions});return R.useEffect(()=>{if(k?.length)for(const N of k)N()},[k]),R.useEffect(()=>()=>{if(U?.length)for(const N of U)N()},[U]),g?I.jsxs(Gu,{parameters:o,children:[A&&I.jsx(Sg,{}),I.jsx(Tg,{background:g?.attributes.background,renderAsElement:r,isBgCalculated:d}),I.jsx("div",{style:{...l,...L},className:p,children:g?.attributes&&I.jsx(To,{renderAsElement:r,currentPageContainersFlow:L.flexFlow,pageData:g})},e.id)]}):null});ni.displayName="Page";const Mg=ze.memo(()=>{const e=Ms(),{pageId:r}=kn(),i=$t(b=>b.workingProject),s=i?.attributes.pages.data,l=i?.attributes.globalContainers,c=It(b=>b.isLandscape),o=It(b=>b.envState),h=mt(b=>b.showBoundingBox),g=mt(b=>b.selectedMenuSection),{containerIndex:d,elementIndex:p,isGlobalContainer:w}=g,[_,S]=R.useState([]),E=R.useCallback(b=>_.map((A,k)=>{if(c&&A.landscapePosition===b||!c&&A.portraitPosition===b){let U=!1;return w&&d===k&&(U=!0),I.jsx(ia,{isStaticPage:!1,parentId:r,style:A.isVisibleOnPage?{}:{display:"none"},containerIndex:k,isGlobal:!0,globalPosition:b,showBoundingBox:o!=="live"&&h||!1,isEditedNow:U,selectedElementIndex:p,containerData:A},`globalContainer_${b}_`+k)}else return null}),[o,_,w,c,r,d,p,h]);return R.useEffect(()=>{let b="";if(r)b=r;else{const A=e.pathname.split("/"),k=A[A.length-1];b=s?.find(U=>Di(U.attributes.name)===k)?.id||"no-name"}const L=[];if(l?.length)for(const A of l){let k;A.visibleByDefault?k=!A.hiddenOnPages.includes(b):k=A.visibleOnPages.includes(b),L.push({...A,isVisibleOnPage:k})}L.length&&S(L)},[o,l,e.pathname,r,s]),I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"globalslot top",children:E("top")}),I.jsx("div",{className:"globalslot left",children:E("left")}),I.jsx("div",{className:"globalslot right",children:E("right")}),I.jsx("div",{className:"globalslot bottom",children:E("bottom")})]})});let wg={data:""},Lg=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||wg,kg=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Ag=/\/\*[^]*?\*\/|  +/g,fs=/\n+/g,kr=(e,r)=>{let i="",s="",l="";for(let c in e){let o=e[c];c[0]=="@"?c[1]=="i"?i=c+" "+o+";":s+=c[1]=="f"?kr(o,c):c+"{"+kr(o,c[1]=="k"?"":r)+"}":typeof o=="object"?s+=kr(o,r?r.replace(/([^,])+/g,h=>c.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,g=>/&/.test(g)?g.replace(/&/g,h):h?h+" "+g:g)):c):o!=null&&(c=/^--/.test(c)?c:c.replace(/[A-Z]/g,"-$&").toLowerCase(),l+=kr.p?kr.p(c,o):c+":"+o+";")}return i+(r&&l?r+"{"+l+"}":l)+s},Tr={},Mo=e=>{if(typeof e=="object"){let r="";for(let i in e)r+=i+Mo(e[i]);return r}return e},Rg=(e,r,i,s,l)=>{let c=Mo(e),o=Tr[c]||(Tr[c]=(g=>{let d=0,p=11;for(;d<g.length;)p=101*p+g.charCodeAt(d++)>>>0;return"go"+p})(c));if(!Tr[o]){let g=c!==e?e:(d=>{let p,w,_=[{}];for(;p=kg.exec(d.replace(Ag,""));)p[4]?_.shift():p[3]?(w=p[3].replace(fs," ").trim(),_.unshift(_[0][w]=_[0][w]||{})):_[0][p[1]]=p[2].replace(fs," ").trim();return _[0]})(e);Tr[o]=kr(l?{["@keyframes "+o]:g}:g,i?"":"."+o)}let h=i&&Tr.g?Tr.g:null;return i&&(Tr.g=Tr[o]),((g,d,p,w)=>{w?d.data=d.data.replace(w,g):d.data.indexOf(g)===-1&&(d.data=p?g+d.data:d.data+g)})(Tr[o],r,s,h),o},Dg=(e,r,i)=>e.reduce((s,l,c)=>{let o=r[c];if(o&&o.call){let h=o(i),g=h&&h.props&&h.props.className||/^go/.test(h)&&h;o=g?"."+g:h&&typeof h=="object"?h.props?"":kr(h,""):h===!1?"":h}return s+l+(o??"")},"");function ii(e){let r=this||{},i=e.call?e(r.p):e;return Rg(i.unshift?i.raw?Dg(i,[].slice.call(arguments,1),r.p):i.reduce((s,l)=>Object.assign(s,l&&l.call?l(r.p):l),{}):i,Lg(r.target),r.g,r.o,r.k)}let wo,Gi,$i;ii.bind({g:1});let wr=ii.bind({k:1});function Cg(e,r,i,s){kr.p=r,wo=e,Gi=i,$i=s}function Cr(e,r){let i=this||{};return function(){let s=arguments;function l(c,o){let h=Object.assign({},c),g=h.className||l.className;i.p=Object.assign({theme:Gi&&Gi()},h),i.o=/ *go\d+/.test(g),h.className=ii.apply(i,s)+(g?" "+g:"");let d=e;return e[0]&&(d=h.as||e,delete h.as),$i&&d[0]&&$i(h),wo(d,h)}return r?r(l):l}}var Ig=e=>typeof e=="function",Qn=(e,r)=>Ig(e)?e(r):e,Pg=(()=>{let e=0;return()=>(++e).toString()})(),Lo=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let r=matchMedia("(prefers-reduced-motion: reduce)");e=!r||r.matches}return e}})(),Og=20,ko=(e,r)=>{switch(r.type){case 0:return{...e,toasts:[r.toast,...e.toasts].slice(0,Og)};case 1:return{...e,toasts:e.toasts.map(c=>c.id===r.toast.id?{...c,...r.toast}:c)};case 2:let{toast:i}=r;return ko(e,{type:e.toasts.find(c=>c.id===i.id)?1:0,toast:i});case 3:let{toastId:s}=r;return{...e,toasts:e.toasts.map(c=>c.id===s||s===void 0?{...c,dismissed:!0,visible:!1}:c)};case 4:return r.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(c=>c.id!==r.toastId)};case 5:return{...e,pausedAt:r.time};case 6:let l=r.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(c=>({...c,pauseDuration:c.pauseDuration+l}))}}},Kn=[],Nr={toasts:[],pausedAt:void 0},Vr=e=>{Nr=ko(Nr,e),Kn.forEach(r=>{r(Nr)})},Fg={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Ng=(e={})=>{let[r,i]=R.useState(Nr),s=R.useRef(Nr);R.useEffect(()=>(s.current!==Nr&&i(Nr),Kn.push(i),()=>{let c=Kn.indexOf(i);c>-1&&Kn.splice(c,1)}),[]);let l=r.toasts.map(c=>{var o,h,g;return{...e,...e[c.type],...c,removeDelay:c.removeDelay||((o=e[c.type])==null?void 0:o.removeDelay)||e?.removeDelay,duration:c.duration||((h=e[c.type])==null?void 0:h.duration)||e?.duration||Fg[c.type],style:{...e.style,...(g=e[c.type])==null?void 0:g.style,...c.style}}});return{...r,toasts:l}},Yg=(e,r="blank",i)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:r,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...i,id:i?.id||Pg()}),Rn=e=>(r,i)=>{let s=Yg(r,e,i);return Vr({type:2,toast:s}),s.id},Jt=(e,r)=>Rn("blank")(e,r);Jt.error=Rn("error");Jt.success=Rn("success");Jt.loading=Rn("loading");Jt.custom=Rn("custom");Jt.dismiss=e=>{Vr({type:3,toastId:e})};Jt.remove=e=>Vr({type:4,toastId:e});Jt.promise=(e,r,i)=>{let s=Jt.loading(r.loading,{...i,...i?.loading});return typeof e=="function"&&(e=e()),e.then(l=>{let c=r.success?Qn(r.success,l):void 0;return c?Jt.success(c,{id:s,...i,...i?.success}):Jt.dismiss(s),l}).catch(l=>{let c=r.error?Qn(r.error,l):void 0;c?Jt.error(c,{id:s,...i,...i?.error}):Jt.dismiss(s)}),e};var Bg=(e,r)=>{Vr({type:1,toast:{id:e,height:r}})},jg=()=>{Vr({type:5,time:Date.now()})},Tn=new Map,Ug=1e3,Hg=(e,r=Ug)=>{if(Tn.has(e))return;let i=setTimeout(()=>{Tn.delete(e),Vr({type:4,toastId:e})},r);Tn.set(e,i)},zg=e=>{let{toasts:r,pausedAt:i}=Ng(e);R.useEffect(()=>{if(i)return;let c=Date.now(),o=r.map(h=>{if(h.duration===1/0)return;let g=(h.duration||0)+h.pauseDuration-(c-h.createdAt);if(g<0){h.visible&&Jt.dismiss(h.id);return}return setTimeout(()=>Jt.dismiss(h.id),g)});return()=>{o.forEach(h=>h&&clearTimeout(h))}},[r,i]);let s=R.useCallback(()=>{i&&Vr({type:6,time:Date.now()})},[i]),l=R.useCallback((c,o)=>{let{reverseOrder:h=!1,gutter:g=8,defaultPosition:d}=o||{},p=r.filter(S=>(S.position||d)===(c.position||d)&&S.height),w=p.findIndex(S=>S.id===c.id),_=p.filter((S,E)=>E<w&&S.visible).length;return p.filter(S=>S.visible).slice(...h?[_+1]:[0,_]).reduce((S,E)=>S+(E.height||0)+g,0)},[r]);return R.useEffect(()=>{r.forEach(c=>{if(c.dismissed)Hg(c.id,c.removeDelay);else{let o=Tn.get(c.id);o&&(clearTimeout(o),Tn.delete(c.id))}})},[r]),{toasts:r,handlers:{updateHeight:Bg,startPause:jg,endPause:s,calculateOffset:l}}},Gg=wr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,$g=wr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Vg=wr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Kg=Cr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Gg} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${$g} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Vg} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Wg=wr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Xg=Cr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${Wg} 1s linear infinite;
`,qg=wr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Jg=wr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Zg=Cr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${qg} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Jg} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Qg=Cr("div")`
  position: absolute;
`,em=Cr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,tm=wr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,rm=Cr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${tm} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,nm=({toast:e})=>{let{icon:r,type:i,iconTheme:s}=e;return r!==void 0?typeof r=="string"?R.createElement(rm,null,r):r:i==="blank"?null:R.createElement(em,null,R.createElement(Xg,{...s}),i!=="loading"&&R.createElement(Qg,null,i==="error"?R.createElement(Kg,{...s}):R.createElement(Zg,{...s})))},im=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,am=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,sm="0%{opacity:0;} 100%{opacity:1;}",om="0%{opacity:1;} 100%{opacity:0;}",lm=Cr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,um=Cr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,cm=(e,r)=>{let i=e.includes("top")?1:-1,[s,l]=Lo()?[sm,om]:[im(i),am(i)];return{animation:r?`${wr(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${wr(l)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},dm=R.memo(({toast:e,position:r,style:i,children:s})=>{let l=e.height?cm(e.position||r||"top-center",e.visible):{opacity:0},c=R.createElement(nm,{toast:e}),o=R.createElement(um,{...e.ariaProps},Qn(e.message,e));return R.createElement(lm,{className:e.className,style:{...l,...i,...e.style}},typeof s=="function"?s({icon:c,message:o}):R.createElement(R.Fragment,null,c,o))});Cg(R.createElement);var fm=({id:e,className:r,style:i,onHeightUpdate:s,children:l})=>{let c=R.useCallback(o=>{if(o){let h=()=>{let g=o.getBoundingClientRect().height;s(e,g)};h(),new MutationObserver(h).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,s]);return R.createElement("div",{ref:c,className:r,style:i},l)},hm=(e,r)=>{let i=e.includes("top"),s=i?{top:0}:{bottom:0},l=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Lo()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${r*(i?1:-1)}px)`,...s,...l}},gm=ii`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Hn=16,mm=({reverseOrder:e,position:r="top-center",toastOptions:i,gutter:s,children:l,containerStyle:c,containerClassName:o})=>{let{toasts:h,handlers:g}=zg(i);return R.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:Hn,left:Hn,right:Hn,bottom:Hn,pointerEvents:"none",...c},className:o,onMouseEnter:g.startPause,onMouseLeave:g.endPause},h.map(d=>{let p=d.position||r,w=g.calculateOffset(d,{reverseOrder:e,gutter:s,defaultPosition:r}),_=hm(p,w);return R.createElement(fm,{id:d.id,key:d.id,onHeightUpdate:g.updateHeight,className:d.visible?gm:"",style:_},d.type==="custom"?Qn(d.message,d):l?l(d):R.createElement(dm,{toast:d,position:p}))}))},pm=Jt;const vm=pt.div`
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  width: 100%;
  height: 100%;
  z-index: 100;
`,_m=Ln`
 0% { opacity:0}
 100% { opacity:1}
`,Ao=pt.div`
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.54);
  will-change: opacity;
  transform: translateZ(0);
  animation-name: ${_m};
  animation-duration: 0.3s;
  animation-iteration-count: 1;
  z-index: 10;
`,Ro=Ln`
  from {
    transform: scale(0.5);
  }

  to {
    transform: scale(1);
  }
`,ym=pt.div`
  position: absolute;
  right: 0px;
  top: 0px;
  cursor: pointer;
  font-size: 35px;
  z-index: 1001;
  will-change: transform;
  animation: ${Ro} 0.3s linear;
  padding: 25px;
`,bm=pt.div`
  position: absolute;
  z-index: 11;
  border-style: solid;
  will-change: 'left, top, right, bottom, translate';
  animation: ${Ro} 0.15s ease-in;
`,Sm=()=>{const e=rn.getState().setVisibleOverlayData;return I.jsx(ym,{onPointerDown:()=>{e(null),console.log("Overlay closed by close button")},children:I.jsx(wu,{})})},Do=({overlayAttachedSubpage:e,overlayAttachedSubpageName:r,overlayWidth:i,overlayHeight:s,overlayBackgroundColor:l,overlayBorder:c,absoluteCentering:o,overlayPlacement:h})=>{const g=$t(b=>b.workingProject?.attributes.pages.data),d=R.useMemo(()=>r?g?.find(b=>b.attributes.name===r):e?g?.find(b=>b.id===e):null,[g,e,r]),p=Mt({width:{width:d?.attributes.width?.width},height:{height:d?.attributes.height?.height}}),w=Mt({width:{width:i},height:{height:s},fallbackWidth:p?.width,fallbackHeight:p?.height}),{useBorder:_,...S}=c??{};let E={};if(o)E={left:"50%",top:"50%",translate:"-50% -50%"};else switch(h){case"top-start":E={left:"0",bottom:"100%"};break;case"top":E={left:"50%",bottom:"100%",translate:"-50% 0"};break;case"top-end":E={right:"0",bottom:"100%"};break;case"bottom-start":E={left:"0",top:"100%"};break;case"bottom":E={left:"50%",top:"100%",translate:"-50% 0"};break;case"bottom-end":E={right:"0",top:"100%"};break;case"right-start":E={left:"100%",top:"0"};break;case"right":E={left:"100%",top:"50%",translate:"0 -50%"};break;case"right-end":E={left:"100%",bottom:0};break;case"left-start":E={left:"auto",right:0,top:"0"};break;case"left":E={right:"100%",top:"50%",translate:"0 -50%"};break;case"left-end":E={right:"100%",bottom:0};break}return d?I.jsx(bm,{id:"overlayInnerContent",className:"overlayInnerContent",style:{...w,...E,backgroundColor:l,..._?S:null},children:I.jsx(ni,{data:d,renderAsElement:!0})}):null},Em=ze.memo(({children:e})=>{const r=document.getElementById("GuiMainContainer");return r?Lu.createPortal(e,r):null}),xm=({actionData:e})=>{const{showMask:r,overlayMaskBackgroundColor:i,overlayBackgroundBlur:s,showCloseButton:l,overlayAttachedSubpage:c,overlayAttachedSubpageName:o,overlayWidth:h,overlayHeight:g,overlayBackgroundColor:d,overlayBorder:p}=e,w=r?{WebkitBackdropFilter:`blur(${s}px)`,backdropFilter:`blur(${s}px)`,backgroundColor:i}:{background:"transparent"};return I.jsx(Em,{children:I.jsxs(vm,{children:[I.jsx(Ao,{style:{...w}}),!!l&&I.jsx(Sm,{}),I.jsx(Do,{absoluteCentering:!0,overlayBorder:p,overlayBackgroundColor:d,overlayWidth:h,overlayHeight:g,overlayAttachedSubpage:c,overlayAttachedSubpageName:o})]})})},Vi=Math.min,on=Math.max,ei=Math.round,zn=Math.floor,vr=e=>({x:e,y:e});function Tm(e,r){return typeof e=="function"?e(r):e}function aa(e){return e.split("-")[0]}function Co(e){return e.split("-")[1]}function Mm(e){return e==="x"?"y":"x"}function wm(e){return e==="y"?"height":"width"}function sa(e){return["top","bottom"].includes(aa(e))?"y":"x"}function Lm(e){return Mm(sa(e))}function Io(e){const{x:r,y:i,width:s,height:l}=e;return{width:s,height:l,top:i,left:r,right:r+s,bottom:i+l,x:r,y:i}}function hs(e,r,i){let{reference:s,floating:l}=e;const c=sa(r),o=Lm(r),h=wm(o),g=aa(r),d=c==="y",p=s.x+s.width/2-l.width/2,w=s.y+s.height/2-l.height/2,_=s[h]/2-l[h]/2;let S;switch(g){case"top":S={x:p,y:s.y-l.height};break;case"bottom":S={x:p,y:s.y+s.height};break;case"right":S={x:s.x+s.width,y:w};break;case"left":S={x:s.x-l.width,y:w};break;default:S={x:s.x,y:s.y}}switch(Co(r)){case"start":S[o]-=_*(i&&d?-1:1);break;case"end":S[o]+=_*(i&&d?-1:1);break}return S}const km=async(e,r,i)=>{const{placement:s="bottom",strategy:l="absolute",middleware:c=[],platform:o}=i,h=c.filter(Boolean),g=await(o.isRTL==null?void 0:o.isRTL(r));let d=await o.getElementRects({reference:e,floating:r,strategy:l}),{x:p,y:w}=hs(d,s,g),_=s,S={},E=0;for(let b=0;b<h.length;b++){const{name:L,fn:A}=h[b],{x:k,y:U,data:N,reset:P}=await A({x:p,y:w,initialPlacement:s,placement:_,strategy:l,middlewareData:S,rects:d,platform:o,elements:{reference:e,floating:r}});p=k??p,w=U??w,S={...S,[L]:{...S[L],...N}},P&&E<=50&&(E++,typeof P=="object"&&(P.placement&&(_=P.placement),P.rects&&(d=P.rects===!0?await o.getElementRects({reference:e,floating:r,strategy:l}):P.rects),{x:p,y:w}=hs(d,_,g)),b=-1)}return{x:p,y:w,placement:_,strategy:l,middlewareData:S}};async function Am(e,r){const{placement:i,platform:s,elements:l}=e,c=await(s.isRTL==null?void 0:s.isRTL(l.floating)),o=aa(i),h=Co(i),g=sa(i)==="y",d=["left","top"].includes(o)?-1:1,p=c&&g?-1:1,w=Tm(r,e);let{mainAxis:_,crossAxis:S,alignmentAxis:E}=typeof w=="number"?{mainAxis:w,crossAxis:0,alignmentAxis:null}:{mainAxis:w.mainAxis||0,crossAxis:w.crossAxis||0,alignmentAxis:w.alignmentAxis};return h&&typeof E=="number"&&(S=h==="end"?E*-1:E),g?{x:S*p,y:_*d}:{x:_*d,y:S*p}}const Rm=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(r){var i,s;const{x:l,y:c,placement:o,middlewareData:h}=r,g=await Am(r,e);return o===((i=h.offset)==null?void 0:i.placement)&&(s=h.arrow)!=null&&s.alignmentOffset?{}:{x:l+g.x,y:c+g.y,data:{...g,placement:o}}}}};function ai(){return typeof window<"u"}function cn(e){return Po(e)?(e.nodeName||"").toLowerCase():"#document"}function sr(e){var r;return(e==null||(r=e.ownerDocument)==null?void 0:r.defaultView)||window}function yr(e){var r;return(r=(Po(e)?e.ownerDocument:e.document)||window.document)==null?void 0:r.documentElement}function Po(e){return ai()?e instanceof Node||e instanceof sr(e).Node:!1}function hr(e){return ai()?e instanceof Element||e instanceof sr(e).Element:!1}function _r(e){return ai()?e instanceof HTMLElement||e instanceof sr(e).HTMLElement:!1}function gs(e){return!ai()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof sr(e).ShadowRoot}function Dn(e){const{overflow:r,overflowX:i,overflowY:s,display:l}=gr(e);return/auto|scroll|overlay|hidden|clip/.test(r+s+i)&&!["inline","contents"].includes(l)}function Dm(e){return["table","td","th"].includes(cn(e))}function si(e){return[":popover-open",":modal"].some(r=>{try{return e.matches(r)}catch{return!1}})}function oa(e){const r=la(),i=hr(e)?gr(e):e;return["transform","translate","scale","rotate","perspective"].some(s=>i[s]?i[s]!=="none":!1)||(i.containerType?i.containerType!=="normal":!1)||!r&&(i.backdropFilter?i.backdropFilter!=="none":!1)||!r&&(i.filter?i.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(s=>(i.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(i.contain||"").includes(s))}function Cm(e){let r=Dr(e);for(;_r(r)&&!un(r);){if(oa(r))return r;if(si(r))return null;r=Dr(r)}return null}function la(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function un(e){return["html","body","#document"].includes(cn(e))}function gr(e){return sr(e).getComputedStyle(e)}function oi(e){return hr(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Dr(e){if(cn(e)==="html")return e;const r=e.assignedSlot||e.parentNode||gs(e)&&e.host||yr(e);return gs(r)?r.host:r}function Oo(e){const r=Dr(e);return un(r)?e.ownerDocument?e.ownerDocument.body:e.body:_r(r)&&Dn(r)?r:Oo(r)}function wn(e,r,i){var s;r===void 0&&(r=[]),i===void 0&&(i=!0);const l=Oo(e),c=l===((s=e.ownerDocument)==null?void 0:s.body),o=sr(l);if(c){const h=Ki(o);return r.concat(o,o.visualViewport||[],Dn(l)?l:[],h&&i?wn(h):[])}return r.concat(l,wn(l,[],i))}function Ki(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Fo(e){const r=gr(e);let i=parseFloat(r.width)||0,s=parseFloat(r.height)||0;const l=_r(e),c=l?e.offsetWidth:i,o=l?e.offsetHeight:s,h=ei(i)!==c||ei(s)!==o;return h&&(i=c,s=o),{width:i,height:s,$:h}}function ua(e){return hr(e)?e:e.contextElement}function ln(e){const r=ua(e);if(!_r(r))return vr(1);const i=r.getBoundingClientRect(),{width:s,height:l,$:c}=Fo(r);let o=(c?ei(i.width):i.width)/s,h=(c?ei(i.height):i.height)/l;return(!o||!Number.isFinite(o))&&(o=1),(!h||!Number.isFinite(h))&&(h=1),{x:o,y:h}}const Im=vr(0);function No(e){const r=sr(e);return!la()||!r.visualViewport?Im:{x:r.visualViewport.offsetLeft,y:r.visualViewport.offsetTop}}function Pm(e,r,i){return r===void 0&&(r=!1),!i||r&&i!==sr(e)?!1:r}function jr(e,r,i,s){r===void 0&&(r=!1),i===void 0&&(i=!1);const l=e.getBoundingClientRect(),c=ua(e);let o=vr(1);r&&(s?hr(s)&&(o=ln(s)):o=ln(e));const h=Pm(c,i,s)?No(c):vr(0);let g=(l.left+h.x)/o.x,d=(l.top+h.y)/o.y,p=l.width/o.x,w=l.height/o.y;if(c){const _=sr(c),S=s&&hr(s)?sr(s):s;let E=_,b=Ki(E);for(;b&&s&&S!==E;){const L=ln(b),A=b.getBoundingClientRect(),k=gr(b),U=A.left+(b.clientLeft+parseFloat(k.paddingLeft))*L.x,N=A.top+(b.clientTop+parseFloat(k.paddingTop))*L.y;g*=L.x,d*=L.y,p*=L.x,w*=L.y,g+=U,d+=N,E=sr(b),b=Ki(E)}}return Io({width:p,height:w,x:g,y:d})}function ca(e,r){const i=oi(e).scrollLeft;return r?r.left+i:jr(yr(e)).left+i}function Yo(e,r,i){i===void 0&&(i=!1);const s=e.getBoundingClientRect(),l=s.left+r.scrollLeft-(i?0:ca(e,s)),c=s.top+r.scrollTop;return{x:l,y:c}}function Om(e){let{elements:r,rect:i,offsetParent:s,strategy:l}=e;const c=l==="fixed",o=yr(s),h=r?si(r.floating):!1;if(s===o||h&&c)return i;let g={scrollLeft:0,scrollTop:0},d=vr(1);const p=vr(0),w=_r(s);if((w||!w&&!c)&&((cn(s)!=="body"||Dn(o))&&(g=oi(s)),_r(s))){const S=jr(s);d=ln(s),p.x=S.x+s.clientLeft,p.y=S.y+s.clientTop}const _=o&&!w&&!c?Yo(o,g,!0):vr(0);return{width:i.width*d.x,height:i.height*d.y,x:i.x*d.x-g.scrollLeft*d.x+p.x+_.x,y:i.y*d.y-g.scrollTop*d.y+p.y+_.y}}function Fm(e){return Array.from(e.getClientRects())}function Nm(e){const r=yr(e),i=oi(e),s=e.ownerDocument.body,l=on(r.scrollWidth,r.clientWidth,s.scrollWidth,s.clientWidth),c=on(r.scrollHeight,r.clientHeight,s.scrollHeight,s.clientHeight);let o=-i.scrollLeft+ca(e);const h=-i.scrollTop;return gr(s).direction==="rtl"&&(o+=on(r.clientWidth,s.clientWidth)-l),{width:l,height:c,x:o,y:h}}function Ym(e,r){const i=sr(e),s=yr(e),l=i.visualViewport;let c=s.clientWidth,o=s.clientHeight,h=0,g=0;if(l){c=l.width,o=l.height;const d=la();(!d||d&&r==="fixed")&&(h=l.offsetLeft,g=l.offsetTop)}return{width:c,height:o,x:h,y:g}}function Bm(e,r){const i=jr(e,!0,r==="fixed"),s=i.top+e.clientTop,l=i.left+e.clientLeft,c=_r(e)?ln(e):vr(1),o=e.clientWidth*c.x,h=e.clientHeight*c.y,g=l*c.x,d=s*c.y;return{width:o,height:h,x:g,y:d}}function ms(e,r,i){let s;if(r==="viewport")s=Ym(e,i);else if(r==="document")s=Nm(yr(e));else if(hr(r))s=Bm(r,i);else{const l=No(e);s={x:r.x-l.x,y:r.y-l.y,width:r.width,height:r.height}}return Io(s)}function Bo(e,r){const i=Dr(e);return i===r||!hr(i)||un(i)?!1:gr(i).position==="fixed"||Bo(i,r)}function jm(e,r){const i=r.get(e);if(i)return i;let s=wn(e,[],!1).filter(h=>hr(h)&&cn(h)!=="body"),l=null;const c=gr(e).position==="fixed";let o=c?Dr(e):e;for(;hr(o)&&!un(o);){const h=gr(o),g=oa(o);!g&&h.position==="fixed"&&(l=null),(c?!g&&!l:!g&&h.position==="static"&&!!l&&["absolute","fixed"].includes(l.position)||Dn(o)&&!g&&Bo(e,o))?s=s.filter(p=>p!==o):l=h,o=Dr(o)}return r.set(e,s),s}function Um(e){let{element:r,boundary:i,rootBoundary:s,strategy:l}=e;const o=[...i==="clippingAncestors"?si(r)?[]:jm(r,this._c):[].concat(i),s],h=o[0],g=o.reduce((d,p)=>{const w=ms(r,p,l);return d.top=on(w.top,d.top),d.right=Vi(w.right,d.right),d.bottom=Vi(w.bottom,d.bottom),d.left=on(w.left,d.left),d},ms(r,h,l));return{width:g.right-g.left,height:g.bottom-g.top,x:g.left,y:g.top}}function Hm(e){const{width:r,height:i}=Fo(e);return{width:r,height:i}}function zm(e,r,i){const s=_r(r),l=yr(r),c=i==="fixed",o=jr(e,!0,c,r);let h={scrollLeft:0,scrollTop:0};const g=vr(0);if(s||!s&&!c)if((cn(r)!=="body"||Dn(l))&&(h=oi(r)),s){const _=jr(r,!0,c,r);g.x=_.x+r.clientLeft,g.y=_.y+r.clientTop}else l&&(g.x=ca(l));const d=l&&!s&&!c?Yo(l,h):vr(0),p=o.left+h.scrollLeft-g.x-d.x,w=o.top+h.scrollTop-g.y-d.y;return{x:p,y:w,width:o.width,height:o.height}}function Li(e){return gr(e).position==="static"}function ps(e,r){if(!_r(e)||gr(e).position==="fixed")return null;if(r)return r(e);let i=e.offsetParent;return yr(e)===i&&(i=i.ownerDocument.body),i}function jo(e,r){const i=sr(e);if(si(e))return i;if(!_r(e)){let l=Dr(e);for(;l&&!un(l);){if(hr(l)&&!Li(l))return l;l=Dr(l)}return i}let s=ps(e,r);for(;s&&Dm(s)&&Li(s);)s=ps(s,r);return s&&un(s)&&Li(s)&&!oa(s)?i:s||Cm(e)||i}const Gm=async function(e){const r=this.getOffsetParent||jo,i=this.getDimensions,s=await i(e.floating);return{reference:zm(e.reference,await r(e.floating),e.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function $m(e){return gr(e).direction==="rtl"}const Vm={convertOffsetParentRelativeRectToViewportRelativeRect:Om,getDocumentElement:yr,getClippingRect:Um,getOffsetParent:jo,getElementRects:Gm,getClientRects:Fm,getDimensions:Hm,getScale:ln,isElement:hr,isRTL:$m};function Uo(e,r){return e.x===r.x&&e.y===r.y&&e.width===r.width&&e.height===r.height}function Km(e,r){let i=null,s;const l=yr(e);function c(){var h;clearTimeout(s),(h=i)==null||h.disconnect(),i=null}function o(h,g){h===void 0&&(h=!1),g===void 0&&(g=1),c();const d=e.getBoundingClientRect(),{left:p,top:w,width:_,height:S}=d;if(h||r(),!_||!S)return;const E=zn(w),b=zn(l.clientWidth-(p+_)),L=zn(l.clientHeight-(w+S)),A=zn(p),U={rootMargin:-E+"px "+-b+"px "+-L+"px "+-A+"px",threshold:on(0,Vi(1,g))||1};let N=!0;function P(G){const $=G[0].intersectionRatio;if($!==g){if(!N)return o();$?o(!1,$):s=setTimeout(()=>{o(!1,1e-7)},1e3)}$===1&&!Uo(d,e.getBoundingClientRect())&&o(),N=!1}try{i=new IntersectionObserver(P,{...U,root:l.ownerDocument})}catch{i=new IntersectionObserver(P,U)}i.observe(e)}return o(!0),c}function Wm(e,r,i,s){s===void 0&&(s={});const{ancestorScroll:l=!0,ancestorResize:c=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:h=typeof IntersectionObserver=="function",animationFrame:g=!1}=s,d=ua(e),p=l||c?[...d?wn(d):[],...wn(r)]:[];p.forEach(A=>{l&&A.addEventListener("scroll",i,{passive:!0}),c&&A.addEventListener("resize",i)});const w=d&&h?Km(d,i):null;let _=-1,S=null;o&&(S=new ResizeObserver(A=>{let[k]=A;k&&k.target===d&&S&&(S.unobserve(r),cancelAnimationFrame(_),_=requestAnimationFrame(()=>{var U;(U=S)==null||U.observe(r)})),i()}),d&&!g&&S.observe(d),S.observe(r));let E,b=g?jr(e):null;g&&L();function L(){const A=jr(e);b&&!Uo(b,A)&&i(),b=A,E=requestAnimationFrame(L)}return i(),()=>{var A;p.forEach(k=>{l&&k.removeEventListener("scroll",i),c&&k.removeEventListener("resize",i)}),w?.(),(A=S)==null||A.disconnect(),S=null,g&&cancelAnimationFrame(E)}}const Xm=Rm,qm=(e,r,i)=>{const s=new Map,l={platform:Vm,...i},c={...l.platform,_c:s};return km(e,r,{...l,platform:c})};var Wn=typeof document<"u"?R.useLayoutEffect:R.useEffect;function ti(e,r){if(e===r)return!0;if(typeof e!=typeof r)return!1;if(typeof e=="function"&&e.toString()===r.toString())return!0;let i,s,l;if(e&&r&&typeof e=="object"){if(Array.isArray(e)){if(i=e.length,i!==r.length)return!1;for(s=i;s--!==0;)if(!ti(e[s],r[s]))return!1;return!0}if(l=Object.keys(e),i=l.length,i!==Object.keys(r).length)return!1;for(s=i;s--!==0;)if(!{}.hasOwnProperty.call(r,l[s]))return!1;for(s=i;s--!==0;){const c=l[s];if(!(c==="_owner"&&e.$$typeof)&&!ti(e[c],r[c]))return!1}return!0}return e!==e&&r!==r}function Ho(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function vs(e,r){const i=Ho(e);return Math.round(r*i)/i}function ki(e){const r=R.useRef(e);return Wn(()=>{r.current=e}),r}function Jm(e){e===void 0&&(e={});const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:l,elements:{reference:c,floating:o}={},transform:h=!0,whileElementsMounted:g,open:d}=e,[p,w]=R.useState({x:0,y:0,strategy:i,placement:r,middlewareData:{},isPositioned:!1}),[_,S]=R.useState(s);ti(_,s)||S(s);const[E,b]=R.useState(null),[L,A]=R.useState(null),k=R.useCallback(he=>{he!==G.current&&(G.current=he,b(he))},[]),U=R.useCallback(he=>{he!==$.current&&($.current=he,A(he))},[]),N=c||E,P=o||L,G=R.useRef(null),$=R.useRef(null),J=R.useRef(p),X=g!=null,Z=ki(g),ie=ki(l),de=ki(d),_e=R.useCallback(()=>{if(!G.current||!$.current)return;const he={placement:r,strategy:i,middleware:_};ie.current&&(he.platform=ie.current),qm(G.current,$.current,he).then(Te=>{const xe={...Te,isPositioned:de.current!==!1};Ee.current&&!ti(J.current,xe)&&(J.current=xe,Es.flushSync(()=>{w(xe)}))})},[_,r,i,ie,de]);Wn(()=>{d===!1&&J.current.isPositioned&&(J.current.isPositioned=!1,w(he=>({...he,isPositioned:!1})))},[d]);const Ee=R.useRef(!1);Wn(()=>(Ee.current=!0,()=>{Ee.current=!1}),[]),Wn(()=>{if(N&&(G.current=N),P&&($.current=P),N&&P){if(Z.current)return Z.current(N,P,_e);_e()}},[N,P,_e,Z,X]);const Se=R.useMemo(()=>({reference:G,floating:$,setReference:k,setFloating:U}),[k,U]),le=R.useMemo(()=>({reference:N,floating:P}),[N,P]),pe=R.useMemo(()=>{const he={position:i,left:0,top:0};if(!le.floating)return he;const Te=vs(le.floating,p.x),xe=vs(le.floating,p.y);return h?{...he,transform:"translate("+Te+"px, "+xe+"px)",...Ho(le.floating)>=1.5&&{willChange:"transform"}}:{position:i,left:Te,top:xe}},[i,h,le.floating,p.x,p.y]);return R.useMemo(()=>({...p,update:_e,refs:Se,elements:le,floatingStyles:pe}),[p,_e,Se,le,pe])}const Zm=(e,r)=>({...Xm(e),options:[e,r]});var zo=typeof document<"u"?R.useLayoutEffect:R.useEffect;let Ai=!1,Qm=0;const _s=()=>"floating-ui-"+Qm++;function ep(){const[e,r]=R.useState(()=>Ai?_s():void 0);return zo(()=>{e==null&&r(_s())},[]),R.useEffect(()=>{Ai||(Ai=!0)},[]),e}const tp=xs.useId,rp=tp||ep;function np(){const e=new Map;return{emit(r,i){var s;(s=e.get(r))==null||s.forEach(l=>l(i))},on(r,i){e.set(r,[...e.get(r)||[],i])},off(r,i){var s;e.set(r,((s=e.get(r))==null?void 0:s.filter(l=>l!==i))||[])}}}const ip=R.createContext(null),ap=()=>R.useContext(ip);function sp(e){return e?.ownerDocument||document}function op(e){return sp(e).defaultView||window}function Gn(e){return e?e instanceof Element||e instanceof op(e).Element:!1}const lp=xs.useInsertionEffect,up=lp||(e=>e());function cp(e){const r=R.useRef(()=>{});return up(()=>{r.current=e}),R.useCallback(function(){for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return r.current==null?void 0:r.current(...s)},[])}function dp(e){var r;e===void 0&&(e={});const{open:i=!1,onOpenChange:s,nodeId:l}=e,[c,o]=R.useState(null),h=((r=e.elements)==null?void 0:r.reference)||c,g=Jm(e),d=ap(),p=cp((N,P)=>{N&&(_.current.openEvent=P),s?.(N,P)}),w=R.useRef(null),_=R.useRef({}),S=R.useState(()=>np())[0],E=rp(),b=R.useCallback(N=>{const P=Gn(N)?{getBoundingClientRect:()=>N.getBoundingClientRect(),contextElement:N}:N;g.refs.setReference(P)},[g.refs]),L=R.useCallback(N=>{(Gn(N)||N===null)&&(w.current=N,o(N)),(Gn(g.refs.reference.current)||g.refs.reference.current===null||N!==null&&!Gn(N))&&g.refs.setReference(N)},[g.refs]),A=R.useMemo(()=>({...g.refs,setReference:L,setPositionReference:b,domReference:w}),[g.refs,L,b]),k=R.useMemo(()=>({...g.elements,domReference:h}),[g.elements,h]),U=R.useMemo(()=>({...g,refs:A,elements:k,dataRef:_,nodeId:l,floatingId:E,events:S,open:i,onOpenChange:p}),[g,l,E,S,i,p,A,k]);return zo(()=>{const N=d?.nodesRef.current.find(P=>P.id===l);N&&(N.context=U)}),R.useMemo(()=>({...g,context:U,refs:A,elements:k}),[g,A,k,U])}const fp=({triggerElementRef:e,actionData:r})=>{const{overlayOffset:i=0,overlayPlacement:s,overlayBorder:l,overlayBackgroundColor:c,overlayWidth:o,overlayHeight:h,overlayAttachedSubpage:g,overlayAttachedSubpageName:d,showMask:p,overlayBackgroundBlur:w,overlayMaskBackgroundColor:_}=r||{},{refs:S,floatingStyles:E}=dp({elements:{reference:e?.current},open:!!r,placement:s,middleware:[Zm(i)],strategy:"fixed",whileElementsMounted:Wm}),b={WebkitBackdropFilter:`blur(${w}px)`,backdropFilter:`blur(${w}px)`,backgroundColor:_};return I.jsxs(I.Fragment,{children:[p&&I.jsx(Ao,{style:{...b}}),I.jsx("div",{ref:S.setFloating,style:{position:"fixed",zIndex:1e3,...E},children:I.jsx(Do,{overlayPlacement:s,absoluteCentering:!1,overlayBorder:l,overlayBackgroundColor:c,overlayWidth:o,overlayHeight:h,overlayAttachedSubpage:g,overlayAttachedSubpageName:d})})]})},hp=ze.memo(()=>{const e=rn(E=>E.visibleOverlayData),{triggerElementRef:r,actionData:i}=e||{},{anyClickClose:s,outsideClose:l,useOverlayTimer:c,overlayTimer:o=0,showMask:h,overlayBackgroundBlur:g=0,overlayPlacement:d="fullscreen"}=i||{},p=d==="fullscreen",w=It(E=>E.envState),{pageId:_}=kn();R.useEffect(()=>{const{setVisibleOverlayData:E,visibleOverlayData:b}=rn.getState();b&&(console.log("Overlay reset, envstate or pageId changed"),E(null))},[w,_]),R.useEffect(()=>{const E=rn.getState().setVisibleOverlayData,b=document.getElementById("GuiMainContainer");function L(A){if(s&&!r?.current?.contains(A.target)){E(null);return}const k=document.getElementById("overlayInnerContent");l&&!k?.contains(A.target)&&!r?.current?.contains(A.target)&&((h||g>0)&&(A.stopPropagation(),A.preventDefault()),E(null))}if(b&&(l||s))return b.addEventListener("pointerdown",L),()=>{b.removeEventListener("pointerdown",L)}},[s,l,g,h,r]);const S=R.useRef();if(R.useEffect(()=>{function E(){console.log("closed by timeout");const k=rn.getState().setVisibleOverlayData;k(null)}const b=()=>{S.current&&clearTimeout(S.current)},L=()=>{S.current=setTimeout(E,o*1e3)},A=document.getElementById("overlayInnerContent");return c&&A&&(S.current=setTimeout(E,o*1e3),A.addEventListener("pointerdown",b),A.addEventListener("pointerup",L)),()=>{S.current&&clearTimeout(S.current),A?.removeEventListener("pointerdown",b),A?.removeEventListener("pointerup",L)}},[o,c]),e&&i){if(p)return I.jsx(xm,{actionData:i});if(i&&r)return I.jsx(fp,{actionData:i,triggerElementRef:r})}return null});var gp="guibox_projectBackgroundImageDiv__z5s1u60";const Wi=e=>typeof e!="object"||e===null?e:Array.isArray(e)?e.map(Wi):Object.fromEntries(Object.entries(e).filter(([,r])=>r!==void 0).map(([r,i])=>[r,Wi(i)])),mp=ze.memo(({pages:e})=>{const r=rc(),{setVariableNewValue:i}=Xn.getState(),s=It(ae=>ae.envState),l=It.getState().updateEnvStore,[c,o]=Ou();R.useEffect(()=>{if(s!=="live")return;const ae=c.get("token");ae&&(Fu(ae),o({}))},[s,c,o]);const h=R.useMemo(()=>{const ae=$t.getState().workingProject?.attributes.variables.filter(Ae=>Ae?.actions?.length),we=new Map([]);if(!ae?.length)return we;for(const Ae of ae)we.set(Ae.name,Ae?.actions);return we},[]),g=$t(ae=>ae.workingProject?.attributes.customCss??""),d=Xn(ae=>ae.calculatedVariables),p=R.useRef(new Map([])),w=$u({actions:h});R.useEffect(()=>{w&&w.forEach((ae,we)=>{const Ae=Object.values(d??{}).find(Be=>Be.name===we);if(!Ae)return;const{defaultValue:Oe,currentValue:Fe}=Ae,Ne=Fe===void 0?Oe:Fe;if(p.current.has(we)){if(Ne!==p.current.get(we)){const Be=ae?.onChangeActions??[];for(const qe of Be)qe(Ne);p.current.set(we,Ne)}}else p.current.set(we,Ne)})},[d,w]);const _=mt(ae=>ae.isSubpageEditor),{ref:S,width:E,height:b}=mo();R.useEffect(()=>{if(s==="live"||s==="preview"){const ae=we=>{we.preventDefault()};return document.addEventListener("contextmenu",ae),()=>{document.removeEventListener("contextmenu",ae)}}},[s]),R.useEffect(()=>{let ae=null;E&&b&&(ae=E>b),l({guiFrameWidth:E,guiFrameHeight:b,isLandscape:ae})},[b,E,l]);const L=$t(ae=>ae.workingProject?.attributes.background),A=$t(ae=>ae.workingProject?.attributes.theme.data.attributes),k=$t(ae=>Wi(ae.workingProject?.attributes.themeOverrides??{})),U=R.useMemo(()=>L?oc(L):void 0,[L]),N=ra({propsToFill:{...L,dynamicDataUsed:U},calculatedParameters:void 0}),{backgroundColor:P,opacity:G,blur:$,backgroundSize:J,backgroundPosition:X,backgroundImageUrl:Z}=R.useMemo(()=>ea({bgProps:N}),[N]),ie=R.useRef(null);R.useLayoutEffect(()=>{if(L?.customBackgroundImage){if(!ie.current)return;ie.current.style.backgroundImage=`url(${Z.fullImageUrl??"bad_url"})`,ie.current.style.opacity=G}else{if(!ie.current)return;ie.current.style.backgroundImage="",ie.current.style.opacity="1"}},[Z,G,L?.customBackgroundImage]);let de;try{de={...A,...k,colors:{...A?.colors,...k?.colors}}}catch(ae){Ss.warning("No Theme Attached to Project"),console.log(ae)}const{analogPageFlip_signal_a_fb:_e,serialPageFlip_signal_s_fb:Ee,notification_signal_s_fb:Se,refreshSingleDataSource_signal_s_fb:le}=$t(ae=>ae.workingProject?.attributes.globalJoins??{}),pe=or({signalName:Se}),he=or({signalName:Ee}),Te=or({signalName:le});R.useEffect(()=>{Te&&(console.log("DS updating ",Te),qu(Te).then(ae=>{console.log("DS updated ",Te,ae);const we=new Date().toISOString();i({name:"datasetUpdated",currentValue:we})}))},[Te]);const xe=Yr(_e),ye=document.getElementsByClassName("toasterContainer");R.useEffect(()=>{pe&&ye?.[0]&&pm(pe)},[pe,ye?.[0]]),R.useEffect(()=>{if(xe){console.log("analogPageFlipFeedBack: ",xe);const we=$t.getState().workingProject?.attributes.pages.data?.find(Ae=>Ae.attributes.pageFlips?.analogPageFlipValue===xe);if(we){const Ae=Di(we.attributes.name);ja({navigate:r,url:Ae})}else console.info("No target page found for analog page flip")}},[xe,r]),R.useEffect(()=>{if(he)if(console.log("serialPageFlipFeedBack: ",he),$t.getState().workingProject?.attributes.pages.data?.some(Ae=>Ae.attributes.name===he)){const Ae=Di(he);ja({navigate:r,url:Ae})}else console.info("No target page found for serial page flip")},[r,he]);const ge=rn(ae=>ae.visibleOverlayData),{overlayBackgroundBlur:be,showMask:fe,overlayMaskBackgroundColor:Ue}=ge?.actionData??{},Ce=rt({showMask:!!fe,isOverlayOpen:!!ge});return s&&de?I.jsx(ku,{theme:de,children:I.jsxs(mc,{className:Ce,ref:S,id:"GuiMainContainer",style:{backgroundColor:P||A?.backgroundColor,"--mask-bg-color":fe?Ue:"transparent","--overlay-background-blur":be+"px"},inlineStyles:g+de.css,children:[I.jsx("div",{className:gp,ref:ie,id:"ProjectBackgroundImage",style:{filter:$,backgroundSize:J,backgroundPosition:X}}),I.jsx("div",{id:"PageBackgroundColor",className:"PageBackgroundColor"}),I.jsx("div",{id:"PageBackgroundImage",className:"PageBackgroundImage"}),I.jsx(Md,{}),I.jsxs(pc,{className:"page",children:[!_&&I.jsx(Mg,{}),I.jsx("div",{className:"content",children:s==="build"||s==="live"?I.jsx(Nu,{}):I.jsx(ni,{data:e?.[0]})})]}),I.jsx(hp,{}),I.jsx(mm,{containerClassName:"toasterContainer",position:"top-right",containerStyle:{position:"absolute",width:"calc(100% - 20px)",height:"calc(100% - 20px)",left:10,top:10}})]})}):null});mp.displayName="GuiBox";export{mp as G,Rt as H,ni as P,cc as R,$h as d,Rd as k,_g as u};
