import{r as p,j as t,ab as w}from"./index-CR7MAnCp.js";import{D,f as B,S as c,j as I}from"./confirm-D0g1-wZ1.js";import{f as k,u as O,J as A,B as h,y as v}from"./editorApp-DLWlunXz.js";import{E as G}from"./EditableCell-DPZgJ8kP.js";import{S}from"./index-KEOervAl.js";import{R as y}from"./MobileOutlined-BXMAzs1p.js";import{T}from"./index-DZHBlNgy.js";import"./index-CGbxNHJV.js";import"./index-hYgSyGbc.js";const R=({onChange:l,checked:r})=>{const[n,s]=p.useState(!1);return t.jsx(S,{loading:n,onChange:d=>{s(!0),l(d).then(()=>s(!1))},checked:r})},{Title:V}=T,E=[{title:"Name",dataIndex:"name",sorter:(l,r)=>{try{const n=l.name.props.initialValue.toLowerCase(),s=r.name.props.initialValue.toLowerCase();if(n<s)return-1;if(n>s)return 1}catch(n){console.log(n)}return 0},defaultSortOrder:"ascend"},{title:"Position",dataIndex:"position"},{title:"Visible on Pages",dataIndex:"visibleOnPages"},{title:"Hidden on Pages",dataIndex:"hiddenOnPages"},{title:"Visible by default",dataIndex:"visibleByDefault"},{title:"Actions",width:"100px",dataIndex:"globalContainerActions"}],q=()=>{const{projectId:l}=k(),r=O(b=>b.workingProject),n=r?.attributes.globalContainers,{setNewGlobalContainerVisible:s}=A(),[d,m]=p.useState();return p.useEffect(()=>{function b(a,e){if(!n)return null;const o=structuredClone(n);o.splice(a,1),l&&v({projectId:l,inputData:{globalContainers:o}})}async function u(a,e){return new Promise((o,i)=>{if(!n)return null;const g=structuredClone(n);g[a]={...g[a],...e},l?v({projectId:l,inputData:{globalContainers:g}}).then(()=>{o("Ok")}).catch(P=>i(P)):i("No projectId")})}const f=r?.attributes.pages.data?.filter(a=>!a.attributes.isSubpage)||[];function C(){const a=[];if(f?.length)for(const e of f)a.push({value:e.id,label:e.attributes.name||"noName"});return a}function x(a){if(!n)return null;const e=n[a];return t.jsx(c,{disabled:!!e.visibleByDefault,value:e.visibleOnPages,onChange:o=>{u(a,{visibleOnPages:[...o]})},placeholder:e.visibleByDefault?"Visible by default":"Add pages...",style:{width:200},mode:"multiple",allowClear:!0,options:C()})}function j(a){if(!n)return null;const e=n[a];return t.jsx(c,{disabled:!e.visibleByDefault,value:e.hiddenOnPages,onChange:o=>{u(a,{hiddenOnPages:[...o]})},placeholder:e.visibleByDefault?"Add pages...":"Hidden by default",style:{width:200},mode:"multiple",allowClear:!0,options:C()})}if(n?.length){const a=[];n.forEach((e,o)=>{a.push({key:`globalContainer_${o}`,order:o+1,name:t.jsx(G,{onChange:i=>i&&u(o,{name:i}),initialValue:e.name,value:e.name}),position:t.jsxs(t.Fragment,{children:[t.jsx(c,{value:e.portraitPosition,onChange:i=>u(o,{portraitPosition:i}),style:{width:100,marginRight:10},suffixIcon:t.jsx(y,{}),options:[{value:"top",label:"Top"},{value:"right",label:"Right"},{value:"bottom",label:"Bottom"},{value:"left",label:"Left"},{value:"null",label:"Hidden"}]}),t.jsx(c,{value:e.landscapePosition,onChange:i=>u(o,{landscapePosition:i}),style:{width:100},suffixIcon:t.jsx(y,{rotate:90}),options:[{value:"top",label:"Top"},{value:"right",label:"Right"},{value:"bottom",label:"Bottom"},{value:"left",label:"Left"},{value:"null",label:"Hidden"}]})]}),visibleByDefault:t.jsx(R,{onChange:()=>u(o,{visibleByDefault:!e.visibleByDefault}),checked:e.visibleByDefault}),visibleOnPages:x(o),hiddenOnPages:j(o),globalContainerActions:t.jsx(D.Button,{menu:{items:[{key:"remove",label:"Remove",onClick:()=>B({title:"Delete Container?",icon:t.jsx(w,{}),content:"Are you sure to delete Global Container with all elements inside? It cannot be undone.",okText:"Delete container",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>b(o,e.name),onCancel:()=>console.log("cancel global container delete")})}]}})})}),m(a)}else m([])},[n,l,r]),t.jsxs(t.Fragment,{children:[t.jsx(V,{id:"Global Containers",style:{margin:"15px 0"},level:5,children:t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("span",{children:["Global Containers ",` (${n?.length||0})`]}),t.jsx(h,{onClick:()=>s(!0),children:"Create Global Container"})]})}),t.jsx(I,{columns:E,dataSource:d,pagination:!1}),t.jsx(h,{style:{marginTop:15},type:"primary",onClick:()=>s(!0),children:"Create Global Container"},"submit")]})};export{q as default};
