const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./undoRedo-Dqtw2Wdi.js","./index-CR7MAnCp.js","./index-D8FflOyX.css","./editorApp-DLWlunXz.js","./editorApp-DB0Q8XAf.css","./confirm-D0g1-wZ1.js","./index-DZHBlNgy.js","./SettingOutlined-CpvU3kuL.js","./pageAPI-DIRfwgbE.js","./localActiveAPI-BcvpvDpS.js","./___vite-browser-external_commonjs-proxy-BMVqCDge.js","./useAddNavigateToWindow-CDeW-InD.js","./getLocalUrlFromString-DptiwCQQ.js","./shared-worker-manager-DgZGRETL.js","./variablesAPI-BLoTBpai.js","./datasourceTools-eZTvAFyf.js","./index-D975UveC.js","./details-y3kaUJCc.js","./details-BO9_zmax.css","./index-KEOervAl.js","./index-CGbxNHJV.js","./index-hYgSyGbc.js","./PlusCircleOutlined-sa3sGDZG.js","./formItemPropsWrapper-Bn4cpF3y.js","./Styles-B69OPKJM.js","./useCustomFonts-ltbbC3EP.js","./calcMediaUrl-BdU63MXS.js","./modificatorAPI-C5vALgNO.js","./renderActionTag-DHoH5FTV.js","./moment-G82_0lEo.js","./newProjectModal-lzdKOwNM.js","./moveable.esm-BYu0Krn6.js"])))=>i.map(i=>d[i]);
import{r as u,L as ue,f as K,aj as ra,j as e,ab as pe,R as me,U as je,ac as sa,ae as He,ap as oa,ao as Vt,an as ct,a as ce,g as ia,q as Ve,ad as la,aq as Qe}from"./index-CR7MAnCp.js";import{h as Ot,s as ca,u as z,D as te,T as Ue,i as da,f as Y,c as dt,j as _e,B as P,a as ae,k as ut,l as Bt,F as x,I as G,b as zt,m as qt,n as Gt,o as nt,p as ua,M as oe,q as ma,r as ha,t as ft,v as De,w as rt,C as Se,x as Ht,y as Ut,z as We,A as st,E as ot,G as fa,H as ga,e as pa,g as va,O as xa}from"./editorApp-DLWlunXz.js";import{D as Wt,R as ja,u as X,a as ba,b as fe,C as Ae,S as Ne,c as ya,d as $t,e as Kt,f as Jt}from"./confirm-D0g1-wZ1.js";import{R as et,a as wa}from"./SettingOutlined-CpvU3kuL.js";import{M as Ca,R as Sa}from"./index-DZHBlNgy.js";import{P as it,c as ka}from"./pageAPI-DIRfwgbE.js";import{u as gt,R as _a,a as Ta}from"./useAddNavigateToWindow-CDeW-InD.js";import{c as Ia,a as Ma,p as pt,r as Pa,u as La,b as Ea}from"./shared-worker-manager-DgZGRETL.js";import{P as ge}from"./index-D975UveC.js";import{h as Fa,u as $e,D as vt,S as Da}from"./details-y3kaUJCc.js";import{S as de}from"./index-KEOervAl.js";import{T as mt}from"./index-CGbxNHJV.js";import{I as lt,S as Zt}from"./index-hYgSyGbc.js";import{R as Aa}from"./PlusCircleOutlined-sa3sGDZG.js";import{u as ht,d as ye,C as Re,k as Na,F as Ra}from"./formItemPropsWrapper-Bn4cpF3y.js";import{u as Va}from"./getLocalUrlFromString-DptiwCQQ.js";import{R as Oa,D as Ba,u as za,A as qa,a as Ga,b as Ha}from"./Styles-B69OPKJM.js";import{c as Ua,a as Wa}from"./localActiveAPI-BcvpvDpS.js";import{r as $a}from"./useCustomFonts-ltbbC3EP.js";import{b as Ka,c as Ja,f as Za,d as xt,e as Xa,g as jt,h as Ya,i as Qa,j as bt,k as yt,a as en}from"./datasourceTools-eZTvAFyf.js";import{u as Xt,c as tn}from"./modificatorAPI-C5vALgNO.js";import{R as Ce}from"./renderActionTag-DHoH5FTV.js";import{h as an}from"./moment-G82_0lEo.js";import{u as nn,c as rn}from"./variablesAPI-BLoTBpai.js";var sn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},on=function(a,r){return u.createElement(ue,K(K({},a),{},{ref:r,icon:sn}))},ln=u.forwardRef(on),cn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917.7 148.8l-42.4-42.4c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-76.1 76.1a199.27 199.27 0 00-112.1-34.3c-51.2 0-102.4 19.5-141.5 58.6L432.3 308.7a8.03 8.03 0 000 11.3L704 591.7c1.6 1.6 3.6 2.3 5.7 2.3 2 0 4.1-.8 5.7-2.3l101.9-101.9c68.9-69 77-175.7 24.3-253.5l76.1-76.1c3.1-3.2 3.1-8.3 0-11.4zM769.1 441.7l-59.4 59.4-186.8-186.8 59.4-59.4c24.9-24.9 58.1-38.7 93.4-38.7 35.3 0 68.4 13.7 93.4 38.7 24.9 24.9 38.7 58.1 38.7 93.4 0 35.3-13.8 68.4-38.7 93.4zm-190.2 105a8.03 8.03 0 00-11.3 0L501 613.3 410.7 523l66.7-66.7c3.1-3.1 3.1-8.2 0-11.3L441 408.6a8.03 8.03 0 00-11.3 0L363 475.3l-43-43a7.85 7.85 0 00-5.7-2.3c-2 0-4.1.8-5.7 2.3L206.8 534.2c-68.9 69-77 175.7-24.3 253.5l-76.1 76.1a8.03 8.03 0 000 11.3l42.4 42.4c1.6 1.6 3.6 2.3 5.7 2.3s4.1-.8 5.7-2.3l76.1-76.1c33.7 22.9 72.9 34.3 112.1 34.3 51.2 0 102.4-19.5 141.5-58.6l101.9-101.9c3.1-3.1 3.1-8.2 0-11.3l-43-43 66.7-66.7c3.1-3.1 3.1-8.2 0-11.3l-36.6-36.2zM441.7 769.1a131.32 131.32 0 01-93.4 38.7c-35.3 0-68.4-13.7-93.4-38.7a131.32 131.32 0 01-38.7-93.4c0-35.3 13.7-68.4 38.7-93.4l59.4-59.4 186.8 186.8-59.4 59.4z"}}]},name:"api",theme:"outlined"},dn=function(a,r){return u.createElement(ue,K(K({},a),{},{ref:r,icon:cn}))},un=u.forwardRef(dn),mn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},hn=function(a,r){return u.createElement(ue,K(K({},a),{},{ref:r,icon:mn}))},ke=u.forwardRef(hn),fn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M956 686.5l-.1-.1-.1-.1C911.7 593 843.4 545 752.5 545s-159.2 48.1-203.4 141.3v.1a42.92 42.92 0 000 36.4C593.3 816 661.6 864 752.5 864s159.2-48.1 203.4-141.3c5.4-11.5 5.4-24.8.1-36.2zM752.5 800c-62.1 0-107.4-30-141.1-95.5C645 639 690.4 609 752.5 609c62.1 0 107.4 30 141.1 95.5C860 770 814.6 800 752.5 800z"}},{tag:"path",attrs:{d:"M697 705a56 56 0 10112 0 56 56 0 10-112 0zM136 232h704v253h72V192c0-17.7-14.3-32-32-32H96c-17.7 0-32 14.3-32 32v520c0 17.7 14.3 32 32 32h352v-72H136V232z"}},{tag:"path",attrs:{d:"M724.9 338.1l-36.8-36.8a8.03 8.03 0 00-11.3 0L493 485.3l-86.1-86.2a8.03 8.03 0 00-11.3 0L251.3 543.4a8.03 8.03 0 000 11.3l36.8 36.8c3.1 3.1 8.2 3.1 11.3 0l101.8-101.8 86.1 86.2c3.1 3.1 8.2 3.1 11.3 0l226.3-226.5c3.2-3.1 3.2-8.2 0-11.3z"}}]},name:"fund-view",theme:"outlined"},gn=function(a,r){return u.createElement(ue,K(K({},a),{},{ref:r,icon:fn}))},pn=u.forwardRef(gn),vn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z"}}]},name:"link",theme:"outlined"},xn=function(a,r){return u.createElement(ue,K(K({},a),{},{ref:r,icon:vn}))},jn=u.forwardRef(xn),bn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 732h-70.3c-4.8 0-9.3 2.1-12.3 5.8-7 8.5-14.5 16.7-22.4 24.5a353.84 353.84 0 01-112.7 75.9A352.8 352.8 0 01512.4 866c-47.9 0-94.3-9.4-137.9-27.8a353.84 353.84 0 01-112.7-75.9 353.28 353.28 0 01-76-112.5C167.3 606.2 158 559.9 158 512s9.4-94.2 27.8-137.8c17.8-42.1 43.4-80 76-112.5s70.5-58.1 112.7-75.9c43.6-18.4 90-27.8 137.9-27.8 47.9 0 94.3 9.3 137.9 27.8 42.2 17.8 80.1 43.4 112.7 75.9 7.9 7.9 15.3 16.1 22.4 24.5 3 3.7 7.6 5.8 12.3 5.8H868c6.3 0 10.2-7 6.7-12.3C798 160.5 663.8 81.6 511.3 82 271.7 82.6 79.6 277.1 82 516.4 84.4 751.9 276.2 942 512.4 942c152.1 0 285.7-78.8 362.3-197.7 3.4-5.3-.4-12.3-6.7-12.3zm88.9-226.3L815 393.7c-5.3-4.2-13-.4-13 6.3v76H488c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h314v76c0 6.7 7.8 10.5 13 6.3l141.9-112a8 8 0 000-12.6z"}}]},name:"logout",theme:"outlined"},yn=function(a,r){return u.createElement(ue,K(K({},a),{},{ref:r,icon:bn}))},wn=u.forwardRef(yn),Cn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M692.8 412.7l.2-.2-34.6-44.3a7.97 7.97 0 00-11.2-1.4l-50.4 39.3-70.5-90.1a7.97 7.97 0 00-11.2-1.4l-37.9 29.7a7.97 7.97 0 00-1.4 11.2l70.5 90.2-.2.1 34.6 44.3c2.7 3.5 7.7 4.1 11.2 1.4l50.4-39.3 64.1 82c2.7 3.5 7.7 4.1 11.2 1.4l37.9-29.6c3.5-2.7 4.1-7.7 1.4-11.2l-64.1-82.1zM608 112c-167.9 0-304 136.1-304 304 0 70.3 23.9 135 63.9 186.5L114.3 856.1a8.03 8.03 0 000 11.3l42.3 42.3c3.1 3.1 8.2 3.1 11.3 0l253.6-253.6C473 696.1 537.7 720 608 720c167.9 0 304-136.1 304-304S775.9 112 608 112zm161.2 465.2C726.2 620.3 668.9 644 608 644s-118.2-23.7-161.2-66.8C403.7 534.2 380 476.9 380 416s23.7-118.2 66.8-161.2c43-43.1 100.3-66.8 161.2-66.8s118.2 23.7 161.2 66.8c43.1 43 66.8 100.3 66.8 161.2s-23.7 118.2-66.8 161.2z"}}]},name:"monitor",theme:"outlined"},Sn=function(a,r){return u.createElement(ue,K(K({},a),{},{ref:r,icon:Cn}))},tt=u.forwardRef(Sn),kn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M952 612c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H298a95.92 95.92 0 00-89-60c-53 0-96 43-96 96s43 96 96 96c40.3 0 74.8-24.8 89-60h150.3v152c0 55.2 44.8 100 100 100H952c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H548.3c-15.5 0-28-12.5-28-28V612H952zM456 344h264v98.2c0 8.1 9.5 12.8 15.8 7.7l172.5-136.2c5-3.9 5-11.4 0-15.3L735.8 162.1c-6.4-5.1-15.8-.5-15.8 7.7V268H456c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8z"}}]},name:"node-expand",theme:"outlined"},_n=function(a,r){return u.createElement(ue,K(K({},a),{},{ref:r,icon:kn}))},Tn=u.forwardRef(_n),In={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M136 552h63.6c4.4 0 8-3.6 8-8V288.7h528.6v72.6c0 1.9.6 3.7 1.8 5.2a8.3 8.3 0 0011.7 1.4L893 255.4c4.3-5 3.6-10.3 0-13.2L749.7 129.8a8.22 8.22 0 00-5.2-1.8c-4.6 0-8.4 3.8-8.4 8.4V209H199.7c-39.5 0-71.7 32.2-71.7 71.8V544c0 4.4 3.6 8 8 8zm752-80h-63.6c-4.4 0-8 3.6-8 8v255.3H287.8v-72.6c0-1.9-.6-3.7-1.8-5.2a8.3 8.3 0 00-11.7-1.4L131 768.6c-4.3 5-3.6 10.3 0 13.2l143.3 112.4c1.5 1.2 3.3 1.8 5.2 1.8 4.6 0 8.4-3.8 8.4-8.4V815h536.6c39.5 0 71.7-32.2 71.7-71.8V480c-.2-4.4-3.8-8-8.2-8z"}}]},name:"retweet",theme:"outlined"},Mn=function(a,r){return u.createElement(ue,K(K({},a),{},{ref:r,icon:In}))},Pn=u.forwardRef(Mn),Ln={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"},En=function(a,r){return u.createElement(ue,K(K({},a),{},{ref:r,icon:Ln}))},Fn=u.forwardRef(En);const Dn=async()=>await Ot.get("/api/themes?sort=createdAt:asc&populate=deep,3",{headers:ca()}).then(t=>t?.data?.data?t.data.data:null).catch(t=>{console.log("Get news error occurred:",t)}),Yt=ra(t=>({themesList:[],fetchAndFillThemesList:async()=>{const a=await Dn();t({themesList:a||[]})}}));var An="renderAppTopBar_topBarContainer__1ey9s4v0",Nn="renderAppTopBar_tabsRow__1ey9s4v1",Rn="renderAppTopBar_pagesTabsArea__1ey9s4v2",Vn="renderAppTopBar_pagesTabsAreaInner__1ey9s4v3",On="renderAppTopBar_pagesTabsHolder__1ey9s4v4",Bn="renderAppTopBar_envButtonArea__1ey9s4v5",wt="renderAppTopBar_tabsAntComponent__1ey9s4v6",Ct="renderAppTopBar_tabContent__1ey9s4v7",St="renderAppTopBar_tabIcon__1ey9s4v8",kt="renderAppTopBar_tabLabel__1ey9s4v9",zn="renderAppTopBar_tabSubIndicator__1ey9s4va",_t={saved:"renderAppTopBar_saveIndicator_saved__1ey9s4vc renderAppTopBar_tabUnsaved__1ey9s4vb",unsaved:"renderAppTopBar_saveIndicator_unsaved__1ey9s4vd renderAppTopBar_tabUnsaved__1ey9s4vb"},Tt="renderAppTopBar_tabClose__1ey9s4ve",qn="renderAppTopBar_envSelectorWrapper__1ey9s4vf",Gn="renderAppTopBar_envLiveStartButton__1ey9s4vg",Hn="renderAppTopBar_envSelectorButton__1ey9s4vh",Un="renderAppTopBar_topBarControlsRow__1ey9s4vj",Wn="renderAppTopBar_viewLayoutContentBox__1ey9s4vk",at="renderAppTopBar_viewLayoutContentRow__1ey9s4vl",$n="renderAppTopBar_testDeviceRadioItem__1ey9s4vn",Kn="renderAppTopBar_secondTabsRow__1ey9s4vo";const Jn=({setEditProjectModalId:t,projectId:a})=>{const r=z(v=>v.workingProject?.attributes.env),i=z(v=>v.workingProject?.attributes.selectedEnv),p=u.useMemo(()=>i?r?.find(v=>v.envId===i)?.envName??"Default":"Default",[r,i]),l=({envUidToSelect:v})=>{const d=z.getState().updateProjectWithHistory;d({selectedEnv:v},!1)},g=u.useMemo(()=>r?.length?r.map(d=>({key:d.envId,label:e.jsx("div",{onClick:()=>l({envUidToSelect:d.envId}),children:d.envName}),icon:e.jsx(et,{})})):[],[r]),f=[{key:"default",label:e.jsx("div",{onClick:()=>l({envUidToSelect:""}),children:"Default"}),icon:e.jsx(et,{})},...g??[],{key:"env divider",label:e.jsx(te,{style:{margin:0}})},{key:"env settings",label:e.jsx("div",{onClick:()=>t(Number(a)),children:"Project ENV settings"}),icon:e.jsx(wa,{})}];return e.jsxs("div",{className:qn,children:[e.jsx(Wt,{className:"GlobalEnvSelector",dropdownRender:()=>e.jsx(Ca,{items:f,style:{whiteSpace:"nowrap"}}),trigger:["click"],children:e.jsxs("div",{className:Hn,children:[e.jsxs("span",{children:[e.jsx(et,{style:{marginRight:5}}),p]}),e.jsx(ja,{})]})}),e.jsx(Ue,{placement:"bottomRight",title:"Open Project LIVE Preview",children:e.jsx("a",{href:da(),target:"_blank",rel:"noreferrer",className:Gn,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:28,height:28,viewBox:"0 0 28 28",children:e.jsx("path",{fill:"currentColor",d:"M25 9.5v5A7.5 7.5 0 0 0 14.5 25H6.25A3.25 3.25 0 0 1 3 21.75V9.5zM21.75 3A3.25 3.25 0 0 1 25 6.25V8H3V6.25A3.25 3.25 0 0 1 6.25 3zM20.5 27a6.5 6.5 0 1 0 0-13a6.5 6.5 0 0 0 0 13m-.902-9.404l4.032 2.275a.72.72 0 0 1 0 1.258l-4.032 2.274c-.49.277-1.098-.072-1.098-.629v-4.548c0-.557.609-.905 1.098-.63"})})})})]})},Fe="mainProjectTab",Zn=()=>{const{pageId:t}=Y(),{projectId:a}=Y(),r=dt(),i=z(j=>j.tabs),p=z(j=>j.pagesHashes),l=z(j=>j.workingProject?.attributes.pages.data)??[],g=z(j=>j.currentProjectHash),f=z(j=>j.savedProjectHash),v=g===f,{removeTab:d}=z.getState();function w(j){async function D(){const{lastUseProjectTabKey:I=""}=X.getState(),A=I?`/${I}`:"";r(`/projects/${a}${A}`)}t===j&&D().then(()=>{d(j)}),d(j)}const b=u.useCallback(j=>{const{lastUseProjectTabKey:D}=X.getState(),A=j===Fe?(B=>B?`/${B}`:"")(D):"",O=j===Fe?`/projects/${a}`:`/projects/${a}/page/${j}`;r(O+A)},[r,a]),y=[];for(const j of i){const D=l.find(J=>String(J.id)===j.pageId);if(!D)return console.log("targetPage is not found"),null;const I=p.find(J=>String(J.pageId)===String(j.pageId)),{name:A,isSubpage:O,isStatic:B}=D.attributes,N=I?I.currentHash!==I.savedHash:!1;y.push({label:e.jsxs("div",{className:Ct,children:[e.jsx("div",{className:St,children:e.jsx(it,{style:{height:"auto",width:"1em"},isStatic:B})}),e.jsx("div",{className:zn,children:O?"sub":null}),e.jsx("div",{className:_t[N?"unsaved":"saved"]}),e.jsx("div",{className:kt,children:A}),e.jsx("div",{onClick:J=>{J.stopPropagation(),w(j.pageId)},className:Tt,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.3em",height:"1.3em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m7 7l10 10M7 17L17 7"})})})]}),key:j.pageId})}const S={label:e.jsxs("div",{className:Ct,children:[e.jsx("div",{className:St,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 15 15",children:e.jsx("path",{fill:"currentColor",d:"M1.5 0A1.5 1.5 0 0 0 0 1.5v4A1.5 1.5 0 0 0 1.5 7h4A1.5 1.5 0 0 0 7 5.5v-4A1.5 1.5 0 0 0 5.5 0zm8 0A1.5 1.5 0 0 0 8 1.5v4A1.5 1.5 0 0 0 9.5 7h4A1.5 1.5 0 0 0 15 5.5v-4A1.5 1.5 0 0 0 13.5 0zm-8 8A1.5 1.5 0 0 0 0 9.5v4A1.5 1.5 0 0 0 1.5 15h4A1.5 1.5 0 0 0 7 13.5v-4A1.5 1.5 0 0 0 5.5 8zm8 0A1.5 1.5 0 0 0 8 9.5v4A1.5 1.5 0 0 0 9.5 15h4a1.5 1.5 0 0 0 1.5-1.5v-4A1.5 1.5 0 0 0 13.5 8z"})})}),e.jsx("div",{className:_t[v?"saved":"unsaved"]}),e.jsx("div",{className:kt,children:"Project"}),e.jsx("div",{onClick:j=>{j.stopPropagation(),r("/projects/")},className:Tt,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.3em",height:"1.3em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m7 7l10 10M7 17L17 7"})})})]}),key:Fe};return e.jsxs("div",{className:Vn,children:[e.jsx(_e,{className:wt,activeKey:t??Fe,onChange:b,items:[S]}),e.jsx("div",{className:On,children:e.jsx(_e,{className:wt,popupClassName:"pagesTabsPopup",activeKey:t??Fe,onChange:b,items:y})})]})},Xn=()=>{Ia();const{xPanelStatus:t="disconnected",lastErrorMessage:a}=gt(),r=gt.getState().updateXpanelStore;function i(){r({manualStartConnect:!0})}function p(){return t==="disconnected"?a?e.jsx(pe,{style:{color:"red"}}):e.jsx(jn,{}):e.jsx(un,{})}const l=e.jsx(P,{icon:p(),loading:t==="connecting",onClick:()=>i(),children:t.charAt(0).toUpperCase()+t.slice(1)});return a?e.jsx(ge,{placement:"bottomLeft",title:"Last connect message",content:a,trigger:"hover",children:l}):l},Yn=me.memo(()=>{const t=X.getState().setMainMenuData,a=X(l=>l.isConsoleOpen),i=X(l=>l.consoleLogs)?.length??0,p=i>100?"100+":i;return e.jsx("div",{"data-counter":p,className:p?"customBadge":"",children:e.jsx(Ue,{title:"Show/Hide Console",children:e.jsx(P,{onFocus:l=>l.target.blur(),type:a?"primary":"default",onClick:()=>{t({isConsoleOpen:!a})},icon:e.jsx(pn,{})})})})}),Qn=me.memo(()=>{const t=()=>{const{displayGuidePos:a,showGuides:r,lockGuides:i}=ae(f=>f.guidesOptions),p=ae.getState().updateEnvGuidesOptions,l=z(f=>f.workingProject?.attributes.guides),g=!!l?.horizontal?.length||!!l?.vertical?.length;return e.jsxs("div",{className:Wn,children:[e.jsxs("div",{className:at,children:[e.jsx(de,{size:"small",checked:r,onChange:()=>{p({showGuides:!r})}}),"Show Guides"]}),e.jsxs("div",{className:at,children:[e.jsx(de,{disabled:!r,size:"small",checked:a,onChange:()=>{p({displayGuidePos:!a})}}),"Display Guides Positions"]}),e.jsxs("div",{className:at,children:[e.jsx(de,{size:"small",checked:i,onChange:()=>{p({lockGuides:!i})}}),"Lock Guides"]}),e.jsx(te,{style:{margin:"5px 0"}}),e.jsx(P,{disabled:!g,icon:e.jsx(ba,{}),onClick:()=>{Fa()},children:"Delete all Guides"})]})};return e.jsx(ge,{placement:"bottomLeft",content:e.jsx(t,{}),trigger:"hover",children:e.jsx(P,{onFocus:a=>a.target.blur(),onClick:()=>{},icon:e.jsx("svg",{style:{translate:"-0.3em 0.1em"},xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 14 14",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",d:"M12.5.5h-11a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-11a1 1 0 0 0-1-1m-12 3h13m-9 0v10m9-5h-9"})}),children:"View"})})}),er=({projectName:t,isProfilePage:a})=>{const{projectId:r}=Y(),i=ut(l=>l.user?.email);let p="My Projects";return r?p=t||e.jsx(je,{}):a&&(p=e.jsxs(e.Fragment,{children:[e.jsx(Bt,{}),i]})),e.jsx(e.Fragment,{children:p})},It=({deviceItem:t,editable:a=!1})=>{const{name:r,width:i,height:p,uid:l}=t,g=f=>{f.stopPropagation(),f.preventDefault();const v=$e.getState().removeUserTestDevice;v(l)};return e.jsx(fe,{value:l,children:e.jsxs("div",{className:$n,children:[r,e.jsxs(mt,{style:{fontSize:11,padding:2,lineHeight:"1em"},children:[i," x ",p]}),a&&e.jsx(sa,{style:{color:"red"},className:"close",onClick:g})]})})};var Mt="testDeviceButton_dimensionsPopTitle__88rnak0",Pt="testDeviceButton_dimensionsPopTitleSmall__88rnak1",tr="testDeviceButton_dimensionsDeviceListScroll__88rnak2",ar="testDeviceButton_addUserDeviceForm__88rnak3";const nr=()=>{const t=ae.getInitialState().updateEnvStore,a=ae(b=>b.selectedTestDevice),{userDefinedTestDevices:r,predefinedTestDevices:i}=$e(b=>b),p=b=>{let y=b.target.value;y=y==="none"?null:y;const S=[...r,...i].find(j=>j.uid===y);if(S){const{fitEditor:j}=ae.getState();t({selectedTestDevice:S}),j()}else throw new Error("Test device not found")},l=u.useMemo(()=>r.map(b=>e.jsx(It,{editable:!0,deviceItem:b},b.uid)),[r]),g=u.useMemo(()=>i.map(b=>e.jsx(It,{editable:!1,deviceItem:b},b.uid)),[i]),[f]=x.useForm(),[v,d]=me.useState(!1),w=b=>{d(!0);const y=$e.getState().createUserTestDevice;y(b).then(()=>{f.resetFields(),d(!1)})};return e.jsxs(e.Fragment,{children:[e.jsx(fe.Group,{onChange:p,value:a?.uid,children:e.jsx(Ae,{style:{width:400},direction:"vertical",children:e.jsxs("div",{className:tr,children:[e.jsxs(vt,{initialOpen:!0,summary:"My devices",children:[...l]}),e.jsxs(vt,{initialOpen:!0,summary:"Predefined devices",children:[...g]})]})})}),e.jsx(te,{style:{margin:"10px 0"}}),e.jsx(x,{form:f,onFinish:w,onFinishFailed:()=>d(!1),className:ar,layout:"vertical",children:e.jsxs(Ae,{children:[e.jsx(x.Item,{required:!1,name:"name",rules:[{required:!0,message:"Required"}],label:"Name",children:e.jsx(G,{style:{width:100},placeholder:"Name"})}),e.jsx(x.Item,{required:!1,name:"width",rules:[{required:!0,message:"Required"}],label:"Width",children:e.jsx(lt,{min:0,style:{width:100},placeholder:"Width"})}),e.jsx(x.Item,{required:!1,name:"height",rules:[{required:!0,message:"Required"}],label:"Height",children:e.jsx(lt,{min:0,style:{width:100},placeholder:"Height"})}),e.jsx(x.Item,{label:" ",children:e.jsx(P,{loading:v,htmlType:"submit",block:!0,icon:e.jsx(Aa,{}),children:"Add device"})})]})})]})},rr=()=>{const t=X(l=>l.isSubpageEditor),a=ae(l=>l.selectedTestDevice),r=ae(l=>l.isTestDeviceRotated),i=()=>{const l=ae.getState().updateEnvStore;l({isTestDeviceRotated:!r})},p=t?e.jsxs("div",{className:Mt,children:["Subpage editor - no test devices available here",e.jsxs("small",{className:Pt,children:[e.jsx(He,{})," Subpage is a reusable component - it has own size and there is no sense to test it on different devices in fullscreen mode."]})]}):e.jsxs("div",{className:Mt,children:["Test device selector",e.jsxs("small",{className:Pt,children:[e.jsx(He,{})," It's not a project setting, just preview option to see how page looks on different devices."]})]});return e.jsxs(Ae.Compact,{block:!0,children:[e.jsx(ge,{placement:"bottomLeft",title:p,content:t?null:e.jsx(nr,{}),trigger:t?"hover":"click",children:e.jsx(P,{disabled:t,onFocus:l=>l.target.blur(),icon:e.jsx("svg",{style:{translate:"-0.3em 0.1em"},xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32",children:e.jsx("path",{fill:"currentColor",d:"M13 3H7.5A4.5 4.5 0 0 0 3 7.5V9a1 1 0 0 0 2 0V7.5A2.5 2.5 0 0 1 7.5 5H13a1 1 0 1 0 0-2m2.5 26a4.5 4.5 0 0 0 4.5-4.5v-8a4.5 4.5 0 0 0-4.5-4.5h-8A4.5 4.5 0 0 0 3 16.5v8A4.5 4.5 0 0 0 7.5 29zm6.5-1a1 1 0 0 1 1-1h1.5a2.5 2.5 0 0 0 2.5-2.5V19a1 1 0 1 1 2 0v5.5a4.5 4.5 0 0 1-4.5 4.5H23a1 1 0 0 1-1-1m7-15V7.5A4.5 4.5 0 0 0 24.5 3H19a1 1 0 1 0 0 2h5.5A2.5 2.5 0 0 1 27 7.5V13a1 1 0 1 0 2 0"})}),children:a?.name})}),e.jsx(P,{disabled:t,onFocus:l=>l.target.blur(),onClick:i,type:r?"primary":"default",icon:e.jsx("svg",{style:{translate:"0 2px"},xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"M16.26 1.874a.75.75 0 0 1 .866-.613c3.2.544 5.624 3.36 5.624 6.74a.75.75 0 0 1-1.17.62l-1.5-1.014a.75.75 0 1 1 .84-1.242l.1.067c-.577-1.91-2.18-3.358-4.146-3.693a.75.75 0 0 1-.613-.865M8.319 3.316c-.579.442-1.257 1.118-2.232 2.092l-.678.679c-.974.974-1.65 1.652-2.092 2.232c-.429.561-.566.941-.566 1.307s.137.746.566 1.308c.442.579 1.118 1.257 2.092 2.232l5.427 5.426c.974.974 1.652 1.65 2.231 2.092c.563.43.942.566 1.308.566s.746-.137 1.308-.566c.579-.442 1.257-1.118 2.232-2.092l.678-.678c.974-.975 1.65-1.653 2.092-2.232c.429-.562.566-.942.566-1.308s-.137-.745-.566-1.307c-.442-.58-1.118-1.258-2.092-2.232l-5.427-5.427c-.974-.974-1.652-1.65-2.231-2.092c-.562-.429-.942-.566-1.308-.566s-.746.137-1.308.566m-.91-1.193c.696-.53 1.392-.873 2.218-.873s1.522.343 2.217.873c.67.51 1.418 1.26 2.345 2.186l5.503 5.504c.927.926 1.676 1.675 2.186 2.344c.53.695.873 1.391.873 2.217s-.343 1.522-.873 2.218c-.51.668-1.26 1.417-2.186 2.344l-.755.755c-.927.927-1.676 1.676-2.344 2.186c-.696.53-1.392.873-2.218.873s-1.522-.343-2.217-.873c-.67-.51-1.418-1.26-2.344-2.186L4.31 14.188c-.927-.927-1.676-1.676-2.186-2.344c-.53-.696-.873-1.392-.873-2.218s.343-1.522.873-2.217c.51-.67 1.26-1.418 2.186-2.344l.755-.756c.927-.926 1.676-1.675 2.345-2.186m2.07 2.903a.75.75 0 0 1 0 1.06L6.086 9.479a.75.75 0 1 1-1.06-1.06l3.391-3.392a.75.75 0 0 1 1.06 0m6.74 10.218a.689.689 0 1 0-.974.974a.689.689 0 0 0 .974-.974m-2.035-1.06a2.189 2.189 0 1 1 3.096 3.095a2.189 2.189 0 0 1-3.096-3.096M1.648 15.337a.75.75 0 0 1 .772.04l1.5 1.015a.75.75 0 0 1-.84 1.242l-.1-.067c.577 1.91 2.18 3.358 4.146 3.693a.75.75 0 0 1-.252 1.479c-3.2-.545-5.624-3.361-5.624-6.74a.75.75 0 0 1 .398-.662",clipRule:"evenodd"})})})]})},sr=me.memo(({subPageHeight:t,subPageWidth:a})=>{const r=ae(d=>d.editorZoom),i=Number.parseFloat((r*100).toFixed(0)),p=({value:d})=>{const w=Number(d)||1,{updateEditorZoom:b}=ae.getState();b(w/100)},{resetEditorZoom:l,centerViewer:g,fitEditor:f}=ae.getState(),v=()=>{a&&t?f(a,t):f()};return e.jsxs(Ae,{style:{minWidth:250},direction:"vertical",size:"small",children:[e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("div",{style:{flexGrow:1},children:e.jsx(Da,{min:1,max:100,value:i,onChange:d=>{p({value:d})}})}),e.jsx(G,{addonAfter:"%",style:{width:87},value:i,onChange:d=>{p({value:d.target.value})}})]}),e.jsxs(Ae.Compact,{block:!0,children:[e.jsx(P,{style:{flexGrow:1},onClick:v,children:"Fit"}),e.jsx(P,{style:{flexGrow:1},onClick:g,children:"Center"}),e.jsx(P,{style:{flexGrow:1},onClick:l,children:"Reset"})]})]})}),or=()=>{const{pageId:t}=Y(),a=(ae(g=>g.editorZoom)*100).toFixed(0),r=ht({pageId:t}),i=X(g=>g.isSubpageEditor),{width:p,height:l}=Va({width:r?.attributes.width,height:r?.attributes.height});return e.jsx(e.Fragment,{children:e.jsx(ge,{placement:"bottomLeft",title:"Zoom controls",content:e.jsx(sr,{subPageHeight:i?l:void 0,subPageWidth:i?p:void 0}),trigger:"click",children:e.jsxs(P,{onFocus:g=>g.target.blur(),icon:e.jsxs("svg",{style:{translate:"-0.3em 0.1em",scale:"1.2"},width:"1em",height:"1em",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsxs("g",{clipPath:"url(#clip0_224_4)",children:[e.jsx("path",{d:"M9.7 9.7L11 11M10.35 7.425C10.35 7.04088 10.2743 6.66053 10.1273 6.30565C9.98035 5.95077 9.7649 5.62832 9.49329 5.35671C9.22168 5.0851 8.89923 4.86965 8.54435 4.72265C8.18947 4.57566 7.80912 4.5 7.425 4.5C7.04088 4.5 6.66053 4.57566 6.30565 4.72265C5.95077 4.86965 5.62832 5.0851 5.35671 5.35671C5.0851 5.62832 4.86965 5.95077 4.72265 6.30565C4.57566 6.66053 4.5 7.04088 4.5 7.425C4.5 8.20076 4.80817 8.94474 5.35671 9.49329C5.90526 10.0418 6.64924 10.35 7.425 10.35C8.20076 10.35 8.94474 10.0418 9.49329 9.49329C10.0418 8.94474 10.35 8.20076 10.35 7.425Z",stroke:"black",strokeWidth:"0.75",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M9.5375 9.5375L11 11M1 3C1.065 2.3325 1.213 1.883 1.548 1.548C1.883 1.213 2.3325 1.0655 3 1M3 11C2.3325 10.935 1.883 10.787 1.548 10.452C1.213 10.117 1.0655 9.6675 1 9M11 3C10.935 2.3325 10.787 1.883 10.452 1.548C10.117 1.213 9.6675 1.0655 9 1M1 5V7M7 1H5M10.35 7.425C10.35 6.64924 10.0418 5.90526 9.49329 5.35671C8.94474 4.80817 8.20076 4.5 7.425 4.5C6.64924 4.5 5.90526 4.80817 5.35671 5.35671C4.80817 5.90526 4.5 6.64924 4.5 7.425C4.5 8.20076 4.80817 8.94474 5.35671 9.49329C5.90526 10.0418 6.64924 10.35 7.425 10.35C8.20076 10.35 8.94474 10.0418 9.49329 9.49329C10.0418 8.94474 10.35 8.20076 10.35 7.425Z",stroke:"black",strokeWidth:"0.75",strokeLinecap:"round",strokeLinejoin:"round"})]}),e.jsx("defs",{children:e.jsx("clipPath",{id:"clip0_224_4",children:e.jsx("rect",{width:"12",height:"12",fill:"white"})})})]}),children:[a,"%"]})})})};var ir="secondRowTabs_secondRowTabContainer__1jvc5q0",se="secondRowTabs_tabLabel__1jvc5q1";const lr=[{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M12 17h.009M20 8.5v5c0 3.771 0 5.657-1.172 6.828S15.771 21.5 12 21.5s-5.657 0-6.828-1.172S4 17.271 4 13.5v-5"}),e.jsx("path",{d:"m22 10.5l-4.343-4.165C14.99 3.778 13.657 2.5 12 2.5S9.01 3.778 6.343 6.335L2 10.5"})]})}),"Dashboard"]}),key:"projectDashboard"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M3.5 10c0-3.771 0-5.657 1.245-6.828S7.993 2 12 2h.773c3.26 0 4.892 0 6.024.798c.324.228.612.5.855.805c.848 1.066.848 2.6.848 5.67v2.545c0 2.963 0 4.445-.469 5.628c-.754 1.903-2.348 3.403-4.37 4.113c-1.257.441-2.83.441-5.98.441c-1.798 0-2.698 0-3.416-.252c-1.155-.406-2.066-1.263-2.497-2.35c-.268-.676-.268-1.523-.268-3.216z"}),e.jsx("path",{d:"M20.5 12a3.333 3.333 0 0 1-3.333 3.333c-.666 0-1.451-.116-2.098.057a1.67 1.67 0 0 0-1.179 1.179c-.173.647-.057 1.432-.057 2.098A3.333 3.333 0 0 1 10.5 22M8 7h7m-7 4h3"})]})}),"Pages"]}),key:"projectPages"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M20 12.5V7.818c0-1.693 0-2.54-.268-3.216c-.43-1.087-1.342-1.944-2.497-2.35C16.517 2 15.617 2 13.818 2c-3.148 0-4.722 0-5.98.441c-2.02.71-3.615 2.21-4.37 4.113C3 7.737 3 9.219 3 12.182v2.545c0 3.07 0 4.604.848 5.67q.366.461.855.805C5.81 21.982 7.39 22 10.5 22"}),e.jsx("path",{d:"M3 12a3.333 3.333 0 0 1 3.333-3.333c.666 0 1.451.116 2.098-.057A1.67 1.67 0 0 0 9.61 7.43c.173-.647.057-1.432.057-2.098A3.333 3.333 0 0 1 13 2m1.813 20c-.57-.59-2.813-2.16-2.813-3s2.244-2.41 2.813-3m3.374 6c.57-.59 2.813-2.16 2.813-3s-2.244-2.41-2.812-3"})]})}),"SubPages"]}),key:"projectSubPages"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2 12c0-3.69 0-5.534.814-6.841a4.8 4.8 0 0 1 1.105-1.243C5.08 3 6.72 3 10 3h4c3.28 0 4.919 0 6.081.916c.43.338.804.759 1.105 1.243C22 6.466 22 8.31 22 12s0 5.534-.814 6.841a4.8 4.8 0 0 1-1.105 1.243C18.92 21 17.28 21 14 21h-4c-3.28 0-4.919 0-6.081-.916a4.8 4.8 0 0 1-1.105-1.243C2 17.534 2 15.69 2 12m7.5-9v18M5 7h1m-1 3h1",color:"currentColor"})}),"Global Containers"]}),key:"projectGlobalContainers"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M2.5 12c0-4.478 0-6.718 1.391-8.109S7.521 2.5 12 2.5c4.478 0 6.718 0 8.109 1.391S21.5 7.521 21.5 12c0 4.478 0 6.718-1.391 8.109S16.479 21.5 12 21.5c-4.478 0-6.718 0-8.109-1.391S2.5 16.479 2.5 12"}),e.jsx("path",{d:"M16 9c-3.184 0-4.816 6.02-8 6.02"}),e.jsx("path",{d:"M15.54 15.02c-.809 0-1.253 0-1.594-.12a1.8 1.8 0 0 1-.52-.284c-.265-.21-.41-.509-.7-1.108l-1.451-2.995c-.29-.6-.436-.9-.7-1.108a1.8 1.8 0 0 0-.52-.284C9.712 9 9.268 9 8.46 9"})]})}),"Variables"]}),key:"projectVariables"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("ellipse",{cx:12,cy:5,rx:8,ry:3}),e.jsx("path",{d:"M20 12c0 1.657-3.582 3-8 3s-8-1.343-8-3"}),e.jsx("path",{d:"M20 5v14c0 1.657-3.582 3-8 3s-8-1.343-8-3V5m4 3v2m0 5v2"})]})}),"Data Sources"]}),key:"projectDataSources"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M8 15.889C8.15 16.42 8.455 17 9.25 17c1.375 0 1.719-1.111 2.75-5s1.375-5 2.75-5c.795 0 1.1.58 1.25 1.111m-5.667 2.5h4.417"}),e.jsx("path",{d:"M2.5 12c0-4.478 0-6.718 1.391-8.109S7.521 2.5 12 2.5c4.478 0 6.718 0 8.109 1.391S21.5 7.521 21.5 12c0 4.478 0 6.718-1.391 8.109S16.479 21.5 12 21.5c-4.478 0-6.718 0-8.109-1.391S2.5 16.479 2.5 12"})]})}),"Functions"]}),key:"projectFunctions"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("circle",{cx:7.5,cy:7.5,r:1.5}),e.jsx("path",{d:"M2.5 12c0-4.478 0-6.718 1.391-8.109S7.521 2.5 12 2.5c4.478 0 6.718 0 8.109 1.391S21.5 7.521 21.5 12c0 4.478 0 6.718-1.391 8.109S16.479 21.5 12 21.5c-4.478 0-6.718 0-8.109-1.391S2.5 16.479 2.5 12"}),e.jsx("path",{d:"M5 21c4.372-5.225 9.274-12.116 16.498-7.458"})]})}),"Media"]}),key:"projectMedia"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M7 9.5c-.24-1.995.916-2.403 5-2.5m0 0c4.123.1 5.341.598 5 2.5M12 7v10m-2 0h4"}),e.jsx("path",{d:"M3.891 3.891C2.5 5.282 2.5 7.521 2.5 12c0 4.478 0 6.718 1.391 8.109S7.521 21.5 12 21.5c4.478 0 6.718 0 8.109-1.391S21.5 16.479 21.5 12c0-4.478 0-6.718-1.391-8.109S16.479 2.5 12 2.5c-4.478 0-6.718 0-8.109 1.391"})]})}),"Fonts"]}),key:"projectFonts"}],cr=({isSubpage:t})=>[{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 3c0-.471 0-.707-.146-.854C15.707 2 15.47 2 15 2h-1c-.471 0-.707 0-.854.146C13 2.293 13 2.53 13 3v1c0 .471 0 .707.146.854C13.293 5 13.53 5 14 5h1c.471 0 .707 0 .854-.146C16 4.707 16 4.47 16 4zM8.333 8.407C9.938 6.68 22.01 10.913 22 12.46c-.011 1.752-4.714 2.292-6.018 2.658c-.784.22-.994.445-1.175 1.267c-.818 3.723-1.23 5.574-2.166 5.616c-1.493.066-5.874-11.906-4.308-13.593M5 3c0-.471 0-.707-.146-.854C4.707 2 4.47 2 4 2H3c-.471 0-.707 0-.854.146C2 2.293 2 2.53 2 3v1c0 .471 0 .707.146.854C2.293 5 2.53 5 3 5h1c.471 0 .707 0 .854-.146C5 4.707 5 4.47 5 4zm0 11c0-.471 0-.707-.146-.854C4.707 13 4.47 13 4 13H3c-.471 0-.707 0-.854.146C2 13.293 2 13.53 2 14v1c0 .471 0 .707.146.854C2.293 16 2.53 16 3 16h1c.471 0 .707 0 .854-.146C5 15.707 5 15.47 5 15zm-1.5-1V5M13 3.5H5",color:"currentColor"})}),"Editor"]}),key:"pageEditor"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M2.5 12c0-4.478 0-6.718 1.391-8.109S7.521 2.5 12 2.5c4.478 0 6.718 0 8.109 1.391S21.5 7.521 21.5 12c0 4.478 0 6.718-1.391 8.109S16.479 21.5 12 21.5c-4.478 0-6.718 0-8.109-1.391S2.5 16.479 2.5 12"}),e.jsx("path",{d:"M16 9c-3.184 0-4.816 6.02-8 6.02"}),e.jsx("path",{d:"M15.54 15.02c-.809 0-1.253 0-1.594-.12a1.8 1.8 0 0 1-.52-.284c-.265-.21-.41-.509-.7-1.108l-1.451-2.995c-.29-.6-.436-.9-.7-1.108a1.8 1.8 0 0 0-.52-.284C9.712 9 9.268 9 8.46 9"})]})}),"Parameters"]}),key:"parameters"}],dr=me.memo(()=>{const t=X(d=>d.lastUseProjectTabKey??"projectDashboard"),{projectInfoSection:a=t,pageInfoSection:r="pageEditor",projectId:i,pageId:p}=Y(),l=dt(),g=d=>{const w=X.getState().setMainMenuData;p?l(`/projects/${i}/page/${p}/${d}`):(l(`/projects/${i}/${d}`),w({lastUseProjectTabKey:d}))};u.useEffect(()=>{const d=X.getState().setMainMenuData;return()=>{d({lastUseProjectTabKey:void 0})}},[]);const f=X(d=>d.isSubpageEditor),v=u.useMemo(()=>cr({isSubpage:f}),[f]);return e.jsx(_e,{tabBarGutter:0,className:ir,size:"small",items:p?v:lr,activeKey:p?r:a,onChange:g})}),ur=me.lazy(()=>ct(()=>import("./undoRedo-Dqtw2Wdi.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29]),import.meta.url)),mr=me.lazy(()=>ct(()=>import("./newProjectModal-lzdKOwNM.js"),__vite__mapDeps([30,1,2,3,4,29,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28]),import.meta.url)),hr=({setEditProjectModalId:t})=>{const a=dt(),{projectId:r}=Y(),{pageId:i}=Y(),l=zt().pathname.includes("profile"),g=z(b=>b.workingProject),f=X(b=>b.showBoundingBox),{setMainMenuData:v}=X.getState(),[d,w]=u.useState(!1);return e.jsxs("div",{className:An,onContextMenu:b=>b.preventDefault(),children:[!!r&&!!g&&e.jsxs(e.Fragment,{children:[e.jsx("section",{children:e.jsxs("div",{className:Nn,children:[e.jsx("div",{className:Rn,children:e.jsx(Zn,{})}),e.jsx("div",{className:Bn,children:e.jsx(Jn,{projectId:r,setEditProjectModalId:t})})]})}),e.jsx("section",{className:Kn,children:e.jsx(dr,{})})]}),e.jsx("section",{children:e.jsxs("div",{className:Un,style:f?{}:{backgroundColor:"rgb(66, 32, 201)",color:"#fff"},children:[e.jsxs("section",{className:"left",style:{fontSize:14},children:[e.jsx("img",{onClick:()=>a("/projects"),style:{width:"auto",height:23,cursor:"pointer"},src:oa,alt:"avgator studio"}),e.jsx(er,{isProfilePage:l,projectName:g?.attributes.name})]}),e.jsx("section",{className:"center",children:i?e.jsxs(e.Fragment,{children:[e.jsx(Qn,{}),e.jsx(rr,{}),e.jsx(or,{}),e.jsxs(fe.Group,{style:{whiteSpace:"nowrap"},value:f,onChange:b=>v({showBoundingBox:b.target.value}),buttonStyle:"solid",children:[e.jsxs(fe.Button,{value:!0,children:[e.jsx(Sa,{})," Editor"]}),e.jsxs(fe.Button,{style:f?{}:{backgroundColor:"red",color:"#fff",borderColor:"red"},className:"previewButton",value:!1,children:[e.jsx(qt,{})," Preview"]})]}),e.jsx(Xn,{}),e.jsx(Yn,{})]}):null}),e.jsxs("section",{className:"right",style:{display:"flex",gap:5},children:[!r&&!l?e.jsx(P,{icon:e.jsx(Gt,{}),onClick:()=>w(!0),type:"primary",children:"New Project"}):null,!r&&!l&&e.jsx(Wt,{menu:{items:[{key:"Profile",label:e.jsx("div",{onClick:()=>a("/profile"),children:"Profile"})},{key:"Logout",label:e.jsx("div",{onClick:()=>nt(),children:"Change Account"})}]},placement:"bottomRight",arrow:!0,children:e.jsx(P,{icon:e.jsx(Bt,{})})}),l&&e.jsxs(e.Fragment,{children:[e.jsx(P,{icon:e.jsx(ln,{}),onClick:()=>a("/projects"),children:"Back to projects"}),e.jsx(P,{onClick:()=>nt(),icon:e.jsx(wn,{}),children:"Logout"})]}),r&&e.jsx(u.Suspense,{fallback:null,children:e.jsx(ur,{})})]}),e.jsx("div",{style:{position:"absolute"},children:d?e.jsx(u.Suspense,{fallback:e.jsx(Vt,{}),children:e.jsx(mr,{setOpenNewProjectModal:w})}):null})]})})]})};function fr(t){const a=/\/projects\/(\d+)/;return!!t.match(a)}const gr=()=>{const t=ut(v=>v.jwt),a=z(v=>v.currentProjectHash),r=z(v=>v.savedProjectHash),i=z.getState().resetWorkingProject,{projectId:p}=Y(),l=!!t&&!!p&&a!==r,g=ua(({nextLocation:v})=>{const d=fr(v.pathname);return!!(l&&!d)});return u.useEffect(()=>{const v=d=>{l&&(d.preventDefault(),d.returnValue="")};return window.addEventListener("beforeunload",v),()=>{window.removeEventListener("beforeunload",v)}},[g.state,l]),{ConfirmModal:()=>{function v(){g?.reset&&g.reset()}function d(){i().then(()=>{g?.proceed?.()})}function w(){y(!0);const S=z.getState().workingProject;S?ma({projectData:S}).then(()=>{ce.success("Project saved successfully"),g?.proceed&&g.proceed(),i()}).catch(j=>{console.error(j),ce.error("Error while saving project")}):(ce.error("Error while saving project: not found"),y(!1))}const[b,y]=u.useState(!1);return g.state==="blocked"?e.jsx(oe,{maskClosable:!1,title:e.jsxs("div",{style:{color:"rgb(255 113 77)"},children:[e.jsx(pe,{})," Unsaved changes"]}),open:!0,onCancel:()=>{v()},footer:[e.jsx(P,{onClick:()=>v(),children:"Stay here"},"back"),e.jsx(P,{loading:b,type:"primary",onClick:()=>w(),children:"Save and exit"},"saveAndExit"),e.jsx(P,{type:"primary",danger:!0,onClick:()=>d(),children:"Leave without saving"},"submit")],children:e.jsx("div",{children:"Are you really want to leave editor? All unsaved changes will be lost."})}):null}}},pr=({cloneItemModal:t,setCloneItemModal:a,onFinish:r})=>{const[i]=x.useForm(),p=()=>{i.submit()};return e.jsx(oe,{destroyOnClose:!0,afterClose:()=>i.resetFields(),maskClosable:!1,title:`Cloning ${t.nodeType}`,open:!!t,onOk:p,onCancel:()=>a(null),footer:[e.jsx(P,{onClick:()=>a(null),children:"Cancel"},"back"),e.jsxs(P,{type:"primary",onClick:p,children:["Clone ",t.nodeType]},"submit")],children:e.jsx(x,{labelCol:{xs:{span:6}},wrapperCol:{xs:{span:16}},form:i,onFinish:l=>r(l),initialValues:{copiesCount:1},scrollToFirstError:!0,children:e.jsx(x.Item,{colon:!1,required:!1,name:"copiesCount",label:"How many copies",rules:[{required:!0,message:"This field is required."}],children:e.jsx(lt,{min:1,max:10})})})})},vr=()=>{const[t,a]=u.useState(null),{pageId:r}=Y(),i=({copiesCount:l})=>{const{containerIndex:g,elementIndex:f,nodeType:v,isGlobal:d}=t||{};g!==void 0&&(v==="container"?Ua({action:"clone",containerIndex:g,copiesCount:l,pageId:r}).then(()=>a(null)):f!==void 0&&Wa({containerIndex:g,elementIndex:f,copiesCount:l,isGlobal:d,pageId:r,action:"clone"}).then(()=>a(null)))};return{CloneModal:t?e.jsx(pr,{onFinish:i,setCloneItemModal:a,cloneItemModal:t}):null,setCloneItemModal:a}},Lt={sourceContainerIndex:null,sourceContainerType:null,destinationContainerIndex:null,destinationContainerType:null,sourceElementIndex:null,destinationElementIndex:null,destinationElementCorner:null,destinationContainerFlow:null},ze=ha((t,a)=>({selectedElementRef:null,staticEementsGuidesClasses:[],activeStaticElementKey:null,dragData:Lt,updateDragStore:r=>{const i=a().dragData,p={...i,...r};ft.isEqual(i,p)||t(()=>({dragData:p}))},resetDragStore:()=>{t(()=>({dragData:Lt}))},setSelectedElementRef:r=>{t(()=>({selectedElementRef:r}))},setActiveStaticElementKey:r=>{t(()=>({activeStaticElementKey:r}))},setStaticEementsGuidesClasses:r=>{t(i=>{const p=i.staticEementsGuidesClasses;return p.includes(r)?i:{staticEementsGuidesClasses:[...p,r]}})}}),ft.isEqual);var Qt={},ea={},ta={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){for(var p=arguments.length,l=new Array(p),g=0;g<p;g++)l[g]=arguments[g];if(typeof window<"u"){var f;typeof window.gtag>"u"&&(window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)}),(f=window).gtag.apply(f,l)}},r=a;t.default=r})(ta);var aa={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=g;var a=/^(a|an|and|as|at|but|by|en|for|if|in|nor|of|on|or|per|the|to|vs?\.?|via)$/i;function r(f){return f.toString().trim().replace(/[A-Za-z0-9\u00C0-\u00FF]+[^\s-]*/g,function(v,d,w){return d>0&&d+v.length!==w.length&&v.search(a)>-1&&w.charAt(d-2)!==":"&&(w.charAt(d+v.length)!=="-"||w.charAt(d-1)==="-")&&w.charAt(d-1).search(/[^\s-]/)<0?v.toLowerCase():v.substr(1).search(/[A-Z]|\../)>-1?v:v.charAt(0).toUpperCase()+v.substr(1)})}function i(f){return typeof f=="string"&&f.indexOf("@")!==-1}var p="REDACTED (Potential Email Address)";function l(f){return i(f)?(console.warn("This arg looks like an email address, redacting."),p):f}function g(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,w=f||"";return v&&(w=r(f)),d&&(w=l(w)),w}})(aa);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.GA4=void 0;var a=f(ta),r=f(aa),i=["eventCategory","eventAction","eventLabel","eventValue","hitType"],p=["title","location"],l=["page","hitType"],g=["action","category","label","value","nonInteraction","transport"];function f(m){return m&&m.__esModule?m:{default:m}}function v(m,o){if(m==null)return{};var s=d(m,o),c,n;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(m);for(n=0;n<h.length;n++)c=h[n],!(o.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(m,c)&&(s[c]=m[c])}return s}function d(m,o){if(m==null)return{};var s={},c=Object.keys(m),n,h;for(h=0;h<c.length;h++)n=c[h],!(o.indexOf(n)>=0)&&(s[n]=m[n]);return s}function w(m){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?w=function(s){return typeof s}:w=function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},w(m)}function b(m){return j(m)||S(m)||B(m)||y()}function y(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function S(m){if(typeof Symbol<"u"&&m[Symbol.iterator]!=null||m["@@iterator"]!=null)return Array.from(m)}function j(m){if(Array.isArray(m))return N(m)}function D(m,o){var s=Object.keys(m);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(m);o&&(c=c.filter(function(n){return Object.getOwnPropertyDescriptor(m,n).enumerable})),s.push.apply(s,c)}return s}function I(m){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?D(Object(s),!0).forEach(function(c){T(m,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(s)):D(Object(s)).forEach(function(c){Object.defineProperty(m,c,Object.getOwnPropertyDescriptor(s,c))})}return m}function A(m,o){return Q(m)||J(m,o)||B(m,o)||O()}function O(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B(m,o){if(m){if(typeof m=="string")return N(m,o);var s=Object.prototype.toString.call(m).slice(8,-1);if(s==="Object"&&m.constructor&&(s=m.constructor.name),s==="Map"||s==="Set")return Array.from(m);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return N(m,o)}}function N(m,o){(o==null||o>m.length)&&(o=m.length);for(var s=0,c=new Array(o);s<o;s++)c[s]=m[s];return c}function J(m,o){var s=m==null?null:typeof Symbol<"u"&&m[Symbol.iterator]||m["@@iterator"];if(s!=null){var c=[],n=!0,h=!1,C,k;try{for(s=s.call(m);!(n=(C=s.next()).done)&&(c.push(C.value),!(o&&c.length===o));n=!0);}catch(F){h=!0,k=F}finally{try{!n&&s.return!=null&&s.return()}finally{if(h)throw k}}return c}}function Q(m){if(Array.isArray(m))return m}function ee(m,o){if(!(m instanceof o))throw new TypeError("Cannot call a class as a function")}function U(m,o){for(var s=0;s<o.length;s++){var c=o[s];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(m,c.key,c)}}function R(m,o,s){return o&&U(m.prototype,o),m}function T(m,o,s){return o in m?Object.defineProperty(m,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):m[o]=s,m}var H=function(){function m(){var o=this;ee(this,m),T(this,"reset",function(){o.isInitialized=!1,o._testMode=!1,o._currentMeasurementId,o._hasLoadedGA=!1,o._isQueuing=!1,o._queueGtag=[]}),T(this,"_gtag",function(){for(var s=arguments.length,c=new Array(s),n=0;n<s;n++)c[n]=arguments[n];o._testMode||o._isQueuing?o._queueGtag.push(c):a.default.apply(void 0,c)}),T(this,"_loadGA",function(s,c){if(!(typeof window>"u"||typeof document>"u")&&!o._hasLoadedGA){var n=document.createElement("script");n.async=!0,n.src="https://www.googletagmanager.com/gtag/js?id=".concat(s),c&&n.setAttribute("nonce",c),document.body.appendChild(n),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},o._hasLoadedGA=!0}}),T(this,"_toGtagOptions",function(s){if(s){var c={cookieUpdate:"cookie_update",cookieExpires:"cookie_expires",cookieDomain:"cookie_domain",cookieFlags:"cookie_flags",userId:"user_id",clientId:"client_id",anonymizeIp:"anonymize_ip",contentGroup1:"content_group1",contentGroup2:"content_group2",contentGroup3:"content_group3",contentGroup4:"content_group4",contentGroup5:"content_group5",allowAdFeatures:"allow_google_signals",allowAdPersonalizationSignals:"allow_ad_personalization_signals",nonInteraction:"non_interaction",page:"page_path",hitCallback:"event_callback"},n=Object.entries(s).reduce(function(h,C){var k=A(C,2),F=k[0],M=k[1];return c[F]?h[c[F]]=M:h[F]=M,h},{});return n}}),T(this,"initialize",function(s){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!s)throw new Error("Require GA_MEASUREMENT_ID");var n=typeof s=="string"?[{trackingId:s}]:s;o._currentMeasurementId=n[0].trackingId;var h=c.gaOptions,C=c.gtagOptions,k=c.legacyDimensionMetric,F=k===void 0?!0:k,M=c.nonce,L=c.testMode,$=L===void 0?!1:L;if(o._testMode=$,$||o._loadGA(o._currentMeasurementId,M),o.isInitialized||(o._gtag("js",new Date),n.forEach(function(ie){var Te=o._appendCustomMap(I(I(I({send_page_view:!1},o._toGtagOptions(I(I({},h),ie.gaOptions))),C),ie.gtagOptions),F);o._gtag("config",ie.trackingId,Te)})),o.isInitialized=!0,!$){var q=b(o._queueGtag);for(o._queueGtag=[],o._isQueuing=!1;q.length;){var ve=q.shift();o._gtag.apply(o,b(ve)),ve[0]==="get"&&(o._isQueuing=!0)}}}),T(this,"set",function(s){if(!s){console.warn("`fieldsObject` is required in .set()");return}if(w(s)!=="object"){console.warn("Expected `fieldsObject` arg to be an Object");return}Object.keys(s).length===0&&console.warn("empty `fieldsObject` given to .set()"),o._gaCommand("set",s)}),T(this,"_gaCommandSendEvent",function(s,c,n,h,C){o._gtag("event",c,I(I({event_category:s,event_label:n,value:h},C&&{non_interaction:C.nonInteraction}),o._toGtagOptions(C)))}),T(this,"_gaCommandSendEventParameters",function(){for(var s=arguments.length,c=new Array(s),n=0;n<s;n++)c[n]=arguments[n];if(typeof c[0]=="string")o._gaCommandSendEvent.apply(o,b(c.slice(1)));else{var h=c[0],C=h.eventCategory,k=h.eventAction,F=h.eventLabel,M=h.eventValue;h.hitType;var L=v(h,i);o._gaCommandSendEvent(C,k,F,M,L)}}),T(this,"_gaCommandSendTiming",function(s,c,n,h){o._gtag("event","timing_complete",{name:c,value:n,event_category:s,event_label:h})}),T(this,"_gaCommandSendPageview",function(s,c){if(c&&Object.keys(c).length){var n=o._toGtagOptions(c),h=n.title,C=n.location,k=v(n,p);o._gtag("event","page_view",I(I(I(I({},s&&{page_path:s}),h&&{page_title:h}),C&&{page_location:C}),k))}else s?o._gtag("event","page_view",{page_path:s}):o._gtag("event","page_view")}),T(this,"_gaCommandSendPageviewParameters",function(){for(var s=arguments.length,c=new Array(s),n=0;n<s;n++)c[n]=arguments[n];if(typeof c[0]=="string")o._gaCommandSendPageview.apply(o,b(c.slice(1)));else{var h=c[0],C=h.page;h.hitType;var k=v(h,l);o._gaCommandSendPageview(C,k)}}),T(this,"_gaCommandSend",function(){for(var s=arguments.length,c=new Array(s),n=0;n<s;n++)c[n]=arguments[n];var h=typeof c[0]=="string"?c[0]:c[0].hitType;switch(h){case"event":o._gaCommandSendEventParameters.apply(o,c);break;case"pageview":o._gaCommandSendPageviewParameters.apply(o,c);break;case"timing":o._gaCommandSendTiming.apply(o,b(c.slice(1)));break;case"screenview":case"transaction":case"item":case"social":case"exception":console.warn("Unsupported send command: ".concat(h));break;default:console.warn("Send command doesn't exist: ".concat(h))}}),T(this,"_gaCommandSet",function(){for(var s=arguments.length,c=new Array(s),n=0;n<s;n++)c[n]=arguments[n];typeof c[0]=="string"&&(c[0]=T({},c[0],c[1])),o._gtag("set",o._toGtagOptions(c[0]))}),T(this,"_gaCommand",function(s){for(var c=arguments.length,n=new Array(c>1?c-1:0),h=1;h<c;h++)n[h-1]=arguments[h];switch(s){case"send":o._gaCommandSend.apply(o,n);break;case"set":o._gaCommandSet.apply(o,n);break;default:console.warn("Command doesn't exist: ".concat(s))}}),T(this,"ga",function(){for(var s=arguments.length,c=new Array(s),n=0;n<s;n++)c[n]=arguments[n];if(typeof c[0]=="string")o._gaCommand.apply(o,c);else{var h=c[0];o._gtag("get",o._currentMeasurementId,"client_id",function(C){o._isQueuing=!1;var k=o._queueGtag;for(h({get:function(L){return L==="clientId"?C:L==="trackingId"?o._currentMeasurementId:L==="apiVersion"?"1":void 0}});k.length;){var F=k.shift();o._gtag.apply(o,b(F))}}),o._isQueuing=!0}return o.ga}),T(this,"event",function(s,c){if(typeof s=="string")o._gtag("event",s,o._toGtagOptions(c));else{var n=s.action,h=s.category,C=s.label,k=s.value,F=s.nonInteraction,M=s.transport,L=v(s,g);if(!h||!n){console.warn("args.category AND args.action are required in event()");return}var $={hitType:"event",eventCategory:(0,r.default)(h),eventAction:(0,r.default)(n)};C&&($.eventLabel=(0,r.default)(C)),typeof k<"u"&&(typeof k!="number"?console.warn("Expected `args.value` arg to be a Number."):$.eventValue=k),typeof F<"u"&&(typeof F!="boolean"?console.warn("`args.nonInteraction` must be a boolean."):$.nonInteraction=F),typeof M<"u"&&(typeof M!="string"?console.warn("`args.transport` must be a string."):(["beacon","xhr","image"].indexOf(M)===-1&&console.warn("`args.transport` must be either one of these values: `beacon`, `xhr` or `image`"),$.transport=M)),Object.keys(L).filter(function(q){return q.substr(0,9)==="dimension"}).forEach(function(q){$[q]=L[q]}),Object.keys(L).filter(function(q){return q.substr(0,6)==="metric"}).forEach(function(q){$[q]=L[q]}),o._gaCommand("send",$)}}),T(this,"send",function(s){o._gaCommand("send",s)}),T(this,"pageview",function(s,c,n){var h=s?.trim();if(h===""){console.warn("path cannot be an empty string in .pageview()");return}o._gaCommand("send","pageview",h,{title:n})}),this.reset()}return R(m,[{key:"gtag",value:function(){this._gtag.apply(this,arguments)}},{key:"_appendCustomMap",value:function(s){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!c)return s;s.custom_map||(s.custom_map={});for(var n=1;n<=200;n++)s.custom_map["dimension".concat(n)]||(s.custom_map["dimension".concat(n)]="dimension".concat(n)),s.custom_map["metric".concat(n)]||(s.custom_map["metric".concat(n)]="metric".concat(n));return s}},{key:"outboundLink",value:function(s,c){var n=s.label;if(typeof c!="function"){console.warn("hitCallback function is required");return}if(!n){console.warn("args.label is required in outboundLink()");return}var h={hitType:"event",eventCategory:"Outbound",eventAction:"Click",eventLabel:(0,r.default)(n)},C=!1,k=function(){C=!0,c()},F=setTimeout(k,250),M=function(){clearTimeout(F),C||c()};h.hitCallback=M,this._gaCommand("send",h)}}]),m}();t.GA4=H;var W=new H;t.default=W})(ea);(function(t){function a(f){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?a=function(d){return typeof d}:a=function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},a(f)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ReactGAImplementation=void 0;var r=p(ea);function i(f){if(typeof WeakMap!="function")return null;var v=new WeakMap,d=new WeakMap;return(i=function(b){return b?d:v})(f)}function p(f,v){if(f&&f.__esModule)return f;if(f===null||a(f)!=="object"&&typeof f!="function")return{default:f};var d=i(v);if(d&&d.has(f))return d.get(f);var w={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in f)if(y!=="default"&&Object.prototype.hasOwnProperty.call(f,y)){var S=b?Object.getOwnPropertyDescriptor(f,y):null;S&&(S.get||S.set)?Object.defineProperty(w,y,S):w[y]=f[y]}return w.default=f,d&&d.set(f,w),w}var l=r.GA4;t.ReactGAImplementation=l;var g=r.default;t.default=g})(Qt);const Et=ia(Qt),{Panel:xr}=Re,jr=Ve(oe)`
  height: calc(100vh - 4%) !important;
  width: 100% !important;

  .ant-modal-content {
    height: 100%;
    position: relative;
    display: flex;
    flex-flow: column;

    .dsForm {
      height: 100%;
      flex: 1;
      position: relative;
      display: flex;
      flex-flow: column;
    }

    .ant-modal-body {
      flex: 1;
      position: relative;
      padding: 0;
      display: flex;
      flex-flow: column;
    }

    .ant-collapse-header {
      font-weight: normal !important;
      user-select: none;
      text-transform: uppercase;
      font-size: 12px;
    }

    .ant-form-item-label {
      flex-basis: 160px;
    }
  }
`,qe=Ve.div`
  position: relative;
  height: 100%;
  padding-top: 17px;
  /* overflow: hidden; */
  min-height: 200px;

  .monaco-editor {
    position: absolute !important;
    left: 0;
    top: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    height: 100%;
  }
`,br=Ve(_e)`
  position: relative;
  flex: 1;

  .ant-tabs-content {
    position: relative;
    height: 100%;
  }

  .ant-tabs-tabpane {
    height: 100%;
    background-color: #1e1e1e;
  }

  .ant-tabs-nav {
    margin: 0;
  }

  .ant-tabs-tab {
    border: 0 !important;

    &.ant-tabs-tab-active {
      background-color: #1e1e1e;

      .ant-tabs-tab-btn {
        color: #fff;
        user-select: none;
      }
    }
  }
`,Ft=Ve.div`
  color: #fff;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
`,yr=Ve.div`
  position: relative;
  display: flex;
  color: #fff;
  height: 100%;

  .functionBox {
    min-width: 300px;
    position: relative;
    height: 100%;
    display: flex;
    flex-flow: column;

    .functionBoxControls {
      padding: 17px;
      padding-right: 0;
      padding-bottom: 0;
      font-size: 12px;
      display: flex;
      gap: 5px;
      justify-content: space-between;
    }
  }

  .resultBox {
    flex: 1;
  }
`,wr=({setNewDatasourceVisible:t,newDatasourceVisible:a})=>{const r=typeof a=="number"?a:null,i=z.getState().workingProject?.attributes.datasources.data.find(_=>_.id===r),p=z.getState().workingProject?.attributes.modificators.data,[l]=x.useForm(),{projectId:g}=Y(),f=u.useMemo(()=>{let _=z.getState().workingProject?.attributes.datasources.data??[];return i&&(_=_.filter(V=>V.id!==i.id)),_.map(V=>V.attributes.name)},[i]),v=u.useMemo(()=>z.getState().workingProject?.attributes.modificators.data?.map(V=>({value:V.id,label:V.attributes.name}))??[],[]),{headerKey:d,headerValue:w,hostname:b}=Ka()??{},[y,S]=u.useState("local"),[j,D]=u.useState(null),[I,A]=u.useState(null),O=x.useWatch("sourceLink",l),B=x.useWatch("useBaseUrl",l),N=x.useWatch("headerKey",l),J=x.useWatch("headerValue",l),Q=N!==null,ee=J!==null,U=x.useWatch("sourceObject",l),R=x.useWatch("modificatorId",l),T=!!O||!!B,[H,W]=u.useState(!1),[m,o]=u.useState(!1),[s,c]=u.useState("local"),n=Ja({data:{useBaseUrl:B,sourceLink:O,headerKey:N,headerValue:J}}),h=u.useMemo(()=>T&&!U?"remote":T&&U?"mixed":"local",[T,U]),C=u.useMemo(()=>R?p?.find(_=>_.id===R):null,[R,p]),k=u.useCallback(()=>{C&&(l.setFieldValue("modificatorFunctionString",C.attributes.function),o(!1))},[l,C]);u.useEffect(()=>{k()},[k]);const[F,M]=u.useState(!1),[L,$]=u.useState([]),[q,ve]=u.useState([]),ie=_=>{$(_)},Te=_=>{ve(_)},E=({formKey:_,value:Z})=>{const V=l.getFieldValue(_);function re(){l.setFieldsValue({[_]:Z?"":null})}!Z&&V?Jt({icon:e.jsx(pe,{}),title:"Are you sure?",content:"Disabling this option will clear the value of the field. Are you sure you want to proceed?",okButtonProps:{danger:!0},okText:"Proceed",cancelText:"Cancel",onOk:()=>{re()},onCancel:()=>{}}):re()},ne=async _=>{if(!g)return;const{name:Z,sourceLink:V,useBaseUrl:re,headerKey:be,headerValue:Me,modificatorId:Xe,sourceObject:Ye,modificatorFunctionString:Pe,isImagePreloadSource:Le}=_;console.log("formData",_);let Ee={name:Z||"New datasouce",production:{sourceLink:V,useBaseUrl:re,headerKey:be,headerValue:Me,modificatorId:Xe||null,sourceObject:Ye,storageType:h,isImagePreloadSource:Le},uid:Ht()};if(M(!0),m&&C?.id&&await Xt({function:Pe},C.id).catch(()=>{ce.error("Failed to update function"),M(!1)}),i){const{uid:Be,...na}=Ee;Xa({...na},i.id).then(()=>t(!1)).then(()=>jt()).finally(()=>M(!1))}else Ya(g,Ee).then(()=>t(!1)).then(()=>jt()).finally(()=>M(!1))},he=u.useCallback(()=>L.length>0?e.jsx(ge,{trigger:"hover",title:"invalid JSON",content:"JSON data contains errors",children:e.jsx(pe,{style:{fontSize:14,margin:"0 0 0 5px",color:"red",cursor:"help"}})}):null,[L.length]);function we(){const _=new Date,Z=_.getFullYear(),V=String(_.getMonth()+1).padStart(2,"0"),re=String(_.getDate()).padStart(2,"0"),be=String(_.getHours()).padStart(2,"0"),Me=String(_.getMinutes()).padStart(2,"0");return`${Z}-${V}-${re}_${be}-${Me}`}const Ie=we(),Ke=i?{name:i.attributes.name,sourceLink:i.attributes.production?.sourceLink??"",useBaseUrl:i.attributes.production?.useBaseUrl??!1,headerKey:i.attributes.production?.headerKey??null,headerValue:i.attributes.production?.headerValue??null,modificatorId:i.attributes.production?.modificatorId??0,sourceObject:i.attributes.production?.sourceObject??"",modificatorFunctionString:"",isImagePreloadSource:i.attributes.production?.isImagePreloadSource??!1}:{name:"New datasource "+Ie,sourceLink:"",useBaseUrl:!1,headerKey:null,headerValue:null,modificatorId:0,sourceObject:"",modificatorFunctionString:"",isImagePreloadSource:!1},le=u.useCallback(async({beforeFetch:_,successFetch:Z,errorFetch:V,finallyFetch:re,applyFunction:be})=>{_();const{sourceLink:Me,headerKey:Xe,headerValue:Ye}=n;try{await Za(Me,Xe,Ye).then(Pe=>{let Le="";if(be){const Ee=l.getFieldValue("modificatorFunctionString");if(Ee)try{const Be=xt([Pe],null,void 0,Ee);console.log("dataAfterFunctionApply",Be),Le=JSON.stringify(Be,null,2)}catch{}}else Le=JSON.stringify(Pe,null,2);Z(Le)})}catch{ce.error("Failed to fetch data"),V()}finally{re?.()}},[n,l]);u.useEffect(()=>{y==="remote"&&!T&&S("local"),y==="modified"&&!R&&S("local"),A(null)},[y,T,R]);const Je=u.useMemo(()=>{const _=()=>{A("loading");try{const V=l.getFieldValue("modificatorFunctionString"),re=JSON.parse(U),be=xt([re],null,void 0,V);A(JSON.stringify(be,null,2))}catch(V){console.log(V),A(null)}},Z=()=>{if(s==="local")return U?e.jsx(P,{style:{textTransform:"capitalize"},icon:e.jsx(tt,{}),loading:I==="loading",onClick:()=>{_()},ghost:!0,children:"Calculate Local Modified Data"}):e.jsx("p",{children:"Your local source is empty"});if(s==="remote")return T?e.jsx(P,{style:{textTransform:"capitalize"},icon:e.jsx(tt,{}),loading:I==="loading",onClick:()=>le({applyFunction:!0,beforeFetch:()=>{A("loading")},successFetch:V=>{A(V)},errorFetch:()=>{A(null)}}),ghost:!0,children:"Calculate Remote Modified Data"}):e.jsx("p",{children:"Remote URL is not presented in ENV or datasource settings"})};return[{label:e.jsxs(e.Fragment,{children:["Set Local Source ",he()]}),key:"local",children:e.jsx(qe,{hasErrors:!!L.length,children:e.jsx(x.Item,{noStyle:!0,name:"sourceObject",validateStatus:L.length?"error":void 0,rules:[()=>({validator(V,re){return L.length?Promise.reject():Promise.resolve()}})],normalize:V=>V===void 0?"":V,children:e.jsx(ye,{className:"monaco-editor",language:"json",loading:e.jsx(je,{}),options:{readOnly:!1,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark",defaultLanguage:"json",onValidate:ie})})})},{label:"Test Remote Source",disabled:!T,key:"remote",children:j===null||j==="loading"?e.jsx(Ft,{children:e.jsx(P,{icon:e.jsx(tt,{}),loading:j==="loading",onClick:()=>le({beforeFetch:()=>{D("loading")},successFetch:V=>{D(V)},errorFetch:()=>{D(null)}}),ghost:!0,children:"Retreive Remote Data"})}):e.jsx(qe,{hasErrors:!!L.length,children:e.jsx(ye,{className:"monaco-editor",language:"json",loading:e.jsx(je,{}),options:{readOnly:!0,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark",defaultLanguage:"json",value:j})})},{label:e.jsxs(e.Fragment,{children:["Test Function",!!q.length&&e.jsx(ge,{trigger:"hover",title:"invalid Function",content:"Function contains errors",children:e.jsx(pe,{style:{fontSize:14,margin:"0 0 0 5px",color:"red",cursor:"help"}})})]}),disabled:!R,key:"modified",children:e.jsxs(yr,{children:[e.jsx("div",{className:"functionBox",children:e.jsx("div",{style:{flex:1},children:e.jsx(qe,{hasErrors:!1,children:e.jsx(x.Item,{name:"modificatorFunctionString",validateStatus:q.length?"error":void 0,rules:[()=>({validator(V,re){return q.length?Promise.reject():Promise.resolve()}})],normalize:V=>V===void 0?"":V,noStyle:!0,children:e.jsx(ye,{className:"monaco-editor",language:"json",loading:e.jsx(je,{}),options:{readOnly:!1,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",lineNumbers:"off",wordWrap:"on",glyphMargin:!1,folding:!0,lineDecorationsWidth:0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark",defaultLanguage:"javascript",onValidate:Te})})})})}),e.jsx("div",{className:"resultBox",children:I===null||I==="loading"?e.jsx(Ft,{children:e.jsx(Z,{})}):e.jsx(qe,{hasErrors:!!L.length,children:e.jsx(ye,{className:"monaco-editor",language:"json",loading:e.jsx(je,{}),options:{readOnly:!0,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark",defaultLanguage:"json",value:I})})})]})}]},[L.length,he,l,q.length,le,T,R,I,s,U,j]),Oe=u.useMemo(()=>{switch(y){case"local":return e.jsxs(e.Fragment,{children:[e.jsx(P,{size:"small",disabled:!T,icon:e.jsx(Tn,{}),type:"dashed",style:{marginLeft:10},loading:H,onClick:()=>le({beforeFetch:()=>{W(!0)},successFetch:_=>{l.setFieldsValue({sourceObject:_})},errorFetch:()=>{},finallyFetch:()=>{W(!1)}}),children:"Fill from remote source"}),e.jsx(P,{size:"small",onClick:()=>{l.setFieldsValue({sourceObject:null})},disabled:!(U&&!H),danger:!0,icon:e.jsx(ke,{}),type:"dashed",style:{marginLeft:10},children:"Clear"})]});case"remote":return e.jsxs(e.Fragment,{children:[e.jsx(P,{onClick:()=>le({beforeFetch:()=>{D("loading")},successFetch:_=>{D(_)},errorFetch:()=>{D(null)}}),loading:j==="loading",size:"small",icon:e.jsx(Oa,{}),type:"dashed",style:{marginLeft:10},disabled:j===null||j==="loading",children:"Refresh Remote Data"}),e.jsx(P,{size:"small",onClick:()=>{D(null)},disabled:j===null||j==="loading",danger:!0,icon:e.jsx(ke,{}),type:"dashed",style:{marginLeft:10},children:"Clear Preview"})]});case"modified":return e.jsxs(e.Fragment,{children:[e.jsx(P,{onClick:()=>A(null),loading:I==="loading",size:"small",icon:e.jsx(ke,{}),type:"dashed",style:{marginLeft:10},disabled:I===null||I==="loading",children:"Clear"}),e.jsx(P,{size:"small",onClick:()=>k(),disabled:!m,danger:!0,icon:e.jsx(ke,{}),type:"dashed",style:{marginLeft:10},children:"Discard function changes"}),e.jsx(Ne,{size:"small",value:s,style:{marginLeft:10},onChange:_=>{c(_),A(null)},options:[{value:"local",label:"Use Local Source"},{value:"remote",label:"Use Remote Source"}]})]});default:return null}},[y,H,l,le,m,T,I,s,k,U,j]),Ze=_=>{const Z=Object.keys(_);Z.includes("modificatorFunctionString")&&!m&&o(!0),Z.includes("modificatorId")&&(o(!1),A(null))};return e.jsx(jr,{destroyOnClose:!0,maskClosable:!1,centered:!0,title:i?`Edit datasource: ${i.attributes.name}`:"Add new datasource",open:!0,onCancel:()=>t(!1),footer:[e.jsx(P,{onClick:()=>t(!1),children:"Cancel"},"back"),e.jsxs(P,{loading:F,type:"primary",onClick:()=>{l.submit()},children:[i?"Save datasource":"Add datasource"," ",m?"& Update Function":""]},"submit")],children:e.jsxs(x,{onValuesChange:Ze,onFinish:ne,className:"dsForm",form:l,initialValues:Ke,scrollToFirstError:!0,children:[e.jsx(Re,{destroyInactivePanel:!1,expandIcon:({isActive:_})=>_?e.jsx($t,{}):e.jsx(Kt,{}),defaultActiveKey:r?[]:["form"],ghost:!0,children:e.jsxs(xr,{forceRender:!0,extra:e.jsx(mt,{color:h==="local"?"gold":"green",style:{marginInlineEnd:0,textTransform:"none"},children:h}),header:"DataSource Settings",children:[e.jsx(x.Item,{colon:!1,required:!1,label:"Name",name:"name",rules:[{required:!0,message:"This field is required."},()=>({validator(_,Z){return Promise.all([De({input:Z,searchArray:f})])}})],children:e.jsx(G,{})}),e.jsx(te,{plain:!0,orientationMargin:160,orientation:"left",children:"Remote fetch settings"}),e.jsx(x.Item,{colon:!1,required:!1,label:"Remote URL",name:"sourceLink",children:e.jsx(x.Item,{noStyle:!0,colon:!1,required:!1,name:"sourceLink",normalize:_=>_===void 0?"":_,children:e.jsx(G,{allowClear:!0,spellCheck:!1,placeholder:B?"End of URL":"URL",addonBefore:e.jsxs(e.Fragment,{children:[e.jsx(x.Item,{valuePropName:"checked",name:"useBaseUrl",noStyle:!0,children:e.jsx(ya,{children:e.jsx("span",{style:{userSelect:"none"},children:"Include Base Url"})})}),e.jsx(ge,{content:e.jsxs(e.Fragment,{children:["BaseUrl: ",b||"Empty"]}),children:e.jsx(qt,{})})]})})})}),T&&e.jsxs(e.Fragment,{children:[e.jsx(x.Item,{label:"Request Header key",colon:!1,children:e.jsxs(rt,{gutter:8,children:[e.jsx(Se,{flex:"auto",children:e.jsx(x.Item,{colon:!1,required:!1,noStyle:!0,name:"headerKey",normalize:_=>_===void 0?"":_,children:e.jsx(G,{addonBefore:e.jsx("div",{style:{textTransform:"uppercase",fontSize:9,color:"gray",width:70,cursor:"default"},children:Q?"custom key":e.jsx(Ue,{placement:"topLeft",title:"Value inherited from Project Environment settings",arrowPointAtCenter:!0,children:"inherited"})}),placeholder:Q?"Empty":d||"Empty",allowClear:!0,spellCheck:!1,disabled:!Q})})}),e.jsx(Se,{style:{alignSelf:"center"},children:e.jsx(x.Item,{noStyle:!0,colon:!1,required:!1,valuePropName:"checked",children:e.jsx(de,{onChange:_=>{E({formKey:"headerKey",value:_})},checked:Q,size:"small"})})})]})}),e.jsx(x.Item,{label:"Request Header value",colon:!1,children:e.jsxs(rt,{gutter:8,children:[e.jsx(Se,{flex:"auto",children:e.jsx(x.Item,{colon:!1,required:!1,noStyle:!0,name:"headerValue",normalize:_=>_===void 0?"":_,children:e.jsx(G,{addonBefore:e.jsx("div",{style:{textTransform:"uppercase",fontSize:9,color:"gray",width:70,cursor:"default"},children:ee?"custom value":e.jsx(Ue,{placement:"topLeft",title:"Value inherited from Project Environment settings",arrowPointAtCenter:!0,children:"inherited"})}),placeholder:ee?"Empty":w||"Empty",allowClear:!0,spellCheck:!1,disabled:!ee})})}),e.jsx(Se,{style:{alignSelf:"center"},children:e.jsx(x.Item,{noStyle:!0,colon:!1,required:!1,valuePropName:"checked",children:e.jsx(de,{onChange:_=>{E({formKey:"headerValue",value:_})},checked:ee,size:"small"})})})]})})]}),e.jsx(te,{plain:!0,orientationMargin:160,orientation:"left",children:"Datasource postprocessing & manipulation"}),e.jsx(x.Item,{colon:!1,required:!1,label:"Modify Function",name:"modificatorId",children:e.jsx(Ne,{options:[{value:0,label:"None"},...v]})}),e.jsx(x.Item,{colon:!1,required:!1,label:e.jsxs("div",{style:{width:200},children:["Image preload",e.jsx(ge,{placement:"topLeft",title:"Datasource for Image preloading",content:"URLs array will be used to preload & cache images",trigger:"hover",arrowPointAtCenter:!0,children:e.jsx(He,{style:{marginLeft:7}})})]}),name:"isImagePreloadSource",valuePropName:"checked",children:e.jsx(de,{})})]},"form")}),e.jsx(br,{activeKey:y,onChange:_=>{S(_)},tabBarExtraContent:{right:e.jsx("div",{style:{paddingRight:17},children:Oe})},animated:!1,type:"card",items:Je})]})})},{Option:Cr}=Ne,xe=me.memo(({name:t,envIndex:a,label:r,placeholder:i,rules:p,addonAfter:l,form:g,setIsFormChanged:f})=>{const v=typeof a!="number",d=g.getFieldValue(["env",a,...t]),[w,b]=u.useState(d!==void 0),y=S=>{S?g.setFieldValue(["env",a,...t],""):g.setFieldValue(["env",a,...t],void 0),b(S),f(!0)};return v?e.jsx(x.Item,{isListField:!1,label:r,colon:!1,required:!1,name:[...t],rules:p,children:e.jsx(G,{addonAfter:l,placeholder:i})}):e.jsx(x.Item,{colon:!1,label:r,children:e.jsxs(rt,{style:{flexWrap:"nowrap"},gutter:8,children:[e.jsx(Se,{flex:"auto",children:e.jsx(x.Item,{noStyle:!0,isListField:w,label:r,colon:!1,required:!1,name:w?["env",a,...t]:t,rules:p,children:e.jsx(G,{disabled:!w,addonAfter:l,placeholder:i,addonBefore:w?null:e.jsx("div",{style:{textTransform:"uppercase",fontSize:9,color:"gray"},children:"inherited"})})})}),e.jsx(Se,{style:{alignSelf:"center"},children:e.jsx(de,{onChange:S=>{y(S)},checked:w,size:"small"})})]})})}),Dt=me.memo(({form:t,envIndex:a,setIsFormChanged:r})=>{const i=typeof a!="number";return e.jsxs(e.Fragment,{children:[i?e.jsx(x.Item,{colon:!0,label:"Environment name",children:e.jsx("div",{children:"Default"})}):e.jsx(x.Item,{isListField:!0,colon:!1,required:!1,name:["env",a,"envName"],label:"Environment name",children:e.jsx(G,{placeholder:"Environment name"})}),e.jsx(te,{plain:!0,orientation:"left",children:e.jsx("span",{style:{textTransform:"uppercase",fontSize:10,opacity:.7},children:"Build Options"})}),e.jsx(x.Item,{isListField:!i,colon:!1,required:!1,label:"Enable console",valuePropName:"checked",name:i?["debugOptions","showConsoleOnLoad"]:["env",a,"debugOptions","showConsoleOnLoad"],children:e.jsx(de,{})}),e.jsx(xe,{setIsFormChanged:r,form:t,label:"Archive Name",placeholder:"Archive Name",envIndex:a,name:["archiveName"],rules:[()=>({validator(p,l){return We(l)}})],addonAfter:".ch5z"}),e.jsx(te,{plain:!0,orientation:"left",children:e.jsx("span",{style:{textTransform:"uppercase",fontSize:10,opacity:.7},children:"Connection Options"})}),e.jsx(xe,{setIsFormChanged:r,form:t,label:"Host",placeholder:"Ip or Hostname",envIndex:a,name:["webXpanel","host"]}),e.jsx(xe,{setIsFormChanged:r,label:"ipId",form:t,placeholder:"IpId",envIndex:a,name:["webXpanel","ipId"]}),e.jsx(xe,{setIsFormChanged:r,label:"Room ID",form:t,placeholder:"Room ID",envIndex:a,name:["webXpanel","roomId"]}),e.jsx(xe,{setIsFormChanged:r,label:"Auth Token",form:t,placeholder:"Auth Token",envIndex:a,name:["webXpanel","authToken"]}),e.jsx(te,{plain:!0,orientation:"left",children:e.jsx("span",{style:{textTransform:"uppercase",fontSize:10,opacity:.7},children:"Dataset Options"})}),e.jsx(xe,{setIsFormChanged:r,label:"Dataset base URL",placeholder:"Dataset base URL",form:t,envIndex:a,name:["datasetOptions","hostname"]}),e.jsx(xe,{setIsFormChanged:r,label:"Authorization header key",placeholder:"Authorization header key",form:t,envIndex:a,name:["datasetOptions","headerKey"]}),e.jsx(xe,{setIsFormChanged:r,label:"Authorization header value",placeholder:"Authorization header value",form:t,envIndex:a,name:["datasetOptions","headerValue"]})]})}),Sr=me.memo(({editProjectModalId:t,setEditProjectModalId:a})=>{const r=Yt(R=>R.themesList),i=z.getState().workingProject,{name:p,theme:l,env:g,webXpanel:f,datasetOptions:v,debugOptions:d,archiveName:w,globalJoins:b}=i?.attributes??{},y={env:g,webXpanel:f,datasetOptions:v,debugOptions:d,archiveName:w,globalJoins:b,name:p,theme:l?.data.id},[S]=x.useForm(),j=x.useWatch("env",S),[D,I]=u.useState(!1),[A,O]=u.useState(!1),B=R=>{I(!0),t&&Ut({projectId:t,inputData:R}).then(()=>{O(!1),ce.success("Project settings saved")}).finally(()=>I(!1))},N=()=>{A?Jt({icon:e.jsx(pe,{}),title:"Exit project settings?",content:"Close without saving project settings?",okText:"Close without save",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>{I(!1),a(null)},onCancel:()=>{I(!1)}}):a(null)},{refreshSingleDataSource_signal_s_fb:J}=i?.attributes.globalJoins||{},Q=()=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{children:"Project Settings"}),e.jsx(P,{icon:e.jsx(Fn,{}),loading:D,disabled:!A,onClick:()=>{S.submit()},type:"primary",children:"Save Project Settings"})]}),ee=(R,T)=>{if(!i||!t)return;const H=[...j??[]];if(T==="add"){const W=an().format("YYYY-MM-DD_HH-mm"),m=Ht(),s={envName:"ENV_"+W,envId:m};H.push(s),S.setFieldValue("env",H),O(!0)}else if(T==="remove"&&typeof R=="string")try{const W=Number(R);H.splice(W,1),S.setFieldValue("env",H),O(!0)}catch(W){console.log(W)}},U=()=>{const R={label:"Default",key:"Default",forceRender:!0,children:e.jsx(Dt,{setIsFormChanged:O,form:S})},H=(j??[]).map((W,m)=>({label:W.envName||"no_name",key:String(m),forceRender:!0,children:e.jsx(Dt,{setIsFormChanged:O,form:S,envIndex:m})}));return[R,...H]};return i?e.jsx(Ba,{closable:!0,maskClosable:!0,width:"min(600px, 85vw)",title:e.jsx(Q,{}),placement:"right",onClose:()=>{N()},destroyOnClose:!0,open:t!==null,children:e.jsxs(x,{onValuesChange:R=>{O(!0),console.log(S.getFieldsValue())},style:{maxHeight:"100%",overflowY:"auto"},labelCol:{xs:{span:8}},wrapperCol:{xs:{span:14}},form:S,initialValues:y,onFinish:B,scrollToFirstError:!0,children:[e.jsx(x.Item,{colon:!1,required:!1,name:"name",label:"Name",rules:[{required:!0,message:"This field is required."}],children:e.jsx(G,{})}),e.jsx(x.Item,{colon:!1,required:!1,name:"theme",label:"Theme",rules:[{required:!0,message:"This field is required."}],children:e.jsx(Ne,{children:r?.map(R=>e.jsx(Cr,{value:R.id,children:R.attributes.name},R.id))})}),e.jsx(te,{plain:!0,orientation:"left",children:e.jsx("span",{style:{textTransform:"uppercase",fontSize:10,opacity:.7},children:"Global joins"})}),e.jsx(x.Item,{colon:!1,required:!1,name:["globalJoins","analogPageFlip_signal_a_fb"],label:"Analog flip page signal",children:e.jsx(G,{addonBefore:e.jsx("div",{style:{marginRight:0,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:"a"})}),placeholder:"Analog signal name"})}),e.jsx(x.Item,{colon:!1,required:!1,name:["globalJoins","serialPageFlip_signal_s_fb"],label:"Serial flip page signal",children:e.jsx(G,{addonBefore:e.jsx("div",{style:{marginRight:0,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:"s"})}),placeholder:"Serial signal name"})}),e.jsx(x.Item,{colon:!1,required:!1,name:["globalJoins","notification_signal_s_fb"],label:"Notification signal",children:e.jsx(G,{addonBefore:e.jsx("div",{style:{marginRight:0,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:"s"})}),placeholder:"Serial signal name"})}),e.jsx(x.Item,{colon:!1,required:!1,name:["globalJoins","refreshDataSources_signal_d_fb"],label:"Refresh All DataSources",children:e.jsx(G,{addonBefore:e.jsx("div",{style:{marginRight:0,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:"d"})}),placeholder:"Digital signal name"})}),e.jsx(x.Item,{colon:!1,initialValue:J,required:!1,name:["globalJoins","refreshSingleDataSource_signal_s_fb"],label:"Refresh Single DataSource",children:e.jsx(G,{addonBefore:e.jsx("div",{style:{marginRight:0,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:"s"})}),placeholder:"Serial signal name"})}),e.jsx(te,{plain:!0}),e.jsx("div",{style:{fontSize:14,fontWeight:500,paddingBottom:20},children:"Project Environments"}),e.jsx(x.List,{name:"env",children:()=>null}),e.jsx(_e,{destroyInactiveTabPane:!1,className:"envProjectTabs",size:"small",type:"editable-card",onEdit:ee,items:U()})]})}):null}),kr=({setNewGlobalContainerVisible:t,newGlobalContainerVisible:a})=>{const{projectId:r}=Y(),[i,p]=u.useState(!1),g=z(b=>b.workingProject)?.attributes.globalContainers;function f(b){return!g?.some(y=>y.name===b)}const[v]=x.useForm(),d=()=>{v.submit()},w=({name:b,visibleByDefault:y,position:S})=>{p(!0);let D=[{name:b||"Global Container",visibleByDefault:y===void 0?!0:y,visibleOnPages:[],hiddenOnPages:[],elements:[],useOrientation:!1,cssClass:"globalContainer",landscapePosition:S||"top",portraitPosition:S||"top",landscape:{flow:"row",padding:{value:void 0,unit:"%"},gap:{value:void 0,unit:"%"},align:"center",distribution:"center",border:null,size:{manualMode:!1,value:void 0,unit:"%"},backgroundColor:""},portrait:{flow:"row",padding:{value:void 0,unit:"%"},gap:{value:void 0,unit:"%"},align:"center",distribution:"center",border:null,size:{manualMode:!1,value:void 0,unit:"%"},backgroundColor:""}}];g&&Array.isArray(g)&&(D=[...g,...D]),r&&Ut({projectId:r,inputData:{globalContainers:D}}).then(()=>{t(!1)}).finally(()=>{p(!1)})};return e.jsx("div",{onKeyUp:b=>{b.key==="Enter"&&d()},children:e.jsx(oe,{afterClose:()=>v.resetFields(),maskClosable:!1,title:"Add New Global Container",open:!0,onCancel:()=>t(!1),footer:[e.jsx(P,{onClick:()=>t(!1),children:"Cancel"},"back"),e.jsx(P,{loading:i,type:"primary",onClick:d,children:"Add global container"},"submit")],children:e.jsxs(x,{labelCol:{xs:{span:8}},wrapperCol:{xs:{span:14}},form:v,onFinish:w,initialValues:{name:"Global Container",visibleByDefault:!0},scrollToFirstError:!0,children:[e.jsx(x.Item,{colon:!1,required:!1,label:"Name",name:"name",rules:[{required:!0,message:"This field is required."},()=>({validator(b,y){return y&&f(y)?Promise.resolve():Promise.reject(new Error("Container name must be unique"))}})],children:e.jsx(G,{})}),e.jsx(x.Item,{colon:!1,required:!1,name:"position",label:"Default Position",initialValue:"top",children:e.jsx(Ne,{style:{width:"100%"},options:[{value:"top",label:"Top"},{value:"right",label:"Right"},{value:"bottom",label:"Bottom"},{value:"left",label:"Left"}]})}),e.jsx(x.Item,{colon:!1,required:!1,name:"visibleByDefault",label:"Default Visibility",valuePropName:"checked",children:e.jsx(de,{checkedChildren:"Visible",unCheckedChildren:"Hidden"})})]})})})};var _r="newModificatorModal_dsTabs__hs8w7r0",At="newModificatorModal_modificatorModal__hs8w7r1",Nt="newModificatorModal_modificatorCreatingEditor__hs8w7r2",Tr="newModificatorModal_modificatorEditorsRow__hs8w7r3",Ir="newModificatorModal_createModificatorColumn__hs8w7r4",Mr="newModificatorModal_testModificatorColumn__hs8w7r5",Pr="newModificatorModal_argumentTabLabel__hs8w7r6";const Lr=({functionString:t})=>{const a={variablesUsed:[],statesUsed:[],datasourceUsed:[]};if(!t)return a;const r=t.replace(/\s+/g,"");if(/getVariableByName\(\{name:\s*([^\s'"]+)\}/.test(r))a.variablesUsed="*";else{const l=/getVariableByName\(\{name:\s*['"]([^'"]+)['"]\}\)/g,g=[];let f;for(;(f=l.exec(r))!==null;)g.push(f[1]);a.variablesUsed=[...new Set(g)]}return/window\?.avgatorStudio\?.getStoreValue/g.test(r)&&(a.statesUsed="*"),console.log("extractUsedDynamicFromFunction result",a),a},{Panel:Rt}=Re,Ge=function(a){return a.trim().toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,(r,i)=>i.toUpperCase())},Er=({setNewModificatorVisible:t,newModificatorVisible:a})=>{const r=typeof a=="number"?a:null,i=z.getState().workingProject?.attributes.modificators.data.find(n=>n.id===r),[p,l]=u.useState(!1),{projectId:g}=Y(),[f,v]=u.useState([]),[d]=x.useForm(),w=x.useWatch("name",d),b="RunFunction",[y,S]=u.useState(b),j=x.useWatch("argumentsTestData",d),{addValueToStore:D,getValueFromStore:I}=Qa.getState(),{setVariableNewValue:A}=nn.getState(),O=u.useRef(null),B=n=>{O.current=n,n.onKeyDown(h=>{const C=O.current&&O.current.getPosition().lineNumber,k=O.current&&O.current.getModel().getLineCount(),F=O.current.getSelection(),{startLineNumber:M,endLineNumber:L,selectionStartLineNumber:$}=F;(C===1||C===k||M===1||M===k||L===1||L===k||$===1||$===k)&&(h.stopPropagation(),h.preventDefault())})},N=u.useRef(null),J=n=>{N.current=n},Q=()=>`arg${j.length+1}`,ee=n=>{try{const h=[...j];h[n].testData="",d.setFieldsValue({argumentsTestData:h})}catch(h){console.log(h)}},U=()=>new Promise((n,h)=>{const C=d.getFieldValue("function");if(!C){h(new Error("No function found."));return}let k=!0;const F=j?.map(M=>{M?.testData||(k=!1);const L=M?.testData;try{return JSON.parse(L)}catch{return L}})||[];try{const M=bt(C);if(console.log("userFunction",M),k){let L=M(...F,yt(),D,I,A);typeof L=="object"?L=JSON.stringify(L):L=String(L),N.current?.getModel().setValue(L),n(L)}else n("No arguments")}catch(M){console.error("Error when calling finalFunction:",M);const L=`Error when calling ${Ge(w??"")}: ${M?.message}`;N.current?.getModel().setValue(L),h(M)}}),R=()=>new Promise((n,h)=>{const C=d.getFieldValue("function");if(!C){h(new Error("No function found."));return}const k=j?.map(F=>{const M=F?.testData;try{return JSON.parse(M)}catch{return M}})||[];try{let M=bt(C)(...k,yt(),D,I,A);typeof M=="object"?M=JSON.stringify(M):M=String(M),N.current?.getModel().setValue(M),n(M)}catch(F){console.error("Error when calling finalFunction:",F);const M=`Error when calling ${Ge(w??"")}: ${F?.message}`;N.current?.getModel().setValue(M),h(F)}}),T=()=>{if(y===b)return e.jsxs("div",{style:{paddingRight:17,display:"flex",gap:5},children:[e.jsx(P,{onClick:()=>{R().catch(C=>{console.log(C)})},icon:e.jsx(Pn,{}),ghost:!0,type:"primary",children:"Run"}),e.jsx(P,{onClick:()=>{N.current?.getModel().setValue("")},danger:!0,icon:e.jsx(ke,{}),type:"dashed"})]});const n=Number(y.split("_")[1]),h=!!j?.[n]?.testData;return e.jsx("div",{style:{paddingRight:17},children:e.jsx(P,{disabled:!h,onClick:()=>{ee(n)},danger:!0,icon:e.jsx(ke,{}),type:"dashed"})})};u.useEffect(()=>{if(y===b)return;const n=Number(y.split("_")[1]);j?.[n]||S(b)},[j,y]),u.useEffect(()=>{if(!w)return;const n=d.getFieldValue("function");if(!n)return;const h=j?.map(F=>F.name)??[],C=n.split(`
`),k=`function ${Ge(w)}(${h.join(",")}){`;C[0]=k,d.setFieldsValue({function:C.join(`
`)})},[d,w,j]);const H=u.useMemo(()=>{let n=[];return!j?.length||j?.some(h=>h===void 0)?n=[]:n=j?.map((h,C)=>({label:e.jsxs("div",{className:Pr,children:[e.jsx("small",{children:"test data"}),h.name]}),key:`argument_${C}`,children:e.jsx("div",{className:Nt,children:e.jsx(x.Item,{isListField:!0,preserve:!1,noStyle:!0,name:["argumentsTestData",C,"testData"],validateStatus:"success",normalize:k=>k===void 0?"":k,children:e.jsx(ye,{className:"monaco-editor",loading:e.jsx(je,{}),options:{readOnly:!1,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark"})},C)})})),[{label:"Test Function",key:"RunFunction",children:e.jsx("div",{className:Nt,children:e.jsx(ye,{value:"",onMount:J,className:"monaco-editor",language:"javascript",loading:e.jsx(je,{}),options:{readOnly:!0,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark",defaultLanguage:"javascript"})},"RunFunctionKey")},...n??[]]},[j]),W=()=>{d.submit()},m=({name:n,function:h,argumentsTestData:C})=>{l(!0),U().then(()=>{const k=Lr({functionString:h}),F={name:n||"New function",function:h,dynamicDataUsed:k};r?Xt({...F},r).then(()=>{t(!1)}):g&&tn(g,{...F,argumentsTestData:C}).then(()=>{t(!1)})}).catch(k=>{S(b),ce.error(`Function test failed: ${k.message}`),console.log(k)}).finally(()=>{l(!1)})},o=i?{name:i.attributes.name,function:i.attributes.function,argumentsTestData:i.attributes.function.substring(i.attributes.function.indexOf("(")+1,i.attributes.function.indexOf(")")).trim()===""?[]:i.attributes.function.substring(i.attributes.function.indexOf("(")+1,i.attributes.function.indexOf(")")).split(",").map(n=>({name:n.trim(),testData:null}))}:{name:"My function",function:[`function ${Ge("My function")}(){`,"//write your code here","","}"].join(`
`),argumentsTestData:[]},s=()=>f.length>0?e.jsx(ge,{trigger:"hover",title:"Validation error",content:"Function contains errors",children:e.jsx(pe,{style:{fontSize:14,margin:"0 0 0 5px",color:"red",cursor:"help"}})}):null,c=[{name:"Navigate",content:`
    //navigate - function to navigate by url path
    window?.avgatorStudio?.navigate("/path")
    //navigate - function to navigate by page name
    window?.avgatorStudio?.navigateToPage("my page name")
    `},{name:"Events",content:`
    //publishAnalog - function to publish analog signal
    window?.avgatorStudio?.publishAnalog({ signalName: "signalName", value: 1 })
    //publishDigital - function to publish digital signal
    window?.avgatorStudio?.publishDigital({ signalName: "signalName", value: true })
    //publishSerial - function to publish serial signal
    window?.avgatorStudio?.publishSerial({ signalName: "signalName", value: "value" })
    //getInstantDigitalFb - get instant digital feedback value
    window?.avgatorStudio?.getInstantDigitalFb({ signalName: "signalName", defaultValue: false })
    //getInstantAnalogFb - get instant analog feedback value
    window?.avgatorStudio?.getInstantAnalogFb({ signalName: "signalName", defaultValue: 0 })
    //getInstantSerialFb - get instant serial feedback value
    window?.avgatorStudio?.getInstantSerialFb({ signalName: "signalName", defaultValue: "text" })
      `},{name:"Get Datasource",content:`
    //getDatasource - function to get datasource value by uid. if no uid provided, returns all datasources
    const dataSource = window?.avgatorStudio?.getDatasource({ uid: '1234' });
      `},{name:"Variables",content:`
      //getVariableByName - function to get variable value by name
      const variableValue = window?.avgatorStudio?.getVariableByName({ name: 'variableName' });
      
      //setVariableByName - function to set variable value by name
      window?.avgatorStudio?.setVariableByName({ name: 'variableName', value: 'newValue' });
      `}];return e.jsx(oe,{className:At,destroyOnClose:!0,maskClosable:!1,centered:!0,title:"Add new function",open:!0,onCancel:()=>t(!1),onOk:W,footer:[e.jsx(P,{onClick:()=>t(!1),children:"Cancel"},"back"),e.jsx(P,{disabled:f.length>0,loading:p,type:"primary",onClick:()=>{d.submit()},children:f.length>0?"Function contains errors":"Save"},"submit")],children:e.jsxs(x,{onFinish:m,className:"modificatorForm",form:d,initialValues:o,scrollToFirstError:!0,children:[e.jsx(Re,{destroyInactivePanel:!1,expandIcon:({isActive:n})=>n?e.jsx($t,{}):e.jsx(Kt,{}),defaultActiveKey:["form"],ghost:!0,children:e.jsx(Rt,{forceRender:!0,header:"Function Settings",children:e.jsxs("div",{style:{display:"flex",gap:20,alignItems:"stretch",height:"100%",position:"relative"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx(x.Item,{colon:!1,required:!1,label:"Name",name:"name",rules:[{required:!0,message:"This field is required."},()=>({validator(n,h){return Promise.all([De({input:h,searchArray:[]}),st(h),ot(h||"")])}})],children:e.jsx(G,{spellCheck:!1})}),e.jsx(te,{plain:!0,orientationMargin:160,orientation:"left",children:"Function Arguments"}),e.jsx(x.List,{name:"argumentsTestData",children:(n,{add:h,remove:C})=>e.jsxs(e.Fragment,{children:[n.map((k,F)=>{const{key:M,...L}=k;return e.jsxs("div",{style:{display:"flex",gap:10,alignItems:"flex-start",marginBottom:15},children:[e.jsx(x.Item,{...L,label:`Argument #${F+1}`,name:[k.name,"name"],validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."},()=>({validator($,q){return Promise.all([De({input:q,searchArray:j.filter((ve,ie)=>ie!==F)||[],searchKey:"name"}),We(q),st(q),ot(q||"")])}})],style:{marginBottom:0,flex:1},children:e.jsx(G,{spellCheck:!1,autoFocus:!0})},M),e.jsx(_a,{style:{marginTop:10},onClick:()=>C(k.name)})]},k.key)}),e.jsx(x.Item,{label:" ",colon:!1,children:e.jsx(P,{type:"dashed",onClick:()=>h({name:Q(),testData:void 0}),style:{width:"100%"},block:!0,icon:e.jsx(Gt,{}),children:"Add Function Argument"})})]})})]}),e.jsx("div",{style:{minWidth:"50%",width:"50%",position:"relative",overflow:"auto",translate:"0 -10px"},children:e.jsx(Re,{ghost:!0,accordion:!0,children:c.map(n=>e.jsx(Rt,{header:n.name,children:e.jsx(Na,{wrapLongLines:!0,lineNumberContainerStyle:{display:"none"},lineNumberStyle:{display:"none"},style:{position:"relative",maxWidth:"100% !important",borderRadius:"3px"},language:"JavaScript",theme:"AtomOneDark",copy:!1,suppressContentWarning:!0,children:n.content})},n.name))})})]})},"form")}),e.jsxs("div",{className:Tr,children:[e.jsxs("div",{className:Ir,children:[e.jsxs(te,{plain:!0,orientationMargin:17,style:{paddingRight:17,marginBottom:9.5},orientation:"left",children:["Function Body editor",e.jsx(s,{})]}),e.jsx("div",{className:At,children:e.jsx(x.Item,{noStyle:!0,name:"function",dependencies:["name"],validateStatus:f.length?"error":void 0,rules:[()=>({validator(n,h){return f.length?Promise.reject():Promise.resolve()}})],normalize:n=>n===void 0?"":n,children:e.jsx(ye,{onMount:B,className:"monaco-editor",language:"javascript",loading:e.jsx(je,{}),options:{readOnly:!1,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0},showUnused:!0},theme:"vs-dark",defaultLanguage:"javascript",onValidate:n=>{v(n)}})})})]}),e.jsx("div",{className:Mr,children:e.jsx(_e,{className:_r,activeKey:y,onChange:n=>{S(n)},tabBarExtraContent:{right:e.jsx(T,{})},animated:!1,type:"card",items:H})})]})]})})},Fr=({setNewPageModalVisible:t,newPageModalVisible:a})=>{const r=z.getState().workingProject?.attributes.pages.data||[],{projectId:i}=Y(),[p,l]=u.useState(!1),[g]=x.useForm(),f=()=>{g.submit()},v=a==="subpage",d=x.useWatch("isStatic",g),w=({name:b,isStatic:y})=>{if(l(!0),!i)return Promise.reject("No projectId");const S=v&&y?200:void 0;return ka({name:b,project:i,isSubpage:v,isStatic:!!y,width:{width:{value:S,unit:"px"}},height:{height:{value:S,unit:"px"}}}).then(()=>t(null)).finally(()=>l(!1))};return e.jsx(oe,{width:600,afterClose:()=>g.resetFields(),maskClosable:!1,title:`Add new ${a}`,open:!0,onCancel:()=>t(null),footer:[e.jsx(P,{onClick:()=>t(null),children:"Cancel"},"back"),e.jsxs(P,{loading:p,type:"primary",onClick:f,children:["Add new ",a]},"submit")],children:e.jsxs(x,{labelCol:{xs:{span:9}},wrapperCol:{xs:{span:12}},form:g,initialValues:{name:"page name",url:"mypage"},onFinish:w,scrollToFirstError:!0,children:[e.jsx(x.Item,{colon:!1,required:!1,name:"name",label:"Name",rules:[{required:!0,message:"This field is required."},()=>({validator(b,y){return De({input:y,searchArray:r,searchKey:["attributes","name"]})}})],children:e.jsx(G,{})}),e.jsx(te,{}),e.jsx(x.Item,{colon:!1,required:!1,name:"isStatic",initialValue:!0,label:"Design paradigm",children:e.jsx(Ra,{children:({onChange:b,value:y,...S})=>e.jsx(Zt,{block:!0,style:{userSelect:"none"},onChange:j=>b(j==="true"),value:y?"true":"false",options:[{label:"Adaptive",value:"true",icon:e.jsx(it,{style:{height:"auto",minWidth:"1em",margin:"0 3px -1px 0"},isStatic:!0})},{label:"Responsive",value:"false",icon:e.jsx(it,{style:{height:"auto",minWidth:"1em",margin:"0 3px -1px 0"},isStatic:!1})}],...S})})}),e.jsx(te,{}),e.jsxs("div",{style:{color:"var(--ant-primary-5)",fontSize:12,marginBottom:4},children:[e.jsx(He,{style:{fontSize:14}})," How"," ",d?"adaptive":"responsive"," page layout works"]}),d?e.jsx("p",{style:{fontSize:12},children:"Adaptive page layout allow you arrange elements manually by dragging ones. Element's position & size doesn't affect each other but optionally may depends on screen size and still be adaptive."}):e.jsx("p",{style:{fontSize:12},children:"Responsive page layout based on flexbox css model and all containers on the page with all elements inside are responsive."})]})})},Dr=({setNewVariableModalVisible:t,newVariableModalVisible:a})=>{const r=a==="parameter",{projectId:i}=Y(),{pageId:p}=Y(),l=ht({pageId:p}),g=z(B=>B.workingProject),{variables:f=[]}=g?.attributes??{},{parameters:v=[]}=l?.attributes??{},[d]=x.useForm(),w=()=>{d.submit()},[b,y]=u.useState(!1),S=async({type:B,defaultValue_boolean:N,defaultValue_number:J,defaultValue_string:Q,name:ee,joinValueSetter_signal_fb:U,waitForLoadingUi:R})=>{let T={name:ee,type:B,joinValueSetter_signal_fb:U};switch(T.type){case"boolean":T={...T,defaultValue:N==="true",waitForLoadingUi:R};break;case"string":T={...T,defaultValue:Q};break;case"number":T={...T,defaultValue:J};break}y(!0);const H=T;try{await rn({actionType:"create",variableData:H,projectId:i,pageId:p}),d.resetFields(),t(null),ce.success("Successfully created")}catch(W){console.log("Error creating",W),ce.error(W)}finally{y(!1)}},j={name:r?"newParameter":"newVariable",type:"boolean",defaultValue_boolean:"false",defaultValue_number:0,defaultValue_string:"",joinValueSetter_signal_fb:"",waitForLoadingUi:!1},D={project:f,parameter:v},[I,A]=u.useState(j),O=u.useMemo(()=>r?"Create Subpage Parameter":"Create Project Variable",[r]);return a?e.jsx(e.Fragment,{children:e.jsx(oe,{maskClosable:!1,title:O,open:!0,width:"50vw",onOk:w,onCancel:()=>t(null),footer:[e.jsx(P,{onClick:()=>t(null),children:"Cancel"},"back"),e.jsxs(P,{loading:b,type:"primary",onClick:w,children:["Create ",r?"Parameter":"Variable"]},"submit")],children:e.jsxs(x,{onValuesChange:B=>A({...I,...B}),labelCol:{xs:{span:9}},wrapperCol:{xs:{span:12}},form:d,initialValues:j,onFinish:S,scrollToFirstError:!0,children:[e.jsx(x.Item,{colon:!1,name:"name",label:"Name",rules:[{required:!0,message:"This field is required."},()=>({validator(B,N){return Promise.all([De({input:N,searchArray:D[a],searchKey:"name"}),We(N),st(N),ot(N)])}})],children:e.jsx(G,{spellCheck:!1})}),e.jsx(x.Item,{colon:!1,name:"type",label:"Type",rules:[{required:!1}],children:e.jsxs(fe.Group,{className:"radioFullWidth",buttonStyle:"solid",children:[e.jsx(fe.Button,{value:"boolean",children:"Boolean"}),e.jsx(fe.Button,{value:"string",children:"String"}),e.jsx(fe.Button,{value:"number",children:"Number"})]})}),I.type==="string"&&e.jsx(x.Item,{colon:!1,name:"defaultValue_string",label:"Default Value",children:e.jsx(G,{spellCheck:!1})}),I.type==="boolean"&&e.jsxs(e.Fragment,{children:[e.jsx(x.Item,{colon:!1,name:"defaultValue_boolean",label:"Default Value",children:e.jsx(Zt,{block:!0,options:["true","false"]})}),a==="project"&&e.jsx(x.Item,{label:"Use for loading UI (exprerimental)",name:"waitForLoadingUi",colon:!1,required:!1,valuePropName:"checked",help:"UI will not started until this variable is false",children:e.jsx(de,{})})]}),I.type==="number"&&e.jsx(x.Item,{colon:!1,name:"defaultValue_number",label:"Default Value",rules:[()=>({validator(B,N){return Promise.all([fa(N),ga(N)])}})],children:e.jsx(G,{style:{width:"100%"}})}),!r&&I.type&&e.jsx(x.Item,{extra:e.jsx(e.Fragment,{children:"Use signal feedback to modify variable"}),colon:!1,name:"joinValueSetter_signal_fb",label:e.jsx(e.Fragment,{children:"Set value Signal "}),rules:[()=>({validator(B,N){return We(N)}})],children:e.jsx(G,{suffix:e.jsx("div",{style:{marginRight:-5,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:I.type,sub:"FB"})}),spellCheck:!1})})]})})}):null},Ar=({workingProject:t})=>{const a=u.useRef();u.useEffect(()=>{clearTimeout(a.current);const r=i=>{const{type:p}=i;p==="CLAIM"&&(console.log("Live project claimed"),pt({type:"LIVE",payload:t}))};return Ma(r),a.current=setTimeout(()=>{console.log("Updated project sent to live"),pt({type:"LIVE",payload:t})},500),()=>{Pa(r)}},[t])},Nr=u.lazy(()=>ct(()=>import("./moveable.esm-BYu0Krn6.js").then(t=>t.A),__vite__mapDeps([31,1,2]),import.meta.url)),Rr=()=>{const t=ut(E=>E.jwt),a=zt(),[r,i]=pa();La();const p=Ta();u.useEffect(()=>{if(r.size){let E=function(){i({})};const ne=r.get("paymentFeedback");if(ne)switch(ne){case"buyBuildError":oe.error({icon:null,maskClosable:!1,content:e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{color:"red",paddingBottom:5},children:e.jsx(pe,{})}),"We cannot process your payment. Please try again later."]}),okText:"Close",onOk:()=>E()});break;case"buyBuildOk":oe.success({icon:null,maskClosable:!1,content:e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{color:"green",paddingBottom:5},children:e.jsx(la,{})}),"Thank you for your purchase! Now project have unlimited builds."]}),okText:"Close",onOk:()=>E()});break;default:oe.error({icon:null,maskClosable:!1,content:e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{color:"red",paddingBottom:5},children:e.jsx(pe,{})}),"Unknown payment feedback: ",ne]}),okText:"Close",onOk:()=>E()}),console.error("Unknown payment feedback: ",ne);break}}return()=>{oe.destroyAll()}},[r,i]),Ot.interceptors.response.use(E=>E.data&&(E?.status===200||E?.status===201)?E:Promise.reject(E),E=>(E.response?.status===401&&nt(),Promise.reject(E)));const l=window.location.hostname;u.useEffect(()=>{l==="avstudio.app"&&Et.initialize("G-CJ806X6F1C")},[l]),u.useEffect(()=>{a.pathname&&l==="avstudio.app"&&Et.send({hitType:"pageview",page:a.pathname})},[l,a.pathname]),u.useEffect(()=>{t||p("/login")},[a.pathname,t,p]);const{projectId:g}=Y(),{pageId:f}=Y(),{ConfirmModal:v}=gr(),{fillProjectsList:d}=va.getState(),{fetchAndFill:w,resetWorkingProject:b,clearHistory:y}=z.getState(),S=z(E=>E.workingProject),j=u.useRef(!1);u.useEffect(()=>{function E(){Qe.destroy(),j.current=!1}async function ne(he){await fetch(he,{headers:{Pragma:"no-cache",Expires:"-1","Cache-Control":"no-cache"}}),window.location.href=he,window.location.reload()}if(!g&&t&&!j.current){const he=za.getState().fetchVersions;try{he().then(we=>{if(we?.length){const Ie="3.0.3",Ke=we?.[0],{version:le,text:Je}=Ke?.attributes??{};if(!Ie||!le)return;let Oe=!1;const Ze=Number(Ie.replace(/\./g,"")),_=Number(le.replace(/\./g,""));Ze<_&&(Oe=!0),Oe&&(j.current=!0,Qe.destroy(),Qe.info({message:"New version available",onClose:E,description:e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5},children:e.jsxs(mt,{children:["Current ",Ie," => New ",le]})}),Je," ",e.jsx(te,{style:{margin:"15px 0"}})," ",e.jsx(P,{onClick:()=>{ne(window.location.href)},style:{marginRight:5},type:"primary",children:"Refresh to update"}),e.jsx(P,{onClick:()=>E(),children:"Later"})]}),onClick:()=>{},placement:"top",duration:null}))}})}catch(we){console.log(we)}}},[g,t]),Ea({initVariableArr:S?.attributes.variables}),en({skipDsLoading:!1});const D=ht({pageId:f}),I=X(E=>E.showBoundingBox),{setMainMenuData:A}=X.getState(),{addNewTab:O,clearTabs:B}=z.getState(),N=ae.getState().setEnvState,J=X(E=>E.selectedMenuSection.elementIndex);u.useEffect(()=>{if(J===null){const E=ze.getState().setSelectedElementRef;E({current:null})}},[J]),u.useEffect(()=>{D?.attributes.isSubpage?A({isSubpageEditor:!0}):A({isSubpageEditor:!1})},[D?.attributes.isSubpage,A]),u.useEffect(()=>{D?.attributes.isStatic?(A({isStaticEditor:!0}),ce.info({content:"You are in adaptive editor mode",style:{position:"fixed",bottom:"50px",left:"50%",translate:"-50% 0"}})):A({isStaticEditor:!1})},[D?.attributes.isStatic,A]),Ar({workingProject:S}),u.useEffect(()=>{f&&N(I?"editor":"preview")},[f,N,I]),u.useEffect(()=>{f&&S&&O(f)},[O,f,S]),u.useLayoutEffect(()=>{if(!t)return;const E=Yt.getState().fetchAndFillThemesList;E();const ne=$e.getState().fetchTestDevices;ne()},[t]),u.useEffect(()=>{y()},[y,f]),u.useEffect(()=>{g||$a()},[g]);const Q=u.useRef(!1);u.useLayoutEffect(()=>{t&&(g?(S&&String(S.id)!==g&&b(),!S&&!Q.current&&(Q.current=!0,w(g).then(()=>{Q.current=!1}))):(d(),B(),y()))},[w,d,g,b,S?.id,B,y,S,t]);const[ee,U]=u.useState(null),[R,T]=u.useState(null),[H,W]=u.useState(null),[m,o]=u.useState(!1),[s,c]=u.useState(!1),[n,h]=u.useState(null),[C,k]=u.useState(!1),{CloneModal:F,setCloneItemModal:M}=vr(),L={editProjectModalId:ee,setEditProjectModalId:U,newPageModalVisible:R,setNewPageModalVisible:T,newGlobalContainerVisible:C,setNewGlobalContainerVisible:k,setNewDatasourceVisible:o,newDatasourceVisible:m,setNewModificatorVisible:c,newModificatorVisible:s,setEditModificator:h,editModificator:n,newVariableModalVisible:H,setNewVariableModalVisible:W,CloneModal:F,setCloneItemModal:M},$=ze(E=>E.selectedElementRef),q=X(E=>E.isStaticEditor),ve=ze(E=>E.staticEementsGuidesClasses),ie=ze(E=>E.activeStaticElementKey),Te=u.useMemo(()=>ve.filter(E=>E!==ie),[ie,ve]);return e.jsxs(e.Fragment,{children:[e.jsxs(qa,{children:[e.jsx(Ga,{children:e.jsx(hr,{setEditProjectModalId:U})}),e.jsx(Ha,{children:e.jsx(xa,{context:L})})]}),ee&&e.jsx(Sr,{editProjectModalId:ee,setEditProjectModalId:U},g+"_EditProjectModal"),R&&e.jsx(Fr,{newPageModalVisible:R,setNewPageModalVisible:T},g+"_NewPageModal"),H&&e.jsx(Dr,{setNewVariableModalVisible:W,newVariableModalVisible:H},g+"_NewVariableModal"),C&&e.jsx(kr,{setNewGlobalContainerVisible:k,newGlobalContainerVisible:C},g+"_NewGlobalContainerModal"),s&&e.jsx(Er,{setNewModificatorVisible:c,newModificatorVisible:s},g+"_NewModificatorModal"),m&&e.jsx(wr,{setNewDatasourceVisible:o,newDatasourceVisible:m},g+"_NewDatasourceModal"),F,e.jsx(v,{}),q&&e.jsx(u.Suspense,{fallback:e.jsx(Vt,{}),children:e.jsx(Nr,{target:I?$:null,zoom:1,snappable:!0,snapThreshold:5,snapContainer:".page",bounds:{left:0,top:0,right:0,bottom:0,position:"css"},isDisplaySnapDigit:!0,isDisplayInnerSnapDigit:!1,snapGap:!0,snapDirections:{top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0},elementSnapDirections:{top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0},dragTargetSelf:!1,elementGuidelines:Te,useMutationObserver:!0,origin:!1,throttleResize:0,throttleDrag:0,throttleRotate:0,startDragRotate:0,throttleDragRotate:0,draggable:!0,resizable:!1,scalable:!1,keepRatio:!0,rotatable:!1,padding:10,onDrag:E=>{const{target:ne,transform:he}=E;ne.style.transform=he}})})]})},ls=Object.freeze(Object.defineProperty({__proto__:null,default:Rr},Symbol.toStringTag,{value:"Module"}));export{ke as R,ls as m,Yt as u};
