import{j as e,R as C,r as I,a as g,ab as b}from"./index-CR7MAnCp.js";import{a as k,f as y}from"./confirm-D0g1-wZ1.js";import{M as h,u as v,B as p,m as F,a3 as w}from"./editorApp-DLWlunXz.js";import{n as D}from"./useCustomFonts-ltbbC3EP.js";import{g as N}from"./localActiveAPI-BcvpvDpS.js";import{T as x}from"./index-CGbxNHJV.js";const R=i=>h.info({icon:null,maskClosable:!0,content:e.jsx(e.Fragment,{children:i}),okText:"Close"}),B=({currentProject:i,selectFile:n,setSelectFile:f,renderAsModalPicker:l,style:u,setUploadState:o})=>{const s=i?.id,c=i?.attributes?.media?.data?.filter(t=>t.attributes.mime.includes("image"));return e.jsx(e.Fragment,{children:e.jsx(D,{style:u,children:c?.map(t=>{let a=t.id;try{const d=JSON.parse(t.attributes.alternativeText),{uuid:j}=d;j&&(a=j)}catch{}const{url:m}=N({imageId:t.id,project:i,renderEnvtype:"editor"});let r={};return t.id===n&&(r={borderColor:"var(--ant-primary-5)"}),i&&e.jsxs("div",{style:r,onClick:()=>l&&f(t.id),className:"thumb",children:[e.jsx("img",{className:"pic",src:m,alt:t.attributes.name}),e.jsxs(x,{className:"imgIDBox",children:["ID: ",a]}),!l&&e.jsxs("div",{className:"overlay",children:[e.jsx(F,{onClick:()=>{R(e.jsxs("div",{style:{display:"flex",flexFlow:"column",gap:10},children:[e.jsx("div",{children:e.jsxs(x,{className:"imgIDBox",children:["ID: ",a]})}),e.jsx("img",{className:"pic",src:m,alt:t.attributes.name})]}))}}),e.jsx(k,{onClick:()=>{y({icon:e.jsx(b,{}),title:"Remove media file?",content:`Please confirm removing ${t.attributes.name} from project media library`,okText:"Delete",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>{s&&o&&(o("removing"),w(s,t.id).then(()=>{o(""),g.success("File deleted")}).catch(()=>{g.error("Failed to delete file")}))},onCancel:()=>{}})}})]})]},t.id)})})})},G=C.memo(({style:i,renderAsModalPicker:n,uploadState:f,setUploadState:l})=>{const u=v(d=>d.workingProject),[o,s,c]=n||[],[t,a]=I.useState(null);function m(){c&&c(t),s&&s(!1)}const r=e.jsx(B,{style:i,setSelectFile:a,selectFile:t,renderAsModalPicker:n,currentProject:u,uploadState:f,setUploadState:l});return n!==void 0?e.jsx(h,{destroyOnClose:!0,maskClosable:!1,title:"Pick Image",open:o,onCancel:()=>s&&s(!1),footer:[e.jsx(p,{onClick:()=>{a(null),s&&s(!1)},children:"Cancel"},"back"),e.jsx(p,{disabled:t===null,type:"primary",onClick:()=>m(),children:"Pick Image"},"submit")],children:r}):e.jsxs(e.Fragment,{children:[" ",r]})});export{G as P,R as s};
