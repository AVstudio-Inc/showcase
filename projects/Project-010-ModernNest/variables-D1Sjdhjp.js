const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./actionsOptions-Cl4qpaJT.js","./main-DkRMjw9y.js","./main-3L8nLUGM.css","./EditableCell-jNDaMm8d.js","./EditOutlined-DWCmQkXB.js","./index-CMItvqjf.js","./Table-CGliJgNY.js","./PlusSquareOutlined-CabPYtdb.js","./index-Com_Q53J.js","./audioTable-k01oRLlp.js","./audioTable-Bu9W_eGQ.css","./CaretRightOutlined-CqwQ7H5O.js","./actionsOptions-BEisVOYx.css"])))=>i.map(i=>d[i]);
import{w as S,ae as T,r as c,cT as w,j as e,W as _,g as k,bW as A,f as R,P as E,bL as L,ai as O,ao as D,Y as N,Z as B,J as U,i as $,O as v,N as M,G,B as W,H as C,m as z}from"./main-DkRMjw9y.js";import{E as F}from"./EditableCell-jNDaMm8d.js";import{u as H,T as J}from"./useTableFilter-Dpb7__Pv.js";import{P as Y}from"./Styles-DhTUTepm.js";import{T as Z}from"./index-Dam0v-Ch.js";import{b as q}from"./Table-CGliJgNY.js";import"./EditOutlined-DWCmQkXB.js";import"./index-CMItvqjf.js";import"./PlusSquareOutlined-CabPYtdb.js";const K=S.memo(({functionUid:o,onChange:p,formatterFunctions:i,type:g})=>{const x=T(u=>u.compiledUserFunctions),j=c.useMemo(()=>{const u=i?.map(b=>{const{uid:n,name:m}=b;return{label:m,value:n}}),f=Object.values(x??{}).map(b=>{const{uid:n,name:m}=b;return{label:m,value:n}});return[{label:"Predefined formatters",options:u},{label:"User functions",options:f}]},[x,i]),l=w({functionUid:o,type:g}),{description:d}=l??{},h=c.useMemo(()=>o&&!l?"deleted":o,[l,o]),y=l?"":"notformatted";return e.jsxs(e.Fragment,{children:[e.jsx(_,{className:y,allowClear:!0,style:{width:"100%"},placeholder:"Attach formatter function",showSearch:!0,filterOption:(u,f)=>f.label.toLowerCase().includes(u.toLowerCase()),value:h,options:j,onChange:p}),e.jsx("div",{style:{fontSize:"10px",color:"gray",paddingTop:"3px"},children:d})]})}),Q=c.lazy(()=>z(()=>import("./actionsOptions-Cl4qpaJT.js").then(o=>o.c),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url)),{Title:X}=Z,ee={project:{title:"Project Variables",buttonText:e.jsxs(e.Fragment,{children:[e.jsx(C,{})," Add Project Variable"]})},page:{title:"Page Parameters",buttonText:e.jsxs(e.Fragment,{children:[e.jsx(C,{})," Add Page Parameter"]})},subpage:{title:"Subpage Parameters",buttonText:e.jsxs(e.Fragment,{children:[e.jsx(C,{})," Add Subpage Parameter"]})}},ue=S.memo(({tableFor:o})=>{const{projectId:p,pageId:i}=k(),{setNewVariableModalVisible:g}=A(),{title:x,buttonText:j}=ee[o],l=R(a=>{const r=a.workingProject?.attributes;return r?o==="project"?r.variables??[]:r.pages.data?.find(t=>t.id===i)?.attributes.parameters??[]:[]}),[d,h,y,u]=H({key:"variableFilter",projectId:p,pageId:i}),f=c.useCallback((a,r)=>{const t=a.name.toLowerCase(),s=r.name.toLowerCase();return t<s?-1:t>s?1:0},[]),b=[{title:e.jsx(J,{setValue:h,value:d}),dataIndex:"name",sorter:f,sortOrder:u("name","ascend"),className:"nowrap"},{title:"Type",dataIndex:"type"},{title:"Default Value",dataIndex:"defaultValue"},{title:"Signal FB Setter",dataIndex:"joinValueSetter_signal_fb"},{title:"Formatter function",dataIndex:"formatValueFunctionUid",className:"formatterCell"},{title:e.jsxs(e.Fragment,{children:["Side Effect Actions",e.jsx(E,{placement:"top",title:"Reactivity",content:e.jsx("div",{style:{width:"250px"},children:"Run actions when value has been changed."}),trigger:"hover",children:e.jsx(L,{style:{marginLeft:7}})})]}),dataIndex:"sideEffects",className:"sideEffectsCell"},{title:"Controls",dataIndex:"controls",width:100}],n=c.useCallback((a,r)=>O({projectId:p,pageId:i,variableData:a,actionType:r}),[i,p]),m=c.useCallback(({formatValueFunctionUid:a,variableData:r})=>{n({...r,formatValueFunctionUid:a},"update")},[n]),V=T(a=>a.formatterFunctions),P=c.useMemo(()=>{const a=[],r=d?l.filter(t=>t.name.toLowerCase().includes(d.toLowerCase().trim())):l;for(const t of r)a.push({key:`variable_${t.name}`,name:t.name,type:e.jsx(e.Fragment,{children:e.jsx(v,{crestronLikeTypesNaming:!1,style:{margin:1},type:t.type})}),defaultValue:e.jsx(F,{onChange:s=>n({...t,defaultValue:s},"update"),initialValue:t.defaultValue,value:t.defaultValue}),joinValueSetter_signal_fb:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(v,{style:{margin:1},type:t.type,sub:"FB"}),e.jsx(F,{style:{marginLeft:".5em"},onChange:s=>n({...t,joinValueSetter_signal_fb:s},"update"),initialValue:t.joinValueSetter_signal_fb??"",value:t.joinValueSetter_signal_fb??"",validators:[s=>M(s).catch(I=>(G.error(I.message),Promise.reject()))]})]}),formatValueFunctionUid:e.jsx(K,{type:t.type,onChange:s=>m({variableData:t,formatValueFunctionUid:s}),functionUid:t.formatValueFunctionUid,formatterFunctions:V[t.type]}),sideEffects:e.jsx(c.Suspense,{fallback:e.jsx($,{}),children:e.jsx(Q,{actionsArr:t?.actions??[],elementType:"variable",variableActionFor:t})}),controls:e.jsx(D.Button,{menu:{items:[{key:"removeVariable",danger:!0,icon:e.jsx(U,{}),label:"Delete",onClick:()=>N({title:`Delete ${t.name}?`,icon:e.jsx(B,{}),content:"Are you sure? It cannot be undone.",okText:"Delete",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>n(t,"delete"),onCancel:()=>console.log("cancel variable delete")})}]}})});return a},[V,m,n,l,d]);return e.jsxs(Y,{id:"Global Containers",children:[e.jsx(X,{id:"Variables",style:{margin:"15px 0"},level:5,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("span",{children:[x," (",l?.length,")"]}),e.jsx(W,{type:"primary",onClick:()=>g(i?"parameter":"project"),children:j})]})}),e.jsx("div",{className:"scrollingTable",children:e.jsx(q,{className:"showScrollbars",columns:b,dataSource:P||[],pagination:!1,onChange:(a,r,t)=>{y(t)}})})]})});export{ue as default};
