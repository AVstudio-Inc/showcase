import{j as e,R as C,r as I,a as g,aa as b}from"./index-CaqiBWD3.js";import{a as k,f as y}from"./confirm-Bux8TUvH.js";import{M as h,u as v,B as p,m as F,a3 as w}from"./editorApp-DZMui-50.js";import{q as D}from"./useCustomFonts-Bu6XhDHJ.js";import{g as N}from"./localActiveAPI-BM1IHP6l.js";import{T as x}from"./index-BzblAUWm.js";const R=a=>h.info({icon:null,maskClosable:!0,content:e.jsx(e.Fragment,{children:a}),okText:"Close"}),B=({currentProject:a,selectFile:o,setSelectFile:f,renderAsModalPicker:l,style:u,setUploadState:n})=>{const s=a?.id,c=a?.attributes?.media?.data?.filter(t=>t.attributes.mime.includes("image"));return e.jsx(e.Fragment,{children:e.jsx(D,{style:u,children:c?.map(t=>{let i=t.id;try{const d=JSON.parse(t.attributes.alternativeText),{uuid:j}=d;j&&(i=j)}catch{}const{url:m}=N({imageId:t.id,project:a,renderEnvtype:"editor"});let r={};return t.id===o&&(r={borderColor:"var(--ant-primary-5)"}),a&&e.jsxs("div",{style:r,onClick:()=>l&&f(t.id),className:"thumb",children:[e.jsx("img",{className:"pic",src:m,alt:t.attributes.name}),e.jsxs(x,{className:"imgIDBox",children:["ID: ",i]}),!l&&e.jsxs("div",{className:"overlay",children:[e.jsx(F,{onClick:()=>{R(e.jsxs("div",{style:{display:"flex",flexFlow:"column",gap:10},children:[e.jsx("div",{children:e.jsxs(x,{className:"imgIDBox",children:["ID: ",i]})}),e.jsx("img",{className:"pic",src:m,alt:t.attributes.name})]}))}}),e.jsx(k,{onClick:()=>{y({icon:e.jsx(b,{}),title:"Remove media file?",content:`Please confirm removing ${t.attributes.name} from project media library`,okText:"Delete",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>{s&&n&&(n("removing"),w(s,t.id).then(()=>{n(""),g.success("File deleted")}).catch(()=>{g.error("Failed to delete file")}))},onCancel:()=>{}})}})]})]},t.id)})})})},G=C.memo(({style:a,renderAsModalPicker:o,uploadState:f,setUploadState:l})=>{const u=v(d=>d.workingProject),[n,s,c]=o||[],[t,i]=I.useState(null);function m(){c&&c(t),s&&s(!1)}const r=e.jsx(B,{style:a,setSelectFile:i,selectFile:t,renderAsModalPicker:o,currentProject:u,uploadState:f,setUploadState:l});return o!==void 0?e.jsx(h,{destroyOnClose:!0,maskClosable:!1,title:"Pick Image",open:n,onCancel:()=>s&&s(!1),footer:[e.jsx(p,{onClick:()=>{i(null),s&&s(!1)},children:"Cancel"},"back"),e.jsx(p,{disabled:t===null,type:"primary",onClick:()=>m(),children:"Pick Image"},"submit")],children:r}):e.jsxs(e.Fragment,{children:[" ",r]})});export{G as P,R as s};
