import{r as g,K as $,f as S,j as e,ac as F,aa as I,a as A,ad as E}from"./index-CaqiBWD3.js";import{i as z,a as O,h as C,P as U,u as k}from"./pageAPI-DlCcwu0D.js";import{d as J}from"./deletePage-zSgO_q0c.js";import{d as W,u as Y,f as H,J as G,D as w,B as u,y as K,v as T,T as q}from"./editorApp-DZMui-50.js";import{E as D}from"./EditableCell-BYILAC5w.js";import{R as L}from"./renderActionTag-AacAROej.js";import{P as Q,D as X}from"./driverGuideButton-bXQQAZca.js";import{T as Z}from"./tableFieldSearchInput-CUkkEkpG.js";import{a as h}from"./dayjs.min-DduH2p7R.js";import{OneProjectGuideContext as ee}from"./oneProject-DpW_QMV0.js";import{P as V}from"./index-DwV6AUp4.js";import{D as te,a as ae,j as se}from"./confirm-Bux8TUvH.js";import{R as ie}from"./DiffOutlined-CoQG7-xX.js";import{T as re}from"./index-BzblAUWm.js";import{T as ne}from"./index-9gNDCDRB.js";import"./localActiveAPI-BM1IHP6l.js";import"./___vite-browser-external_commonjs-proxy-BovDvJPF.js";import"./index-vWj0pZVz.js";import"./useCustomFonts-Bu6XhDHJ.js";import"./calcMediaUrl-BnxoRVw_.js";var le={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 305H624V192c0-17.7-14.3-32-32-32H184v-40c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v784c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V640h248v113c0 17.7 14.3 32 32 32h416c17.7 0 32-14.3 32-32V337c0-17.7-14.3-32-32-32z"}}]},name:"flag",theme:"filled"},oe=function(c,f){return g.createElement($,S(S({},c),{},{ref:f,icon:le}))},_=g.forwardRef(oe);const{Title:de}=ne,De=()=>{const m=W(),[c,f]=g.useState(),i=Y(n=>n.workingProject),R=!z({project:i}),{projectId:l}=H(),{setNewPageModalVisible:j,setEditProjectModalId:b}=G(),[x,P]=g.useState(null),y=g.useMemo(()=>{const n=[],d=i?.attributes.pages.data?.filter(r=>!r.attributes?.isSubpage);for(const r of d??[]){const s=r.attributes.pageFlips?.analogPageFlipValue;s!=null&&n.push(s)}return n},[i?.attributes.pages.data]),B=[{title:e.jsxs(Q,{children:[e.jsx(Z,{value:c,setValue:f}),e.jsx("div",{style:{paddingRight:10},children:e.jsx(V,{content:e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("div",{children:"Project page flip serial signal name"}),e.jsx(L,{style:{margin:"0 3px 0 0"},crestronLikeTypesNaming:!0,type:"s",sub:"signal name"})," ",e.jsx("strong",{children:i?.attributes.globalJoins?.serialPageFlip_signal_s_fb||"not set"}),e.jsx(w,{style:{margin:"15px 0 10px 0"}}),e.jsx("div",{children:e.jsx(u,{block:!0,style:{marginTop:10},type:"dashed",size:"small",onClick:()=>i&&b(i.id),children:"Open project settings"})})]})}),title:"Page flip serial",children:i?.attributes.globalJoins?.serialPageFlip_signal_s_fb?e.jsx(F,{style:{color:"#0eae23",marginLeft:"0.6em"}}):e.jsx(I,{style:{color:"#ff6d24",marginLeft:"0.6em"}})})})]}),dataIndex:"name",sorter:(n,d)=>{const r=n.name.props.initialValue.toLowerCase(),s=d.name.props.initialValue.toLowerCase();return r<s?-1:r>s?1:0},defaultSortOrder:"ascend"},{title:e.jsx(e.Fragment,{children:"Design paradigm"}),dataIndex:"layoutMode"},{title:e.jsxs(e.Fragment,{children:["Analog flip ID",e.jsx(V,{content:e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("div",{children:"Project page flip analog signal name"}),e.jsx(L,{style:{margin:"0 3px 0 0"},crestronLikeTypesNaming:!0,type:"a",sub:"signal name"})," ",e.jsx("strong",{children:i?.attributes.globalJoins?.analogPageFlip_signal_a_fb||"not set"}),e.jsx(w,{style:{margin:"15px 0 10px 0"}}),e.jsx("div",{children:e.jsx(u,{block:!0,style:{marginTop:10},type:"dashed",size:"small",onClick:()=>i&&b(i.id),children:"Open project settings"})})]})}),title:"Page flip analog",children:i?.attributes.globalJoins?.analogPageFlip_signal_a_fb?e.jsx(F,{style:{color:"#0eae23",marginLeft:"0.6em"}}):e.jsx(I,{style:{color:"#ff6d24",marginLeft:"0.6em"}})})]}),dataIndex:"analogFlip"},{title:"Updated",dataIndex:"updated",sorter:(n,d)=>{const r=h(n.updated),s=h(d.updated);return r.isBefore(s)?-1:r.isAfter(s)?1:0},render:n=>e.jsx(e.Fragment,{children:h(n).format("MMM D, YYYY, h:mm A")})},{title:"Subpages Used",dataIndex:"subUsed"},{title:"Actions",dataIndex:"actions",width:100}];g.useEffect(()=>{function n(s){let t=null;return String(s)===String(i?.attributes.startPage)&&(t=e.jsx(q,{placement:"topLeft",title:"This is Start Page",children:e.jsx(_,{})})),t}function d(s){const t=[];for(const a of s.attributes.containers??[])for(const o of a.elements)if(o.type==="subpage"||o.type==="subpageList"){const p=i?.attributes.pages.data.find(N=>N.id===o.subpageId)?.attributes.name;t.push({id:o.subpageId,name:p||"No name"})}return t.length?t.map((a,o)=>e.jsx(u,{onClick:p=>C({pageId:a.id,navigate:m,evt:p,projectId:l}),type:"dashed",size:"small",children:a.name},`${a.id}_${o}`)):null}let r=i?.attributes.pages.data?.filter(s=>!s.attributes.isSubpage);if(r?.length){c&&(r=r.filter(t=>{const a=t.attributes.name;if(!a)return!1;const o=a.trim().toLowerCase(),p=c.trim().toLowerCase();return o.includes(p)}));const s=[];for(const t of r)s.push({pageID:t.id,key:`page_${t.id}`,name:e.jsx(D,{onChange:a=>a&&l&&k({pageId:t.id,inputData:{name:a}}),initialValue:t.attributes.name,value:e.jsxs(e.Fragment,{children:[n(t.id)," ",t.attributes.name]}),validators:[a=>T({input:a,searchArray:r||[],searchKey:["attributes","name"]}).catch(o=>(A.error(o.message),Promise.reject()))]}),analogFlip:e.jsx(e.Fragment,{children:e.jsx(D,{onChange:a=>l&&k({pageId:t.id,inputData:{pageFlips:{...t.attributes.pageFlips,analogPageFlipValue:a}}}),initialValue:t.attributes.pageFlips?.analogPageFlipValue??null,value:t.attributes.pageFlips?.analogPageFlipValue??null,validators:[a=>T({input:a,searchArray:y})]})}),layoutMode:e.jsx(re,{icon:e.jsx(U,{style:{height:"auto",minWidth:"1em",margin:"0 3px -1px 0"},isStatic:t.attributes?.isStatic}),children:t.attributes?.isStatic?"adaptive":"responsive"}),updated:t.attributes.updatedAt,subUsed:e.jsx("div",{style:{display:"flex",gap:5,flexWrap:"wrap"},children:d(t)}),actions:e.jsxs(te.Button,{onClick:a=>C({pageId:t.id,navigate:m,evt:a,projectId:l}),menu:{items:[t.attributes.isSubpage?null:{key:"startPage",icon:e.jsx(_,{}),label:"Mark as Start Page",onClick:()=>l&&K({projectId:l,inputData:{startPage:`${t.id}`}})},{key:"clonePage",icon:e.jsx(ie,{}),label:"Clone Page",onClick:()=>l&&O({pageCloneData:t})},{key:"remove",danger:!0,icon:e.jsx(ae,{}),label:"Delete Page",onClick:()=>l&&J({pageId:t.id,projectId:l,name:t.attributes.name})}]},children:[e.jsx("svg",{style:{marginRight:3,marginBottom:-2},xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M6 2c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-1.9l10-10V8l-6-6zm7 1.5L18.5 9H13zm7.1 9.5c-.1 0-.3.1-.4.2l-1 1l2.1 2.1l1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-2 1.8L12 20.9V23h2.1l6.1-6.1z"})}),"Open in Editor"]})});P(s)}else P([])},[m,l,i,c,y]);const M=g.useContext(ee),v="PagesSection";return e.jsxs("div",{id:v,children:[e.jsx(de,{id:"Pages",style:{margin:"15px 0"},level:5,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:["Pages",e.jsx(X,{guide:M,guideStartTargetElement:`#${v}`})]}),!!x?.length&&R&&e.jsxs("div",{style:{fontWeight:"normal",textTransform:"uppercase",fontSize:10,borderRadius:5,background:"#fff",padding:"5px 7px",border:"0.5px var(--ant-primary-5) dashed"},children:[e.jsx(E,{style:{color:"var(--ant-primary-5)"}})," ","No start page found, please set one"]}),e.jsx(u,{onClick:()=>j("page"),children:"Create New Page"})]})}),x?e.jsxs(e.Fragment,{children:[e.jsx(se,{showSorterTooltip:!1,columns:B,dataSource:x,pagination:!1}),e.jsx(u,{style:{marginTop:15},type:"primary",onClick:()=>j("page"),children:"Create New Page"})]}):null]})};export{De as default};
