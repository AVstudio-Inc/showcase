const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./actionsOptions-C4B1rCEu.js","./main-BKM2fIwG.js","./main-BS2GFsH7.css","./EditableCell-cqK7iS5z.js","./EditOutlined-_GB9OZ1y.js","./index-Aazyqc20.js","./DownOutlined-BZ_0tHYf.js","./Table-DlRpDtjF.js","./PlusSquareOutlined-DN4XdNMT.js","./formItemPropsWrapper-I6w9mx6V.js","./audioTable-hV8HCeGu.js","./audioTable-Bu9W_eGQ.css","./actionsOptions-B5GE1QQX.css"])))=>i.map(i=>d[i]);
import{E as T,r as l,j as e,g as I,bS as w,f as _,W as k,bL as A,an as E,ak as R,as as L,a0 as O,y as D,Q as N,i as B,V as v,U as $,z as M,B as z,P as y,m as U}from"./main-BKM2fIwG.js";import{E as S}from"./EditableCell-cqK7iS5z.js";import{u as W,T as G}from"./useTableFilter-CF3g0AgZ.js";import{S as Q}from"./PlusSquareOutlined-DN4XdNMT.js";import{P as q}from"./Styles-CgWqeJi4.js";import{T as H}from"./index-DxXoshz8.js";import{b as J}from"./Table-DlRpDtjF.js";import"./EditOutlined-_GB9OZ1y.js";import"./index-Aazyqc20.js";import"./DownOutlined-BZ_0tHYf.js";const K=T.memo(({functionUid:s,onChange:f,formatterFunctions:n})=>{const g=l.useCallback(i=>i?n.find(x=>x.uid===i):void 0,[n]),b=l.useMemo(()=>n?.length?[{label:"Predefined formatters",options:n.map(m=>{const{uid:x,name:h}=m;return{label:h,value:x}})}]:[],[n]),c=l.useMemo(()=>g(s),[s,g]),{description:u}=c??{},d=l.useMemo(()=>s&&!c?"deleted":s,[c,s]),j=c?"":"notformatted";return e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:j,allowClear:!0,style:{width:"100%"},placeholder:"Attach formatter function",showSearch:!0,filterOption:(i,m)=>m.label.toLowerCase().includes(i.toLowerCase()),value:d,options:b,onChange:f}),e.jsx("div",{style:{fontSize:"10px",color:"gray",paddingTop:"3px"},children:u})]})}),X=l.lazy(()=>U(()=>import("./actionsOptions-C4B1rCEu.js").then(s=>s.v),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url)),{Title:Y}=H,Z={project:{title:"Project Variables",buttonText:e.jsxs(e.Fragment,{children:[e.jsx(y,{})," Add Project Variable"]})},page:{title:"Page Parameters",buttonText:e.jsxs(e.Fragment,{children:[e.jsx(y,{})," Add Page Parameter"]})},subpage:{title:"Subpage Parameters",buttonText:e.jsxs(e.Fragment,{children:[e.jsx(y,{})," Add Subpage Parameter"]})}},ue=T.memo(({tableFor:s})=>{const{projectId:f,pageId:n}=I(),{setNewVariableModalVisible:g}=w(),{title:b,buttonText:c}=Z[s],u=_(a=>{const r=a.workingProject?.attributes;return r?s==="project"?r.variables??[]:r.pages.data?.find(t=>t.id===n)?.attributes.parameters??[]:[]}),[d,j,i,m]=W({key:"variableFilter",projectId:f,pageId:n}),x=l.useCallback((a,r)=>{const t=a.name.toLowerCase(),o=r.name.toLowerCase();return t<o?-1:t>o?1:0},[]),h=[{title:e.jsx(G,{setValue:j,value:d}),dataIndex:"name",sorter:x,sortOrder:m("name","ascend"),className:"nowrap"},{title:"Type",dataIndex:"type"},{title:"Default Value",dataIndex:"defaultValue"},{title:"Signal FB Setter",dataIndex:"joinValueSetter_signal_fb"},{title:"Formatter function",dataIndex:"formatValueFunctionUid",className:"formatterCell"},{title:e.jsxs(e.Fragment,{children:["Side Effect Actions",e.jsx(k,{placement:"top",title:"Reactivity",content:e.jsx("div",{style:{width:"250px"},children:"Run actions when value has been changed."}),trigger:"hover",children:e.jsx(A,{style:{marginLeft:7}})})]}),dataIndex:"sideEffects",className:"sideEffectsCell"},{title:"Controls",dataIndex:"controls",width:100}],p=l.useCallback((a,r)=>E({projectId:f,pageId:n,variableData:a,actionType:r}),[n,f]),C=l.useCallback(({formatValueFunctionUid:a,variableData:r})=>{p({...r,formatValueFunctionUid:a},"update")},[p]),V=R(a=>a.formatterFunctions),F=l.useMemo(()=>{const a=[],r=d?u.filter(t=>t.name.toLowerCase().includes(d.toLowerCase().trim())):u;for(const t of r)a.push({key:`variable_${t.name}`,name:t.name,type:e.jsx(e.Fragment,{children:e.jsx(v,{crestronLikeTypesNaming:!1,style:{margin:1},type:t.type})}),defaultValue:e.jsx(S,{onChange:o=>p({...t,defaultValue:o},"update"),initialValue:t.defaultValue,value:t.defaultValue}),joinValueSetter_signal_fb:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(v,{style:{margin:1},type:t.type,sub:"FB"}),e.jsx(S,{style:{marginLeft:".5em"},onChange:o=>p({...t,joinValueSetter_signal_fb:o},"update"),initialValue:t.joinValueSetter_signal_fb??"",value:t.joinValueSetter_signal_fb??"",validators:[o=>$(o).catch(P=>(M.error(P.message),Promise.reject()))]})]}),formatValueFunctionUid:e.jsx(K,{onChange:o=>C({variableData:t,formatValueFunctionUid:o}),functionUid:t.formatValueFunctionUid,formatterFunctions:V[t.type]}),sideEffects:e.jsx(l.Suspense,{fallback:e.jsx(B,{}),children:e.jsx(X,{actionsArr:t?.actions??[],elementType:"variable",variableActionFor:t})}),controls:e.jsx(L.Button,{menu:{items:[{key:"removeVariable",danger:!0,icon:e.jsx(N,{}),label:"Delete",onClick:()=>O({title:`Delete ${t.name}?`,icon:e.jsx(D,{}),content:"Are you sure? It cannot be undone.",okText:"Delete",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>p(t,"delete"),onCancel:()=>console.log("cancel variable delete")})}]}})});return a},[V,C,p,u,d]);return e.jsxs(q,{id:"Global Containers",children:[e.jsx(Y,{id:"Variables",style:{margin:"15px 0"},level:5,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("span",{children:[b," (",u?.length,")"]}),e.jsx(z,{type:"primary",onClick:()=>g(n?"parameter":"project"),children:c})]})}),e.jsx("div",{className:"scrollingTable",children:e.jsx(J,{className:"showScrollbars",columns:h,dataSource:F||[],pagination:!1,onChange:(a,r,t)=>{i(t)}})})]})});export{ue as default};
