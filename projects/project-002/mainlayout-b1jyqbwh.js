const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./undoRedo-BnfKpAU6.js","./main-BKM2fIwG.js","./main-BS2GFsH7.css","./renderGuides-Dj2i6UDx.js","./PlusSquareOutlined-DN4XdNMT.js","./EditOutlined-_GB9OZ1y.js","./DownOutlined-BZ_0tHYf.js","./renderGuides-BO9_zmax.css","./Styles-BqtYWpHV.js","./index-Aazyqc20.js","./formItemPropsWrapper-I6w9mx6V.js","./SettingOutlined-CvJ3130u.js","./modificatorAPI-D74AIDqr.js","./pageAPI-DkFp6Yf6.js","./index-B2WlvB3G.js","./newProjectModal-BzeU1zvB.js"])))=>i.map(i=>d[i]);
import{r as h,I as he,_ as $,n as Sn,o as At,p as rn,s as kn,q as _n,g as te,j as e,F as v,M as le,B as F,t as Fn,v as Pn,w as kt,f as V,x as Tn,y as be,z as je,A as In,E as K,G as Ze,H as z,J as vt,K as Ie,S as me,N as _e,D as Q,O as et,P as _t,Q as Ft,T as qe,U as Xe,V as Ce,W as ue,X as Ve,Y as xt,Z as Ee,$ as on,a0 as ln,a1 as He,a2 as Mn,a3 as En,a4 as An,a5 as Lt,i as ve,a6 as Be,a7 as cn,a8 as Ye,a9 as Ln,aa as Nt,ab as Nn,ac as Dn,ad as Rn,ae as jt,af as bt,ag as On,ah as dn,ai as Vn,aj as Bn,ak as zn,al as Wn,am as qn,an as Hn,ao as Gn,ap as Un,aq as Dt,ar as $n,l as ee,as as un,at as Kn,au as Jn,av as Zn,aw as mn,ax as ne,u as Pt,ay as Xn,az as ze,aA as Yn,aB as Qn,aC as ea,aD as hn,aE as ta,aF as gn,aG as na,aH as yt,L as fn,m as Tt,e as aa,aI as sa,aJ as ra,h as oa,aK as ot,aL as ia,aM as la,aN as ca,aO as da}from"./main-BKM2fIwG.js";import{D as wt,h as ua,u as Qe,S as ma}from"./renderGuides-Dj2i6UDx.js";import{D as ha,R as ga,u as fa,A as pa,a as va,b as xa}from"./Styles-BqtYWpHV.js";import{I as Ct,S as It}from"./index-Aazyqc20.js";import{C as re,F as pn,d as Se,k as ja,a as ba,u as Mt}from"./formItemPropsWrapper-I6w9mx6V.js";import{h as ya,R as it,a as wa}from"./SettingOutlined-CvJ3130u.js";import{S as ke,R as vn,a as xn,b as xe}from"./PlusSquareOutlined-DN4XdNMT.js";import{u as jn,c as Ca}from"./modificatorAPI-D74AIDqr.js";import{P as St,c as Sa}from"./pageAPI-DkFp6Yf6.js";import{B as Rt}from"./index-B2WlvB3G.js";import{R as ka}from"./EditOutlined-_GB9OZ1y.js";var _a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},Fa=function(n,a){return h.createElement(he,$($({},n),{},{ref:a,icon:_a}))},Pa=h.forwardRef(Fa),Ta={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917.7 148.8l-42.4-42.4c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-76.1 76.1a199.27 199.27 0 00-112.1-34.3c-51.2 0-102.4 19.5-141.5 58.6L432.3 308.7a8.03 8.03 0 000 11.3L704 591.7c1.6 1.6 3.6 2.3 5.7 2.3 2 0 4.1-.8 5.7-2.3l101.9-101.9c68.9-69 77-175.7 24.3-253.5l76.1-76.1c3.1-3.2 3.1-8.3 0-11.4zM769.1 441.7l-59.4 59.4-186.8-186.8 59.4-59.4c24.9-24.9 58.1-38.7 93.4-38.7 35.3 0 68.4 13.7 93.4 38.7 24.9 24.9 38.7 58.1 38.7 93.4 0 35.3-13.8 68.4-38.7 93.4zm-190.2 105a8.03 8.03 0 00-11.3 0L501 613.3 410.7 523l66.7-66.7c3.1-3.1 3.1-8.2 0-11.3L441 408.6a8.03 8.03 0 00-11.3 0L363 475.3l-43-43a7.85 7.85 0 00-5.7-2.3c-2 0-4.1.8-5.7 2.3L206.8 534.2c-68.9 69-77 175.7-24.3 253.5l-76.1 76.1a8.03 8.03 0 000 11.3l42.4 42.4c1.6 1.6 3.6 2.3 5.7 2.3s4.1-.8 5.7-2.3l76.1-76.1c33.7 22.9 72.9 34.3 112.1 34.3 51.2 0 102.4-19.5 141.5-58.6l101.9-101.9c3.1-3.1 3.1-8.2 0-11.3l-43-43 66.7-66.7c3.1-3.1 3.1-8.2 0-11.3l-36.6-36.2zM441.7 769.1a131.32 131.32 0 01-93.4 38.7c-35.3 0-68.4-13.7-93.4-38.7a131.32 131.32 0 01-38.7-93.4c0-35.3 13.7-68.4 38.7-93.4l59.4-59.4 186.8 186.8-59.4 59.4z"}}]},name:"api",theme:"outlined"},Ia=function(n,a){return h.createElement(he,$($({},n),{},{ref:a,icon:Ta}))},Ma=h.forwardRef(Ia),Ea={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},Aa=function(n,a){return h.createElement(he,$($({},n),{},{ref:a,icon:Ea}))},Me=h.forwardRef(Aa),La={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M956 686.5l-.1-.1-.1-.1C911.7 593 843.4 545 752.5 545s-159.2 48.1-203.4 141.3v.1a42.92 42.92 0 000 36.4C593.3 816 661.6 864 752.5 864s159.2-48.1 203.4-141.3c5.4-11.5 5.4-24.8.1-36.2zM752.5 800c-62.1 0-107.4-30-141.1-95.5C645 639 690.4 609 752.5 609c62.1 0 107.4 30 141.1 95.5C860 770 814.6 800 752.5 800z"}},{tag:"path",attrs:{d:"M697 705a56 56 0 10112 0 56 56 0 10-112 0zM136 232h704v253h72V192c0-17.7-14.3-32-32-32H96c-17.7 0-32 14.3-32 32v520c0 17.7 14.3 32 32 32h352v-72H136V232z"}},{tag:"path",attrs:{d:"M724.9 338.1l-36.8-36.8a8.03 8.03 0 00-11.3 0L493 485.3l-86.1-86.2a8.03 8.03 0 00-11.3 0L251.3 543.4a8.03 8.03 0 000 11.3l36.8 36.8c3.1 3.1 8.2 3.1 11.3 0l101.8-101.8 86.1 86.2c3.1 3.1 8.2 3.1 11.3 0l226.3-226.5c3.2-3.1 3.2-8.2 0-11.3z"}}]},name:"fund-view",theme:"outlined"},Na=function(n,a){return h.createElement(he,$($({},n),{},{ref:a,icon:La}))},Da=h.forwardRef(Na),Ra={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm72-112c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48zm400-188h-59.3c-2.6 0-5 1.2-6.5 3.3L763.7 538.1l-49.9-68.8a7.92 7.92 0 00-6.5-3.3H648c-6.5 0-10.3 7.4-6.5 12.7l109.2 150.7a16.1 16.1 0 0026 0l165.8-228.7c3.8-5.3 0-12.7-6.5-12.7zm-44 306h-64.2c-5.5 0-10.6 2.9-13.6 7.5a352.2 352.2 0 01-49.8 62.2A355.92 355.92 0 01651.1 840a355 355 0 01-138.7 27.9c-48.1 0-94.8-9.4-138.7-27.9a355.92 355.92 0 01-113.3-76.3A353.06 353.06 0 01184 650.5c-18.6-43.8-28-90.5-28-138.5s9.4-94.7 28-138.5c17.9-42.4 43.6-80.5 76.4-113.2 32.8-32.7 70.9-58.4 113.3-76.3a355 355 0 01138.7-27.9c48.1 0 94.8 9.4 138.7 27.9 42.4 17.9 80.5 43.6 113.3 76.3 19 19 35.6 39.8 49.8 62.2 2.9 4.7 8.1 7.5 13.6 7.5H892c6 0 9.8-6.3 7.2-11.6C828.8 178.5 684.7 82 517.7 80 278.9 77.2 80.5 272.5 80 511.2 79.5 750.1 273.3 944 512.4 944c169.2 0 315.6-97 386.7-238.4A8 8 0 00892 694z"}}]},name:"issues-close",theme:"outlined"},Oa=function(n,a){return h.createElement(he,$($({},n),{},{ref:a,icon:Ra}))},Va=h.forwardRef(Oa),Ba={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 732h-70.3c-4.8 0-9.3 2.1-12.3 5.8-7 8.5-14.5 16.7-22.4 24.5a353.84 353.84 0 01-112.7 75.9A352.8 352.8 0 01512.4 866c-47.9 0-94.3-9.4-137.9-27.8a353.84 353.84 0 01-112.7-75.9 353.28 353.28 0 01-76-112.5C167.3 606.2 158 559.9 158 512s9.4-94.2 27.8-137.8c17.8-42.1 43.4-80 76-112.5s70.5-58.1 112.7-75.9c43.6-18.4 90-27.8 137.9-27.8 47.9 0 94.3 9.3 137.9 27.8 42.2 17.8 80.1 43.4 112.7 75.9 7.9 7.9 15.3 16.1 22.4 24.5 3 3.7 7.6 5.8 12.3 5.8H868c6.3 0 10.2-7 6.7-12.3C798 160.5 663.8 81.6 511.3 82 271.7 82.6 79.6 277.1 82 516.4 84.4 751.9 276.2 942 512.4 942c152.1 0 285.7-78.8 362.3-197.7 3.4-5.3-.4-12.3-6.7-12.3zm88.9-226.3L815 393.7c-5.3-4.2-13-.4-13 6.3v76H488c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h314v76c0 6.7 7.8 10.5 13 6.3l141.9-112a8 8 0 000-12.6z"}}]},name:"logout",theme:"outlined"},za=function(n,a){return h.createElement(he,$($({},n),{},{ref:a,icon:Ba}))},Wa=h.forwardRef(za),qa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M692.8 412.7l.2-.2-34.6-44.3a7.97 7.97 0 00-11.2-1.4l-50.4 39.3-70.5-90.1a7.97 7.97 0 00-11.2-1.4l-37.9 29.7a7.97 7.97 0 00-1.4 11.2l70.5 90.2-.2.1 34.6 44.3c2.7 3.5 7.7 4.1 11.2 1.4l50.4-39.3 64.1 82c2.7 3.5 7.7 4.1 11.2 1.4l37.9-29.6c3.5-2.7 4.1-7.7 1.4-11.2l-64.1-82.1zM608 112c-167.9 0-304 136.1-304 304 0 70.3 23.9 135 63.9 186.5L114.3 856.1a8.03 8.03 0 000 11.3l42.3 42.3c3.1 3.1 8.2 3.1 11.3 0l253.6-253.6C473 696.1 537.7 720 608 720c167.9 0 304-136.1 304-304S775.9 112 608 112zm161.2 465.2C726.2 620.3 668.9 644 608 644s-118.2-23.7-161.2-66.8C403.7 534.2 380 476.9 380 416s23.7-118.2 66.8-161.2c43-43.1 100.3-66.8 161.2-66.8s118.2 23.7 161.2 66.8c43.1 43 66.8 100.3 66.8 161.2s-23.7 118.2-66.8 161.2z"}}]},name:"monitor",theme:"outlined"},Ha=function(n,a){return h.createElement(he,$($({},n),{},{ref:a,icon:qa}))},lt=h.forwardRef(Ha),Ga={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M952 612c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H298a95.92 95.92 0 00-89-60c-53 0-96 43-96 96s43 96 96 96c40.3 0 74.8-24.8 89-60h150.3v152c0 55.2 44.8 100 100 100H952c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H548.3c-15.5 0-28-12.5-28-28V612H952zM456 344h264v98.2c0 8.1 9.5 12.8 15.8 7.7l172.5-136.2c5-3.9 5-11.4 0-15.3L735.8 162.1c-6.4-5.1-15.8-.5-15.8 7.7V268H456c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8z"}}]},name:"node-expand",theme:"outlined"},Ua=function(n,a){return h.createElement(he,$($({},n),{},{ref:a,icon:Ga}))},$a=h.forwardRef(Ua),Ka={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M136 552h63.6c4.4 0 8-3.6 8-8V288.7h528.6v72.6c0 1.9.6 3.7 1.8 5.2a8.3 8.3 0 0011.7 1.4L893 255.4c4.3-5 3.6-10.3 0-13.2L749.7 129.8a8.22 8.22 0 00-5.2-1.8c-4.6 0-8.4 3.8-8.4 8.4V209H199.7c-39.5 0-71.7 32.2-71.7 71.8V544c0 4.4 3.6 8 8 8zm752-80h-63.6c-4.4 0-8 3.6-8 8v255.3H287.8v-72.6c0-1.9-.6-3.7-1.8-5.2a8.3 8.3 0 00-11.7-1.4L131 768.6c-4.3 5-3.6 10.3 0 13.2l143.3 112.4c1.5 1.2 3.3 1.8 5.2 1.8 4.6 0 8.4-3.8 8.4-8.4V815h536.6c39.5 0 71.7-32.2 71.7-71.8V480c-.2-4.4-3.8-8-8.2-8z"}}]},name:"retweet",theme:"outlined"},Ja=function(n,a){return h.createElement(he,$($({},n),{},{ref:a,icon:Ka}))},Za=h.forwardRef(Ja),Xa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"},Ya=function(n,a){return h.createElement(he,$($({},n),{},{ref:a,icon:Xa}))},Qa=h.forwardRef(Ya);const Ot={sourceContainerIndex:null,sourceContainerType:null,destinationContainerIndex:null,destinationContainerType:null,sourceElementIndex:null,destinationElementIndex:null,destinationElementCorner:null,destinationContainerFlow:null},Ke=Sn((t,n)=>({selectedElementRef:null,staticEementsGuidesClasses:[],activeStaticElementKey:null,dragData:Ot,updateDragStore:a=>{const i=n().dragData,g={...i,...a};At.isEqual(i,g)||t(()=>({dragData:g}))},resetDragStore:()=>{t(()=>({dragData:Ot}))},setSelectedElementRef:a=>{t(()=>({selectedElementRef:a}))},setActiveStaticElementKey:a=>{t(()=>({activeStaticElementKey:a}))},setStaticEementsGuidesClasses:a=>{t(i=>{const g=i.staticEementsGuidesClasses;return g.includes(a)?i:{staticEementsGuidesClasses:[...g,a]}})}}),At.isEqual),es=async()=>await rn.get("/api/themes?sort=createdAt:asc&populate=deep,3",{headers:kn()}).then(t=>t?.data?.data?t.data.data:null).catch(t=>{console.log("Get news error occurred:",t)}),bn=_n(t=>({themesList:[],fetchAndFillThemesList:async()=>{const n=await es();t({themesList:n||[]})}})),ts=({cloneItemModal:t,setCloneItemModal:n,onFinish:a})=>{const[i]=v.useForm(),g=()=>{i.submit()};return e.jsx(le,{destroyOnClose:!0,afterClose:()=>i.resetFields(),maskClosable:!1,title:`Cloning ${t.nodeType}`,open:!!t,onOk:g,onCancel:()=>n(null),footer:[e.jsx(F,{onClick:()=>n(null),children:"Cancel"},"back"),e.jsxs(F,{type:"primary",onClick:g,children:["Clone ",t.nodeType]},"submit")],children:e.jsx(v,{labelCol:{xs:{span:6}},wrapperCol:{xs:{span:16}},form:i,onFinish:c=>a(c),initialValues:{copiesCount:1},scrollToFirstError:!0,children:e.jsx(v.Item,{colon:!1,required:!1,name:"copiesCount",label:"How many copies",rules:[{required:!0,message:"This field is required."}],children:e.jsx(Ct,{min:1,max:10})})})})},ns=()=>{const[t,n]=h.useState(null),{pageId:a}=te(),i=({copiesCount:c})=>{const{containerIndex:d,elementIndex:o,nodeType:f,isGlobal:m}=t||{};d!==void 0&&(f==="container"?Fn({action:"clone",containerIndex:d,copiesCount:c,pageId:a}).then(()=>n(null)):o!==void 0&&Pn({containerIndex:d,elementIndex:o,copiesCount:c,isGlobal:m,pageId:a,action:"clone"}).then(()=>n(null)))};return{CloneModal:t?e.jsx(ts,{onFinish:i,setCloneItemModal:n,cloneItemModal:t}):null,setCloneItemModal:n}};function as(t){const n=/\/projects\/(\d+)/;return!!t.match(n)}const ss=()=>{const t=kt(f=>f.jwt),n=V(f=>f.currentProjectHash),a=V(f=>f.savedProjectHash),i=V.getState().resetWorkingProject,{projectId:g}=te(),c=!!t&&!!g&&n!==a,d=Tn(({nextLocation:f})=>{const m=as(f.pathname);return!!(c&&!m)});return h.useEffect(()=>{const f=m=>{c&&(m.preventDefault(),m.returnValue="")};return window.addEventListener("beforeunload",f),()=>{window.removeEventListener("beforeunload",f)}},[d.state,c]),{ConfirmModal:()=>{function f(){d?.reset&&d.reset()}function m(){i().then(()=>{d?.proceed?.()})}function y(){w(!0);const S=V.getState().workingProject;S?In({projectData:S}).then(()=>{je.success("Project saved successfully"),d?.proceed&&d.proceed(),i()}).catch(b=>{console.error(b),je.error("Error while saving project")}):(je.error("Error while saving project: not found"),w(!1))}const[x,w]=h.useState(!1);return d.state==="blocked"?e.jsx(le,{maskClosable:!1,title:e.jsxs("div",{style:{color:"rgb(255 113 77)"},children:[e.jsx(be,{})," Unsaved changes"]}),open:!0,onCancel:()=>{f()},footer:[e.jsx(F,{onClick:()=>f(),children:"Stay here"},"back"),e.jsx(F,{loading:x,type:"primary",onClick:()=>y(),children:"Save and exit"},"saveAndExit"),e.jsx(F,{type:"primary",danger:!0,onClick:()=>m(),children:"Leave without saving"},"submit")],children:e.jsx("div",{children:"Are you really want to leave editor? All unsaved changes will be lost."})}):null}}};var rs="editProjectModal_solidProjectSettingsRow__mtt4ox0",os="editProjectModal_envTabs__mtt4ox2",We="editProjectModal_settingsRow__mtt4ox3",Te="editProjectModal_settingsCell__mtt4ox4";const se=K.memo(({name:t,envIndex:n,label:a,placeholder:i,rules:g,addonAfter:c,form:d,isBooleanValue:o,allowEditOnlyForDefault:f})=>{const m=typeof n!="number",y=d.getFieldValue(["env",n,...t]),[x,w]=h.useState(y!==void 0),S=b=>{b?d.setFieldValue(["env",n,...t],""):d.setFieldValue(["env",n,...t],void 0),w(b),_e.emit("projectFormHasChanges")};return m?e.jsx(v.Item,{isListField:!1,label:a,colon:!1,required:!1,name:[...t],rules:g,valuePropName:o?"checked":"value",children:o?e.jsx(Ze,{children:i}):e.jsx(z,{addonAfter:c,placeholder:i})}):e.jsx(v.Item,{colon:!1,label:a,children:e.jsxs(vt,{style:{flexWrap:"nowrap"},gutter:8,children:[e.jsx(Ie,{flex:"auto",children:e.jsx(v.Item,{noStyle:!0,isListField:x,label:a,colon:!1,required:!1,name:x?["env",n,...t]:t,rules:g,valuePropName:o?"checked":"value",children:o?e.jsx(Ze,{disabled:!x,children:i}):e.jsx(z,{disabled:!x,addonAfter:c,placeholder:i,addonBefore:x?null:e.jsx("div",{style:{textTransform:"uppercase",fontSize:9,color:"gray"},children:"inherited"})})})}),e.jsx(Ie,{style:{alignSelf:"center"},children:e.jsx(me,{onChange:b=>{S(b)},checked:x,size:"small",disabled:f&&!m})})]})})}),Ge=h.createContext(void 0),is=({children:t})=>{const[n,a]=h.useState(""),[i,g]=h.useState(""),c=h.useCallback(o=>{Array.isArray(o)||a(o)},[]),d=h.useCallback(o=>{Array.isArray(o)||g(o)},[]);return e.jsx(Ge.Provider,{value:{connectorsOpenSection:n,handleChangeConectorsOpenSection:c,singleConnectorOpenKey:i,handleChangeSingleConnectorOpen:d},children:t})},{Panel:ls}=re,cs=K.memo(({envIndex:t})=>{const n=v.useFormInstance(),{singleConnectorOpenKey:a,handleChangeSingleConnectorOpen:i}=K.useContext(Ge)??{};return e.jsx(e.Fragment,{children:e.jsx(re,{accordion:!0,activeKey:a,onChange:i,children:e.jsx(ls,{header:"WebXpanel",children:e.jsxs("div",{className:We,style:{"--gap":"3em"},children:[e.jsx(se,{form:n,label:"Host",placeholder:"Ip or Hostname",envIndex:t,name:["webXpanel","host"]}),e.jsx(se,{label:"ipId",form:n,placeholder:"IpId",envIndex:t,name:["webXpanel","ipId"]}),e.jsx(se,{label:"Room ID",form:n,placeholder:"Room ID",envIndex:t,name:["webXpanel","roomId"]}),e.jsx(se,{label:"Auth Token",form:n,placeholder:"Auth Token",envIndex:t,name:["webXpanel","authToken"]})]})},"1")})})}),{Panel:ds}=re,us=K.memo(({envIndex:t})=>{const n=v.useFormInstance(),{singleConnectorOpenKey:a,handleChangeSingleConnectorOpen:i}=K.useContext(Ge)??{},g=pn.useWatch("websocketConnectors",n),c=h.useCallback((d,o)=>{if(d.preventDefault(),d.stopPropagation(),i?.(""),g){const f=[...g];f.splice(o,1);const m=n.getFieldValue(["env"]);if(m?.length){const y=m.map((x,w)=>{if(w===w){const{websocketConnectors:S}=x,b=S.filter((M,_)=>_!==o);return{...x,websocketConnectors:b}}});n.setFieldValue(["env"],y)}n.setFieldValue("websocketConnectors",f),_e.emit("projectFormHasChanges")}},[n,i,g]);return g?.length?e.jsx(re,{destroyInactivePanel:!0,accordion:!0,activeKey:a,onChange:i,children:g.map((d,o)=>{const{uid:f}=d;if(!f)return null;const m=g[o].name??"No name";return e.jsx(ds,{header:e.jsxs(e.Fragment,{children:[e.jsx(qe,{children:"ws"}),m]}),extra:e.jsx(F,{onClick:y=>{c(y,o)},danger:!0,icon:e.jsx(Ft,{}),size:"small"}),children:e.jsxs("div",{className:We,style:{"--gap":"3em"},children:[e.jsx(se,{form:n,label:"Name",placeholder:"Friendly Name",envIndex:t,name:["websocketConnectors",o,"name"]}),e.jsx(se,{form:n,label:"Host URL (IP)",placeholder:"WS Connect Host URL",envIndex:t,name:["websocketConnectors",o,"host"]}),e.jsx(se,{form:n,label:"Reconnect Timeout (ms)",placeholder:"5000ms by default",envIndex:t,name:["websocketConnectors",o,"reconnectTimeout"]})]})},f)})}):e.jsx("div",{children:"No connectors yet"})}),ms=K.memo(({envIndex:t})=>e.jsxs(e.Fragment,{children:[e.jsx(us,{envIndex:t}),e.jsx(v.List,{name:"websocketConnectors",children:(n,{add:a})=>e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx(F,{icon:e.jsx(_t,{}),type:"primary",onClick:()=>a({name:"My WS connector",uid:et(),type:"websocket",host:""}),children:"Add Websocket Connector"})]})})]})),{Panel:hs}=re,gs=K.memo(({envIndex:t})=>{const n=v.useFormInstance(),{singleConnectorOpenKey:a,handleChangeSingleConnectorOpen:i}=K.useContext(Ge)??{},g=pn.useWatch("webConnectors",n),c=(d,o)=>{d.preventDefault(),d.stopPropagation();const f=g?.filter((y,x)=>x!==o);n.setFieldValue(["webConnectors"],f);const m=n.getFieldValue(["env"]);if(m?.length){const y=m.map((x,w)=>{if(w===w){const{webConnectors:S}=x,b=S.filter((M,_)=>_!==o);return{...x,webConnectors:b}}});n.setFieldValue(["env"],y)}_e.emit("projectFormHasChanges")};return g?.length?e.jsx(re,{destroyInactivePanel:!0,accordion:!0,activeKey:a,onChange:i,children:g.map((d,o)=>{const{uid:f}=d;if(!f)return null;const m=g[o].name??"No name";return e.jsx(hs,{header:e.jsxs(e.Fragment,{children:[e.jsx(qe,{children:"web"}),m]}),extra:e.jsx(F,{onClick:y=>{c(y,o)},danger:!0,icon:e.jsx(Ft,{}),size:"small"}),children:e.jsxs("div",{className:We,style:{"--gap":"3em"},children:[e.jsx(se,{form:n,label:"Name",placeholder:"Friendly Name",envIndex:t,name:["webConnectors",o,"name"],allowEditOnlyForDefault:!0}),e.jsx(se,{form:n,label:"Host URL (IP)",placeholder:"WS Connect Host URL",envIndex:t,name:["webConnectors",o,"host"]})]})},f)})}):e.jsx("div",{children:"No connectors yet"})}),fs=K.memo(({envIndex:t})=>e.jsxs(e.Fragment,{children:[e.jsx(gs,{envIndex:t}),e.jsx(v.List,{name:"webConnectors",children:(n,{add:a})=>e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx(F,{icon:e.jsx(_t,{}),type:"primary",onClick:()=>a({name:"My Web connector",uid:et(),type:"web",host:""}),children:"Add Web Connector"})]})})]})),{Panel:ct}=re,dt=["webxpanel","web","websocket"],Vt=K.memo(({envIndex:t})=>{const n=v.useFormInstance(),a=typeof t!="number",i=a?{value:"Default"}:{},g=v.useWatch("websocketConnectors",n)??n.getFieldValue("websocketConnectors"),c=v.useWatch("webConnectors",n)??n.getFieldValue("webConnectors"),d=g?.length??0,o=c?.length??0,{connectorsOpenSection:f,handleChangeConectorsOpenSection:m}=K.useContext(Ge)??{};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:We,children:[e.jsx("div",{className:Te,children:e.jsx(v.Item,{isListField:!0,colon:!1,required:!1,name:a?void 0:["env",t,"envName"],label:"Environment name",children:e.jsx(z,{...i,disabled:a,placeholder:"Environment name"})})}),e.jsx("div",{className:Te,children:e.jsx(v.Item,{isListField:!a,colon:!1,required:!1,label:"Enable debug console",valuePropName:"checked",name:a?["debugOptions","showConsoleOnLoad"]:["env",t,"debugOptions","showConsoleOnLoad"],children:e.jsx(me,{})})}),e.jsx("div",{className:Te,children:e.jsx(se,{form:n,label:"Build Archive Name",placeholder:"Archive Name",envIndex:t,name:["archiveName"],rules:[()=>({validator(y,x){return Xe(x)}})],addonAfter:".ch5z"})})]}),e.jsx(Q,{plain:!0,className:"fromleft",orientation:"left",children:"project connectors"}),e.jsxs(re,{onChange:m,activeKey:f,accordion:!0,children:[e.jsxs(ct,{header:"Crestron connectors (1)",children:[e.jsxs(wt,{summary:"Crestron Global Joins",children:[e.jsx(v.Item,{colon:!1,required:!1,name:["globalJoins","analogPageFlip_signal_a_fb"],label:"Analog flip page signal",children:e.jsx(z,{disabled:!a,addonBefore:e.jsx("div",{style:{marginRight:0,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:"a"})}),placeholder:"Analog signal name"})}),e.jsx(v.Item,{colon:!1,required:!1,name:["globalJoins","serialPageFlip_signal_s_fb"],label:"Serial flip page signal",children:e.jsx(z,{disabled:!a,addonBefore:e.jsx("div",{style:{marginRight:0,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:"s"})}),placeholder:"Serial signal name"})}),e.jsx(v.Item,{colon:!1,required:!1,name:["globalJoins","notification_signal_s_fb"],label:"Notification signal",children:e.jsx(z,{disabled:!a,addonBefore:e.jsx("div",{style:{marginRight:0,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:"s"})}),placeholder:"Serial signal name"})}),e.jsx(v.Item,{colon:!1,required:!1,name:["globalJoins","refreshDataSources_signal_d_fb"],label:"Refresh All DataSources",children:e.jsx(z,{disabled:!a,addonBefore:e.jsx("div",{style:{marginRight:0,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:"d"})}),placeholder:"Digital signal name"})}),e.jsx(v.Item,{colon:!1,required:!1,name:["globalJoins","refreshSingleDataSource_signal_s_fb"],label:"Refresh Single DataSource",children:e.jsx(z,{disabled:!a,addonBefore:e.jsx("div",{style:{marginRight:0,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:"s"})}),placeholder:"Serial signal name"})}),e.jsx(v.Item,{style:{margin:0},colon:!1,required:!1,name:["globalJoins","connected_signal_d_fb"],label:e.jsxs(e.Fragment,{children:["Connected status indicator",e.jsx(ue,{placement:"top",title:"Crestron connect indicator",content:e.jsx("div",{style:{maxWidth:200},children:"UI will not start until we get true feedback value from this signal (if filled)."}),trigger:"hover",children:e.jsx(Ve,{style:{color:"var(--ant-primary-5)",marginInlineStart:"0.5em"}})})]}),children:e.jsx(z,{disabled:!a,addonBefore:e.jsx("div",{style:{marginRight:0,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:"d"})}),placeholder:"Digital signal name"})})]}),e.jsx(Q,{style:{marginBottom:5},plain:!0}),e.jsx(cs,{envIndex:t})]},dt[0]),e.jsx(ct,{header:`Websocket connectors (${d})`,children:e.jsx(ms,{envIndex:t})},dt[2]),e.jsx(ct,{header:`WEB connectors (${o})`,children:e.jsx(fs,{envIndex:t})},dt[1])]}),e.jsx(Q,{plain:!0,className:"fromleft",orientation:"left",children:"Dataset Options"}),e.jsxs("div",{className:We,children:[e.jsx("div",{className:Te,children:e.jsx(se,{label:"Dataset base URL",placeholder:"Dataset base URL",form:n,envIndex:t,name:["datasetOptions","hostname"]})}),e.jsx("div",{className:Te,children:e.jsx(se,{label:"Authorization header key",placeholder:"Authorization header key",form:n,envIndex:t,name:["datasetOptions","headerKey"]})}),e.jsx("div",{className:Te,children:e.jsx(se,{label:"Authorization header value",placeholder:"Authorization header value",form:n,envIndex:t,name:["datasetOptions","headerValue"]})})]})]})}),ps=K.memo(()=>{const t=v.useFormInstance(),n=v.useWatch("env",t),a=(g,c)=>{const d=[...n??[]];if(c==="add"){const o=ya().format("YYYY-MM-DD_HH-mm"),f=et(),y={envName:"ENV_"+o,envId:f};d.push(y),t.setFieldValue("env",d),_e.emit("projectFormHasChanges")}else if(c==="remove"&&typeof g=="string")try{const o=Number(g);d.splice(o,1),t.setFieldValue("env",d),_e.emit("projectFormHasChanges")}catch(o){console.log(o)}},i=h.useMemo(()=>{const g={label:"Default Project Settings",key:"Default",forceRender:!0,children:e.jsx(Vt,{})},d=(n??[]).map((o,f)=>{const{envName:m="no_name"}=o;return{label:e.jsxs(e.Fragment,{children:[e.jsx(xt,{star:!0})," ",m]}),key:String(f),forceRender:!0,children:e.jsx(Vt,{envIndex:f})}});return[g,...d]},[n]);return e.jsx(is,{children:e.jsx(Ee,{destroyInactiveTabPane:!1,className:os,size:"small",type:"editable-card",onEdit:a,items:i})})}),{Option:vs}=ke,xs=K.memo(({editProjectModalId:t,setEditProjectModalId:n})=>{const a=bn(R=>R.themesList),i=V.getState().workingProject,{name:g,theme:c,env:d,webXpanel:o,datasetOptions:f,debugOptions:m,archiveName:y,globalJoins:x,splashScreen:w,websocketConnectors:S,webConnectors:b}=i?.attributes??{},M={env:d,webXpanel:o,datasetOptions:f,debugOptions:m,archiveName:y,globalJoins:x,name:g,splashScreen:w,theme:c?.data.id,websocketConnectors:S,webConnectors:b},[_]=v.useForm(),[L,A]=h.useState(!1),[U,W]=h.useState(!1);h.useEffect(()=>{const R=()=>{W(!0)};return _e.on("projectFormHasChanges",R),()=>{_e.off("projectFormHasChanges",R)}},[]);const J=R=>{A(!0),t&&on({projectId:t,inputData:R}).then(()=>{W(!1),je.success("Project settings saved")}).finally(()=>A(!1))},O=()=>{U?ln({icon:e.jsx(be,{}),title:"Exit project settings?",content:"Close without saving project settings?",okText:"Close without save",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>{A(!1),n(null)},onCancel:()=>{A(!1)}}):n(null)},{refreshSingleDataSource_signal_s_fb:N}=i?.attributes.globalJoins||{},Z=()=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{children:"Project Settings"}),e.jsx(F,{icon:e.jsx(Qa,{}),loading:L,disabled:!U,onClick:()=>{_.submit()},type:"primary",children:"Save Project Settings"})]});return i?e.jsx(ha,{closable:!0,maskClosable:!0,width:"100vw",title:e.jsx(Z,{}),placement:"right",onClose:()=>{O()},destroyOnClose:!0,open:t!==null,children:e.jsxs(v,{onValuesChange:()=>{W(!0),console.log("form changed",_.getFieldsValue())},style:{maxHeight:"100%",overflowY:"auto"},form:_,initialValues:M,onFinish:J,scrollToFirstError:!0,layout:"vertical",children:[e.jsxs("section",{className:rs,children:[e.jsx(v.Item,{colon:!1,required:!1,name:"name",label:"Project Name",rules:[{required:!0,message:"This field is required."}],children:e.jsx(z,{})}),e.jsx(v.Item,{colon:!1,required:!1,name:"theme",label:"Project Theme",rules:[{required:!0,message:"This field is required."}],children:e.jsx(ke,{children:a?.map(R=>e.jsx(vs,{value:R.id,children:R.attributes.name},R.id))})}),e.jsx(v.Item,{colon:!1,initialValue:N,required:!1,name:["splashScreen","logoImgId"],label:"Splash screen Logo image ID",children:e.jsx(z,{placeholder:"Image id from library"})}),e.jsx(v.Item,{colon:!1,initialValue:N,required:!1,name:["splashScreen","text"],label:"Splash screen Text",children:e.jsx(z,{placeholder:"Splash screen text"})})]}),e.jsx(Q,{className:"fromleft",plain:!0,children:"project settings with environment support"}),e.jsx(v.List,{name:"env",children:()=>null}),e.jsx(ps,{})]})}):null}),js=He(le)`
  height: calc(100vh - 4%) !important;
  width: 100% !important;

  .ant-modal-content {
    height: 100%;
    position: relative;
    display: flex;
    flex-flow: column;

    .dsForm {
      height: 100%;
      flex: 1;
      position: relative;
      display: flex;
      flex-flow: column;
    }

    .ant-modal-body {
      flex: 1;
      position: relative;
      padding: 0;
      display: flex;
      flex-flow: column;
    }

    .ant-collapse-header {
      font-weight: normal !important;
      user-select: none;
      text-transform: uppercase;
      font-size: 12px;
    }

    .ant-form-item-label {
      flex-basis: 200px;
    }
  }
`,Je=He.div`
  position: relative;
  height: 100%;
  padding-top: 17px;
  /* overflow: hidden; */
  min-height: 200px;

  .monaco-editor {
    position: absolute !important;
    left: 0;
    top: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    height: 100%;
  }
`,{Panel:bs}=re,ys=He(Ee)`
  position: relative;
  flex: 1;

  .ant-tabs-content {
    position: relative;
    height: 100%;
  }

  .ant-tabs-tabpane {
    height: 100%;
    background-color: #1e1e1e;
  }

  .ant-tabs-nav {
    margin: 0;
  }

  .ant-tabs-tab {
    border: 0 !important;

    &.ant-tabs-tab-active {
      background-color: #1e1e1e;

      .ant-tabs-tab-btn {
        color: #fff;
        user-select: none;
      }
    }
  }
`,Bt=He.div`
  color: #fff;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
`,ws=He.div`
  position: relative;
  display: flex;
  color: #fff;
  height: 100%;

  .functionBox {
    min-width: 300px;
    position: relative;
    height: 100%;
    display: flex;
    flex-flow: column;

    .functionBoxControls {
      padding: 17px;
      padding-right: 0;
      padding-bottom: 0;
      font-size: 12px;
      display: flex;
      gap: 5px;
      justify-content: space-between;
    }
  }

  .resultBox {
    flex: 1;
  }
`,Cs=({setNewDatasourceVisible:t,newDatasourceVisible:n})=>{const a=typeof n=="number"?n:null,i=V.getState().workingProject?.attributes.datasources.data.find(C=>C.id===a),g=V.getState().workingProject?.attributes.modificators.data,[c]=v.useForm(),{projectId:d}=te(),o=h.useMemo(()=>{let C=V.getState().workingProject?.attributes.datasources.data??[];return i&&(C=C.filter(D=>D.id!==i.id)),C.map(D=>D.attributes.name)},[i]),f=h.useMemo(()=>V.getState().workingProject?.attributes.modificators.data?.map(D=>({value:D.attributes.uid,label:D.attributes.name}))??[],[]),m=h.useMemo(()=>V.getState().workingProject?.attributes.websocketConnectors?.map(D=>({value:D.uid,label:D.name}))??[],[]),{headerKey:y,headerValue:x,hostname:w}=Mn()??{},[S,b]=h.useState("local"),[M,_]=h.useState(null),[L,A]=h.useState(null),U=v.useWatch("sourceLink",c),W=v.useWatch("useBaseUrl",c),J=v.useWatch("headerKey",c),O=v.useWatch("headerValue",c),N=J!==null,Z=O!==null,R=v.useWatch("sourceObject",c),E=v.useWatch("modificatorId",c),ae=v.useWatch("wsConnectorUid",c),X=!!U||!!W,[p,l]=h.useState(!1),[r,s]=h.useState(!1),[u,j]=h.useState("local"),k=En({data:{useBaseUrl:W,sourceLink:U,headerKey:J,headerValue:O}}),P=h.useMemo(()=>X||ae?R?"mixed":"remote":"local",[X,R,ae]),T=h.useMemo(()=>E?g?.find(C=>C.id===E):null,[E,g]),B=h.useCallback(()=>{T&&(c.setFieldValue("modificatorFunctionString",T.attributes.function),s(!1))},[c,T]);h.useEffect(()=>{B()},[B]);const[H,G]=h.useState(!1),[q,ge]=h.useState([]),[ie,Ae]=h.useState([]),I=C=>{ge(C)},oe=C=>{Ae(C)},fe=({formKey:C,value:Y})=>{const D=c.getFieldValue(C);function ce(){c.setFieldsValue({[C]:Y?"":null})}!Y&&D?ln({icon:e.jsx(be,{}),title:"Are you sure?",content:"Disabling this option will clear the value of the field. Are you sure you want to proceed?",okButtonProps:{danger:!0},okText:"Proceed",cancelText:"Cancel",onOk:()=>{ce()},onCancel:()=>{}}):ce()},Fe=async C=>{if(!d)return;const{name:Y,sourceLink:D,useBaseUrl:ce,headerKey:ye,headerValue:Ne,modificatorId:st,sourceObject:rt,modificatorFunctionString:De,isImagePreloadSource:Re,wsConnectorUid:$e}=C;console.log("formData",C);const we={name:Y||"New datasouce",production:{sourceLink:D,useBaseUrl:ce,headerKey:ye,headerValue:Ne,modificatorId:st||null,sourceObject:rt,storageType:P,isImagePreloadSource:Re,wsConnectorUid:$e},uid:et()};if(G(!0),r&&T?.id&&await jn({function:De},T.id).catch(()=>{je.error("Failed to update function"),G(!1)}),i){const{uid:Cr,...Cn}=we;Ln({...Cn},i.id).then(()=>t(!1)).then(()=>Nt()).finally(()=>G(!1))}else Nn(d,we).then(()=>t(!1)).then(()=>Nt()).finally(()=>G(!1))},Pe=h.useCallback(()=>q.length>0?e.jsx(ue,{trigger:"hover",title:"invalid JSON",content:"JSON data contains errors",children:e.jsx(be,{style:{fontSize:14,margin:"0 0 0 5px",color:"red",cursor:"help"}})}):null,[q.length]);function tt(){const C=new Date,Y=C.getFullYear(),D=String(C.getMonth()+1).padStart(2,"0"),ce=String(C.getDate()).padStart(2,"0"),ye=String(C.getHours()).padStart(2,"0"),Ne=String(C.getMinutes()).padStart(2,"0");return`${Y}-${D}-${ce}_${ye}-${Ne}`}const Le=tt(),Ue=i?{name:i.attributes.name,sourceLink:i.attributes.production?.sourceLink??"",useBaseUrl:i.attributes.production?.useBaseUrl??!1,headerKey:i.attributes.production?.headerKey??null,headerValue:i.attributes.production?.headerValue??null,modificatorId:i.attributes.production?.modificatorId??0,sourceObject:i.attributes.production?.sourceObject??"",modificatorFunctionString:"",isImagePreloadSource:i.attributes.production?.isImagePreloadSource??!1,wsConnectorUid:i.attributes.production?.wsConnectorUid}:{name:"New datasource "+Le,sourceLink:"",useBaseUrl:!1,headerKey:null,headerValue:null,modificatorId:0,sourceObject:"",modificatorFunctionString:"",isImagePreloadSource:!1,wsConnectorUid:void 0},pe=h.useCallback(async({beforeFetch:C,successFetch:Y,errorFetch:D,finallyFetch:ce,applyFunction:ye})=>{C();const{sourceLink:Ne,headerKey:st,headerValue:rt}=k;try{await An(Ne,st,rt).then(De=>{let Re="";if(ye){const $e=c.getFieldValue("modificatorFunctionString");if($e)try{const we=Lt([De],null,void 0,$e);console.log("dataAfterFunctionApply",we),Re=JSON.stringify(we,null,2)}catch(we){console.log("error",we)}}else Re=JSON.stringify(De,null,2);Y(Re)})}catch{je.error("Failed to fetch data"),D()}finally{ce?.()}},[k,c]);h.useEffect(()=>{S==="remote"&&!X&&b("local"),S==="modified"&&!E&&b("local"),A(null)},[S,X,E]);const nt=h.useMemo(()=>{const C=()=>{A("loading");try{const D=c.getFieldValue("modificatorFunctionString"),ce=JSON.parse(R),ye=Lt([ce],null,void 0,D);A(JSON.stringify(ye,null,2))}catch(D){console.log(D),A(null)}},Y=()=>{if(u==="local")return R?e.jsx(F,{style:{textTransform:"capitalize"},icon:e.jsx(lt,{}),loading:L==="loading",onClick:()=>{C()},ghost:!0,children:"Calculate Local Modified Data"}):e.jsx("p",{children:"Your local source is empty"});if(u==="remote")return X?e.jsx(F,{style:{textTransform:"capitalize"},icon:e.jsx(lt,{}),loading:L==="loading",onClick:()=>pe({applyFunction:!0,beforeFetch:()=>{A("loading")},successFetch:D=>{A(D)},errorFetch:()=>{A(null)}}),ghost:!0,children:"Calculate Remote Modified Data"}):e.jsx("p",{children:"Remote URL is not presented in ENV or datasource settings"})};return[{label:e.jsxs(e.Fragment,{children:["Set Local Source ",Pe()]}),key:"local",children:e.jsx(Je,{hasErrors:!!q.length,children:e.jsx(v.Item,{noStyle:!0,name:"sourceObject",validateStatus:q.length?"error":void 0,rules:[()=>({validator(){return q.length?Promise.reject():Promise.resolve()}})],normalize:D=>D===void 0?"":D,children:e.jsx(Se,{className:"monaco-editor",language:"json",loading:e.jsx(ve,{}),options:{readOnly:!1,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark",defaultLanguage:"json",onValidate:I})})})},{label:"Test Remote HTTP Source",disabled:!X,key:"remote",children:M===null||M==="loading"?e.jsx(Bt,{children:e.jsx(F,{icon:e.jsx(lt,{}),loading:M==="loading",onClick:()=>pe({beforeFetch:()=>{_("loading")},successFetch:D=>{_(D)},errorFetch:()=>{_(null)}}),ghost:!0,children:"Retreive Remote Data"})}):e.jsx(Je,{hasErrors:!!q.length,children:e.jsx(Se,{className:"monaco-editor",language:"json",loading:e.jsx(ve,{}),options:{readOnly:!0,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark",defaultLanguage:"json",value:M})})},{label:e.jsxs(e.Fragment,{children:["Test Function",!!ie.length&&e.jsx(ue,{trigger:"hover",title:"invalid Function",content:"Function contains errors",children:e.jsx(be,{style:{fontSize:14,margin:"0 0 0 5px",color:"red",cursor:"help"}})})]}),disabled:!E,key:"modified",children:e.jsxs(ws,{children:[e.jsx("div",{className:"functionBox",children:e.jsx("div",{style:{flex:1},children:e.jsx(Je,{hasErrors:!1,children:e.jsx(v.Item,{name:"modificatorFunctionString",validateStatus:ie.length?"error":void 0,rules:[()=>({validator(){return ie.length?Promise.reject():Promise.resolve()}})],normalize:D=>D===void 0?"":D,noStyle:!0,children:e.jsx(Se,{className:"monaco-editor",language:"json",loading:e.jsx(ve,{}),options:{readOnly:!1,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",lineNumbers:"off",wordWrap:"on",glyphMargin:!1,folding:!0,lineDecorationsWidth:0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark",defaultLanguage:"javascript",onValidate:oe})})})})}),e.jsx("div",{className:"resultBox",children:L===null||L==="loading"?e.jsx(Bt,{children:e.jsx(Y,{})}):e.jsx(Je,{hasErrors:!!q.length,children:e.jsx(Se,{className:"monaco-editor",language:"json",loading:e.jsx(ve,{}),options:{readOnly:!0,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark",defaultLanguage:"json",value:L})})})]})}]},[q.length,Pe,c,ie.length,pe,X,E,L,u,R,M]),at=h.useMemo(()=>{switch(S){case"local":return e.jsxs(e.Fragment,{children:[e.jsx(F,{size:"small",disabled:!X,icon:e.jsx($a,{}),type:"dashed",style:{marginLeft:10},loading:p,onClick:()=>pe({beforeFetch:()=>{l(!0)},successFetch:C=>{c.setFieldsValue({sourceObject:C})},errorFetch:()=>{},finallyFetch:()=>{l(!1)}}),children:"Fill from remote source"}),e.jsx(F,{size:"small",onClick:()=>{c.setFieldsValue({sourceObject:null})},disabled:!(R&&!p),danger:!0,icon:e.jsx(Me,{}),type:"dashed",style:{marginLeft:10},children:"Clear"})]});case"remote":return e.jsxs(e.Fragment,{children:[e.jsx(F,{onClick:()=>pe({beforeFetch:()=>{_("loading")},successFetch:C=>{_(C)},errorFetch:()=>{_(null)}}),loading:M==="loading",size:"small",icon:e.jsx(ga,{}),type:"dashed",style:{marginLeft:10},disabled:M===null||M==="loading",children:"Refresh Remote Data"}),e.jsx(F,{size:"small",onClick:()=>{_(null)},disabled:M===null||M==="loading",danger:!0,icon:e.jsx(Me,{}),type:"dashed",style:{marginLeft:10},children:"Clear Preview"})]});case"modified":return e.jsxs(e.Fragment,{children:[e.jsx(F,{onClick:()=>A(null),loading:L==="loading",size:"small",icon:e.jsx(Me,{}),type:"dashed",style:{marginLeft:10},disabled:L===null||L==="loading",children:"Clear"}),e.jsx(F,{size:"small",onClick:()=>B(),disabled:!r,danger:!0,icon:e.jsx(Me,{}),type:"dashed",style:{marginLeft:10},children:"Discard function changes"}),e.jsx(ke,{size:"small",value:u,style:{marginLeft:10},onChange:C=>{j(C),A(null)},options:[{value:"local",label:"Use Local Source"},{value:"remote",label:"Use Remote Source"}]})]});default:return null}},[S,p,c,pe,r,X,L,u,B,R,M]),yn=C=>{const Y=Object.keys(C);Y.includes("modificatorFunctionString")&&!r&&s(!0),Y.includes("modificatorId")&&(s(!1),A(null))},[Et,wn]=h.useState(Ue.wsConnectorUid?"ws":"http");return e.jsx(js,{destroyOnClose:!0,maskClosable:!1,centered:!0,title:i?`Edit datasource: ${i.attributes.name}`:"Add new datasource",open:!0,onCancel:()=>t(!1),footer:[e.jsx(F,{onClick:()=>t(!1),children:"Cancel"},"back"),e.jsxs(F,{loading:H,type:"primary",onClick:()=>{c.submit()},children:[i?"Save datasource":"Add datasource"," ",r?"& Update Function":""]},"submit")],children:e.jsxs(v,{onValuesChange:yn,onFinish:Fe,className:"dsForm",form:c,initialValues:Ue,scrollToFirstError:!0,children:[e.jsx(re,{destroyInactivePanel:!1,expandIcon:({isActive:C})=>C?e.jsx(vn,{}):e.jsx(xn,{}),defaultActiveKey:a?[]:["form"],ghost:!0,children:e.jsxs(bs,{forceRender:!0,extra:e.jsx(qe,{color:P==="local"?"gold":"green",style:{marginInlineEnd:0,textTransform:"none"},children:P}),header:"DataSource Settings",children:[e.jsx(v.Item,{colon:!1,required:!1,label:"Name",name:"name",rules:[{required:!0,message:"This field is required."},()=>({validator(C,Y){return Promise.all([Be({input:Y,searchArray:o})])}})],children:e.jsx(z,{})}),e.jsx(Q,{plain:!0,orientationMargin:200,orientation:"left",children:"Remote fetch settings"}),e.jsx(It,{style:{margin:"0 0 16px 200px"},onChange:C=>{wn(C)},value:Et,options:[{label:"HTTP",value:"http"},{label:"WebSocket",value:"ws"}]}),Et==="http"?e.jsx(v.Item,{colon:!1,required:!1,label:e.jsxs(e.Fragment,{children:[e.jsx(xt,{placement:"topLeft",star:!0})," Remote URL"]}),children:e.jsx(v.Item,{noStyle:!0,colon:!1,required:!1,name:"sourceLink",preserve:!1,normalize:C=>C===void 0?"":C,children:e.jsx(z,{allowClear:!0,spellCheck:!1,placeholder:W?"End of URL":"URL",addonBefore:e.jsxs(e.Fragment,{children:[e.jsx(v.Item,{valuePropName:"checked",name:"useBaseUrl",noStyle:!0,preserve:!1,children:e.jsx(Ze,{children:e.jsx("span",{style:{userSelect:"none"},children:"Include Base Url"})})}),e.jsx(ue,{content:e.jsxs(e.Fragment,{children:["BaseUrl: ",w||"Empty"]}),children:e.jsx(cn,{})})]})})})}):e.jsx(v.Item,{colon:!1,required:!1,preserve:!1,label:e.jsxs(e.Fragment,{children:[e.jsx(xt,{placement:"topLeft",star:!0})," Websocket Connector"]}),children:e.jsx(v.Item,{noStyle:!0,colon:!1,required:!1,name:"wsConnectorUid",preserve:!1,children:e.jsx(ke,{placeholder:"Select Websocket connector",allowClear:!0,notFoundContent:"No Websocket connectors found",options:m})})}),(!!U||!!W)&&e.jsxs(e.Fragment,{children:[e.jsx(v.Item,{label:"Request Header key",colon:!1,children:e.jsxs(vt,{gutter:8,children:[e.jsx(Ie,{flex:"auto",children:e.jsx(v.Item,{colon:!1,required:!1,noStyle:!0,name:"headerKey",normalize:C=>C===void 0?"":C,children:e.jsx(z,{addonBefore:e.jsx("div",{style:{textTransform:"uppercase",fontSize:9,color:"gray",width:70,cursor:"default"},children:N?"custom key":e.jsx(Ye,{placement:"topLeft",title:"Value inherited from Project Environment settings",arrowPointAtCenter:!0,children:"inherited"})}),placeholder:N?"Empty":y||"Empty",allowClear:!0,spellCheck:!1,disabled:!N})})}),e.jsx(Ie,{style:{alignSelf:"center"},children:e.jsx(v.Item,{noStyle:!0,colon:!1,required:!1,valuePropName:"checked",children:e.jsx(me,{onChange:C=>{fe({formKey:"headerKey",value:C})},checked:N,size:"small"})})})]})}),e.jsx(v.Item,{label:"Request Header value",colon:!1,children:e.jsxs(vt,{gutter:8,children:[e.jsx(Ie,{flex:"auto",children:e.jsx(v.Item,{colon:!1,required:!1,noStyle:!0,name:"headerValue",normalize:C=>C===void 0?"":C,children:e.jsx(z,{addonBefore:e.jsx("div",{style:{textTransform:"uppercase",fontSize:9,color:"gray",width:70,cursor:"default"},children:Z?"custom value":e.jsx(Ye,{placement:"topLeft",title:"Value inherited from Project Environment settings",arrowPointAtCenter:!0,children:"inherited"})}),placeholder:Z?"Empty":x||"Empty",allowClear:!0,spellCheck:!1,disabled:!Z})})}),e.jsx(Ie,{style:{alignSelf:"center"},children:e.jsx(v.Item,{noStyle:!0,colon:!1,required:!1,valuePropName:"checked",children:e.jsx(me,{onChange:C=>{fe({formKey:"headerValue",value:C})},checked:Z,size:"small"})})})]})})]}),e.jsx(Q,{plain:!0,orientationMargin:200,orientation:"left",children:"Datasource postprocessing & manipulation"}),e.jsx(v.Item,{colon:!1,required:!1,label:"Modify Function",name:"modificatorId",children:e.jsx(ke,{options:[{value:0,label:"None"},...f]})}),e.jsx(v.Item,{colon:!1,required:!1,label:e.jsxs("div",{style:{width:200},children:["Image preload",e.jsx(ue,{placement:"topLeft",title:"Datasource for Image preloading",content:"URLs array will be used to preload & cache images",trigger:"hover",arrowPointAtCenter:!0,children:e.jsx(Ve,{style:{marginLeft:7}})})]}),name:"isImagePreloadSource",valuePropName:"checked",children:e.jsx(me,{})})]},"form")}),e.jsx(ys,{activeKey:S,onChange:C=>{b(C)},tabBarExtraContent:{right:e.jsx("div",{style:{paddingRight:17},children:at})},animated:!1,type:"card",items:nt})]})})},Ss=({setNewGlobalContainerVisible:t,newGlobalContainerVisible:n})=>{const{projectId:a}=te(),[i,g]=h.useState(!1),d=V(x=>x.workingProject)?.attributes.globalContainers;function o(x){return!d?.some(w=>w.name===x)}const[f]=v.useForm(),m=()=>{f.submit()},y=({name:x,visibleByDefault:w,position:S})=>{g(!0);let M=[{name:x||"Global Container",visibleByDefault:w===void 0?!0:w,visibleOnPages:[],hiddenOnPages:[],elements:[],useOrientation:!1,cssClass:"globalContainer",landscapePosition:S||"top",portraitPosition:S||"top",landscape:{flow:"row",padding:{value:void 0,unit:"%"},gap:{value:void 0,unit:"%"},align:"center",distribution:"center",border:null,size:{manualMode:!1,value:void 0,unit:"%"},backgroundColor:""},portrait:{flow:"row",padding:{value:void 0,unit:"%"},gap:{value:void 0,unit:"%"},align:"center",distribution:"center",border:null,size:{manualMode:!1,value:void 0,unit:"%"},backgroundColor:""}}];d&&Array.isArray(d)&&(M=[...d,...M]),a&&on({projectId:a,inputData:{globalContainers:M}}).then(()=>{t(!1)}).finally(()=>{g(!1)})};return e.jsx("div",{onKeyUp:x=>{x.key==="Enter"&&m()},children:e.jsx(le,{afterClose:()=>f.resetFields(),maskClosable:!1,title:"Add New Global Container",open:!0,onCancel:()=>t(!1),footer:[e.jsx(F,{onClick:()=>t(!1),children:"Cancel"},"back"),e.jsx(F,{loading:i,type:"primary",onClick:m,children:"Add global container"},"submit")],children:e.jsxs(v,{labelCol:{xs:{span:8}},wrapperCol:{xs:{span:14}},form:f,onFinish:y,initialValues:{name:"Global Container",visibleByDefault:!0},scrollToFirstError:!0,children:[e.jsx(v.Item,{colon:!1,required:!1,label:"Name",name:"name",rules:[{required:!0,message:"This field is required."},()=>({validator(x,w){return w&&o(w)?Promise.resolve():Promise.reject(new Error("Container name must be unique"))}})],children:e.jsx(z,{})}),e.jsx(v.Item,{colon:!1,required:!1,name:"position",label:"Default Position",initialValue:"top",children:e.jsx(ke,{style:{width:"100%"},options:[{value:"top",label:"Top"},{value:"right",label:"Right"},{value:"bottom",label:"Bottom"},{value:"left",label:"Left"}]})}),e.jsx(v.Item,{colon:!1,required:!1,name:"visibleByDefault",label:"Default Visibility",valuePropName:"checked",children:e.jsx(me,{checkedChildren:"Visible",unCheckedChildren:"Hidden"})})]})})})},ks=({functionString:t})=>{const n={variablesUsed:[],statesUsed:[],datasourceUsed:[]};if(!t)return n;const a=t.replace(/\s+/g,"");if(/getVariableByName\(\{name:\s*([^\s'"]+)\}/.test(a))n.variablesUsed="*";else{const c=/getVariableByName\(\{name:\s*['"]([^'"]+)['"]\}\)/g,d=[];let o;for(;(o=c.exec(a))!==null;)d.push(o[1]);n.variablesUsed=[...new Set(d)]}return/window\?.avgatorStudio\?.getStoreValue/g.test(a)&&(n.statesUsed="*"),console.log("extractUsedDynamicFromFunction result",n),n};var _s="newModificatorModal_dsTabs__hs8w7r0",zt="newModificatorModal_modificatorModal__hs8w7r1",Wt="newModificatorModal_modificatorCreatingEditor__hs8w7r2",Fs="newModificatorModal_modificatorEditorsRow__hs8w7r3",Ps="newModificatorModal_createModificatorColumn__hs8w7r4",Ts="newModificatorModal_testModificatorColumn__hs8w7r5",Is="newModificatorModal_argumentTabLabel__hs8w7r6";const{Panel:qt}=re,ut=function(n){return n.trim().toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,(a,i)=>i.toUpperCase())},Ms=({setNewModificatorVisible:t,newModificatorVisible:n})=>{const a=typeof n=="number"?n:null,i=V.getState().workingProject?.attributes.modificators.data.find(s=>s.id===a),[g,c]=h.useState(!1),{projectId:d}=te(),[o,f]=h.useState([]),[m]=v.useForm(),y=v.useWatch("name",m),x="RunFunction",[w,S]=h.useState(x),b=v.useWatch("argumentsTestData",m),{addValueToStore:M,getValueFromStore:_}=Dn.getState(),{setVariableNewValue:L}=Rn.getState(),A=h.useRef(null),U=s=>{A.current=s,s.onKeyDown(u=>{const j=A.current&&A.current.getPosition().lineNumber,k=A.current&&A.current.getModel().getLineCount(),P=A.current.getSelection(),{startLineNumber:T,endLineNumber:B,selectionStartLineNumber:H}=P;(j===1||j===k||T===1||T===k||B===1||B===k||H===1||H===k)&&(u.stopPropagation(),u.preventDefault())})},W=h.useRef(null),J=s=>{W.current=s},O=()=>`arg${b.length+1}`,N=s=>{try{const u=[...b];u[s].testData="",m.setFieldsValue({argumentsTestData:u})}catch(u){console.log(u)}},Z=()=>new Promise((s,u)=>{const j=m.getFieldValue("function");if(!j){u(new Error("No function found."));return}const k=b?.map(P=>{const T=P?.testData;try{return JSON.parse(T)}catch{return T}})||[];try{let T=Vn(j)(...k,Bn(),M,_,L);typeof T=="object"?T=JSON.stringify(T):T=String(T),W.current?.getModel().setValue(T),s(T)}catch(P){console.error("Error when calling finalFunction:",P);const T=`Error when calling ${ut(y??"")}: ${P?.message}`;W.current?.getModel().setValue(T),u(P)}}),R=()=>{if(w===x)return e.jsxs("div",{style:{paddingRight:17,display:"flex",gap:5},children:[e.jsx(F,{onClick:()=>{Z().catch(j=>{console.log(j)})},icon:e.jsx(Za,{}),ghost:!0,type:"primary",children:"Run"}),e.jsx(F,{onClick:()=>{W.current?.getModel().setValue("")},danger:!0,icon:e.jsx(Me,{}),type:"dashed"})]});const s=Number(w.split("_")[1]),u=!!b?.[s]?.testData;return e.jsx("div",{style:{paddingRight:17},children:e.jsx(F,{disabled:!u,onClick:()=>{N(s)},danger:!0,icon:e.jsx(Me,{}),type:"dashed"})})};h.useEffect(()=>{if(w===x)return;const s=Number(w.split("_")[1]);b?.[s]||S(x)},[b,w]),h.useEffect(()=>{if(!y)return;const s=m.getFieldValue("function");if(!s)return;const u=b?.map(P=>P.name)??[],j=s.split(`
`),k=`function ${ut(y)}(${u.join(",")}){`;j[0]=k,m.setFieldsValue({function:j.join(`
`)})},[m,y,b]);const E=h.useMemo(()=>{let s=[];return!b?.length||b?.some(u=>u===void 0)?s=[]:s=b?.map((u,j)=>({label:e.jsxs("div",{className:Is,children:[e.jsx("small",{children:"test data"}),u.name]}),key:`argument_${j}`,children:e.jsx("div",{className:Wt,children:e.jsx(v.Item,{isListField:!0,preserve:!1,noStyle:!0,name:["argumentsTestData",j,"testData"],validateStatus:"success",normalize:k=>k===void 0?"":k,children:e.jsx(Se,{className:"monaco-editor",loading:e.jsx(ve,{}),options:{readOnly:!1,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark"})},j)})})),[{label:"Test Function",key:"RunFunction",children:e.jsx("div",{className:Wt,children:e.jsx(Se,{value:"",onMount:J,className:"monaco-editor",language:"javascript",loading:e.jsx(ve,{}),options:{readOnly:!0,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark",defaultLanguage:"javascript"})},"RunFunctionKey")},...s??[]]},[b]),ae=()=>{m.submit()},X=({name:s,function:u,argumentsTestData:j})=>{c(!0);const k=ks({functionString:u}),P={name:s||"New function",function:u,dynamicDataUsed:k};a?jn({...P},a).then(()=>{t(!1)}):d&&Ca(d,{...P,argumentsTestData:j}).then(()=>{t(!1)}),c(!1)},p=i?{name:i.attributes.name,function:i.attributes.function,argumentsTestData:i.attributes.function.substring(i.attributes.function.indexOf("(")+1,i.attributes.function.indexOf(")")).trim()===""?[]:i.attributes.function.substring(i.attributes.function.indexOf("(")+1,i.attributes.function.indexOf(")")).split(",").map(s=>({name:s.trim(),testData:null}))}:{name:"My function",function:[`function ${ut("My function")}(){`,"//write your code here","","}"].join(`
`),argumentsTestData:[]},l=()=>o.length>0?e.jsx(ue,{trigger:"hover",title:"Validation error",content:"Function contains errors",children:e.jsx(be,{style:{fontSize:14,margin:"0 0 0 5px",color:"red",cursor:"help"}})}):null,r=[{name:"Navigate",content:`
    //navigate - function to navigate by url path
    window?.avgatorStudio?.navigate("/path")
    //navigate - function to navigate by page name
    window?.avgatorStudio?.navigateToPage("my page name")
    `},{name:"Events",content:`
    //publishAnalog - function to publish analog signal
    window?.avgatorStudio?.publishAnalog({ signalName: "signalName", value: 1 })
    //publishDigital - function to publish digital signal
    window?.avgatorStudio?.publishDigital({ signalName: "signalName", value: true })
    //publishSerial - function to publish serial signal
    window?.avgatorStudio?.publishSerial({ signalName: "signalName", value: "value" })
    //getInstantDigitalFb - get instant digital feedback value
    window?.avgatorStudio?.getInstantDigitalFb({ signalName: "signalName", defaultValue: false })
    //getInstantAnalogFb - get instant analog feedback value
    window?.avgatorStudio?.getInstantAnalogFb({ signalName: "signalName", defaultValue: 0 })
    //getInstantSerialFb - get instant serial feedback value
    window?.avgatorStudio?.getInstantSerialFb({ signalName: "signalName", defaultValue: "text" })
      `},{name:"Get Datasource",content:`
    //getDatasource - function to get datasource value by uid. if no uid provided, returns all datasources
    const dataSource = window?.avgatorStudio?.getDatasource({ uid: '1234' });
      `},{name:"Variables",content:`
      //getVariableByName - function to get variable value by name
      const variableValue = window?.avgatorStudio?.getVariableByName({ name: 'variableName' });
      
      //setVariableByName - function to set variable value by name
      window?.avgatorStudio?.setVariableByName({ name: 'variableName', value: 'newValue' });
      `},{name:"Audio control",content:`
      //audioControl - function to control audio
	  window?.avgatorStudio?.audioControl({
	  value: true, //true to play, false to stop. Any type of value will be converted to boolean
	  audioLoop: false,
	  audioSrcTargetByName:'audio_file_name.mp3',
	  audioVolumePercent: 100,
	  });
      `}];return e.jsx(le,{className:zt,destroyOnClose:!0,maskClosable:!1,centered:!0,title:"Add new function",open:!0,onCancel:()=>t(!1),onOk:ae,footer:[e.jsx(F,{onClick:()=>t(!1),children:"Cancel"},"back"),e.jsx(F,{disabled:o.length>0,loading:g,type:"primary",onClick:()=>{m.submit()},children:o.length>0?"Function contains errors":"Save"},"submit")],children:e.jsxs(v,{onFinish:X,className:"modificatorForm",form:m,initialValues:p,scrollToFirstError:!0,children:[e.jsx(re,{destroyInactivePanel:!1,expandIcon:({isActive:s})=>s?e.jsx(vn,{}):e.jsx(xn,{}),defaultActiveKey:["form"],ghost:!0,children:e.jsx(qt,{forceRender:!0,header:"Function Settings",children:e.jsxs("div",{style:{display:"flex",gap:20,alignItems:"stretch",height:"100%",position:"relative"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx(v.Item,{colon:!1,required:!1,label:"Name",name:"name",rules:[{required:!0,message:"This field is required."},()=>({validator(s,u){return Promise.all([Be({input:u,searchArray:[]}),jt(u),bt(u||"")])}})],children:e.jsx(z,{spellCheck:!1})}),e.jsx(Q,{plain:!0,orientationMargin:160,orientation:"left",children:"Function Arguments"}),e.jsx(v.List,{name:"argumentsTestData",children:(s,{add:u,remove:j})=>e.jsxs(e.Fragment,{children:[s.map((k,P)=>{const{key:T,...B}=k;return e.jsxs("div",{style:{display:"flex",gap:10,alignItems:"flex-start",marginBottom:15},children:[e.jsx(v.Item,{...B,label:`Argument #${P+1}`,name:[k.name,"name"],validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."},()=>({validator(H,G){return Promise.all([Be({input:G,searchArray:b.filter((q,ge)=>ge!==P)||[],searchKey:"name"}),Xe(G),jt(G),bt(G||"")])}})],style:{marginBottom:0,flex:1},children:e.jsx(z,{spellCheck:!1,autoFocus:!0})},T),e.jsx(On,{style:{marginTop:10},onClick:()=>j(k.name)})]},k.key)}),e.jsx(v.Item,{label:" ",colon:!1,children:e.jsx(F,{type:"dashed",onClick:()=>u({name:O(),testData:void 0}),style:{width:"100%"},block:!0,icon:e.jsx(dn,{}),children:"Add Function Argument"})})]})})]}),e.jsx("div",{style:{minWidth:"50%",width:"50%",position:"relative",overflow:"auto",translate:"0 -10px"},children:e.jsx(re,{ghost:!0,accordion:!0,children:r.map(s=>e.jsx(qt,{header:s.name,children:e.jsx(ja,{wrapLongLines:!0,lineNumberContainerStyle:{display:"none"},lineNumberStyle:{display:"none"},style:{position:"relative",maxWidth:"100% !important",borderRadius:"3px"},language:"JavaScript",theme:"AtomOneDark",copy:!1,suppressContentWarning:!0,children:s.content})},s.name))})})]})},"form")}),e.jsxs("div",{className:Fs,children:[e.jsxs("div",{className:Ps,children:[e.jsxs(Q,{plain:!0,orientationMargin:17,style:{paddingRight:17,marginBottom:9.5},orientation:"left",children:["Function Body editor",e.jsx(l,{})]}),e.jsx("div",{className:zt,children:e.jsx(v.Item,{noStyle:!0,name:"function",dependencies:["name"],validateStatus:o.length?"error":void 0,rules:[()=>({validator(s,u){return o.length?Promise.reject():Promise.resolve()}})],normalize:s=>s===void 0?"":s,children:e.jsx(Se,{onMount:U,className:"monaco-editor",language:"javascript",loading:e.jsx(ve,{}),options:{readOnly:!1,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0},showUnused:!0},theme:"vs-dark",defaultLanguage:"javascript",onValidate:s=>{f(s)}})})})]}),e.jsx("div",{className:Ts,children:e.jsx(Ee,{className:_s,activeKey:w,onChange:s=>{S(s)},tabBarExtraContent:{right:e.jsx(R,{})},animated:!1,type:"card",items:E})})]})]})})},Es=({setNewPageModalVisible:t,newPageModalVisible:n})=>{const a=V.getState().workingProject?.attributes.pages.data||[],{projectId:i}=te(),[g,c]=h.useState(!1),[d]=v.useForm(),o=()=>{d.submit()},f=n==="subpage",m=v.useWatch("isStatic",d),y=({name:x,isStatic:w})=>{if(c(!0),!i)return Promise.reject("No projectId");const S=f&&w?200:void 0;return Sa({name:x,project:i,isSubpage:f,isStatic:!!w,width:{width:{value:S,unit:"px"}},height:{height:{value:S,unit:"px"}}}).then(()=>t(null)).finally(()=>c(!1))};return e.jsx(le,{width:600,afterClose:()=>d.resetFields(),maskClosable:!1,title:`Add new ${n}`,open:!0,onCancel:()=>t(null),footer:[e.jsx(F,{onClick:()=>t(null),children:"Cancel"},"back"),e.jsxs(F,{loading:g,type:"primary",onClick:o,children:["Add new ",n]},"submit")],children:e.jsxs(v,{labelCol:{xs:{span:9}},wrapperCol:{xs:{span:12}},form:d,initialValues:{name:"page name",url:"mypage"},onFinish:y,scrollToFirstError:!0,children:[e.jsx(v.Item,{colon:!1,required:!1,name:"name",label:"Name",rules:[{required:!0,message:"This field is required."},()=>({validator(x,w){return Be({input:w,searchArray:a,searchKey:["attributes","name"]})}})],children:e.jsx(z,{})}),e.jsx(Q,{}),e.jsx(v.Item,{colon:!1,required:!1,name:"isStatic",initialValue:!1,label:"Design paradigm",children:e.jsx(ba,{children:({onChange:x,value:w,...S})=>e.jsx(It,{block:!0,style:{userSelect:"none"},onChange:b=>x(b==="true"),value:w?"true":"false",options:[{label:"Adaptive",value:"true",icon:e.jsx(St,{style:{height:"auto",minWidth:"1em",margin:"0 3px -1px 0"},isStatic:!0})},{label:"Responsive",value:"false",icon:e.jsx(St,{style:{height:"auto",minWidth:"1em",margin:"0 3px -1px 0"},isStatic:!1})}],...S})})}),e.jsx(Q,{}),e.jsxs("div",{style:{color:"var(--ant-primary-5)",fontSize:12,marginBottom:4},children:[e.jsx(Ve,{style:{fontSize:14}})," How"," ",m?"adaptive":"responsive"," page layout works"]}),m?e.jsx("p",{style:{fontSize:12},children:"Adaptive page layout allow you arrange elements manually by dragging ones. Element's position & size doesn't affect each other but optionally may depends on screen size and still be adaptive."}):e.jsx("p",{style:{fontSize:12},children:"Responsive page layout based on flexbox css model and all containers on the page with all elements inside are responsive."})]})})},As=({setNewVariableModalVisible:t,newVariableModalVisible:n})=>{const a=n==="parameter",{projectId:i}=te(),{pageId:g}=te(),c=Mt({pageId:g}),d=V(O=>O.workingProject),{variables:o=[]}=d?.attributes??{},{parameters:f=[]}=c?.attributes??{},[m]=v.useForm(),y=()=>{m.submit()},[x,w]=h.useState(!1),S=async({type:O,defaultValue_boolean:N,defaultValue_number:Z,defaultValue_string:R,name:E,joinValueSetter_signal_fb:ae,formatValueFunctionUid:X})=>{let p={name:E,type:O,joinValueSetter_signal_fb:ae,formatValueFunctionUid:X};switch(p.type){case"boolean":p={...p,defaultValue:N==="true"};break;case"string":p={...p,defaultValue:R};break;case"number":p={...p,defaultValue:Z};break}w(!0);const l=p;try{await Hn({actionType:"create",variableData:l,projectId:i,pageId:g}),m.resetFields(),t(null),je.success("Successfully created")}catch(r){console.log("Error creating",r),je.error(r)}finally{w(!1)}},b={name:a?"newParameter":"newVariable",type:"boolean",defaultValue_boolean:"false",defaultValue_number:0,defaultValue_string:"",joinValueSetter_signal_fb:"",formatValueFunctionUid:void 0},M={project:o,parameter:f},[_,L]=h.useState(b),A=h.useMemo(()=>a?"Create Subpage Parameter":"Create Project Variable",[a]),[U,W]=h.useState(!1),J=h.useMemo(()=>{const O=zn.getState().formatterFunctions[_.type??"boolean"];return O?.length?O.map(N=>{const{uid:Z,name:R}=N;return{label:R,value:Z}}):[]},[_.type]);return n?e.jsx(e.Fragment,{children:e.jsx(le,{maskClosable:!1,title:A,open:!0,width:"50vw",onOk:y,onCancel:()=>t(null),footer:[e.jsx(F,{onClick:()=>t(null),children:"Cancel"},"back"),e.jsxs(F,{loading:x,type:"primary",onClick:y,children:["Create ",a?"Parameter":"Variable"]},"submit")],children:e.jsxs(v,{onValuesChange:O=>L({..._,...O}),labelCol:{xs:{span:9}},wrapperCol:{xs:{span:12}},form:m,initialValues:b,onFinish:S,scrollToFirstError:!0,children:[e.jsx(v.Item,{colon:!1,name:"name",label:"Name",rules:[{required:!0,message:"This field is required."},()=>({validator(O,N){return Promise.all([Be({input:N,searchArray:M[n],searchKey:"name"}),Xe(N),jt(N),bt(N)])}})],children:e.jsx(z,{spellCheck:!1})}),e.jsx(v.Item,{colon:!1,name:"type",label:"Type",rules:[{required:!1}],children:e.jsxs(xe.Group,{className:"radioFullWidth",buttonStyle:"solid",children:[e.jsx(xe.Button,{value:"boolean",children:"Boolean"}),e.jsx(xe.Button,{value:"string",children:"String"}),e.jsx(xe.Button,{value:"number",children:"Number"})]})}),_.type==="string"&&e.jsx(v.Item,{colon:!1,name:"defaultValue_string",label:"Default Value",children:e.jsx(z,{spellCheck:!1})}),_.type==="boolean"&&e.jsx(e.Fragment,{children:e.jsx(v.Item,{colon:!1,name:"defaultValue_boolean",label:"Default Value",children:e.jsx(It,{block:!0,options:["true","false"]})})}),_.type==="number"&&e.jsx(v.Item,{colon:!1,name:"defaultValue_number",label:"Default Value",rules:[()=>({validator(O,N){return Promise.all([Wn(N),qn(N)])}})],children:e.jsx(z,{style:{width:"100%"}})}),!a&&_.type&&e.jsx(v.Item,{extra:e.jsx(e.Fragment,{children:"Use signal feedback to modify variable"}),colon:!1,name:"joinValueSetter_signal_fb",label:e.jsx(e.Fragment,{children:"Set value Signal "}),rules:[()=>({validator(O,N){return Xe(N)}})],children:e.jsx(z,{suffix:e.jsx("div",{style:{marginRight:-5,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:_.type,sub:"FB"})}),spellCheck:!1})}),e.jsx(v.Item,{colon:!1,label:e.jsx(e.Fragment,{}),children:e.jsx(Ze,{checked:U,onChange:O=>W(O.target.checked),children:"Format output value"})}),U&&e.jsx(v.Item,{colon:!1,name:"formatValueFunctionUid",label:e.jsx(e.Fragment,{children:"Format value with function "}),children:e.jsx(ke,{allowClear:!0,style:{width:"100%",minWidth:"250px"},placeholder:"Select formatter function",showSearch:!0,filterOption:(O,N)=>N.label.toLowerCase().includes(O.toLowerCase()),options:J})})]})})}):null};var mt={},ht={},gt={},Ht;function Ls(){return Ht||(Ht=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){for(var g=arguments.length,c=new Array(g),d=0;d<g;d++)c[d]=arguments[d];if(typeof window<"u"){var o;typeof window.gtag>"u"&&(window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)}),(o=window).gtag.apply(o,c)}},a=n;t.default=a}(gt)),gt}var ft={},Gt;function Ns(){return Gt||(Gt=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=d;var n=/^(a|an|and|as|at|but|by|en|for|if|in|nor|of|on|or|per|the|to|vs?\.?|via)$/i;function a(o){return o.toString().trim().replace(/[A-Za-z0-9\u00C0-\u00FF]+[^\s-]*/g,function(f,m,y){return m>0&&m+f.length!==y.length&&f.search(n)>-1&&y.charAt(m-2)!==":"&&(y.charAt(m+f.length)!=="-"||y.charAt(m-1)==="-")&&y.charAt(m-1).search(/[^\s-]/)<0?f.toLowerCase():f.substr(1).search(/[A-Z]|\../)>-1?f:f.charAt(0).toUpperCase()+f.substr(1)})}function i(o){return typeof o=="string"&&o.indexOf("@")!==-1}var g="REDACTED (Potential Email Address)";function c(o){return i(o)?(console.warn("This arg looks like an email address, redacting."),g):o}function d(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,y=o||"";return f&&(y=a(o)),m&&(y=c(y)),y}}(ft)),ft}var Ut;function Ds(){return Ut||(Ut=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.GA4=void 0;var n=o(Ls()),a=o(Ns()),i=["eventCategory","eventAction","eventLabel","eventValue","hitType"],g=["title","location"],c=["page","hitType"],d=["action","category","label","value","nonInteraction","transport"];function o(p){return p&&p.__esModule?p:{default:p}}function f(p,l){if(p==null)return{};var r=m(p,l),s,u;if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(p);for(u=0;u<j.length;u++)s=j[u],!(l.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(p,s)&&(r[s]=p[s])}return r}function m(p,l){if(p==null)return{};var r={},s=Object.keys(p),u,j;for(j=0;j<s.length;j++)u=s[j],!(l.indexOf(u)>=0)&&(r[u]=p[u]);return r}function y(p){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?y=function(r){return typeof r}:y=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},y(p)}function x(p){return b(p)||S(p)||U(p)||w()}function w(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function S(p){if(typeof Symbol<"u"&&p[Symbol.iterator]!=null||p["@@iterator"]!=null)return Array.from(p)}function b(p){if(Array.isArray(p))return W(p)}function M(p,l){var r=Object.keys(p);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(p);l&&(s=s.filter(function(u){return Object.getOwnPropertyDescriptor(p,u).enumerable})),r.push.apply(r,s)}return r}function _(p){for(var l=1;l<arguments.length;l++){var r=arguments[l]!=null?arguments[l]:{};l%2?M(Object(r),!0).forEach(function(s){E(p,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach(function(s){Object.defineProperty(p,s,Object.getOwnPropertyDescriptor(r,s))})}return p}function L(p,l){return O(p)||J(p,l)||U(p,l)||A()}function A(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function U(p,l){if(p){if(typeof p=="string")return W(p,l);var r=Object.prototype.toString.call(p).slice(8,-1);if(r==="Object"&&p.constructor&&(r=p.constructor.name),r==="Map"||r==="Set")return Array.from(p);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W(p,l)}}function W(p,l){(l==null||l>p.length)&&(l=p.length);for(var r=0,s=new Array(l);r<l;r++)s[r]=p[r];return s}function J(p,l){var r=p==null?null:typeof Symbol<"u"&&p[Symbol.iterator]||p["@@iterator"];if(r!=null){var s=[],u=!0,j=!1,k,P;try{for(r=r.call(p);!(u=(k=r.next()).done)&&(s.push(k.value),!(l&&s.length===l));u=!0);}catch(T){j=!0,P=T}finally{try{!u&&r.return!=null&&r.return()}finally{if(j)throw P}}return s}}function O(p){if(Array.isArray(p))return p}function N(p,l){if(!(p instanceof l))throw new TypeError("Cannot call a class as a function")}function Z(p,l){for(var r=0;r<l.length;r++){var s=l[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(p,s.key,s)}}function R(p,l,r){return l&&Z(p.prototype,l),p}function E(p,l,r){return l in p?Object.defineProperty(p,l,{value:r,enumerable:!0,configurable:!0,writable:!0}):p[l]=r,p}var ae=function(){function p(){var l=this;N(this,p),E(this,"reset",function(){l.isInitialized=!1,l._testMode=!1,l._currentMeasurementId,l._hasLoadedGA=!1,l._isQueuing=!1,l._queueGtag=[]}),E(this,"_gtag",function(){for(var r=arguments.length,s=new Array(r),u=0;u<r;u++)s[u]=arguments[u];l._testMode||l._isQueuing?l._queueGtag.push(s):n.default.apply(void 0,s)}),E(this,"_loadGA",function(r,s){if(!(typeof window>"u"||typeof document>"u")&&!l._hasLoadedGA){var u=document.createElement("script");u.async=!0,u.src="https://www.googletagmanager.com/gtag/js?id=".concat(r),s&&u.setAttribute("nonce",s),document.body.appendChild(u),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},l._hasLoadedGA=!0}}),E(this,"_toGtagOptions",function(r){if(r){var s={cookieUpdate:"cookie_update",cookieExpires:"cookie_expires",cookieDomain:"cookie_domain",cookieFlags:"cookie_flags",userId:"user_id",clientId:"client_id",anonymizeIp:"anonymize_ip",contentGroup1:"content_group1",contentGroup2:"content_group2",contentGroup3:"content_group3",contentGroup4:"content_group4",contentGroup5:"content_group5",allowAdFeatures:"allow_google_signals",allowAdPersonalizationSignals:"allow_ad_personalization_signals",nonInteraction:"non_interaction",page:"page_path",hitCallback:"event_callback"},u=Object.entries(r).reduce(function(j,k){var P=L(k,2),T=P[0],B=P[1];return s[T]?j[s[T]]=B:j[T]=B,j},{});return u}}),E(this,"initialize",function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!r)throw new Error("Require GA_MEASUREMENT_ID");var u=typeof r=="string"?[{trackingId:r}]:r;l._currentMeasurementId=u[0].trackingId;var j=s.gaOptions,k=s.gtagOptions,P=s.legacyDimensionMetric,T=P===void 0?!0:P,B=s.nonce,H=s.testMode,G=H===void 0?!1:H;if(l._testMode=G,G||l._loadGA(l._currentMeasurementId,B),l.isInitialized||(l._gtag("js",new Date),u.forEach(function(ie){var Ae=l._appendCustomMap(_(_(_({send_page_view:!1},l._toGtagOptions(_(_({},j),ie.gaOptions))),k),ie.gtagOptions),T);l._gtag("config",ie.trackingId,Ae)})),l.isInitialized=!0,!G){var q=x(l._queueGtag);for(l._queueGtag=[],l._isQueuing=!1;q.length;){var ge=q.shift();l._gtag.apply(l,x(ge)),ge[0]==="get"&&(l._isQueuing=!0)}}}),E(this,"set",function(r){if(!r){console.warn("`fieldsObject` is required in .set()");return}if(y(r)!=="object"){console.warn("Expected `fieldsObject` arg to be an Object");return}Object.keys(r).length===0&&console.warn("empty `fieldsObject` given to .set()"),l._gaCommand("set",r)}),E(this,"_gaCommandSendEvent",function(r,s,u,j,k){l._gtag("event",s,_(_({event_category:r,event_label:u,value:j},k&&{non_interaction:k.nonInteraction}),l._toGtagOptions(k)))}),E(this,"_gaCommandSendEventParameters",function(){for(var r=arguments.length,s=new Array(r),u=0;u<r;u++)s[u]=arguments[u];if(typeof s[0]=="string")l._gaCommandSendEvent.apply(l,x(s.slice(1)));else{var j=s[0],k=j.eventCategory,P=j.eventAction,T=j.eventLabel,B=j.eventValue;j.hitType;var H=f(j,i);l._gaCommandSendEvent(k,P,T,B,H)}}),E(this,"_gaCommandSendTiming",function(r,s,u,j){l._gtag("event","timing_complete",{name:s,value:u,event_category:r,event_label:j})}),E(this,"_gaCommandSendPageview",function(r,s){if(s&&Object.keys(s).length){var u=l._toGtagOptions(s),j=u.title,k=u.location,P=f(u,g);l._gtag("event","page_view",_(_(_(_({},r&&{page_path:r}),j&&{page_title:j}),k&&{page_location:k}),P))}else r?l._gtag("event","page_view",{page_path:r}):l._gtag("event","page_view")}),E(this,"_gaCommandSendPageviewParameters",function(){for(var r=arguments.length,s=new Array(r),u=0;u<r;u++)s[u]=arguments[u];if(typeof s[0]=="string")l._gaCommandSendPageview.apply(l,x(s.slice(1)));else{var j=s[0],k=j.page;j.hitType;var P=f(j,c);l._gaCommandSendPageview(k,P)}}),E(this,"_gaCommandSend",function(){for(var r=arguments.length,s=new Array(r),u=0;u<r;u++)s[u]=arguments[u];var j=typeof s[0]=="string"?s[0]:s[0].hitType;switch(j){case"event":l._gaCommandSendEventParameters.apply(l,s);break;case"pageview":l._gaCommandSendPageviewParameters.apply(l,s);break;case"timing":l._gaCommandSendTiming.apply(l,x(s.slice(1)));break;case"screenview":case"transaction":case"item":case"social":case"exception":console.warn("Unsupported send command: ".concat(j));break;default:console.warn("Send command doesn't exist: ".concat(j))}}),E(this,"_gaCommandSet",function(){for(var r=arguments.length,s=new Array(r),u=0;u<r;u++)s[u]=arguments[u];typeof s[0]=="string"&&(s[0]=E({},s[0],s[1])),l._gtag("set",l._toGtagOptions(s[0]))}),E(this,"_gaCommand",function(r){for(var s=arguments.length,u=new Array(s>1?s-1:0),j=1;j<s;j++)u[j-1]=arguments[j];switch(r){case"send":l._gaCommandSend.apply(l,u);break;case"set":l._gaCommandSet.apply(l,u);break;default:console.warn("Command doesn't exist: ".concat(r))}}),E(this,"ga",function(){for(var r=arguments.length,s=new Array(r),u=0;u<r;u++)s[u]=arguments[u];if(typeof s[0]=="string")l._gaCommand.apply(l,s);else{var j=s[0];l._gtag("get",l._currentMeasurementId,"client_id",function(k){l._isQueuing=!1;var P=l._queueGtag;for(j({get:function(H){return H==="clientId"?k:H==="trackingId"?l._currentMeasurementId:H==="apiVersion"?"1":void 0}});P.length;){var T=P.shift();l._gtag.apply(l,x(T))}}),l._isQueuing=!0}return l.ga}),E(this,"event",function(r,s){if(typeof r=="string")l._gtag("event",r,l._toGtagOptions(s));else{var u=r.action,j=r.category,k=r.label,P=r.value,T=r.nonInteraction,B=r.transport,H=f(r,d);if(!j||!u){console.warn("args.category AND args.action are required in event()");return}var G={hitType:"event",eventCategory:(0,a.default)(j),eventAction:(0,a.default)(u)};k&&(G.eventLabel=(0,a.default)(k)),typeof P<"u"&&(typeof P!="number"?console.warn("Expected `args.value` arg to be a Number."):G.eventValue=P),typeof T<"u"&&(typeof T!="boolean"?console.warn("`args.nonInteraction` must be a boolean."):G.nonInteraction=T),typeof B<"u"&&(typeof B!="string"?console.warn("`args.transport` must be a string."):(["beacon","xhr","image"].indexOf(B)===-1&&console.warn("`args.transport` must be either one of these values: `beacon`, `xhr` or `image`"),G.transport=B)),Object.keys(H).filter(function(q){return q.substr(0,9)==="dimension"}).forEach(function(q){G[q]=H[q]}),Object.keys(H).filter(function(q){return q.substr(0,6)==="metric"}).forEach(function(q){G[q]=H[q]}),l._gaCommand("send",G)}}),E(this,"send",function(r){l._gaCommand("send",r)}),E(this,"pageview",function(r,s,u){var j=r?.trim();if(j===""){console.warn("path cannot be an empty string in .pageview()");return}l._gaCommand("send","pageview",j,{title:u})}),this.reset()}return R(p,[{key:"gtag",value:function(){this._gtag.apply(this,arguments)}},{key:"_appendCustomMap",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!s)return r;r.custom_map||(r.custom_map={});for(var u=1;u<=200;u++)r.custom_map["dimension".concat(u)]||(r.custom_map["dimension".concat(u)]="dimension".concat(u)),r.custom_map["metric".concat(u)]||(r.custom_map["metric".concat(u)]="metric".concat(u));return r}},{key:"outboundLink",value:function(r,s){var u=r.label;if(typeof s!="function"){console.warn("hitCallback function is required");return}if(!u){console.warn("args.label is required in outboundLink()");return}var j={hitType:"event",eventCategory:"Outbound",eventAction:"Click",eventLabel:(0,a.default)(u)},k=!1,P=function(){k=!0,s()},T=setTimeout(P,250),B=function(){clearTimeout(T),k||s()};j.hitCallback=B,this._gaCommand("send",j)}}]),p}();t.GA4=ae;var X=new ae;t.default=X}(ht)),ht}var $t;function Rs(){return $t||($t=1,function(t){function n(o){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(m){return typeof m}:n=function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},n(o)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ReactGAImplementation=void 0;var a=g(Ds());function i(o){if(typeof WeakMap!="function")return null;var f=new WeakMap,m=new WeakMap;return(i=function(x){return x?m:f})(o)}function g(o,f){if(o&&o.__esModule)return o;if(o===null||n(o)!=="object"&&typeof o!="function")return{default:o};var m=i(f);if(m&&m.has(o))return m.get(o);var y={},x=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in o)if(w!=="default"&&Object.prototype.hasOwnProperty.call(o,w)){var S=x?Object.getOwnPropertyDescriptor(o,w):null;S&&(S.get||S.set)?Object.defineProperty(y,w,S):y[w]=o[w]}return y.default=o,m&&m.set(o,y),y}var c=a.GA4;t.ReactGAImplementation=c;var d=a.default;t.default=d}(mt)),mt}var Os=Rs();const Kt=Gn(Os),Vs=({workingProject:t})=>{const n=h.useRef(),a=h.useRef();h.useEffect(()=>{clearTimeout(n.current),clearTimeout(a.current);const i=g=>{const{type:c}=g;c==="CLAIM"&&(clearTimeout(a.current),a.current=setTimeout(()=>{Dt({type:"LIVE",payload:t})},300))};return Un(i),n.current=setTimeout(()=>{console.log("Updated project sent to live"),Dt({type:"LIVE",payload:t})},500),()=>{$n(i)}},[t])},Bs=K.memo(()=>{const t=ee.getState().setMainMenuData,n=ee(c=>c.isConsoleOpen),i=ee(c=>c.consoleLogs)?.length??0,g=i>100?"100+":i;return e.jsx("div",{"data-counter":g,className:g?"customBadge":"",children:e.jsx(Ye,{title:"Show/Hide Console",children:e.jsx(F,{onFocus:c=>c.target.blur(),type:n?"primary":"default",onClick:()=>{t({isConsoleOpen:!n})},icon:e.jsx(Da,{})})})})});var zs="renderAppTopBar_topBarContainer__1ey9s4v0",Ws="renderAppTopBar_tabsRow__1ey9s4v1",qs="renderAppTopBar_pagesTabsArea__1ey9s4v2",Hs="renderAppTopBar_pagesTabsAreaInner__1ey9s4v3",Gs="renderAppTopBar_pagesTabsHolder__1ey9s4v4",Us="renderAppTopBar_envButtonArea__1ey9s4v5",Jt="renderAppTopBar_tabsAntComponent__1ey9s4v6",Zt="renderAppTopBar_tabContent__1ey9s4v7",Xt="renderAppTopBar_tabIcon__1ey9s4v8",Yt="renderAppTopBar_tabLabel__1ey9s4v9",$s="renderAppTopBar_tabSubIndicator__1ey9s4va",Qt={saved:"renderAppTopBar_saveIndicator_saved__1ey9s4vc renderAppTopBar_tabUnsaved__1ey9s4vb",unsaved:"renderAppTopBar_saveIndicator_unsaved__1ey9s4vd renderAppTopBar_tabUnsaved__1ey9s4vb"},en="renderAppTopBar_tabClose__1ey9s4ve",Ks="renderAppTopBar_envSelectorWrapper__1ey9s4vf",Js="renderAppTopBar_envLiveStartButton__1ey9s4vg",Zs="renderAppTopBar_envSelectorButton__1ey9s4vh",Xs="renderAppTopBar_topBarControlsRow__1ey9s4vj",Ys="renderAppTopBar_viewLayoutContentBox__1ey9s4vk",pt="renderAppTopBar_viewLayoutContentRow__1ey9s4vl",Qs="renderAppTopBar_testDeviceRadioItem__1ey9s4vn",er="renderAppTopBar_secondTabsRow__1ey9s4vo",tr="renderAppTopBar_connectionManagerButton__1ey9s4vp";const nr=({setEditProjectModalId:t,projectId:n})=>{const a=V(f=>f.workingProject?.attributes.env),i=V(f=>f.workingProject?.attributes.selectedEnv),g=h.useMemo(()=>i?a?.find(f=>f.envId===i)?.envName??"Default":"Default",[a,i]),c=({envUidToSelect:f})=>{const m=V.getState().updateProjectWithHistory;m({selectedEnv:f},!1)},d=h.useMemo(()=>a?.length?a.map(m=>({key:m.envId,label:e.jsx("div",{onClick:()=>c({envUidToSelect:m.envId}),children:m.envName}),icon:e.jsx(it,{})})):[],[a]),o=[{key:"default",label:e.jsx("div",{onClick:()=>c({envUidToSelect:""}),children:"Default"}),icon:e.jsx(it,{})},...d??[],{key:"env divider",label:e.jsx(Q,{style:{margin:0}})},{key:"env settings",label:e.jsx("div",{onClick:()=>t(Number(n)),children:"Project ENV settings"}),icon:e.jsx(wa,{})}];return e.jsxs("div",{className:Ks,children:[e.jsx(un,{className:"GlobalEnvSelector",dropdownRender:()=>e.jsx(Jn,{items:o,style:{whiteSpace:"nowrap"}}),trigger:["click"],children:e.jsxs("div",{className:Zs,children:[e.jsxs("span",{children:[e.jsx(it,{style:{marginRight:5}}),g]}),e.jsx(Kn,{})]})}),e.jsx(Ye,{placement:"bottomRight",title:"Open Project LIVE Preview",children:e.jsx("a",{href:Zn(),target:"_blank",rel:"noreferrer",className:Js,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:28,height:28,viewBox:"0 0 28 28",children:e.jsx("path",{fill:"currentColor",d:"M25 9.5v5A7.5 7.5 0 0 0 14.5 25H6.25A3.25 3.25 0 0 1 3 21.75V9.5zM21.75 3A3.25 3.25 0 0 1 25 6.25V8H3V6.25A3.25 3.25 0 0 1 6.25 3zM20.5 27a6.5 6.5 0 1 0 0-13a6.5 6.5 0 0 0 0 13m-.902-9.404l4.032 2.275a.72.72 0 0 1 0 1.258l-4.032 2.274c-.49.277-1.098-.072-1.098-.629v-4.548c0-.557.609-.905 1.098-.63"})})})})]})},ar=({projectName:t,isProfilePage:n})=>{const{projectId:a}=te(),i=kt(c=>c.user?.email);let g="My Projects";return a?g=t||e.jsx(ve,{}):n&&(g=e.jsxs(e.Fragment,{children:[e.jsx(mn,{}),i]})),e.jsx(e.Fragment,{children:g})},sr=K.memo(()=>{const t=()=>{const{displayGuidePos:n,showGuides:a,lockGuides:i}=ne(o=>o.guidesOptions),g=ne.getState().updateEnvGuidesOptions,c=V(o=>o.workingProject?.attributes.guides),d=!!c?.horizontal?.length||!!c?.vertical?.length;return e.jsxs("div",{className:Ys,children:[e.jsxs("div",{className:pt,children:[e.jsx(me,{size:"small",checked:a,onChange:()=>{g({showGuides:!a})}}),"Show Guides"]}),e.jsxs("div",{className:pt,children:[e.jsx(me,{disabled:!a,size:"small",checked:n,onChange:()=>{g({displayGuidePos:!n})}}),"Display Guides Positions"]}),e.jsxs("div",{className:pt,children:[e.jsx(me,{size:"small",checked:i,onChange:()=>{g({lockGuides:!i})}}),"Lock Guides"]}),e.jsx(Q,{style:{margin:"5px 0"}}),e.jsx(F,{disabled:!d,icon:e.jsx(Ft,{}),onClick:()=>{ua()},children:"Delete all Guides"})]})};return e.jsx(ue,{placement:"bottomLeft",content:e.jsx(t,{}),trigger:"hover",children:e.jsx(F,{onFocus:n=>n.target.blur(),onClick:()=>{},icon:e.jsx("svg",{style:{translate:"-0.3em 0.1em"},xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 14 14",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",d:"M12.5.5h-11a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-11a1 1 0 0 0-1-1m-12 3h13m-9 0v10m9-5h-9"})}),children:"View"})})}),Oe="mainProjectTab",rr=()=>{const{pageId:t}=te(),{projectId:n}=te(),a=Pt(),i=V(b=>b.tabs),g=V(b=>b.pagesHashes),c=V(b=>b.workingProject?.attributes.pages.data)??[],d=V(b=>b.currentProjectHash),o=V(b=>b.savedProjectHash),f=d===o,{removeTab:m}=V.getState();function y(b){async function M(){const{lastUseProjectTabKey:_=""}=ee.getState(),L=_?`/${_}`:"";a(`/projects/${n}${L}`)}t===b&&M().then(()=>{m(b)}),m(b)}const x=h.useCallback(b=>{const{lastUseProjectTabKey:M}=ee.getState(),L=b===Oe?(U=>U?`/${U}`:"")(M):"",A=b===Oe?`/projects/${n}`:`/projects/${n}/page/${b}`;a(A+L)},[a,n]),w=[];for(const b of i){const M=c.find(J=>String(J.id)===b.pageId);if(!M)continue;const _=g.find(J=>String(J.pageId)===String(b.pageId)),{name:L,isSubpage:A,isStatic:U}=M.attributes,W=_?_.currentHash!==_.savedHash:!1;w.push({label:e.jsxs("div",{className:Zt,children:[e.jsx("div",{className:Xt,children:e.jsx(St,{style:{height:"auto",width:"1em"},isStatic:U})}),e.jsx("div",{className:$s,children:A?"sub":null}),e.jsx("div",{className:Qt[W?"unsaved":"saved"]}),e.jsx("div",{className:Yt,children:L}),e.jsx("div",{onClick:J=>{J.stopPropagation(),y(b.pageId)},className:en,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.3em",height:"1.3em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m7 7l10 10M7 17L17 7"})})})]}),key:b.pageId})}const S={label:e.jsxs("div",{className:Zt,children:[e.jsx("div",{className:Xt,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 15 15",children:e.jsx("path",{fill:"currentColor",d:"M1.5 0A1.5 1.5 0 0 0 0 1.5v4A1.5 1.5 0 0 0 1.5 7h4A1.5 1.5 0 0 0 7 5.5v-4A1.5 1.5 0 0 0 5.5 0zm8 0A1.5 1.5 0 0 0 8 1.5v4A1.5 1.5 0 0 0 9.5 7h4A1.5 1.5 0 0 0 15 5.5v-4A1.5 1.5 0 0 0 13.5 0zm-8 8A1.5 1.5 0 0 0 0 9.5v4A1.5 1.5 0 0 0 1.5 15h4A1.5 1.5 0 0 0 7 13.5v-4A1.5 1.5 0 0 0 5.5 8zm8 0A1.5 1.5 0 0 0 8 9.5v4A1.5 1.5 0 0 0 9.5 15h4a1.5 1.5 0 0 0 1.5-1.5v-4A1.5 1.5 0 0 0 13.5 8z"})})}),e.jsx("div",{className:Qt[f?"saved":"unsaved"]}),e.jsx("div",{className:Yt,children:"Project"}),e.jsx("div",{onClick:b=>{b.stopPropagation(),a("/projects/")},className:en,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.3em",height:"1.3em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m7 7l10 10M7 17L17 7"})})})]}),key:Oe};return e.jsxs("div",{className:Hs,children:[e.jsx(Ee,{className:Jt,activeKey:t??Oe,onChange:x,items:[S]}),e.jsx("div",{className:Gs,children:e.jsx(Ee,{className:Jt,popupClassName:"pagesTabsPopup",activeKey:t??Oe,onChange:x,items:w})})]})};var or="secondRowTabs_secondRowTabContainer__1jvc5q0",de="secondRowTabs_tabLabel__1jvc5q1";const ir=[{label:e.jsxs("span",{className:de,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M12 17h.009M20 8.5v5c0 3.771 0 5.657-1.172 6.828S15.771 21.5 12 21.5s-5.657 0-6.828-1.172S4 17.271 4 13.5v-5"}),e.jsx("path",{d:"m22 10.5l-4.343-4.165C14.99 3.778 13.657 2.5 12 2.5S9.01 3.778 6.343 6.335L2 10.5"})]})}),"Dashboard"]}),key:"projectDashboard"},{label:e.jsxs("span",{className:de,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M3.5 10c0-3.771 0-5.657 1.245-6.828S7.993 2 12 2h.773c3.26 0 4.892 0 6.024.798c.324.228.612.5.855.805c.848 1.066.848 2.6.848 5.67v2.545c0 2.963 0 4.445-.469 5.628c-.754 1.903-2.348 3.403-4.37 4.113c-1.257.441-2.83.441-5.98.441c-1.798 0-2.698 0-3.416-.252c-1.155-.406-2.066-1.263-2.497-2.35c-.268-.676-.268-1.523-.268-3.216z"}),e.jsx("path",{d:"M20.5 12a3.333 3.333 0 0 1-3.333 3.333c-.666 0-1.451-.116-2.098.057a1.67 1.67 0 0 0-1.179 1.179c-.173.647-.057 1.432-.057 2.098A3.333 3.333 0 0 1 10.5 22M8 7h7m-7 4h3"})]})}),"Pages"]}),key:"projectPages"},{label:e.jsxs("span",{className:de,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M20 12.5V7.818c0-1.693 0-2.54-.268-3.216c-.43-1.087-1.342-1.944-2.497-2.35C16.517 2 15.617 2 13.818 2c-3.148 0-4.722 0-5.98.441c-2.02.71-3.615 2.21-4.37 4.113C3 7.737 3 9.219 3 12.182v2.545c0 3.07 0 4.604.848 5.67q.366.461.855.805C5.81 21.982 7.39 22 10.5 22"}),e.jsx("path",{d:"M3 12a3.333 3.333 0 0 1 3.333-3.333c.666 0 1.451.116 2.098-.057A1.67 1.67 0 0 0 9.61 7.43c.173-.647.057-1.432.057-2.098A3.333 3.333 0 0 1 13 2m1.813 20c-.57-.59-2.813-2.16-2.813-3s2.244-2.41 2.813-3m3.374 6c.57-.59 2.813-2.16 2.813-3s-2.244-2.41-2.812-3"})]})}),"SubPages"]}),key:"projectSubPages"},{label:e.jsxs("span",{className:de,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2 12c0-3.69 0-5.534.814-6.841a4.8 4.8 0 0 1 1.105-1.243C5.08 3 6.72 3 10 3h4c3.28 0 4.919 0 6.081.916c.43.338.804.759 1.105 1.243C22 6.466 22 8.31 22 12s0 5.534-.814 6.841a4.8 4.8 0 0 1-1.105 1.243C18.92 21 17.28 21 14 21h-4c-3.28 0-4.919 0-6.081-.916a4.8 4.8 0 0 1-1.105-1.243C2 17.534 2 15.69 2 12m7.5-9v18M5 7h1m-1 3h1",color:"currentColor"})}),"Global Containers"]}),key:"projectGlobalContainers"},{label:e.jsxs("span",{className:de,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M2.5 12c0-4.478 0-6.718 1.391-8.109S7.521 2.5 12 2.5c4.478 0 6.718 0 8.109 1.391S21.5 7.521 21.5 12c0 4.478 0 6.718-1.391 8.109S16.479 21.5 12 21.5c-4.478 0-6.718 0-8.109-1.391S2.5 16.479 2.5 12"}),e.jsx("path",{d:"M16 9c-3.184 0-4.816 6.02-8 6.02"}),e.jsx("path",{d:"M15.54 15.02c-.809 0-1.253 0-1.594-.12a1.8 1.8 0 0 1-.52-.284c-.265-.21-.41-.509-.7-1.108l-1.451-2.995c-.29-.6-.436-.9-.7-1.108a1.8 1.8 0 0 0-.52-.284C9.712 9 9.268 9 8.46 9"})]})}),"Variables"]}),key:"projectVariables"},{label:e.jsxs("span",{className:de,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("ellipse",{cx:12,cy:5,rx:8,ry:3}),e.jsx("path",{d:"M20 12c0 1.657-3.582 3-8 3s-8-1.343-8-3"}),e.jsx("path",{d:"M20 5v14c0 1.657-3.582 3-8 3s-8-1.343-8-3V5m4 3v2m0 5v2"})]})}),"Data Sources"]}),key:"projectDataSources"},{label:e.jsxs("span",{className:de,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M8 15.889C8.15 16.42 8.455 17 9.25 17c1.375 0 1.719-1.111 2.75-5s1.375-5 2.75-5c.795 0 1.1.58 1.25 1.111m-5.667 2.5h4.417"}),e.jsx("path",{d:"M2.5 12c0-4.478 0-6.718 1.391-8.109S7.521 2.5 12 2.5c4.478 0 6.718 0 8.109 1.391S21.5 7.521 21.5 12c0 4.478 0 6.718-1.391 8.109S16.479 21.5 12 21.5c-4.478 0-6.718 0-8.109-1.391S2.5 16.479 2.5 12"})]})}),"Functions"]}),key:"projectFunctions"},{label:e.jsxs("span",{className:de,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("circle",{cx:7.5,cy:7.5,r:1.5}),e.jsx("path",{d:"M2.5 12c0-4.478 0-6.718 1.391-8.109S7.521 2.5 12 2.5c4.478 0 6.718 0 8.109 1.391S21.5 7.521 21.5 12c0 4.478 0 6.718-1.391 8.109S16.479 21.5 12 21.5c-4.478 0-6.718 0-8.109-1.391S2.5 16.479 2.5 12"}),e.jsx("path",{d:"M5 21c4.372-5.225 9.274-12.116 16.498-7.458"})]})}),"Media Assets"]}),key:"projectMedia"}],lr=({isSubpage:t})=>[{label:e.jsxs("span",{className:de,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 3c0-.471 0-.707-.146-.854C15.707 2 15.47 2 15 2h-1c-.471 0-.707 0-.854.146C13 2.293 13 2.53 13 3v1c0 .471 0 .707.146.854C13.293 5 13.53 5 14 5h1c.471 0 .707 0 .854-.146C16 4.707 16 4.47 16 4zM8.333 8.407C9.938 6.68 22.01 10.913 22 12.46c-.011 1.752-4.714 2.292-6.018 2.658c-.784.22-.994.445-1.175 1.267c-.818 3.723-1.23 5.574-2.166 5.616c-1.493.066-5.874-11.906-4.308-13.593M5 3c0-.471 0-.707-.146-.854C4.707 2 4.47 2 4 2H3c-.471 0-.707 0-.854.146C2 2.293 2 2.53 2 3v1c0 .471 0 .707.146.854C2.293 5 2.53 5 3 5h1c.471 0 .707 0 .854-.146C5 4.707 5 4.47 5 4zm0 11c0-.471 0-.707-.146-.854C4.707 13 4.47 13 4 13H3c-.471 0-.707 0-.854.146C2 13.293 2 13.53 2 14v1c0 .471 0 .707.146.854C2.293 16 2.53 16 3 16h1c.471 0 .707 0 .854-.146C5 15.707 5 15.47 5 15zm-1.5-1V5M13 3.5H5",color:"currentColor"})}),"Editor"]}),key:"pageEditor"},{label:e.jsxs("span",{className:de,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M2.5 12c0-4.478 0-6.718 1.391-8.109S7.521 2.5 12 2.5c4.478 0 6.718 0 8.109 1.391S21.5 7.521 21.5 12c0 4.478 0 6.718-1.391 8.109S16.479 21.5 12 21.5c-4.478 0-6.718 0-8.109-1.391S2.5 16.479 2.5 12"}),e.jsx("path",{d:"M16 9c-3.184 0-4.816 6.02-8 6.02"}),e.jsx("path",{d:"M15.54 15.02c-.809 0-1.253 0-1.594-.12a1.8 1.8 0 0 1-.52-.284c-.265-.21-.41-.509-.7-1.108l-1.451-2.995c-.29-.6-.436-.9-.7-1.108a1.8 1.8 0 0 0-.52-.284C9.712 9 9.268 9 8.46 9"})]})}),"Parameters"]}),key:"parameters"}],cr=K.memo(()=>{const t=ee(m=>m.lastUseProjectTabKey??"projectDashboard"),{projectInfoSection:n=t,pageInfoSection:a="pageEditor",projectId:i,pageId:g}=te(),c=Pt(),d=m=>{const y=ee.getState().setMainMenuData;g?c(`/projects/${i}/page/${g}/${m}`):(c(`/projects/${i}/${m}`),y({lastUseProjectTabKey:m}))};h.useEffect(()=>{const m=ee.getState().setMainMenuData;return()=>{m({lastUseProjectTabKey:void 0})}},[]);const o=ee(m=>m.isSubpageEditor),f=h.useMemo(()=>lr({isSubpage:o}),[o]);return e.jsx(Ee,{tabBarGutter:0,className:or,size:"small",items:g?f:ir,activeKey:g?a:n,onChange:d})});var tn="testDeviceButton_dimensionsPopTitle__88rnak0",nn="testDeviceButton_dimensionsPopTitleSmall__88rnak1",dr="testDeviceButton_dimensionsDeviceListScroll__88rnak2",ur="testDeviceButton_addUserDeviceForm__88rnak3";const an=({deviceItem:t,editable:n=!1})=>{const{name:a,width:i,height:g,uid:c}=t,d=o=>{o.stopPropagation(),o.preventDefault();const f=Qe.getState().removeUserTestDevice;f(c)};return e.jsx(xe,{value:c,children:e.jsxs("div",{className:Qs,children:[a,e.jsxs(qe,{style:{fontSize:11,padding:2,lineHeight:"1em"},children:[i," x ",g]}),n&&e.jsx(Xn,{style:{color:"red"},className:"close",onClick:d})]})})},mr=()=>{const t=ne.getInitialState().updateEnvStore,n=ne(x=>x.selectedTestDevice),{userDefinedTestDevices:a,predefinedTestDevices:i}=Qe(x=>x),g=x=>{let w=x.target.value;w=w==="none"?null:w;const S=[...a,...i].find(b=>b.uid===w);if(S){const{fitEditor:b}=ne.getState();t({selectedTestDevice:S}),b()}else throw new Error("Test device not found")},c=h.useMemo(()=>a.map(x=>e.jsx(an,{editable:!0,deviceItem:x},x.uid)),[a]),d=h.useMemo(()=>i.map(x=>e.jsx(an,{editable:!1,deviceItem:x},x.uid)),[i]),[o]=v.useForm(),[f,m]=K.useState(!1),y=x=>{m(!0);const w=Qe.getState().createUserTestDevice;w(x).then(()=>{o.resetFields(),m(!1)})};return e.jsxs(e.Fragment,{children:[e.jsx(xe.Group,{onChange:g,value:n?.uid,children:e.jsx(ze,{style:{width:400},direction:"vertical",children:e.jsxs("div",{className:dr,children:[e.jsxs(wt,{initialOpen:!0,summary:"My devices",children:[...c]}),e.jsxs(wt,{initialOpen:!0,summary:"Predefined devices",children:[...d]})]})})}),e.jsx(Q,{style:{margin:"10px 0"}}),e.jsx(v,{form:o,onFinish:y,onFinishFailed:()=>m(!1),className:ur,layout:"vertical",children:e.jsxs(ze,{children:[e.jsx(v.Item,{required:!1,name:"name",rules:[{required:!0,message:"Required"}],label:"Name",children:e.jsx(z,{style:{width:100},placeholder:"Name"})}),e.jsx(v.Item,{required:!1,name:"width",rules:[{required:!0,message:"Required"}],label:"Width",children:e.jsx(Ct,{min:0,style:{width:100},placeholder:"Width"})}),e.jsx(v.Item,{required:!1,name:"height",rules:[{required:!0,message:"Required"}],label:"Height",children:e.jsx(Ct,{min:0,style:{width:100},placeholder:"Height"})}),e.jsx(v.Item,{label:" ",children:e.jsx(F,{loading:f,htmlType:"submit",block:!0,icon:e.jsx(_t,{}),children:"Add device"})})]})})]})},hr=()=>{const t=ee(c=>c.isSubpageEditor),n=ne(c=>c.selectedTestDevice),a=ne(c=>c.isTestDeviceRotated),i=()=>{const c=ne.getState().updateEnvStore;c({isTestDeviceRotated:!a})},g=t?e.jsxs("div",{className:tn,children:["Subpage editor - no test devices available here",e.jsxs("small",{className:nn,children:[e.jsx(Ve,{})," Subpage is a reusable component - it has own size and there is no sense to test it on different devices in fullscreen mode."]})]}):e.jsxs("div",{className:tn,children:["Test device selector",e.jsxs("small",{className:nn,children:[e.jsx(Ve,{})," It's not a project setting, just preview option to see how page looks on different devices."]})]});return e.jsxs(ze.Compact,{block:!0,children:[e.jsx(ue,{placement:"bottomLeft",title:g,content:t?null:e.jsx(mr,{}),trigger:t?"hover":"click",children:e.jsx(F,{disabled:t,onFocus:c=>c.target.blur(),icon:e.jsx("svg",{style:{translate:"-0.3em 0.1em"},xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32",children:e.jsx("path",{fill:"currentColor",d:"M13 3H7.5A4.5 4.5 0 0 0 3 7.5V9a1 1 0 0 0 2 0V7.5A2.5 2.5 0 0 1 7.5 5H13a1 1 0 1 0 0-2m2.5 26a4.5 4.5 0 0 0 4.5-4.5v-8a4.5 4.5 0 0 0-4.5-4.5h-8A4.5 4.5 0 0 0 3 16.5v8A4.5 4.5 0 0 0 7.5 29zm6.5-1a1 1 0 0 1 1-1h1.5a2.5 2.5 0 0 0 2.5-2.5V19a1 1 0 1 1 2 0v5.5a4.5 4.5 0 0 1-4.5 4.5H23a1 1 0 0 1-1-1m7-15V7.5A4.5 4.5 0 0 0 24.5 3H19a1 1 0 1 0 0 2h5.5A2.5 2.5 0 0 1 27 7.5V13a1 1 0 1 0 2 0"})}),children:n?.name})}),e.jsx(F,{disabled:t,onFocus:c=>c.target.blur(),onClick:i,type:a?"primary":"default",icon:e.jsx("svg",{style:{translate:"0 2px"},xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"M16.26 1.874a.75.75 0 0 1 .866-.613c3.2.544 5.624 3.36 5.624 6.74a.75.75 0 0 1-1.17.62l-1.5-1.014a.75.75 0 1 1 .84-1.242l.1.067c-.577-1.91-2.18-3.358-4.146-3.693a.75.75 0 0 1-.613-.865M8.319 3.316c-.579.442-1.257 1.118-2.232 2.092l-.678.679c-.974.974-1.65 1.652-2.092 2.232c-.429.561-.566.941-.566 1.307s.137.746.566 1.308c.442.579 1.118 1.257 2.092 2.232l5.427 5.426c.974.974 1.652 1.65 2.231 2.092c.563.43.942.566 1.308.566s.746-.137 1.308-.566c.579-.442 1.257-1.118 2.232-2.092l.678-.678c.974-.975 1.65-1.653 2.092-2.232c.429-.562.566-.942.566-1.308s-.137-.745-.566-1.307c-.442-.58-1.118-1.258-2.092-2.232l-5.427-5.427c-.974-.974-1.652-1.65-2.231-2.092c-.562-.429-.942-.566-1.308-.566s-.746.137-1.308.566m-.91-1.193c.696-.53 1.392-.873 2.218-.873s1.522.343 2.217.873c.67.51 1.418 1.26 2.345 2.186l5.503 5.504c.927.926 1.676 1.675 2.186 2.344c.53.695.873 1.391.873 2.217s-.343 1.522-.873 2.218c-.51.668-1.26 1.417-2.186 2.344l-.755.755c-.927.927-1.676 1.676-2.344 2.186c-.696.53-1.392.873-2.218.873s-1.522-.343-2.217-.873c-.67-.51-1.418-1.26-2.344-2.186L4.31 14.188c-.927-.927-1.676-1.676-2.186-2.344c-.53-.696-.873-1.392-.873-2.218s.343-1.522.873-2.217c.51-.67 1.26-1.418 2.186-2.344l.755-.756c.927-.926 1.676-1.675 2.345-2.186m2.07 2.903a.75.75 0 0 1 0 1.06L6.086 9.479a.75.75 0 1 1-1.06-1.06l3.391-3.392a.75.75 0 0 1 1.06 0m6.74 10.218a.689.689 0 1 0-.974.974a.689.689 0 0 0 .974-.974m-2.035-1.06a2.189 2.189 0 1 1 3.096 3.095a2.189 2.189 0 0 1-3.096-3.096M1.648 15.337a.75.75 0 0 1 .772.04l1.5 1.015a.75.75 0 0 1-.84 1.242l-.1-.067c.577 1.91 2.18 3.358 4.146 3.693a.75.75 0 0 1-.252 1.479c-3.2-.545-5.624-3.361-5.624-6.74a.75.75 0 0 1 .398-.662",clipRule:"evenodd"})})})]})},sn={connected:"success",disconnected:"warning",connecting:"processing",error:"error"},gr=({manualConnection:t,wsConnectors:n,wsInstances:a,xpanelStatus:i})=>{const g=ne.getState().toggleManualConnection,c=h.useMemo(()=>{if(!n)return e.jsx(e.Fragment,{children:"No connectors..."});const d=n.map(o=>{const{uid:f,name:m}=o,y=a?.[f].status??"disconnected";return e.jsx("span",{children:e.jsx(Rt,{status:sn[y],text:m})},f)});return e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"1em"},children:d})},[n,a]);return e.jsxs("div",{style:{minWidth:300},children:[e.jsxs("div",{children:[e.jsx(me,{checkedChildren:"ON",unCheckedChildren:"OFF",checked:t,onChange:g})," Toggle connections"]}),e.jsx(Q,{className:"fromleft",plain:!0,children:"Crestron Connection"}),e.jsx(Rt,{status:sn[i],text:"WebXpanel"}),e.jsx(Q,{className:"fromleft",plain:!0,children:"Websocket Connections"}),c]})},fr=()=>{const t=Yn(d=>d.status),n=Qn(),a=ea(d=>d.wsInstances),i=ne(d=>d.manualConnection),g=h.useMemo(()=>{const d=[t];if(n){const o=n.map(f=>{const{uid:m}=f;return a?.[m].status??"disconnected"});d.push(...o)}return d},[n,a,t]),c=h.useMemo(()=>i?g.every(d=>d==="connecting")?{text:"Connecting...",icon:e.jsx(ve,{}),bgColor:"inherit"}:g.some(d=>d!=="connected")?{text:"Partially Connected",icon:e.jsx(Va,{}),bgColor:"#EC6258"}:{text:"Connected",icon:e.jsx(hn,{}),bgColor:"#d1f155"}:{text:"Disconnected",icon:e.jsx(Ma,{})},[g,i]);return e.jsx(ue,{placement:"bottom",title:"Connection Manager",content:e.jsx(gr,{manualConnection:i,wsConnectors:n,xpanelStatus:t,wsInstances:a}),trigger:"click",children:e.jsx(F,{style:{"--iconBg":c.bgColor},className:tr,icon:c.icon,children:c.text})})},pr=K.memo(({subPageHeight:t,subPageWidth:n})=>{const a=ne(m=>m.editorZoom),i=Number.parseFloat((a*100).toFixed(0)),g=({value:m})=>{const y=Number(m)||1,{updateEditorZoom:x}=ne.getState();x(y/100)},{resetEditorZoom:c,centerViewer:d,fitEditor:o}=ne.getState(),f=()=>{n&&t?o(n,t):o()};return e.jsxs(ze,{style:{minWidth:250},direction:"vertical",size:"small",children:[e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("div",{style:{flexGrow:1},children:e.jsx(ma,{min:1,max:100,value:i,onChange:m=>{g({value:m})}})}),e.jsx(z,{addonAfter:"%",style:{width:87},value:i,onChange:m=>{g({value:m.target.value})}})]}),e.jsxs(ze.Compact,{block:!0,children:[e.jsx(F,{style:{flexGrow:1},onClick:f,children:"Fit"}),e.jsx(F,{style:{flexGrow:1},onClick:d,children:"Center"}),e.jsx(F,{style:{flexGrow:1},onClick:c,children:"Reset"})]})]})}),vr=()=>{const{pageId:t}=te(),n=(ne(d=>d.editorZoom)*100).toFixed(0),a=Mt({pageId:t}),i=ee(d=>d.isSubpageEditor),{width:g,height:c}=ta({width:a?.attributes.width,height:a?.attributes.height});return e.jsx(e.Fragment,{children:e.jsx(ue,{placement:"bottomLeft",title:"Zoom controls",content:e.jsx(pr,{subPageHeight:i?c:void 0,subPageWidth:i?g:void 0}),trigger:"click",children:e.jsxs(F,{onFocus:d=>d.target.blur(),icon:e.jsxs("svg",{style:{translate:"-0.3em 0.1em",scale:"1.2"},width:"1em",height:"1em",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsxs("g",{clipPath:"url(#clip0_224_4)",children:[e.jsx("path",{d:"M9.7 9.7L11 11M10.35 7.425C10.35 7.04088 10.2743 6.66053 10.1273 6.30565C9.98035 5.95077 9.7649 5.62832 9.49329 5.35671C9.22168 5.0851 8.89923 4.86965 8.54435 4.72265C8.18947 4.57566 7.80912 4.5 7.425 4.5C7.04088 4.5 6.66053 4.57566 6.30565 4.72265C5.95077 4.86965 5.62832 5.0851 5.35671 5.35671C5.0851 5.62832 4.86965 5.95077 4.72265 6.30565C4.57566 6.66053 4.5 7.04088 4.5 7.425C4.5 8.20076 4.80817 8.94474 5.35671 9.49329C5.90526 10.0418 6.64924 10.35 7.425 10.35C8.20076 10.35 8.94474 10.0418 9.49329 9.49329C10.0418 8.94474 10.35 8.20076 10.35 7.425Z",stroke:"black",strokeWidth:"0.75",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M9.5375 9.5375L11 11M1 3C1.065 2.3325 1.213 1.883 1.548 1.548C1.883 1.213 2.3325 1.0655 3 1M3 11C2.3325 10.935 1.883 10.787 1.548 10.452C1.213 10.117 1.0655 9.6675 1 9M11 3C10.935 2.3325 10.787 1.883 10.452 1.548C10.117 1.213 9.6675 1.0655 9 1M1 5V7M7 1H5M10.35 7.425C10.35 6.64924 10.0418 5.90526 9.49329 5.35671C8.94474 4.80817 8.20076 4.5 7.425 4.5C6.64924 4.5 5.90526 4.80817 5.35671 5.35671C4.80817 5.90526 4.5 6.64924 4.5 7.425C4.5 8.20076 4.80817 8.94474 5.35671 9.49329C5.90526 10.0418 6.64924 10.35 7.425 10.35C8.20076 10.35 8.94474 10.0418 9.49329 9.49329C10.0418 8.94474 10.35 8.20076 10.35 7.425Z",stroke:"black",strokeWidth:"0.75",strokeLinecap:"round",strokeLinejoin:"round"})]}),e.jsx("defs",{children:e.jsx("clipPath",{id:"clip0_224_4",children:e.jsx("rect",{width:"12",height:"12",fill:"white"})})})]}),children:[n,"%"]})})})},xr=K.lazy(()=>Tt(()=>import("./undoRedo-BnfKpAU6.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),jr=K.lazy(()=>Tt(()=>import("./newProjectModal-BzeU1zvB.js"),__vite__mapDeps([15,1,2,11,4,5,6,3,7,8,9,10,12,13,14]),import.meta.url)),br=({setEditProjectModalId:t})=>{const n=Pt(),{projectId:a}=te(),{pageId:i}=te(),c=gn().pathname.includes("profile"),d=V(x=>x.workingProject),o=ee(x=>x.showBoundingBox),{setMainMenuData:f}=ee.getState(),[m,y]=h.useState(!1);return e.jsxs("div",{className:zs,onContextMenu:x=>x.preventDefault(),children:[!!a&&!!d&&e.jsxs(e.Fragment,{children:[e.jsx("section",{children:e.jsxs("div",{className:Ws,children:[e.jsx("div",{className:qs,children:e.jsx(rr,{})}),e.jsx("div",{className:Us,children:e.jsx(nr,{projectId:a,setEditProjectModalId:t})})]})}),e.jsx("section",{className:er,children:e.jsx(cr,{})})]}),e.jsx("section",{children:e.jsxs("div",{className:Xs,style:o?{}:{backgroundColor:"rgb(66, 32, 201)",color:"#fff"},children:[e.jsxs("section",{className:"left",style:{fontSize:14},children:[e.jsx("img",{onClick:()=>n("/projects"),style:{width:"auto",height:23,cursor:"pointer"},src:na,alt:"avgator studio"}),e.jsx(ar,{isProfilePage:c,projectName:d?.attributes.name})]}),e.jsx("section",{className:"center",children:i?e.jsxs(e.Fragment,{children:[e.jsx(sr,{}),e.jsx(hr,{}),e.jsx(vr,{}),e.jsxs(xe.Group,{style:{whiteSpace:"nowrap"},value:o,onChange:x=>f({showBoundingBox:x.target.value}),buttonStyle:"solid",children:[e.jsxs(xe.Button,{value:!0,children:[e.jsx(ka,{})," Editor"]}),e.jsxs(xe.Button,{style:o?{}:{backgroundColor:"red",color:"#fff",borderColor:"red"},className:"previewButton",value:!1,children:[e.jsx(cn,{})," Preview"]})]}),e.jsx(fr,{}),e.jsx(Bs,{})]}):null}),e.jsxs("section",{className:"right",style:{display:"flex",gap:5},children:[!a&&!c?e.jsx(F,{icon:e.jsx(dn,{}),onClick:()=>y(!0),type:"primary",children:"New Project"}):null,!a&&!c&&e.jsx(un,{menu:{items:[{key:"Profile",label:e.jsx("div",{onClick:()=>n("/profile"),children:"Profile"})},{key:"Logout",label:e.jsx("div",{onClick:()=>yt(),children:"Change Account"})}]},placement:"bottomRight",arrow:!0,children:e.jsx(F,{icon:e.jsx(mn,{})})}),c&&e.jsxs(e.Fragment,{children:[e.jsx(F,{icon:e.jsx(Pa,{}),onClick:()=>n("/projects"),children:"Back to projects"}),e.jsx(F,{onClick:()=>yt(),icon:e.jsx(Wa,{}),children:"Logout"})]}),a&&e.jsx(h.Suspense,{fallback:null,children:e.jsx(xr,{})})]}),e.jsx("div",{style:{position:"absolute"},children:m?e.jsx(h.Suspense,{fallback:e.jsx(fn,{}),children:e.jsx(jr,{setOpenNewProjectModal:y})}):null})]})})]})},yr=h.lazy(()=>Tt(()=>import("./main-BKM2fIwG.js").then(t=>t.eh),__vite__mapDeps([1,2]),import.meta.url)),wr=()=>{const t=kt(I=>I.jwt),n=gn(),[a,i]=aa();sa();const g=ra();h.useEffect(()=>{if(a.size){let I=function(){i({})};const oe=a.get("paymentFeedback");if(oe)switch(oe){case"buyBuildError":le.error({icon:null,maskClosable:!1,content:e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{color:"red",paddingBottom:5},children:e.jsx(be,{})}),"We cannot process your payment. Please try again later."]}),okText:"Close",onOk:()=>I()});break;case"buyBuildOk":le.success({icon:null,maskClosable:!1,content:e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{color:"green",paddingBottom:5},children:e.jsx(hn,{})}),"Thank you for your purchase! Now project have unlimited builds."]}),okText:"Close",onOk:()=>I()});break;default:le.error({icon:null,maskClosable:!1,content:e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{color:"red",paddingBottom:5},children:e.jsx(be,{})}),"Unknown payment feedback: ",oe]}),okText:"Close",onOk:()=>I()}),console.error("Unknown payment feedback: ",oe);break}}return()=>{le.destroyAll()}},[a,i]),rn.interceptors.response.use(I=>I.data&&(I?.status===200||I?.status===201)?I:Promise.reject(I),I=>(I.response?.status===401&&yt(),Promise.reject(I)));const c=window.location.hostname;h.useEffect(()=>{c==="avstudio.app"&&Kt.initialize("G-CJ806X6F1C")},[c]),h.useEffect(()=>{n.pathname&&c==="avstudio.app"&&Kt.send({hitType:"pageview",page:n.pathname})},[c,n.pathname]),h.useEffect(()=>{t||g("/login")},[n.pathname,t,g]);const{projectId:d}=te(),{pageId:o}=te(),{ConfirmModal:f}=ss(),{fillProjectsList:m}=oa.getState(),{fetchAndFill:y,resetWorkingProject:x,clearHistory:w}=V.getState(),S=V(I=>I.workingProject),b=h.useRef(!1);h.useEffect(()=>{function I(){ot.destroy(),b.current=!1}async function oe(fe){await fetch(fe,{headers:{Pragma:"no-cache",Expires:"-1","Cache-Control":"no-cache"}}),window.location.href=fe,window.location.reload()}if(!d&&t&&!b.current){const fe=fa.getState().fetchVersions;try{fe().then(Fe=>{if(Fe?.length){const Pe="3.4.2",tt=Fe?.[0],{version:Le,text:Ue}=tt?.attributes??{};if(!Pe||!Le)return;let pe=!1;const nt=Number(Pe.replace(/\./g,"")),at=Number(Le.replace(/\./g,""));nt<at&&(pe=!0),pe&&(b.current=!0,ot.destroy(),ot.info({message:"New version available",onClose:I,description:e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5},children:e.jsxs(qe,{children:["Current ",Pe," => New ",Le]})}),Ue," ",e.jsx(Q,{style:{margin:"15px 0"}})," ",e.jsx(F,{onClick:()=>{oe(window.location.href)},style:{marginRight:5},type:"primary",children:"Refresh to update"}),e.jsx(F,{onClick:()=>I(),children:"Later"})]}),onClick:()=>{},placement:"top",duration:null}))}})}catch(Fe){console.log(Fe)}}},[d,t]),ia({initVariableArr:S?.attributes.variables}),la({skipDsLoading:!1});const M=Mt({pageId:o}),_=ee(I=>I.showBoundingBox),{setMainMenuData:L}=ee.getState(),{addNewTab:A,clearTabs:U}=V.getState(),W=ne.getState().setEnvState,J=ee(I=>I.selectedMenuSection.elementIndex);h.useEffect(()=>{if(J===null){const I=Ke.getState().setSelectedElementRef;I({current:null})}},[J]),h.useEffect(()=>{M?.attributes.isSubpage?L({isSubpageEditor:!0}):L({isSubpageEditor:!1})},[M?.attributes.isSubpage,L]),h.useEffect(()=>{M?.attributes.isStatic?(L({isStaticEditor:!0}),je.info({content:"You are in adaptive editor mode",style:{position:"fixed",bottom:"50px",left:"50%",translate:"-50% 0"}})):L({isStaticEditor:!1})},[M?.attributes.isStatic,L]),Vs({workingProject:S}),h.useEffect(()=>{o&&W(_?"editor":"preview")},[o,W,_]),h.useEffect(()=>{o&&S&&A(o)},[A,o,S]),h.useLayoutEffect(()=>{if(!t)return;const I=bn.getState().fetchAndFillThemesList;I();const oe=Qe.getState().fetchTestDevices;oe()},[t]),h.useEffect(()=>{w()},[w,o]),h.useEffect(()=>{d||ca()},[d]);const O=h.useRef(!1);h.useLayoutEffect(()=>{t&&(d?(S&&String(S.id)!==d&&x(),!S&&!O.current&&(O.current=!0,y(d).then(()=>{O.current=!1}))):(m(),U(),w()))},[y,m,d,x,S?.id,U,w,S,t]);const[N,Z]=h.useState(null),[R,E]=h.useState(null),[ae,X]=h.useState(null),[p,l]=h.useState(!1),[r,s]=h.useState(!1),[u,j]=h.useState(null),[k,P]=h.useState(!1),{CloneModal:T,setCloneItemModal:B}=ns(),H={editProjectModalId:N,setEditProjectModalId:Z,newPageModalVisible:R,setNewPageModalVisible:E,newGlobalContainerVisible:k,setNewGlobalContainerVisible:P,setNewDatasourceVisible:l,newDatasourceVisible:p,setNewModificatorVisible:s,newModificatorVisible:r,setEditModificator:j,editModificator:u,newVariableModalVisible:ae,setNewVariableModalVisible:X,CloneModal:T,setCloneItemModal:B},G=Ke(I=>I.selectedElementRef),q=ee(I=>I.isStaticEditor),ge=Ke(I=>I.staticEementsGuidesClasses),ie=Ke(I=>I.activeStaticElementKey),Ae=h.useMemo(()=>ge.filter(I=>I!==ie),[ie,ge]);return e.jsxs(e.Fragment,{children:[e.jsxs(pa,{children:[e.jsx(va,{children:e.jsx(br,{setEditProjectModalId:Z})}),e.jsx(xa,{children:e.jsx(da,{context:H})})]}),N&&e.jsx(xs,{editProjectModalId:N,setEditProjectModalId:Z},d+"_EditProjectModal"),R&&e.jsx(Es,{newPageModalVisible:R,setNewPageModalVisible:E},d+"_NewPageModal"),ae&&e.jsx(As,{setNewVariableModalVisible:X,newVariableModalVisible:ae},d+"_NewVariableModal"),k&&e.jsx(Ss,{setNewGlobalContainerVisible:P,newGlobalContainerVisible:k},d+"_NewGlobalContainerModal"),r&&e.jsx(Ms,{setNewModificatorVisible:s,newModificatorVisible:r},d+"_NewModificatorModal"),p&&e.jsx(Cs,{setNewDatasourceVisible:l,newDatasourceVisible:p},d+"_NewDatasourceModal"),T,e.jsx(f,{}),q&&e.jsx(h.Suspense,{fallback:e.jsx(fn,{}),children:e.jsx(yr,{target:_?G:null,zoom:1,snappable:!0,snapThreshold:5,snapContainer:".page",bounds:{left:0,top:0,right:0,bottom:0,position:"css"},isDisplaySnapDigit:!0,isDisplayInnerSnapDigit:!1,snapGap:!0,snapDirections:{top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0},elementSnapDirections:{top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0},dragTargetSelf:!1,elementGuidelines:Ae,useMutationObserver:!0,origin:!1,throttleResize:0,throttleDrag:0,throttleRotate:0,startDragRotate:0,throttleDragRotate:0,draggable:!0,resizable:!1,scalable:!1,keepRatio:!0,rotatable:!1,padding:10,onDrag:I=>{const{target:oe,transform:fe}=I;oe.style.transform=fe}})})]})},Nr=Object.freeze(Object.defineProperty({__proto__:null,default:wr},Symbol.toStringTag,{value:"Module"}));export{Me as R,Nr as m,bn as u};
