import{r as g,I as E,_ as F,u as O,g as U,f as W,bS as J,j as e,W as S,aD as I,y as C,V as T,D as k,B as f,cz as h,as as Y,$ as H,Q as G,T as q,a6 as w,z as K,X as Q,a8 as X}from"./main-BKM2fIwG.js";import{D as Z}from"./driverGuideButton-DmMT0RTN.js";import{E as V}from"./EditableCell-cqK7iS5z.js";import{i as ee,a as ae,h as _,P as te,u as D}from"./pageAPI-DkFp6Yf6.js";import{b as se,P as ie}from"./Styles-CgWqeJi4.js";import{d as re}from"./deletePage-DZsQQUbX.js";import{OneProjectGuideContext as ne}from"./oneProject-9D6mqakA.js";import{u as le,T as oe}from"./useTableFilter-CF3g0AgZ.js";import{R as de}from"./DiffOutlined-DRn9zohQ.js";import{T as ge}from"./index-DxXoshz8.js";import{b as ce}from"./Table-DlRpDtjF.js";import"./EditOutlined-_GB9OZ1y.js";import"./index-Aazyqc20.js";import"./DownOutlined-BZ_0tHYf.js";import"./PlusSquareOutlined-DN4XdNMT.js";var pe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 305H624V192c0-17.7-14.3-32-32-32H184v-40c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v784c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V640h248v113c0 17.7 14.3 32 32 32h416c17.7 0 32-14.3 32-32V337c0-17.7-14.3-32-32-32z"}}]},name:"flag",theme:"filled"},ue=function(n,x){return g.createElement(E,F(F({},n),{},{ref:x,icon:pe}))},L=g.forwardRef(ue);const{Title:me}=ge,Ve=()=>{const p=O(),{projectId:n,pageId:x}=U(),[u,N,R,b]=le({key:"pagesFilter",projectId:n,pageId:x}),r=W(l=>l.workingProject),B=!ee({project:r}),{setNewPageModalVisible:M,setEditProjectModalId:j}=J(),[m,P]=g.useState(null),y=g.useMemo(()=>{const l=[],d=r?.attributes.pages.data?.filter(i=>!i.attributes?.isSubpage);for(const i of d??[]){const s=i.attributes.pageFlips?.analogPageFlipValue;s!=null&&l.push(s)}return l},[r?.attributes.pages.data]),$=[{title:e.jsxs(se,{children:[e.jsx(oe,{value:u,setValue:N}),e.jsx("div",{style:{paddingRight:10},children:e.jsx(S,{content:e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("div",{children:"Project page flip serial signal name"}),e.jsx(T,{style:{margin:"0 3px 0 0"},crestronLikeTypesNaming:!0,type:"s",sub:"signal name"})," ",e.jsx("strong",{children:r?.attributes.globalJoins?.serialPageFlip_signal_s_fb||"not set"}),e.jsx(k,{style:{margin:"15px 0 10px 0"}}),e.jsx("div",{children:e.jsx(f,{block:!0,style:{marginTop:10},type:"dashed",size:"small",onClick:()=>r&&j(r.id),children:"Open project settings"})})]})}),title:"Page flip serial",children:r?.attributes.globalJoins?.serialPageFlip_signal_s_fb?e.jsx(I,{style:{color:"#0eae23",marginLeft:"0.6em"}}):e.jsx(C,{style:{color:"#ff6d24",marginLeft:"0.6em"}})})})]}),dataIndex:"name",sorter:(l,d)=>{const i=l.name.props.initialValue.toLowerCase(),s=d.name.props.initialValue.toLowerCase();return i<s?-1:i>s?1:0},sortOrder:b("name","ascend")},{title:e.jsx(e.Fragment,{children:"Design paradigm"}),dataIndex:"layoutMode"},{title:e.jsxs(e.Fragment,{children:["Analog flip ID",e.jsx(S,{content:e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("div",{children:"Project page flip analog signal name"}),e.jsx(T,{style:{margin:"0 3px 0 0"},crestronLikeTypesNaming:!0,type:"a",sub:"signal name"})," ",e.jsx("strong",{children:r?.attributes.globalJoins?.analogPageFlip_signal_a_fb||"not set"}),e.jsx(k,{style:{margin:"15px 0 10px 0"}}),e.jsx("div",{children:e.jsx(f,{block:!0,style:{marginTop:10},type:"dashed",size:"small",onClick:()=>r&&j(r.id),children:"Open project settings"})})]})}),title:"Page flip analog",children:r?.attributes.globalJoins?.analogPageFlip_signal_a_fb?e.jsx(I,{style:{color:"#0eae23",marginLeft:"0.6em"}}):e.jsx(C,{style:{color:"#ff6d24",marginLeft:"0.6em"}})})]}),dataIndex:"analogFlip"},{title:"Updated",dataIndex:"updated",sortOrder:b("updated"),sorter:(l,d)=>{const i=h(l.updated),s=h(d.updated);return i.isBefore(s)?-1:i.isAfter(s)?1:0},render:l=>e.jsx(e.Fragment,{children:h(l).format("MMM D, YYYY, h:mm A")})},{title:"Subpages Used",dataIndex:"subUsed"},{title:"Actions",dataIndex:"actions",width:100}];g.useEffect(()=>{function l(s){let a=null;return String(s)===String(r?.attributes.startPage)&&(a=e.jsx(X,{placement:"topLeft",title:"This is Start Page",children:e.jsx(L,{})})),a}function d(s){const a=[];for(const t of s.attributes.containers??[])for(const o of t.elements)if(o.type==="subpage"||o.type==="subpageList"){const c=r?.attributes.pages.data.find(z=>z.id===o.subpageId)?.attributes.name;a.push({id:o.subpageId,name:c||"No name"})}return a.length?a.map((t,o)=>e.jsx(f,{onClick:c=>_({pageId:t.id,navigate:p,evt:c,projectId:n}),type:"dashed",size:"small",children:t.name},`${t.id}_${o}`)):null}let i=r?.attributes.pages.data?.filter(s=>!s.attributes.isSubpage);if(i?.length){u&&(i=i.filter(a=>{const t=a.attributes.name;if(!t)return!1;const o=t.trim().toLowerCase(),c=u.trim().toLowerCase();return o.includes(c)}));const s=[];for(const a of i)s.push({pageID:a.id,key:`page_${a.id}`,name:e.jsx(V,{onChange:t=>t&&n&&D({pageId:a.id,inputData:{name:t}}),initialValue:a.attributes.name,value:e.jsxs(e.Fragment,{children:[l(a.id)," ",a.attributes.name]}),validators:[t=>w({input:t,searchArray:i||[],searchKey:["attributes","name"]}).catch(o=>(K.error(o.message),Promise.reject()))]}),analogFlip:e.jsx(e.Fragment,{children:e.jsx(V,{onChange:t=>n&&D({pageId:a.id,inputData:{pageFlips:{...a.attributes.pageFlips,analogPageFlipValue:t}}}),initialValue:a.attributes.pageFlips?.analogPageFlipValue??null,value:a.attributes.pageFlips?.analogPageFlipValue??null,validators:[t=>w({input:t,searchArray:y})]})}),layoutMode:e.jsx(q,{icon:e.jsx(te,{style:{height:"auto",minWidth:"1em",margin:"0 3px -1px 0"},isStatic:a.attributes?.isStatic}),children:a.attributes?.isStatic?"adaptive":"responsive"}),updated:a.attributes.updatedAt,subUsed:e.jsx("div",{style:{display:"flex",gap:5,flexWrap:"wrap"},children:d(a)}),actions:e.jsxs(Y.Button,{onClick:t=>_({pageId:a.id,navigate:p,evt:t,projectId:n}),menu:{items:[a.attributes.isSubpage?null:{key:"startPage",icon:e.jsx(L,{}),label:"Mark as Start Page",onClick:()=>n&&H({projectId:n,inputData:{startPage:`${a.id}`}})},{key:"clonePage",icon:e.jsx(de,{}),label:"Clone Page",onClick:()=>n&&ae({pageCloneData:a})},{key:"remove",danger:!0,icon:e.jsx(G,{}),label:"Delete Page",onClick:()=>n&&re({pageId:a.id,projectId:n,name:a.attributes.name})}]},children:[e.jsx("svg",{style:{marginRight:3,marginBottom:-2},xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M6 2c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-1.9l10-10V8l-6-6zm7 1.5L18.5 9H13zm7.1 9.5c-.1 0-.3.1-.4.2l-1 1l2.1 2.1l1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-2 1.8L12 20.9V23h2.1l6.1-6.1z"})}),"Open in Editor"]})});P(s)}else P([])},[p,n,r,u,y]);const A=g.useContext(ne),v="PagesSection";return e.jsxs(ie,{id:v,children:[e.jsx(me,{id:"Pages",style:{margin:"15px 0"},level:5,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:["Pages (",m?.length,")",e.jsx(Z,{guide:A,guideStartTargetElement:`#${v}`})]}),!!m?.length&&B&&e.jsxs("div",{style:{fontWeight:"normal",textTransform:"uppercase",fontSize:10,borderRadius:5,background:"#fff",padding:"5px 7px",border:"0.5px var(--ant-primary-5) dashed"},children:[e.jsx(Q,{style:{color:"var(--ant-primary-5)"}})," ","No start page found, please set one"]}),e.jsx(f,{type:"primary",onClick:()=>M("page"),children:"Create New Page"})]})}),e.jsx("div",{className:"scrollingTable",children:m&&e.jsx(ce,{className:"showScrollbars",showSorterTooltip:!1,columns:$,dataSource:m,pagination:!1,onChange:(l,d,i)=>{R(i)}})})]})};export{Ve as default};
