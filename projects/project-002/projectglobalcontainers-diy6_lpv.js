import{r as p,j as t,S as j,g as w,f as B,bS as D,as as I,a0 as O,y as k,B as S,$ as C}from"./main-BKM2fIwG.js";import{E as A}from"./EditableCell-cqK7iS5z.js";import{P as G}from"./Styles-CgWqeJi4.js";import{S as c}from"./PlusSquareOutlined-DN4XdNMT.js";import{R as v}from"./MobileOutlined-BZozzWa1.js";import{T}from"./index-DxXoshz8.js";import{b as R}from"./Table-DlRpDtjF.js";import"./EditOutlined-_GB9OZ1y.js";import"./index-Aazyqc20.js";import"./DownOutlined-BZ_0tHYf.js";const V=({onChange:o,checked:i})=>{const[a,r]=p.useState(!1);return t.jsx(j,{loading:a,onChange:d=>{r(!0),o(d).then(()=>r(!1))},checked:i})},{Title:E}=T,N=[{title:"Name",dataIndex:"name",sorter:(o,i)=>{try{const a=o.name.props.initialValue.toLowerCase(),r=i.name.props.initialValue.toLowerCase();if(a<r)return-1;if(a>r)return 1}catch(a){console.log(a)}return 0},defaultSortOrder:"ascend"},{title:"Position",dataIndex:"position"},{title:"Visible on Pages",dataIndex:"visibleOnPages"},{title:"Hidden on Pages",dataIndex:"hiddenOnPages"},{title:"Visible by default",dataIndex:"visibleByDefault"},{title:"Actions",width:"100px",dataIndex:"globalContainerActions"}],K=()=>{const{projectId:o}=w(),i=B(b=>b.workingProject),a=i?.attributes.globalContainers,{setNewGlobalContainerVisible:r}=D(),[d,m]=p.useState();return p.useEffect(()=>{function b(n,e){if(!a)return null;const l=structuredClone(a);l.splice(n,1),o&&C({projectId:o,inputData:{globalContainers:l}})}async function u(n,e){return new Promise((l,s)=>{if(!a)return null;const g=structuredClone(a);g[n]={...g[n],...e},o?C({projectId:o,inputData:{globalContainers:g}}).then(()=>{l("Ok")}).catch(P=>s(P)):s("No projectId")})}const f=i?.attributes.pages.data?.filter(n=>!n.attributes.isSubpage)||[];function h(){const n=[];if(f?.length)for(const e of f)n.push({value:e.id,label:e.attributes.name||"noName"});return n}function x(n){if(!a)return null;const e=a[n];return t.jsx(c,{disabled:!!e.visibleByDefault,value:e.visibleOnPages,onChange:l=>{u(n,{visibleOnPages:[...l]})},placeholder:e.visibleByDefault?"Visible by default":"Add pages...",style:{width:200},mode:"multiple",allowClear:!0,options:h()})}function y(n){if(!a)return null;const e=a[n];return t.jsx(c,{disabled:!e.visibleByDefault,value:e.hiddenOnPages,onChange:l=>{u(n,{hiddenOnPages:[...l]})},placeholder:e.visibleByDefault?"Add pages...":"Hidden by default",style:{width:200},mode:"multiple",allowClear:!0,options:h()})}if(a?.length){const n=[];a.forEach((e,l)=>{n.push({key:`globalContainer_${l}`,order:l+1,name:t.jsx(A,{onChange:s=>s&&u(l,{name:s}),initialValue:e.name,value:e.name}),position:t.jsxs(t.Fragment,{children:[t.jsx(c,{value:e.portraitPosition,onChange:s=>u(l,{portraitPosition:s}),style:{width:100,marginRight:10},suffixIcon:t.jsx(v,{}),options:[{value:"top",label:"Top"},{value:"right",label:"Right"},{value:"bottom",label:"Bottom"},{value:"left",label:"Left"},{value:"null",label:"Hidden"}]}),t.jsx(c,{value:e.landscapePosition,onChange:s=>u(l,{landscapePosition:s}),style:{width:100},suffixIcon:t.jsx(v,{rotate:90}),options:[{value:"top",label:"Top"},{value:"right",label:"Right"},{value:"bottom",label:"Bottom"},{value:"left",label:"Left"},{value:"null",label:"Hidden"}]})]}),visibleByDefault:t.jsx(V,{onChange:()=>u(l,{visibleByDefault:!e.visibleByDefault}),checked:e.visibleByDefault}),visibleOnPages:x(l),hiddenOnPages:y(l),globalContainerActions:t.jsx(I.Button,{menu:{items:[{key:"remove",label:"Remove",onClick:()=>O({title:"Delete Container?",icon:t.jsx(k,{}),content:"Are you sure to delete Global Container with all elements inside? It cannot be undone.",okText:"Delete container",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>b(l,e.name),onCancel:()=>console.log("cancel global container delete")})}]}})})}),m(n)}else m([])},[a,o,i]),t.jsxs(G,{id:"Global Containers",children:[t.jsx(E,{style:{margin:"15px 0"},level:5,children:t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("span",{children:["Global Containers ",` (${a?.length||0})`]}),t.jsx(S,{type:"primary",onClick:()=>r(!0),children:"Create Global Container"})]})}),t.jsx("div",{className:"scrollingTable",children:t.jsx(R,{className:"showScrollbars",columns:N,dataSource:d,pagination:!1})})]})};export{K as default};
