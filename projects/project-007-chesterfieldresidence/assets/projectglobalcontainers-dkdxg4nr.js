import{r as f,j as n,ac as B}from"./index-BWO8qd00.js";import{S as c,D as I,g as w,I as O}from"./useCustomFonts--hfI8X19.js";import{h as G,a as k,W as S,B as v,K as x}from"./editorApp-BQHhAWNR.js";import{E as T}from"./EditableCell-CnqTEXkH.js";import{S as A}from"./index-xMIPA-_5.js";import{R as y}from"./MobileOutlined-DKAIJHhJ.js";import{T as R}from"./index-BPRdgIWZ.js";import"./index-DQFZSvcF.js";import"./index-DI0YWsM8.js";const V=({onChange:s,checked:o})=>{const[e,r]=f.useState(!1);return n.jsx(A,{loading:e,onChange:b=>{r(!0),s(b).then(()=>r(!1))},checked:o})},{Title:E}=R,H=[{title:"Name",dataIndex:"name",sorter:(s,o)=>{try{const e=s.name.props.initialValue.toLowerCase(),r=o.name.props.initialValue.toLowerCase();if(e<r)return-1;if(e>r)return 1}catch(e){console.log(e)}return 0},defaultSortOrder:"ascend"},{title:"Position",dataIndex:"position"},{title:"Visible on Pages",dataIndex:"visibleOnPages"},{title:"Hidden on Pages",dataIndex:"hiddenOnPages"},{title:"Visible by default",dataIndex:"visibleByDefault"},{title:"Actions",width:"100px",dataIndex:"globalContainerActions"}],z=()=>{const{projectId:s}=G(),o=k(p=>p.workingProject),e=o==null?void 0:o.attributes.globalContainers,{setNewGlobalContainerVisible:r}=S(),[b,g]=f.useState();return f.useEffect(()=>{var C;function p(a,t){if(!e)return null;const l=structuredClone(e);l.splice(a,1),s&&x({projectId:s,inputData:{globalContainers:l}})}async function u(a,t){return new Promise((l,i)=>{if(!e)return null;const m=structuredClone(e);m[a]={...m[a],...t},s?x({projectId:s,inputData:{globalContainers:m}}).then(()=>{l("Ok")}).catch(D=>i(D)):i("No projectId")})}const d=((C=o==null?void 0:o.attributes.pages.data)==null?void 0:C.filter(a=>!a.attributes.isSubpage))||[];function h(){const a=[];if(d!=null&&d.length)for(const t of d)a.push({value:t.id,label:t.attributes.name||"noName"});return a}function j(a){if(!e)return null;const t=e[a];return n.jsx(c,{disabled:!!t.visibleByDefault,value:t.visibleOnPages,onChange:l=>{u(a,{visibleOnPages:[...l]})},placeholder:t.visibleByDefault?"Visible by default":"Add pages...",style:{width:200},mode:"multiple",allowClear:!0,options:h()})}function P(a){if(!e)return null;const t=e[a];return n.jsx(c,{disabled:!t.visibleByDefault,value:t.hiddenOnPages,onChange:l=>{u(a,{hiddenOnPages:[...l]})},placeholder:t.visibleByDefault?"Add pages...":"Hidden by default",style:{width:200},mode:"multiple",allowClear:!0,options:h()})}if(e!=null&&e.length){const a=[];e.forEach((t,l)=>{a.push({key:`globalContainer_${l}`,order:l+1,name:n.jsx(T,{onChange:i=>i&&u(l,{name:i}),initialValue:t.name,value:t.name}),position:n.jsxs(n.Fragment,{children:[n.jsx(c,{value:t.portraitPosition,onChange:i=>u(l,{portraitPosition:i}),style:{width:100,marginRight:10},suffixIcon:n.jsx(y,{}),options:[{value:"top",label:"Top"},{value:"right",label:"Right"},{value:"bottom",label:"Bottom"},{value:"left",label:"Left"},{value:"null",label:"Hidden"}]}),n.jsx(c,{value:t.landscapePosition,onChange:i=>u(l,{landscapePosition:i}),style:{width:100},suffixIcon:n.jsx(y,{rotate:90}),options:[{value:"top",label:"Top"},{value:"right",label:"Right"},{value:"bottom",label:"Bottom"},{value:"left",label:"Left"},{value:"null",label:"Hidden"}]})]}),visibleByDefault:n.jsx(V,{onChange:()=>u(l,{visibleByDefault:!t.visibleByDefault}),checked:t.visibleByDefault}),visibleOnPages:j(l),hiddenOnPages:P(l),globalContainerActions:n.jsx(I.Button,{menu:{items:[{key:"remove",label:"Remove",onClick:()=>w({title:"Delete Container?",icon:n.jsx(B,{}),content:"Are you sure to delete Global Container with all elements inside? It cannot be undone.",okText:"Delete container",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>p(l,t.name),onCancel:()=>console.log("cancel global container delete")})}]}})})}),g(a)}else g([])},[e,s,o]),n.jsxs(n.Fragment,{children:[n.jsx(E,{id:"Global Containers",style:{margin:"15px 0"},level:5,children:n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[n.jsxs("span",{children:["Global Containers ",` (${(e==null?void 0:e.length)||0})`]}),n.jsx(v,{onClick:()=>r(!0),children:"Create Global Container"})]})}),n.jsx(O,{columns:H,dataSource:b,pagination:!1}),n.jsx(v,{style:{marginTop:15},type:"primary",onClick:()=>r(!0),children:"Create Global Container"},"submit")]})};export{z as default};
