import{r as u,L as H,h as R,j as e,ae as V,ac as B,a as G,ad as K}from"./index-BWO8qd00.js";import{i as q,u as N,P as Q,h as $,a as X}from"./pageAPI-B3I9BgVC.js";import{d as Z}from"./deletePage-BqMP05t5.js";import{e as ee,a as ae,h as te,W as se,D as A,B as h,C as E,K as ie,l as ne}from"./editorApp-BQHhAWNR.js";import{E as O}from"./EditableCell-CnqTEXkH.js";import{R as z}from"./renderActionTag-DNrT7Mjk.js";import{P as re,D as le}from"./driverGuideButton-BquW8wR7.js";import{T as oe}from"./tableFieldSearchInput-DW8T1Il9.js";import{u as de,D as pe,b as ge,I as ce}from"./useCustomFonts--hfI8X19.js";import{a as y}from"./dayjs.min-DIl2m-M7.js";import{O as me}from"./oneProject-73XmHinD.js";import{P as U}from"./index-PlVE70kS.js";import{T as ue}from"./index-DQFZSvcF.js";import{R as fe}from"./DiffOutlined-4UMKY59v.js";import{T as xe}from"./index-BPRdgIWZ.js";import"./localActiveAPI-Dv2O1BDy.js";import"./variablesAPI-D_uU0Jyf.js";import"./___vite-browser-external_commonjs-proxy-FhmH_qOu.js";import"./index-DI0YWsM8.js";import"./leftSidebar-AH8kSalj.js";import"./Styles-BTfwVjr1.js";import"./GlobalOutlined-f3TBbcvU.js";var he={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 305H624V192c0-17.7-14.3-32-32-32H184v-40c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v784c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V640h248v113c0 17.7 14.3 32 32 32h416c17.7 0 32-14.3 32-32V337c0-17.7-14.3-32-32-32z"}}]},name:"flag",theme:"filled"},be=function(f,a){return u.createElement(H,R(R({},f),{},{ref:a,icon:he}))},k=u.forwardRef(be);const{Title:je}=xe,ke=()=>{var C,T,L,D;const b=ee(),f=de(n=>n.pageSearchString),a=ae(n=>n.workingProject),w=!q({project:a}),{projectId:d}=te(),{setNewPageModalVisible:v,setEditProjectModalId:S}=se(),[x,F]=u.useState(null),P=u.useMemo(()=>{var s,r;const n=[],c=(s=a==null?void 0:a.attributes.pages.data)==null?void 0:s.filter(m=>{var l;return!((l=m.attributes)!=null&&l.isSubpage)});for(const m of c??[]){const l=(r=m.attributes.pageFlips)==null?void 0:r.analogPageFlipValue;l!=null&&n.push(l)}return n},[a==null?void 0:a.attributes.pages.data]),W=[{title:e.jsxs(re,{children:[e.jsx(oe,{searchType:"pageSearchString"}),e.jsx("div",{style:{paddingRight:10},children:e.jsx(U,{content:e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("div",{children:"Project page flip serial signal name"}),e.jsx(z,{style:{margin:"0 3px 0 0"},crestronLikeTypesNaming:!0,type:"s",sub:"signal name"})," ",e.jsx("strong",{children:((C=a==null?void 0:a.attributes.globalJoins)==null?void 0:C.serialPageFlip_signal_s_fb)||"not set"}),e.jsx(A,{style:{margin:"15px 0 10px 0"}}),e.jsx("div",{children:e.jsx(h,{block:!0,style:{marginTop:10},type:"dashed",size:"small",onClick:()=>a&&S(a.id),children:"Open project settings"})})]})}),title:"Page flip serial",children:(T=a==null?void 0:a.attributes.globalJoins)!=null&&T.serialPageFlip_signal_s_fb?e.jsx(V,{style:{color:"#0eae23",marginLeft:"0.6em"}}):e.jsx(B,{style:{color:"#ff6d24",marginLeft:"0.6em"}})})})]}),dataIndex:"name",sorter:(n,c)=>{const s=n.name.props.initialValue.toLowerCase(),r=c.name.props.initialValue.toLowerCase();return s<r?-1:s>r?1:0},defaultSortOrder:"ascend"},{title:e.jsx(e.Fragment,{children:"Design paradigm"}),dataIndex:"layoutMode"},{title:e.jsxs(e.Fragment,{children:["Analog flip ID",e.jsx(U,{content:e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("div",{children:"Project page flip analog signal name"}),e.jsx(z,{style:{margin:"0 3px 0 0"},crestronLikeTypesNaming:!0,type:"a",sub:"signal name"})," ",e.jsx("strong",{children:((L=a==null?void 0:a.attributes.globalJoins)==null?void 0:L.analogPageFlip_signal_a_fb)||"not set"}),e.jsx(A,{style:{margin:"15px 0 10px 0"}}),e.jsx("div",{children:e.jsx(h,{block:!0,style:{marginTop:10},type:"dashed",size:"small",onClick:()=>a&&S(a.id),children:"Open project settings"})})]})}),title:"Page flip analog",children:(D=a==null?void 0:a.attributes.globalJoins)!=null&&D.analogPageFlip_signal_a_fb?e.jsx(V,{style:{color:"#0eae23",marginLeft:"0.6em"}}):e.jsx(B,{style:{color:"#ff6d24",marginLeft:"0.6em"}})})]}),dataIndex:"analogFlip"},{title:"Updated",dataIndex:"updated",sorter:(n,c)=>{const s=y(n.updated),r=y(c.updated);return s.isBefore(r)?-1:s.isAfter(r)?1:0},render:n=>e.jsx(e.Fragment,{children:y(n).format("MMM D, YYYY, h:mm A")})},{title:"Subpages Used",dataIndex:"subUsed"},{title:"Actions",dataIndex:"actions",width:100}];u.useEffect(()=>{var r,m,l,_,M;function n(p){let t=null;return String(p)===String(a==null?void 0:a.attributes.startPage)&&(t=e.jsx(ne,{placement:"topLeft",title:"This is Start Page",children:e.jsx(k,{})})),t}function c(p){var i;const t=[];for(const o of p.attributes.containers??[])for(const g of o.elements)if(g.type==="subpage"||g.type==="subpageList"){const j=(i=a==null?void 0:a.attributes.pages.data.find(Y=>Y.id===g.subpageId))==null?void 0:i.attributes.name;t.push({id:g.subpageId,name:j||"No name"})}return t.length?t.map((o,g)=>e.jsx(h,{onClick:j=>$({pageId:o.id,navigate:b,evt:j}),type:"dashed",size:"small",children:o.name},`${o.id}_${g}`)):null}let s=(r=a==null?void 0:a.attributes.pages.data)==null?void 0:r.filter(p=>!p.attributes.isSubpage);if(s!=null&&s.length){f&&(s=s.filter(t=>{const i=t.attributes.name;if(!i)return!1;const o=i.trim().toLowerCase(),g=f.trim().toLowerCase();return o.includes(g)}));const p=[];for(const t of s)p.push({pageID:t.id,key:`page_${t.id}`,name:e.jsx(O,{onChange:i=>i&&d&&N({pageId:t.id,inputData:{name:i}}),initialValue:t.attributes.name,value:e.jsxs(e.Fragment,{children:[n(t.id)," ",t.attributes.name]}),validators:[i=>E({input:i,searchArray:s||[],searchKey:["attributes","name"]}).catch(o=>(G.error(o.message),Promise.reject()))]}),analogFlip:e.jsx(e.Fragment,{children:e.jsx(O,{onChange:i=>d&&N({pageId:t.id,inputData:{pageFlips:{...t.attributes.pageFlips,analogPageFlipValue:i}}}),initialValue:((m=t.attributes.pageFlips)==null?void 0:m.analogPageFlipValue)??null,value:((l=t.attributes.pageFlips)==null?void 0:l.analogPageFlipValue)??null,validators:[i=>E({input:i,searchArray:P})]})}),layoutMode:e.jsx(ue,{icon:e.jsx(Q,{style:{height:"auto",minWidth:"1em",margin:"0 3px -1px 0"},isStatic:(_=t.attributes)==null?void 0:_.isStatic}),children:(M=t.attributes)!=null&&M.isStatic?"adaptive":"responsive"}),updated:t.attributes.updatedAt,subUsed:e.jsx("div",{style:{display:"flex",gap:5,flexWrap:"wrap"},children:c(t)}),actions:e.jsxs(pe.Button,{onClick:i=>$({pageId:t.id,navigate:b,evt:i}),menu:{items:[t.attributes.isSubpage?null:{key:"startPage",icon:e.jsx(k,{}),label:"Mark as Start Page",onClick:()=>d&&ie({projectId:d,inputData:{startPage:`${t.id}`}})},{key:"clonePage",icon:e.jsx(fe,{}),label:"Clone Page",onClick:()=>d&&X({pageCloneData:t})},{key:"remove",danger:!0,icon:e.jsx(ge,{}),label:"Delete Page",onClick:()=>d&&Z({pageId:t.id,projectId:d,name:t.attributes.name})}]},children:[e.jsx("svg",{style:{marginRight:3,marginBottom:-2},xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M6 2c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-1.9l10-10V8l-6-6zm7 1.5L18.5 9H13zm7.1 9.5c-.1 0-.3.1-.4.2l-1 1l2.1 2.1l1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-2 1.8L12 20.9V23h2.1l6.1-6.1z"})}),"Open in Editor"]})});F(p)}else F([])},[b,d,a,f,P]);const J=u.useContext(me),I="PagesSection";return e.jsxs("div",{id:I,children:[e.jsx(je,{id:"Pages",style:{margin:"15px 0"},level:5,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:["Pages",e.jsx(le,{guide:J,guideStartTargetElement:`#${I}`})]}),!!(x!=null&&x.length)&&w&&e.jsxs("div",{style:{fontWeight:"normal",textTransform:"uppercase",fontSize:10,borderRadius:5,background:"#fff",padding:"5px 7px",border:"0.5px var(--ant-primary-5) dashed"},children:[e.jsx(K,{style:{color:"var(--ant-primary-5)"}})," ","No start page found, please set one"]}),e.jsx(h,{onClick:()=>v("page"),children:"Create New Page"})]})}),x?e.jsxs(e.Fragment,{children:[e.jsx(ce,{showSorterTooltip:!1,columns:W,dataSource:x,pagination:!1}),e.jsx(h,{style:{marginTop:15},type:"primary",onClick:()=>v("page"),children:"Create New Page"})]}):null]})};export{ke as default};
