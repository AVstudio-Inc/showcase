import{j as e,R as b,r as k,ac as y,a as v}from"./index-BWO8qd00.js";import{J as w,b as D,g as F}from"./useCustomFonts--hfI8X19.js";import{M as I,a as N,B as C,o as R,aC as B}from"./editorApp-BQHhAWNR.js";import{g as T}from"./localActiveAPI-Dv2O1BDy.js";import{T as j}from"./index-DQFZSvcF.js";const S=a=>I.info({icon:null,maskClosable:!0,content:e.jsx(e.Fragment,{children:a}),okText:"Close"}),E=({currentProject:a,selectFile:l,setSelectFile:f,renderAsModalPicker:m,style:g,setUploadState:o})=>{var n,r,d;const i=a==null?void 0:a.id,t=(d=(r=(n=a==null?void 0:a.attributes)==null?void 0:n.media)==null?void 0:r.data)==null?void 0:d.filter(s=>s.attributes.mime.includes("image"));return e.jsx(e.Fragment,{children:e.jsx(w,{style:g,children:t==null?void 0:t.map(s=>{let c=s.id;try{const x=JSON.parse(s.attributes.alternativeText),{uuid:h}=x;h&&(c=h)}catch{}const{url:p}=T({imageId:s.id,project:a,renderEnvtype:"editor"});let u={};return s.id===l&&(u={borderColor:"var(--ant-primary-5)"}),a&&e.jsxs("div",{style:u,onClick:()=>m&&f(s.id),className:"thumb",children:[e.jsx("img",{className:"pic",src:p,alt:s.attributes.name}),e.jsxs(j,{className:"imgIDBox",children:["ID: ",c]}),!m&&e.jsxs("div",{className:"overlay",children:[e.jsx(R,{onClick:()=>{S(e.jsxs("div",{style:{display:"flex",flexFlow:"column",gap:10},children:[e.jsx("div",{children:e.jsxs(j,{className:"imgIDBox",children:["ID: ",c]})}),e.jsx("img",{className:"pic",src:p,alt:s.attributes.name})]}))}}),e.jsx(D,{onClick:()=>{F({icon:e.jsx(y,{}),title:"Remove media file?",content:`Please confirm removing ${s.attributes.name} from project media library`,okText:"Delete",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>{i&&o&&(o("removing"),B(i,s.id).then(()=>{o(""),v.success("File deleted")}))},onCancel:()=>{}})}})]})]},s.id)})})})},W=b.memo(({style:a,renderAsModalPicker:l,uploadState:f,setUploadState:m})=>{const g=N(c=>c.workingProject),[o,i,t]=l||[],[n,r]=k.useState(null);function d(){t&&t(n),i&&i(!1)}const s=e.jsx(E,{style:a,setSelectFile:r,selectFile:n,renderAsModalPicker:l,currentProject:g,uploadState:f,setUploadState:m});return l!==void 0?e.jsx(I,{destroyOnClose:!0,maskClosable:!1,title:"Pick Image",open:o,onCancel:()=>i&&i(!1),footer:[e.jsx(C,{onClick:()=>{r(null),i&&i(!1)},children:"Cancel"},"back"),e.jsx(C,{disabled:n===null,type:"primary",onClick:()=>d(),children:"Pick Image"},"submit")],children:s}):e.jsxs(e.Fragment,{children:[" ",s]})});export{W as P,S as s};
