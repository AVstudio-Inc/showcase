var Mu=Object.defineProperty;var Lu=(e,r,i)=>r in e?Mu(e,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[r]=i;var mr=(e,r,i)=>Lu(e,typeof r!="symbol"?r+"":r,i);import{r as I,L as ks,h as Dt,ar as Pr,q as ct,j as D,as as za,R as et,g as Or,w as nt,v as As,l as Fi,F as pr,o as dr,p as ku,H as Ar,k as Au,z as Ru,at as Cu,ai as Qe,a as Rs,y as Cs,af as Du,t as Iu,a6 as Ds,au as Pu}from"./index-BWO8qd00.js";import{a as $t,u as Lt,Z as Is,_ as Ou,$ as Wt,a0 as Fu,a1 as Nu,w as ra,P as Yu,h as An,b as na,H as Bu,k as ju,e as Ps,W as Hu,B as jn,D as Ga,f as Uu,s as zu,Q as Gu}from"./editorApp-BQHhAWNR.js";import{B as jt,u as Pt,a as $r,d as lr,R as fr,e as Vr,f as Xt,P as Gt,E as $a,h as ia,i as $u,j as Vu,I as Wu,g as Ni,k as sn,l as Ku,r as Va}from"./index-E6gmldJE.js";import{P as Os,a as Fs,b as Ns,u as wt,c as Kt,d as or,e as Hr,f as wr,R as Wa,g as Ur,p as Ys,h as Ka}from"./useGetElDimensionsStyles-DKp_YFdD.js";import{n as Xu,o as Bs,d as si,p as Ln,q as Yi,r as qu,e as js}from"./datasourceTools-CeSl9gC_.js";import{u as zr,a as Ju}from"./variablesAPI-D_uU0Jyf.js";import{u as pt,f as Zu,z as Qu,R as ec}from"./useCustomFonts--hfI8X19.js";import{S as tc}from"./index-xMIPA-_5.js";import{R as Xa,u as Hs,g as rc,a as nc}from"./useWindowAvgatorStudioComposer-LuIThOM1.js";import{m as ic,S as ac}from"./index.es-6fh8Idhv.js";import{d as tt,a as En}from"./dayjs.min-DIl2m-M7.js";import{M as sc}from"./moveable.esm-CxaKG_HY.js";import{a as Us,f as oc}from"./localActiveAPI-Dv2O1BDy.js";import{T as Ti}from"./index-DQFZSvcF.js";import{a as lc}from"./datasourceAPI-BARHsYAW.js";var uc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M180 176h-60c-4.4 0-8 3.6-8 8v656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V184c0-4.4-3.6-8-8-8zm724 0h-60c-4.4 0-8 3.6-8 8v656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V184c0-4.4-3.6-8-8-8zM785.3 504.3L657.7 403.6a7.23 7.23 0 00-11.7 5.7V476H378v-62.8c0-6-7-9.4-11.7-5.7L238.7 508.3a7.14 7.14 0 000 11.3l127.5 100.8c4.7 3.7 11.7.4 11.7-5.7V548h268v62.8c0 6 7 9.4 11.7 5.7l127.5-100.8c3.8-2.9 3.8-8.5.2-11.4z"}}]},name:"column-width",theme:"outlined"},cc=function(r,i){return I.createElement(ks,Dt(Dt({},r),{},{ref:i,icon:uc}))},dc=I.forwardRef(cc),fc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M859.9 474H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zm-353.6-74.7c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H550V104c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v156h-62.8c-6 0-9.4 7-5.7 11.7l100.8 127.6zm11.4 225.4a7.14 7.14 0 00-11.3 0L405.6 752.3a7.23 7.23 0 005.7 11.7H474v156c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V764h62.8c6 0 9.4-7 5.7-11.7L517.7 624.7z"}}]},name:"vertical-align-middle",theme:"outlined"},hc=function(r,i){return I.createElement(ks,Dt(Dt({},r),{},{ref:i,icon:fc}))},gc=I.forwardRef(hc);const mc=Pr`
from {
  opacity: 0.000001;
}

to {
 
}
`,pc=ct.div`
  position: relative;
  /* overflow: hidden; */
  color: ${({theme:e})=>e.colors.textColor};
  width: 100%;
  height: 100%;
  max-height: 100%;
  min-height: 0;
  -webkit-text-size-adjust: 100%;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif;
  container-type: size;


  & * {
    box-sizing: border-box;
    font-display: swap;
  }

  sup,
  sub {
    font-size: 0.5em;
  }

  .text-tiny {
    font-size: 0.3em;
  }

  .text-small {
    font-size: 0.5em;
  }

  .text-big {
    font-size: 1.2em;
  }
  .text-huge {
    font-size: 2em;
  }

  --active-page-background-color: transparent;

  --active-page-background-image: none;
  --active-page-background-filter: none;
  --active-page-background-opacity: 1;
  --active-page-background-backgroundSize: cover;
  --active-page-background-backgroundPosition: center;

  #ProjectBackgroundImage,
  .PageBackgroundImage,
  .PageBackgroundColor,
  .expand {
    position: absolute;
    pointer-events: none;
    /* will-change: opacity; */
    /* transition: opacity 200ms; */
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    background-repeat: no-repeat;
    background-position: 50% 50%;
    background-size: cover;
  }

  #PageBackgroundColor {
    transition: background-color 200ms ease-in;
    background-color: var(--active-page-background-color);
  }

  #PageBackgroundImage {
    background-image: var(--active-page-background-image);
    filter: var(--active-page-background-filter);
    opacity: var(--active-page-background-opacity);
    background-size: var(--active-page-background-backgroundSize);
    background-position: var(--active-page-background-backgroundPosition);
    visibility: hidden;
  }

  #PageBackgroundImage.animateActivePageBg {
    animation-name: ${mc};
    animation-duration: 500ms;
    animation-delay: 300ms;
    animation-fill-mode: both;
    visibility: visible;
  }

  .ql-align-center {
    text-align: center;
  }

  .ql-align-right {
    text-align: right;
  }

  .ql-align-justify {
    text-align: justify;
  }

  .ant-switch-checked:focus {
    box-shadow: none;
  }

  .isDisabled {
    pointer-events: none;
    filter: grayscale(100%);
    opacity: 0.3;
    * {
      color: #fff !important;
      pointer-events: none;
    }
  }
  .isHidden,
  .isHiddenByOrientation {
    &:not(.isReserveSpace) {
      display: none;
    }
    &.isReserveSpace {
      opacity: 0 !important;
      pointer-events: none;
    }
  }

  .hasActions {
    cursor: pointer;
    transition: 200ms;
    &:active {
      transform: scale(0.9);
    }
  }

  #layers {
    z-index: 1000;
    position: fixed;
  }

  [data-visualhidden='true'] {
    clip-path: inset(50%);
  }

  [data-visualhidden='false'] {
  }

  //overlayMask

  --mask-bg-color: rgba(0, 0, 0, 0.5);
  --overlay-background-blur: 0px;
  /* 
  &.isOverlayOpen .content .page {
    .container:not(:has(.isActiveOverlayTrigger)),
    .globalContainer {
      background-color: red;
    }
  } */

  /* 
  & .container,
  & .globalContainer {
    &:not(.renderAsElement):after {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      right: 0;
      bottom: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      pointer-events: none;
      background-color: transparent;
      backdrop-filter: blur(0px);
      transition: 100ms;
      opacity: 0.000001;
      will-change: 'opacity';
      background-color: var(--mask-bg-color);
      backdrop-filter: blur(var(--overlay-background-blur));
    }
  }

  &.isOverlayOpen {
    .container:after,
    .globalContainer:after {
      pointer-events: auto;
      opacity: 0.99999;
    }
  } */

  /* #overlayInnerContent {
    & [class*='element_'] {
      opacity: 1;
      filter: blur(0px);
    }
  } */

  /* &.isOverlayOpen .container,
  &.isOverlayOpen .globalContainer {
    & > *:not(.isActiveOverlayTrigger) {
      filter: blur(var(--overlay-background-blur));
    }
  } */
  /* 
  &.isOverlayOpen.showMask .container,
  &.isOverlayOpen.showMask .globalContainer {
    &:not(.renderAsElement):after {
      opacity: 0.99999;
      background-color: var(--mask-bg-color);
    }
  } */

  ${({inlineStyles:e})=>e}
`,vc=ct.div.attrs(({dynamicBg:e})=>({style:{transform:`translateY(
        ${e!==null?-66.5*e.value/100+"%":"-32.5%"}
      )`,opacity:`${e!=null&&e.show?.3:0}`,backgroundImage:`linear-gradient(
        180deg,
        ${e==null?void 0:e.minColor} 0%,
        ${e==null?void 0:e.maxColor} 100%
      )`}}))`
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 300%;
  background-repeat: no-repeat;
  background-size: 100% 100%;
  background-position: 50% 50%;
  transition: 500ms;
  will-change: all;
`;ct.div`
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;

  video {
    position: relative;
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: 50% 50%;
    mix-blend-mode: screen;
    /* mix-blend-mode: lighten; */
    /* mix-blend-mode: exclusion; */
    /* mix-blend-mode: luminosity; */
    opacity: 0.1;
  }
`;const _c=ct.div`
  left: 0;
  top: 0;
  position: absolute;
  width: 100%;
  height: 100%;
  min-height: 0;
  display: grid;

  grid-template-columns: auto 1fr auto;
  grid-template-rows: auto 1fr auto;
  gap: 0px 0px;
  grid-template-areas:
    'top top top'
    'left content right'
    'bottom bottom bottom';

  .globalslot {
    position: relative;
    z-index: 10;
  }

  .top {
    grid-area: top;
  }

  .right {
    grid-area: right;
    & > div {
      position: relative;
      width: 100%;
      height: 100%;
    }
  }

  .bottom {
    grid-area: bottom;
  }

  .left {
    grid-area: left;
    & > div {
      position: relative;
      width: 100%;
      height: 100%;
    }
  }
  .content {
    /* position: relative;
    z-index: 10; */
    grid-area: content;
    width: 100%;
    height: 100%;
    min-width: 0;
    min-height: 0;
  }

  background-position: 50% 50%;
  background-repeat: no-repeat;
  background-size: cover;
`,yc=ct.div`
  position: relative;
  display: flex;
  /* overflow: hidden; */
  width: 100%;
  height: 100%;
  max-height: 100%;
  min-height: 0;
  ${({inlineStyles:e})=>e}

  #pageBackground {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    transform: translateZ(0);
  }
`;ct.div`
  /* background-color: red; */
  position: relative;
  width: 100%;
  height: 100%;
  border-radius: 3px;
  border: 0.5px #fff dashed;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  font-size: 8px;
  text-transform: uppercase;
`;const bc=ct.div`
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  flex-flow: column;
  align-items: center;
  justify-content: center;
  gap: 0.5em;
  font-weight: normal;
  pointer-events: none;
  overflow: hidden;

  .icon {
    width: 50px;
    height: auto;
  }

  .title {
    font-size: 14px;
  }

  .text {
    opacity: 0.5;
    font-size: 10px;
    text-transform: uppercase;
  }
`,aa=({text:e,title:r,icon:i,style:o})=>D.jsxs(bc,{style:o,children:[D.jsx("div",{className:"icon",children:i}),D.jsx("div",{className:"title",children:r}),D.jsx("div",{className:"text",children:e})]});aa.displayName="EmptyElement";const Sc=Pr`
from {
  opacity: 0.000001;
}

to {
 
}
`,Ec=Pr`
from {
  scale: 0.7
}

to {
  scale: 1
}
`,xc=Pr`
from {
 visibility: hidden
}

to {
}
`,Tc=ct.div`
  position: relative;
  display: flex;
  outline-offset: -3px;
  overflow: hidden;
  width: 100%;
  height: 100%;
  border-style: solid;
  gap: 1em;
  /* transform: translateZ(0); */
  transition: 0ms;
  opacity: 1;

  &.renderAsElement {
    container: 'ContainerBox / inline-size';
    animation-name: ${xc};
    animation-delay: 50ms;
    animation-fill-mode: both;
  }

  /* &.showContainer {
    transition: opacity 300ms;
    opacity: 1;
  } */

  .contextMenuOverlay {
    position: absolute;
    z-index: -1;
  }

  .dragIndicator {
    height: 1px;
    width: 80%;
    background: ${({theme:e})=>{var r;return(r=e.devColors)==null?void 0:r.element}};
    transition: 200ms;
    animation-name: ${Ec};
    animation-duration: 300ms;
    animation-fill-mode: both;

    &.containerRow {
      height: 80%;
      width: 1px;
    }
  }

  //bg image for container
  &::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    background-repeat: 'no-repeat';
    background-size: ${({backgroundImageStyles:e})=>(e==null?void 0:e.backgroundSize)??"cover"};
    background-position: ${({backgroundImageStyles:e})=>(e==null?void 0:e.backgroundPosition)??"center"};
    background-image: ${({backgroundImageStyles:e})=>(e==null?void 0:e.backgroundImage)??"none"};
    filter: ${({backgroundImageStyles:e})=>(e==null?void 0:e.filter)??"none"};
    opacity: ${({backgroundImageStyles:e})=>(e==null?void 0:e.opacity)??1};
    will-change: 'filter, opacity';
    animation-name: ${Sc};
    animation-duration: 500ms;
    animation-delay: 300ms;
    animation-fill-mode: both;

  }

  &.emptyDragOverGlobal {
    min-height: 100px;
    min-width: 100px;
  }

  &.globalContainer {

    min-width: 100px;
  }

  
  &.staticContainer {
    position: absolute;
    left: 0;
    top: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    height: 100%;
    display: block;
    overflow: visible;

    &> * {
      position: absolute;

      min-width: 0;
      min-height: 0;
      max-width: auto;
      max-height: auto;
    }

  }

  &.selectedContainer
 {
  outline-color: ${({theme:e,isGlobal:r})=>{var i,o;return r?(i=e.devColors)==null?void 0:i.globalContainer:(o=e.devColors)==null?void 0:o.container}};
  outline-style: dashed;
  outline-width: 1px;
 }  

`,xn=ct(jt)`
  cursor: pointer;
  background: rgba(255, 255, 255, 0.1);
  border-radius: ${({theme:e})=>e.borderRadius};
  padding: 1.2em 1.5em;
  white-space: nowrap;
  min-width: min-content;
  min-height: min-content;
  color: inherit;
  font-size: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.3em;
  user-select: none;
  transition: 200ms;
  will-change: transform;
  /* transform-origin: 50% 50%; */
  position: relative;
  z-index: ${({zIndex:e})=>e??1};
 

  &.ghost {
    background: none;
  }

  &.danger {
    background: none;
    border: 0.5px solid rgba(247, 54, 54, 0.4);
    color: rgba(240, 0, 0, 0.93);
  }

  &.size-large {
    font-size: 1.2em;
  }

  &.size-small {
    font-size: 0.7em;
  }

  &.contentAlign-end {
    justify-content: end;
  }

  &.contentAlign-start {
    justify-content: start;
  }

  &.iconPosition-top {
    flex-flow: column;

    &.contentAlign-end {
      align-items: end;
    }

    &.contentAlign-start {
      align-items: start;
    }
  }

  &.iconPosition-bottom {
    flex-flow: column-reverse;
    &.contentAlign-end {
      align-items: end;
    }

    &.contentAlign-start {
      align-items: start;
    }
  }

  &.iconPosition-right {
    flex-flow: row-reverse;
  }

  &:before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    right: 0;
    bottom: 0;
    transform: scale(0);
    opacity: 0.1;
    transition: 200ms;
    z-index: -1;
    border-radius: inherit;
  }

  &:active {
    scale: 0.85;
  }

  &.isPressed {
    &:not(.ghost):not(.danger) {
      background: ${({theme:e})=>e.colors.primaryColor};
      color: #000;
    }
    &.ghost {
      color: ${({theme:e})=>e.colors.primaryColor};
    }
    &.danger,
    &.element_button.danger {
      background: rgba(255, 84, 46, 0.93);
      color: #fff;
    }
  }

  ${({$isActive:e})=>e&&za`
      &:before {
        display: block;
        transform: scale(1);
        opacity: 1;
      }
      color: #212121;
      box-shadow: 0px 69px 112px rgba(186, 255, 237, 0.1), 0px 44.7222px 65.5926px rgba(186, 255, 237, 0.0759259),
        0px 26.5778px 35.6741px rgba(186, 255, 237, 0.0607407), 0px 13.8px 18.2px rgba(186, 255, 237, 0.05),
        0px 5.62222px 9.12593px rgba(186, 255, 237, 0.0392593), 0px 1.27778px 4.40741px rgba(186, 255, 237, 0.0240741);
    `}/* ${({$isEnabled:e})=>!e&&za`
      pointer-events: none;
      opacity: 0.5;
    `} */
`,ht=1,zs=2,Gs=4,Yt=8,Bi=16,Hn=32,vr=64,ji={a:{content:ht|Yt,self:!1,type:ht|Yt|Hn|vr},address:{invalid:["h1","h2","h3","h4","h5","h6","address","article","aside","section","div","header","footer"],self:!1},audio:{children:["track","source"]},br:{type:ht|Yt,void:!0},body:{content:ht|zs|Gs|Yt|Bi|Hn|vr},button:{content:Yt,type:ht|Yt|Hn|vr},caption:{content:ht,parent:["table"]},col:{parent:["colgroup"],void:!0},colgroup:{children:["col"],parent:["table"]},details:{children:["summary"],type:ht|Hn|vr},dd:{content:ht,parent:["dl"]},dl:{children:["dt","dd"],type:ht},dt:{content:ht,invalid:["footer","header"],parent:["dl"]},figcaption:{content:ht,parent:["figure"]},footer:{invalid:["footer","header"]},header:{invalid:["footer","header"]},hr:{type:ht,void:!0},img:{void:!0},li:{content:ht,parent:["ul","ol","menu"]},main:{self:!1},ol:{children:["li"],type:ht},picture:{children:["source","img"],type:ht|Yt|Bi},rb:{parent:["ruby","rtc"]},rp:{parent:["ruby","rtc"]},rt:{content:Yt,parent:["ruby","rtc"]},rtc:{content:Yt,parent:["ruby"]},ruby:{children:["rb","rp","rt","rtc"]},source:{parent:["audio","video","picture"],void:!0},summary:{content:Yt,parent:["details"]},table:{children:["caption","colgroup","thead","tbody","tfoot","tr"],type:ht},tbody:{parent:["table"],children:["tr"]},td:{content:ht,parent:["tr"]},tfoot:{parent:["table"],children:["tr"]},th:{content:ht,parent:["tr"]},thead:{parent:["table"],children:["tr"]},tr:{parent:["table","tbody","thead","tfoot"],children:["th","td"]},track:{parent:["audio","video"],void:!0},ul:{children:["li"],type:ht},video:{children:["track","source"]},wbr:{type:ht|Yt,void:!0}};function Wr(e){return r=>{ji[r]={...e,...ji[r]}}}["address","main","div","figure","p","pre"].forEach(Wr({content:ht,type:ht|vr}));["abbr","b","bdi","bdo","cite","code","data","dfn","em","i","kbd","mark","q","ruby","samp","strong","sub","sup","time","u","var"].forEach(Wr({content:Yt,type:ht|Yt|vr}));["p","pre"].forEach(Wr({content:Yt,type:ht|vr}));["s","small","span","del","ins"].forEach(Wr({content:Yt,type:ht|Yt}));["article","aside","footer","header","nav","section","blockquote"].forEach(Wr({content:ht,type:ht|zs|vr}));["h1","h2","h3","h4","h5","h6"].forEach(Wr({content:Yt,type:ht|Gs|vr}));["audio","canvas","iframe","img","video"].forEach(Wr({type:ht|Yt|Bi|vr}));const Hi=Object.freeze(ji),wc=["applet","base","body","command","embed","frame","frameset","head","html","link","meta","noscript","object","script","style","title"],Mc=Object.keys(Hi).filter(e=>e!=="canvas"&&e!=="iframe"),_t=1,Lc=2,Sn=3,nn=4,$s=5,qa=Object.freeze({alt:_t,cite:_t,class:_t,colspan:Sn,controls:nn,datetime:_t,default:nn,disabled:nn,dir:_t,height:_t,href:_t,id:_t,kind:_t,label:_t,lang:_t,loading:_t,loop:nn,media:_t,muted:nn,poster:_t,rel:_t,role:_t,rowspan:Sn,scope:_t,sizes:_t,span:Sn,start:Sn,style:$s,src:_t,srclang:_t,srcset:_t,tabindex:_t,target:_t,title:_t,type:_t,width:_t}),kc=Object.freeze({class:"className",colspan:"colSpan",datetime:"dateTime",rowspan:"rowSpan",srclang:"srcLang",srcset:"srcSet",tabindex:"tabIndex"});function Qn(){return Qn=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},Qn.apply(this,arguments)}function Vs({attributes:e={},className:r,children:i=null,selfClose:o=!1,tagName:l}){const f=l;return o?et.createElement(f,Qn({className:r},e)):et.createElement(f,Qn({className:r},e),i)}class Ac{attribute(r,i){return i}node(r,i){return i}}/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */var Rc=/["'&<>]/,Cc=Dc;function Dc(e){var r=""+e,i=Rc.exec(r);if(!i)return r;var o,l="",f=0,s=0;for(f=i.index;f<r.length;f++){switch(r.charCodeAt(f)){case 34:o="&quot;";break;case 38:o="&amp;";break;case 39:o="&#39;";break;case 60:o="&lt;";break;case 62:o="&gt;";break;default:continue}s!==f&&(l+=r.substring(s,f)),s=f+1,l+=o}return s!==f?l+r.substring(s,f):l}const Ic=Or(Cc);var Ja={};function xr(e,r,i){return r in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i,e}const Pc=/(url|image|image-set)\(/i;class Oc extends Ac{attribute(r,i){return r==="style"&&Object.keys(i).forEach(o=>{String(i[o]).match(Pc)&&delete i[o]}),i}}const Za=1,Fc=3,Nc=/^<(!doctype|(html|head|body)(\s|>))/i,Yc=/^(aria-|data-|\w+:)/iu,Bc=/{{{(\w+)\/?}}}/;function jc(){if(!(typeof window>"u"||typeof document>"u"))return document.implementation.createHTMLDocument("Interweave")}class Ws{constructor(r,i={},o=[],l=[]){var f;xr(this,"allowed",void 0),xr(this,"banned",void 0),xr(this,"blocked",void 0),xr(this,"container",void 0),xr(this,"content",[]),xr(this,"props",void 0),xr(this,"matchers",void 0),xr(this,"filters",void 0),xr(this,"keyIndex",void 0),this.props=i,this.matchers=o,this.filters=[...l,new Oc],this.keyIndex=-1,this.container=this.createContainer(r||""),this.allowed=new Set((f=i.allowList)!==null&&f!==void 0?f:Mc),this.banned=new Set(wc),this.blocked=new Set(i.blockList)}applyAttributeFilters(r,i){return this.filters.reduce((o,l)=>o!==null&&typeof l.attribute=="function"?l.attribute(r,o):o,i)}applyNodeFilters(r,i){return this.filters.reduce((o,l)=>o!==null&&typeof l.node=="function"?l.node(r,o):o,i)}applyMatchers(r,i){const o={},{props:l}=this;let f=r,s=0,g=null;return this.matchers.forEach(p=>{const d=p.asTag().toLowerCase(),h=this.getTagConfig(d);if(l[p.inverseName]||!this.isTagAllowed(d)||!this.canRenderChild(i,h))return;let L="";for(;f&&(g=p.match(f));){const{index:_,length:x,match:T,valid:b,void:M,...R}=g,k=p.propName+String(s);_>0&&(L+=f.slice(0,_)),b?(L+=M?`{{{${k}/}}}`:`{{{${k}}}}${T}{{{/${k}}}}`,this.keyIndex+=1,s+=1,o[k]={children:T,matcher:p,props:{...l,...R,key:this.keyIndex}}):L+=T,p.greedy?(f=L+f.slice(_+x),L=""):f=f.slice(_+(x||T.length))}p.greedy||(f=L+f)}),s===0?r:this.replaceTokens(f,o)}canRenderChild(r,i){return!r.tagName||!i.tagName||r.void?!1:r.children.length>0?r.children.includes(i.tagName):r.invalid.length>0&&r.invalid.includes(i.tagName)?!1:i.parent.length>0?i.parent.includes(r.tagName):!r.self&&r.tagName===i.tagName?!1:!!(r&&r.content&i.type)}convertLineBreaks(r){const{noHtml:i,disableLineBreaks:o}=this.props;if(i||o||r.match(/<((?:\/[ a-z]+)|(?:[ a-z]+\/))>/gi))return r;let l=r.replace(/\r\n/g,`
`);return l=l.replace(/\n{3,}/g,`


`),l=l.replace(/\n/g,"<br/>"),l}createContainer(r){var i;const l=(typeof Ja<"u"&&Ja.INTERWEAVE_SSR_POLYFILL||jc)();if(!l)return;const f=(i=this.props.containerTagName)!==null&&i!==void 0?i:"body",s=f==="body"||f==="fragment"?l.body:l.createElement(f);return r.match(Nc)||(s.innerHTML=this.convertLineBreaks(this.props.escapeHtml?Ic(r):r)),s}extractAttributes(r){const{allowAttributes:i}=this.props,o={};let l=0;return r.nodeType!==Za||!r.attributes||([...r.attributes].forEach(f=>{const{name:s,value:g}=f,p=s.toLowerCase(),d=qa[p]||qa[s];if(!this.isSafe(r)||!p.match(Yc)&&(!i&&(!d||d===Lc)||p.startsWith("on")||g.replace(/(\s|\0|&#x0([9AD]);)/,"").match(/(javascript|vbscript|livescript|xss):/i)))return;let h=p==="style"?this.extractStyleAttribute(r):g;d===nn?h=!0:d===Sn?h=Number.parseFloat(String(h)):d!==$s&&(h=String(h)),o[kc[p]||p]=this.applyAttributeFilters(p,h),l+=1}),l===0)?null:o}extractStyleAttribute(r){const i={};return Array.from(r.style).forEach(o=>{const l=r.style[o];(typeof l=="string"||typeof l=="number")&&(i[o.replace(/-([a-z])/g,(f,s)=>String(s).toUpperCase())]=l)}),i}getTagConfig(r){const i={children:[],content:0,invalid:[],parent:[],self:!0,tagName:"",type:0,void:!1};return Hi[r]?{...i,...Hi[r],tagName:r}:i}isSafe(r){if(typeof HTMLAnchorElement<"u"&&r instanceof HTMLAnchorElement){const i=r.getAttribute("href");if(i!=null&&i.startsWith("#"))return!0;const o=r.protocol.toLowerCase();return o===":"||o==="http:"||o==="https:"||o==="mailto:"||o==="tel:"}return!0}isTagAllowed(r){return this.banned.has(r)||this.blocked.has(r)?!1:this.props.allowElements||this.allowed.has(r)}parse(){return this.container?this.parseNode(this.container,this.getTagConfig(this.container.nodeName.toLowerCase())):[]}parseNode(r,i){const{noHtml:o,noHtmlExceptMatchers:l,allowElements:f,transform:s,transformOnlyAllowList:g}=this.props;let p=[],d="";return[...r.childNodes].forEach(h=>{if(h.nodeType===Za){const _=h.nodeName.toLowerCase(),x=this.getTagConfig(_);d&&(p.push(d),d="");const T=this.applyNodeFilters(_,h);if(!T)return;let b;if(s&&!(g&&!this.isTagAllowed(_))){this.keyIndex+=1;const M=this.keyIndex;b=this.parseNode(T,x);const R=s(T,b,x);if(R===null)return;if(typeof R<"u"){p.push(et.cloneElement(R,{key:M}));return}this.keyIndex=M-1}if(this.banned.has(_))return;if(!(o||l&&_!=="br")&&this.isTagAllowed(_)&&(f||this.canRenderChild(i,x))){var L;this.keyIndex+=1;const M=this.extractAttributes(T),R={tagName:_};M&&(R.attributes=M),x.void&&(R.selfClose=x.void),p.push(et.createElement(Vs,{...R,key:this.keyIndex},(L=b)!==null&&L!==void 0?L:this.parseNode(T,x)))}else p=[...p,...this.parseNode(T,x.tagName?x:i)]}else if(h.nodeType===Fc){const _=o&&!l?h.textContent:this.applyMatchers(h.textContent||"",i);Array.isArray(_)?p=[...p,..._]:d+=_}}),d&&p.push(d),p}replaceTokens(r,i){if(!r.includes("{{{"))return r;const o=[];let l=r,f=null;for(;f=l.match(Bc);){const[s,g]=f,p=f.index,d=s.includes("/");p>0&&(o.push(l.slice(0,p)),l=l.slice(p));const{children:h,matcher:L,props:_}=i[g];let x;if(d)x=s.length,o.push(L.createElement(h,_));else{const T=l.match(new RegExp(`{{{/${g}}}}`));x=T.index+T[0].length,o.push(L.createElement(this.replaceTokens(l.slice(s.length,T.index),i),_))}l=l.slice(x)}return l.length>0&&o.push(l),o.length===0?"":o.length===1&&typeof o[0]=="string"?o[0]:o}}function Hc(e){var r;const{attributes:i,className:o,containerTagName:l,content:f,emptyContent:s,parsedContent:g,tagName:p,noWrap:d}=e,h=(r=l??p)!==null&&r!==void 0?r:"span",L=h==="fragment"?!0:d;let _;if(g)_=g;else{const x=new Ws(f??"",e).parse();x.length>0&&(_=x)}return _||(_=s),L?et.createElement(et.Fragment,null,_):et.createElement(Vs,{attributes:i,className:o,tagName:h},_)}function Uc(e){const{attributes:r,className:i,content:o="",disableFilters:l=!1,disableMatchers:f=!1,emptyContent:s=null,filters:g=[],matchers:p=[],onAfterParse:d=null,onBeforeParse:h=null,tagName:L="span",noWrap:_=!1,...x}=e,T=f?[]:p,b=l?[]:g,M=h?[h]:[],R=d?[d]:[];T.forEach(H=>{H.onBeforeParse&&M.push(H.onBeforeParse.bind(H)),H.onAfterParse&&R.push(H.onAfterParse.bind(H))});const k=M.reduce((H,G)=>G(H,e),o??""),j=new Ws(k,x,T,b),N=R.reduce((H,G)=>G(H,e),j.parse());return et.createElement(Hc,{attributes:r,className:i,containerTagName:e.containerTagName,emptyContent:s,noWrap:_,parsedContent:N.length===0?void 0:N,tagName:L})}function zc(e){const r=/(<([\w-]+)\s*[^>]*?\/>)(?!<\/\2\s*>)/g;let i=e,o;for(;o=r.exec(e);){const l=o[1],s=`</${o[2]}>`;i=i.replace(l,`${l}${s}`)}return i}function Gc(e){if(e){const r=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");return zc(r)}else return e}const $c=({getTextFromDatasource:e,defaultText:r})=>{const[i,o]=I.useState(r),l=si(s=>s.entries),f=zr(s=>s.calculatedVariables);return I.useEffect(()=>{e.then(s=>{s!==void 0&&s!==""&&o(g=>{const p=String(s);return p===g?g:p})}).catch(()=>console.log("Error getting text value from datasource"))},[e,l,f]),D.jsx(D.Fragment,{children:i})},Vc=({stateVariableName:e,defaultText:r})=>{const[i,o]=et.useState(r),[l,f]=et.useState(""),s=zr(d=>d.calculatedVariables),{calculatedParameters:g}=I.useContext(oi),p=si(d=>d.entries);return I.useEffect(()=>{if(e!=null&&e!==""){let d=e.split(","),h=[],L=[],_=e;for(const x of d){const[T,b]=x.split("=");T==="variableName"?h.push(b):T==="parameterName"&&L.push(b)}L.length>0&&L.forEach(x=>{let T=g==null?void 0:g.find(b=>b.name===x);if(T){const{currentValue:b,defaultValue:M}=T;let R=b===void 0?M:b;_&&_!==void 0&&(_=_.replace(`parameterName=${x}`,R.toString()))}}),h.length>0&&h.forEach(x=>{let T=s==null?void 0:s.find(b=>b.name===x);if(T){const{currentValue:b,defaultValue:M}=T;let R=b===void 0?M:b;_&&_!==void 0&&(_=_.replace(`variableName=${x}`,R.toString()))}}),_&&_!==void 0&&f(_==null?void 0:_.replace(/,/g,""))}},[g,s,e]),I.useEffect(()=>{var h;let d=(h=p.find(L=>L.name===l))==null?void 0:h.value;d!==void 0&&d!==r&&o(d)},[l,r,p,e]),D.jsx(D.Fragment,{children:i})},Wc=({trueText:e,falseText:r,variableName:i,childrenText:o,fillVariable:l})=>{const{calculatedValue:f,targetVariable:s}=Ju(i)||{},[g,p]=I.useState(o);return I.useEffect(()=>{const d=()=>{if(s&&s!==void 0){let h=r;switch(s.type){case"string":case"number":String(f)!==""&&(h=String(f));break;case"boolean":h=f?e:r;break}return h}};s===void 0&&p(D.jsx(D.Fragment,{children:o})),s!=null&&s.dynamicValue&&s.dynamicValue!==void 0?l.then(h=>{p(h!==void 0&&h!==""?D.jsx(D.Fragment,{children:h}):D.jsx(D.Fragment,{children:d()}))}):p(D.jsx(D.Fragment,{children:d()}))},[f,o,r,l,s,e,i]),D.jsx(D.Fragment,{children:g})},Kc=({parameterName:e,defaultText:r,parentArrayIndex:i,parentData:o})=>{var _,x;let l=r;const{calculatedParameters:f}=I.useContext(oi);let s=f==null?void 0:f.find(T=>T.name===e);s&&(l=(s==null?void 0:s.currentValue)??s.defaultValue);const[g,p]=I.useState(r),d=$t(T=>{var b;return((b=T.workingProject)==null?void 0:b.attributes.variables)||[]}),h=(_=d.find(T=>T.name===e))==null?void 0:_.dynamicValue,L=(x=d.find(T=>T.name===e))==null?void 0:x.defaultValue;return I.useEffect(()=>{typeof l=="string"&&l.startsWith("{")&&l.endsWith("}")?Ln("%"+e+"%",i,o,"htmlFromString - PrintParameterValue",void 0,l).then(T=>{T!==void 0&&T!==""&&(console.log("PrintParameterValue x",T),p(String(T)))}).catch(()=>console.log("Error getting text value from parameter")):p(l)},[e,h,L,i,o,l,r,f]),D.jsx(D.Fragment,{children:g})},wi=({parameterName:e,node:r,childrenText:i,parentArrayIndex:o,parentData:l})=>{var x,T;let f=i;const{calculatedParameters:s}=I.useContext(oi),g=s==null?void 0:s.find(b=>b.name===e);if(g){const b=(g==null?void 0:g.currentValue)??g.defaultValue;(typeof b=="string"||typeof b=="number")&&(f=b.toString())}const[p,d]=I.useState(""),h=$t(b=>{var M;return((M=b.workingProject)==null?void 0:M.attributes.variables)||[]}),L=(x=h.find(b=>b.name===e))==null?void 0:x.dynamicValue,_=(T=h.find(b=>b.name===e))==null?void 0:T.defaultValue;if(I.useEffect(()=>{typeof f=="string"&&f.startsWith("{")&&f.endsWith("}")?Ln("%"+e+"%",o,l,"htmlFromString - PrintParameterValue",void 0,f).then(b=>{b!==void 0&&b!==""&&d(String(b))}).catch(()=>console.log("Error getting text value from parameter")):d((f==null?void 0:f.toString())??"")},[e,L,_,o,l,f]),r.tagName.toLowerCase()==="serial_fb")return D.jsx(Os,{signalName:p,placeholder:i});if(r.tagName.toLowerCase()==="digital_fb"){const b=r.getAttribute("true")||"",M=r.getAttribute("false")||"";return D.jsx(Ns,{signalName:p,trueText:b,falseText:M})}return console.log("PrintDynamicJoinValue",p),D.jsx(Fs,{signalName:p})},Ct=et.memo(({text:e,style:r,indexInList:i,...o})=>{const l=Gc(String(e??""));function f(s,g){let p=g==null?void 0:g[0];if(s.tagName.toLowerCase()==="state"){const d=s.getAttribute("name");return D.jsx(Vc,{stateVariableName:d,defaultText:p})}if(s.tagName.toLowerCase()==="serial_fb"){const d=s.getAttribute("signal");return d&&d.startsWith("%")&&d.endsWith("%")?D.jsx(wi,{parameterName:d.substring(1,d.length-1),node:s,childrenText:p,parentArrayIndex:o.parentArrayIndex,parentData:o.parentData}):D.jsx(Os,{signalName:d,placeholder:p})}if(s.tagName.toLowerCase()==="analog_fb"){const d=s.getAttribute("signal")||void 0;return d&&d.startsWith("%")&&d.endsWith("%")?D.jsx(wi,{parameterName:d.substring(1,d.length-1),node:s,childrenText:p,parentArrayIndex:o.parentArrayIndex,parentData:o.parentData}):D.jsx(Fs,{signalName:d})}if(s.tagName.toLowerCase()==="digital_fb"){const d=s.getAttribute("signal")||void 0,h=s.getAttribute("true")||"",L=s.getAttribute("false")||"";return d&&d.startsWith("%")&&d.endsWith("%")?D.jsx(wi,{parameterName:d.substring(1,d.length-1),node:s,childrenText:p,parentArrayIndex:o.parentArrayIndex,parentData:o.parentData}):D.jsx(Ns,{signalName:d,trueText:h,falseText:L})}if(s.tagName.toLowerCase()==="varstring"||s.tagName.toLowerCase()==="varnumber"||s.tagName.toLowerCase()==="varboolean"){const d=s.getAttribute("variableName")||"",h=s.getAttribute("true"),L=s.getAttribute("false"),_=Xu(d);return D.jsx(Wc,{trueText:h,falseText:L,childrenText:p||"",variableName:d,fillVariable:_})}if(s.tagName.toLowerCase()==="datasource"){let d=s.getAttribute("valuePath")||"";d&&(d=d.substring(1,d.length-1));let h=o;const L=Bs(h.dataset,h.datasetPath,h.filter,d,i,void 0,h.parentData,h.parentArrayIndex);return D.jsx($c,{defaultText:p,getTextFromDatasource:L})}if(s.tagName.toLowerCase()==="parameter"){let d=s.getAttribute("name")||"";return d&&(d=d.substring(1,d.length-1)),D.jsx(Kc,{defaultText:p,parameterName:d,parentArrayIndex:o.parentArrayIndex,parentData:o.parentData})}}return D.jsx("div",{style:r,children:D.jsx(Uc,{transform:f,allowAttributes:!0,allowElements:!0,content:l})})}),Et=e=>{let r={};return(e==null?void 0:e.value)!==void 0&&(r={fontSize:e.value+((e==null?void 0:e.unit)||"px")}),r},yt=({sizeObj:e,sizePropName:r,defaultValue:i})=>I.useMemo(()=>(e==null?void 0:e.value)!==void 0&&(e==null?void 0:e.value)!==null?{[r]:e.value+((e==null?void 0:e.unit)||"px")}:i&&(i!=null&&i.value)&&(i!=null&&i.unit)?{[r]:i.value+i.unit}:{},[e,r,i]),sa=et.memo(e=>{const{cssClass:r,text:i,index:o,style:l,indexInList:f,iconName:s,iconPosition:g,size:p,actions:d,buttonDesign:h,width:L,height:_,state:x,iconSize:T,textFontSize:b,gap:M,padding:R,paddingTop:k,paddingBottom:j,paddingLeft:N,paddingRight:H,textColor:G,iconColor:V,backgroundColor:J,border:Z,dataset:ee,datasetPath:ge,filter:pe,textTransform:Ee="none",parentArrayIndex:be,parentData:Me,iconImageData:ce,useImageAsIcon:ve,contentAlign:fe="center",allowTextWrap:xe=!1,fontFamily:we="inherit",boxShadow:ye,boxReflect:q,staticDevMoveableRef:oe,constraintsVertical:ae,constraintsHorizontal:Re,isStaticElement:Ce,left:ke,top:De,right:Ne,bottom:je,deltaCenterX:Fe,deltaCenterY:ze}=e,Ge=be,Ve=I.useRef(null),Xe=Pt(x,o),me=wt({width:L,height:_,constraintsVertical:ae,constraintsHorizontal:Re,isStaticElement:Ce,left:ke,top:De,right:Ne,bottom:je,deltaCenterX:Fe,deltaCenterY:ze}),te=Et(T),de=Et(b),Ae=yt({sizeObj:M,sizePropName:"gap"}),{globalPadding:O}=yt({sizeObj:R,sizePropName:"globalPadding"}),U={paddingTop:O,paddingRight:O,paddingBottom:O,paddingLeft:O},A=yt({sizeObj:k,sizePropName:"paddingTop"}),S=yt({sizeObj:j,sizePropName:"paddingBottom"}),P=yt({sizeObj:N,sizePropName:"paddingLeft"}),F=yt({sizeObj:H,sizePropName:"paddingRight"}),z=J?{backgroundColor:J}:{},$=$r(Z),W=Vr(ye),X=Xt(q),{tapActionsArr:se,isActiveOverlayTrigger:ie}=lr({indexInList:f,actions:d,dataset:ee,datasetPath:ge,filter:pe,elementRef:Ve,parentData:Me,parentIndex:Ge}),re=nt({[`element_${e.type}`]:!0,[`${r}`]:r,ghost:h==="ghost",danger:h==="danger",[`size-${p}`]:p,["iconPosition-"+g]:s||ve,[`contentAlign-${fe}`]:!0,isActiveOverlayTrigger:!!ie,...Xe}),le={...se};let he={};G&&(he={color:G});const ue={...W,...X,...Ae,...U,...A,...S,...P,...F,...z,...$,...he,textTransform:Ee,...xe?{whiteSpace:"normal",minWidth:"5px"}:{},...me,...l};return D.jsxs(xn,{ref:Ie=>{oe&&(oe.current=Ie),Ve.current=Ie},...e,...le,style:{...ue,fontFamily:we},className:re,children:[s||ve?D.jsx(fr,{style:{...te,color:V||"inherit"},icon:s,iconImageData:ce,useImageAsIcon:ve}):null,i?D.jsx(Ct,{indexInList:f,...e,style:de,text:i}):null]})});sa.displayName="ButtonElement";const Xc=ct(jt)`
  display: flex;
  align-items: center;
  gap: 0.3em;

  &.iconPosition-top {
    flex-flow: column;
  }

  &.iconPosition-bottom {
    flex-flow: column-reverse;
  }

  &.iconPosition-right {
    flex-flow: row-reverse;
  }

  &.size-large {
    font-size: 1.2em;
  }

  &.size-small {
    font-size: 0.7em;
  }
`,Ks=e=>{const{size:r,text:i,cssClass:o,iconName:l,iconPosition:f,state:s,iconSize:g,textFontSize:p,gap:d,actions:h,textColor:L,iconColor:_,textTransform:x="none",iconImageData:T,useImageAsIcon:b,dataset:M,datasetPath:R,filter:k,parentData:j,parentArrayIndex:N,elementRenderId:H,boxReflect:G,allowTextWrap:V=!0,fontFamily:J="inherit",staticDevMoveableRef:Z,constraintsVertical:ee,constraintsHorizontal:ge,isStaticElement:pe,left:Ee,top:be,right:Me,bottom:ce,width:ve,height:fe,index:xe,deltaCenterX:we,deltaCenterY:ye}=e,q=N,oe=I.useRef(null),ae=Pt(s,xe),Re=Et(g),Ce=Et(p),ke=yt({sizeObj:d,sizePropName:"gap"}),{tapActionsArr:De,isActiveOverlayTrigger:Ne}=lr({actions:h,dataset:M,datasetPath:R,filter:k,elementRef:oe,parentData:j,parentIndex:q,elementRenderId:H}),je=nt({[`element_${e.type}`]:!0,[`${o}`]:o,[`size-${r}`]:r,["iconPosition-"+f]:l||b,isActiveOverlayTrigger:!!Ne,...ae}),Fe={...De};let ze={};L&&(ze={color:L});const Ge=V?{whiteSpace:"normal",minWidth:"5px"}:{whiteSpace:"nowrap"},Ve=Xt(G),Xe=wt({width:ve,height:fe,constraintsVertical:ee,constraintsHorizontal:ge,isStaticElement:pe,left:Ee,top:be,right:Me,bottom:ce,deltaCenterX:we,deltaCenterY:ye});return D.jsxs(Xc,{ref:me=>{Z&&(Z.current=me),oe.current=me},...e,style:{...ke,...ze,textTransform:x,fontFamily:J,...Ve,...Xe},...Fe,className:je,children:[l||b?D.jsx(fr,{style:{...Re,color:_||"inherit"},icon:l,iconImageData:T,useImageAsIcon:b}):null,i?D.jsx(Ct,{...e,style:{...Ce,...Ge},text:i}):null]})};Ks.displayName="TextElement";const qc=ct(jt)`

display: flex;
align-items: center;
justify-content: center;


  input {
    position: relative;
    color: ${({theme:e})=>e.colors.textColor};
    background: transparent;
    outline: 0;
    border: 1px ${({theme:e})=>e.colors.textColor} solid;
    font-size: 14px;
    border-radius: ${({theme:e})=>e.borderRadius};
    padding: 1.2em 1.5em;
    opacity: 0.5;
    width: 100%;



    &:focus {
      opacity: 1;
      border-color: ${({theme:e})=>e.colors.primaryColor};
    }

    &:disabled {
      filter: saturate(30%);
      cursor: not-allowed;
    }
  }

  &.size-large input {
    font-size: 1.2em;
  }

  &.size-small input {
    font-size: 0.7em;
  }
`,Xs=e=>{const{size:r,cssClass:i,width:o,input_signal_s_fb:l,state:f,textFontSize:s,placeholder:g,elementRenderId:p,actions:d,fontFamily:h="inherit",boxShadow:L,boxReflect:_,height:x,constraintsVertical:T,constraintsHorizontal:b,isStaticElement:M,left:R,top:k,right:j,bottom:N,staticDevMoveableRef:H,index:G,deltaCenterX:V,deltaCenterY:J}=e,Z=Pt(f,G),{displayAsPassword:ee,setFocusOff_signal_d:ge,setFocusOn_signal_d:pe}=f||{},Ee=Kt(pe),be=Kt(ge),Me=or({signalName:l,placeHolder:g||""}),[ce,ve]=I.useState(Me),fe=I.useRef(),xe=I.useRef(),we=I.useRef(Me),ye=I.useRef(Me),q=I.useRef(!1);I.useEffect(()=>{we.current=Me,ve(Me)},[Me]),I.useEffect(()=>{ye.current=ce},[ce]);const oe=wt({width:o,height:x,constraintsVertical:T,constraintsHorizontal:b,isStaticElement:M,left:R,top:k,right:j,bottom:N,deltaCenterX:V,deltaCenterY:J}),ae=I.useRef(null);I.useEffect(()=>{ae.current&&Ee&&ae.current.focus()},[ae,Ee]),I.useEffect(()=>{ae.current&&be&&ae.current.blur()},[ae,be]);const Re=Et(s),{onBeforeChangeActions:Ce,onAfterChangeActions:ke,onChangeActions:De,isActiveOverlayTrigger:Ne}=lr({actions:d,elementRenderId:p}),je=nt({[`element_${e.type}`]:!0,[`${i}`]:i,[`size-${r}`]:r,isActiveOverlayTrigger:!!Ne,...Z});function Fe(Ve){function Xe(){clearTimeout(fe.current),fe.current=setTimeout(()=>{ve(we.current)},3e3)}if(Xe(),ve(Ve),!q.current){for(const me of Ce)me(Ve);q.current=!0}for(const me of De)me(Ve);ke.length&&(clearTimeout(xe.current),xe.current=setTimeout(()=>{for(const me of ke)me(ye.current);q.current=!1},1e3))}const ze=Vr(L),Ge=Xt(_);return D.jsx(qc,{...e,ref:Ve=>{H&&(H.current=Ve)},style:{...oe,fontFamily:h},className:je,children:D.jsx("input",{style:{...Re,...ze,...Ge},ref:ae,placeholder:g,type:ee?"password":"text",value:ce,onChange:Ve=>{Fe(Ve.target.value)}})})};Xs.displayName="InputElement";const Jc=ct(jt)`
  position: relative;

  &.showBoundingBox {
    background-repeat: repeat;
    background-position: 50% 50%;
    background-size: 40px auto;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%239C92AC' fill-opacity='0.36'%3E%3Cpath d='M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41zM20 18.6l2.83-2.83 1.41 1.41L21.41 20l2.83 2.83-1.41 1.41L20 21.41l-2.83 2.83-1.41-1.41L18.59 20l-2.83-2.83 1.41-1.41L20 18.59z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
  }
`,qs=e=>{const{cssClass:r,state:i,width:o,height:l,border:f,staticDevMoveableRef:s,constraintsVertical:g,constraintsHorizontal:p,isStaticElement:d,left:h,top:L,right:_,bottom:x,index:T,deltaCenterX:b,deltaCenterY:M}=e,R=Pt(i,T),k=Lt(V=>V.envState),j=pt(V=>V.showBoundingBox),N=$r(f),H=wt({width:o,height:l,constraintsVertical:g,constraintsHorizontal:p,isStaticElement:d,left:h,top:L,right:_,bottom:x,deltaCenterX:b,deltaCenterY:M}),G=nt({[`element_${e.type}`]:!0,[`${r}`]:r,showBoundingBox:k!=="live"&&k!=="build"&&j,...R});return D.jsx(Jc,{...e,ref:V=>{s&&(s.current=V)},style:{...H,...N},className:G})};qs.displayName="SpacerElement";const Zc=ct(jt)`
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.4em;
  position: relative;

  &.size-small {
    font-size: 0.7em;
  }

  .ant-switch {
    background: rgba(0, 0, 0, 0.8);
  }

  .ant-switch-checked {
    background: ${({color:e,theme:r})=>e||r.colors.primaryColor};
  }

  &.reverseOrder {
    flex-direction: row-reverse;
  }
`,Js=e=>{const{size:r,text:i,cssClass:o,state:l,reverseOrder:f,color:s,textFontSize:g,gap:p,textOff:d,textOn:h,actions:L,elementRenderId:_,boxReflect:x,fontFamily:T="inherit",width:b,height:M,constraintsVertical:R,constraintsHorizontal:k,isStaticElement:j,left:N,top:H,right:G,bottom:V,staticDevMoveableRef:J,index:Z,deltaCenterX:ee,deltaCenterY:ge}=e,pe=pt(Ne=>Ne.showBoundingBox),Ee=Pt(l,Z),be=Kt(l==null?void 0:l.checkedState_signal),[Me,ce]=I.useState(be),ve=I.useRef(),fe=I.useRef(be),xe=Et(g),we=yt({sizeObj:p,sizePropName:"gap"}),{onBeforeChangeActions:ye,onAfterChangeActions:q,onChangeActions:oe,isActiveOverlayTrigger:ae}=lr({actions:L,elementRenderId:_}),Re=nt({[`element_${e.type}`]:!0,[`${o}`]:o,[`size-${r}`]:r,showBoundingBox:pe,reverseOrder:f,isActiveOverlayTrigger:!!ae,...Ee});I.useEffect(()=>{fe.current=be,ce(be)},[be]);const Ce=Ne=>{function je(){clearTimeout(ve.current),ve.current=setTimeout(()=>{console.log("switch sync after timer delay",fe.current),ce(fe.current)},3e3)}if(je(),ye.length)for(const Fe of ye)Fe(Ne);if(ce(Ne),oe.length)for(const Fe of oe)Fe(Ne);if(ce(Ne),q.length)for(const Fe of q)Fe(Ne)},ke=Xt(x),De=wt({width:b,height:M,constraintsVertical:R,constraintsHorizontal:k,isStaticElement:j,left:N,top:H,right:G,bottom:V,deltaCenterX:ee,deltaCenterY:ge});return D.jsxs(Zc,{...e,ref:Ne=>{J&&(J.current=Ne)},style:{...we,fontFamily:T,...ke,...De},color:s,className:Re,children:[D.jsx(tc,{checkedChildren:h,unCheckedChildren:d,checked:Me,size:r==="small"?"small":void 0,className:"antSwitch",onChange:Ne=>{Ce(Ne)}}),i?D.jsx(Ct,{...e,style:xe,text:i}):null]})};Js.displayName="SwitchElement";var Zs={exports:{}},Qs={exports:{}},Qc=function(r){return!r||typeof r=="string"?!1:r instanceof Array||Array.isArray(r)||r.length>=0&&(r.splice instanceof Function||Object.getOwnPropertyDescriptor(r,r.length-1)&&r.constructor.name!=="String")},ed=Qc,td=Array.prototype.concat,rd=Array.prototype.slice,Qa=Qs.exports=function(r){for(var i=[],o=0,l=r.length;o<l;o++){var f=r[o];ed(f)?i=td.call(i,rd.call(f)):i.push(f)}return i};Qa.wrap=function(e){return function(){return e(Qa(arguments))}};var nd=Qs.exports,Tn=Is(),Rn=nd,eo=Object.hasOwnProperty,to=Object.create(null);for(var Mi in Tn)eo.call(Tn,Mi)&&(to[Tn[Mi]]=Mi);var ir=Zs.exports={to:{},get:{}};ir.get=function(e){var r=e.substring(0,3).toLowerCase(),i,o;switch(r){case"hsl":i=ir.get.hsl(e),o="hsl";break;case"hwb":i=ir.get.hwb(e),o="hwb";break;default:i=ir.get.rgb(e),o="rgb";break}return i?{model:o,value:i}:null};ir.get.rgb=function(e){if(!e)return null;var r=/^#([a-f0-9]{3,4})$/i,i=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,o=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,l=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,f=/^(\w+)$/,s=[0,0,0,1],g,p,d;if(g=e.match(i)){for(d=g[2],g=g[1],p=0;p<3;p++){var h=p*2;s[p]=parseInt(g.slice(h,h+2),16)}d&&(s[3]=parseInt(d,16)/255)}else if(g=e.match(r)){for(g=g[1],d=g[3],p=0;p<3;p++)s[p]=parseInt(g[p]+g[p],16);d&&(s[3]=parseInt(d+d,16)/255)}else if(g=e.match(o)){for(p=0;p<3;p++)s[p]=parseInt(g[p+1],0);g[4]&&(g[5]?s[3]=parseFloat(g[4])*.01:s[3]=parseFloat(g[4]))}else if(g=e.match(l)){for(p=0;p<3;p++)s[p]=Math.round(parseFloat(g[p+1])*2.55);g[4]&&(g[5]?s[3]=parseFloat(g[4])*.01:s[3]=parseFloat(g[4]))}else return(g=e.match(f))?g[1]==="transparent"?[0,0,0,0]:eo.call(Tn,g[1])?(s=Tn[g[1]],s[3]=1,s):null:null;for(p=0;p<3;p++)s[p]=Rr(s[p],0,255);return s[3]=Rr(s[3],0,1),s};ir.get.hsl=function(e){if(!e)return null;var r=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,i=e.match(r);if(i){var o=parseFloat(i[4]),l=(parseFloat(i[1])%360+360)%360,f=Rr(parseFloat(i[2]),0,100),s=Rr(parseFloat(i[3]),0,100),g=Rr(isNaN(o)?1:o,0,1);return[l,f,s,g]}return null};ir.get.hwb=function(e){if(!e)return null;var r=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,i=e.match(r);if(i){var o=parseFloat(i[4]),l=(parseFloat(i[1])%360+360)%360,f=Rr(parseFloat(i[2]),0,100),s=Rr(parseFloat(i[3]),0,100),g=Rr(isNaN(o)?1:o,0,1);return[l,f,s,g]}return null};ir.to.hex=function(){var e=Rn(arguments);return"#"+Un(e[0])+Un(e[1])+Un(e[2])+(e[3]<1?Un(Math.round(e[3]*255)):"")};ir.to.rgb=function(){var e=Rn(arguments);return e.length<4||e[3]===1?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"};ir.to.rgb.percent=function(){var e=Rn(arguments),r=Math.round(e[0]/255*100),i=Math.round(e[1]/255*100),o=Math.round(e[2]/255*100);return e.length<4||e[3]===1?"rgb("+r+"%, "+i+"%, "+o+"%)":"rgba("+r+"%, "+i+"%, "+o+"%, "+e[3]+")"};ir.to.hsl=function(){var e=Rn(arguments);return e.length<4||e[3]===1?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"};ir.to.hwb=function(){var e=Rn(arguments),r="";return e.length>=4&&e[3]!==1&&(r=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+r+")"};ir.to.keyword=function(e){return to[e.slice(0,3)]};function Rr(e,r,i){return Math.min(Math.max(r,e),i)}function Un(e){var r=Math.round(e).toString(16).toUpperCase();return r.length<2?"0"+r:r}var id=Zs.exports;const an=id,nr=Ou(),ro=["keyword","gray","hex"],Ui={};for(const e of Object.keys(nr))Ui[[...nr[e].labels].sort().join("")]=e;const ei={};function Bt(e,r){if(!(this instanceof Bt))return new Bt(e,r);if(r&&r in ro&&(r=null),r&&!(r in nr))throw new Error("Unknown model: "+r);let i,o;if(e==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof Bt)this.model=e.model,this.color=[...e.color],this.valpha=e.valpha;else if(typeof e=="string"){const l=an.get(e);if(l===null)throw new Error("Unable to parse color from string: "+e);this.model=l.model,o=nr[this.model].channels,this.color=l.value.slice(0,o),this.valpha=typeof l.value[o]=="number"?l.value[o]:1}else if(e.length>0){this.model=r||"rgb",o=nr[this.model].channels;const l=Array.prototype.slice.call(e,0,o);this.color=zi(l,o),this.valpha=typeof e[o]=="number"?e[o]:1}else if(typeof e=="number")this.model="rgb",this.color=[e>>16&255,e>>8&255,e&255],this.valpha=1;else{this.valpha=1;const l=Object.keys(e);"alpha"in e&&(l.splice(l.indexOf("alpha"),1),this.valpha=typeof e.alpha=="number"?e.alpha:0);const f=l.sort().join("");if(!(f in Ui))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=Ui[f];const{labels:s}=nr[this.model],g=[];for(i=0;i<s.length;i++)g.push(e[s[i]]);this.color=zi(g)}if(ei[this.model])for(o=nr[this.model].channels,i=0;i<o;i++){const l=ei[this.model][i];l&&(this.color[i]=l(this.color[i]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}Bt.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(e){let r=this.model in an.to?this:this.rgb();r=r.round(typeof e=="number"?e:1);const i=r.valpha===1?r.color:[...r.color,this.valpha];return an.to[r.model](i)},percentString(e){const r=this.rgb().round(typeof e=="number"?e:1),i=r.valpha===1?r.color:[...r.color,this.valpha];return an.to.rgb.percent(i)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){const e={},{channels:r}=nr[this.model],{labels:i}=nr[this.model];for(let o=0;o<r;o++)e[i[o]]=this.color[o];return this.valpha!==1&&(e.alpha=this.valpha),e},unitArray(){const e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,this.valpha!==1&&e.push(this.valpha),e},unitObject(){const e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,this.valpha!==1&&(e.alpha=this.valpha),e},round(e){return e=Math.max(e||0,0),new Bt([...this.color.map(sd(e)),this.valpha],this.model)},alpha(e){return e!==void 0?new Bt([...this.color,Math.max(0,Math.min(1,e))],this.model):this.valpha},red:Tt("rgb",0,It(255)),green:Tt("rgb",1,It(255)),blue:Tt("rgb",2,It(255)),hue:Tt(["hsl","hsv","hsl","hwb","hcg"],0,e=>(e%360+360)%360),saturationl:Tt("hsl",1,It(100)),lightness:Tt("hsl",2,It(100)),saturationv:Tt("hsv",1,It(100)),value:Tt("hsv",2,It(100)),chroma:Tt("hcg",1,It(100)),gray:Tt("hcg",2,It(100)),white:Tt("hwb",1,It(100)),wblack:Tt("hwb",2,It(100)),cyan:Tt("cmyk",0,It(100)),magenta:Tt("cmyk",1,It(100)),yellow:Tt("cmyk",2,It(100)),black:Tt("cmyk",3,It(100)),x:Tt("xyz",0,It(95.047)),y:Tt("xyz",1,It(100)),z:Tt("xyz",2,It(108.833)),l:Tt("lab",0,It(100)),a:Tt("lab",1),b:Tt("lab",2),keyword(e){return e!==void 0?new Bt(e):nr[this.model].keyword(this.color)},hex(e){return e!==void 0?new Bt(e):an.to.hex(this.rgb().round().color)},hexa(e){if(e!==void 0)return new Bt(e);const r=this.rgb().round().color;let i=Math.round(this.valpha*255).toString(16).toUpperCase();return i.length===1&&(i="0"+i),an.to.hex(r)+i},rgbNumber(){const e=this.rgb().color;return(e[0]&255)<<16|(e[1]&255)<<8|e[2]&255},luminosity(){const e=this.rgb().color,r=[];for(const[i,o]of e.entries()){const l=o/255;r[i]=l<=.04045?l/12.92:((l+.055)/1.055)**2.4}return .2126*r[0]+.7152*r[1]+.0722*r[2]},contrast(e){const r=this.luminosity(),i=e.luminosity();return r>i?(r+.05)/(i+.05):(i+.05)/(r+.05)},level(e){const r=this.contrast(e);return r>=7?"AAA":r>=4.5?"AA":""},isDark(){const e=this.rgb().color;return(e[0]*2126+e[1]*7152+e[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){const e=this.rgb();for(let r=0;r<3;r++)e.color[r]=255-e.color[r];return e},lighten(e){const r=this.hsl();return r.color[2]+=r.color[2]*e,r},darken(e){const r=this.hsl();return r.color[2]-=r.color[2]*e,r},saturate(e){const r=this.hsl();return r.color[1]+=r.color[1]*e,r},desaturate(e){const r=this.hsl();return r.color[1]-=r.color[1]*e,r},whiten(e){const r=this.hwb();return r.color[1]+=r.color[1]*e,r},blacken(e){const r=this.hwb();return r.color[2]+=r.color[2]*e,r},grayscale(){const e=this.rgb().color,r=e[0]*.3+e[1]*.59+e[2]*.11;return Bt.rgb(r,r,r)},fade(e){return this.alpha(this.valpha-this.valpha*e)},opaquer(e){return this.alpha(this.valpha+this.valpha*e)},rotate(e){const r=this.hsl();let i=r.color[0];return i=(i+e)%360,i=i<0?360+i:i,r.color[0]=i,r},mix(e,r){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);const i=e.rgb(),o=this.rgb(),l=r===void 0?.5:r,f=2*l-1,s=i.alpha()-o.alpha(),g=((f*s===-1?f:(f+s)/(1+f*s))+1)/2,p=1-g;return Bt.rgb(g*i.red()+p*o.red(),g*i.green()+p*o.green(),g*i.blue()+p*o.blue(),i.alpha()*l+o.alpha()*(1-l))}};for(const e of Object.keys(nr)){if(ro.includes(e))continue;const{channels:r}=nr[e];Bt.prototype[e]=function(...i){return this.model===e?new Bt(this):i.length>0?new Bt(i,e):new Bt([...od(nr[this.model][e].raw(this.color)),this.valpha],e)},Bt[e]=function(...i){let o=i[0];return typeof o=="number"&&(o=zi(i,r)),new Bt(o,e)}}function ad(e,r){return Number(e.toFixed(r))}function sd(e){return function(r){return ad(r,e)}}function Tt(e,r,i){e=Array.isArray(e)?e:[e];for(const o of e)(ei[o]||(ei[o]=[]))[r]=i;return e=e[0],function(o){let l;return o!==void 0?(i&&(o=i(o)),l=this[e](),l.color[r]=o,l):(l=this[e]().color[r],i&&(l=i(l)),l)}}function It(e){return function(r){return Math.max(0,Math.min(e,r))}}function od(e){return Array.isArray(e)?e:[e]}function zi(e,r){for(let i=0;i<r;i++)typeof e[i]!="number"&&(e[i]=0);return e}var ld=Bt;const on=Or(ld),ud=ct(jt)`
  position: relative;
  color: rgba(255, 255, 255, 0.6);
  display: grid;
  grid-template-columns: auto auto 1fr auto auto;
  grid-template-rows: auto auto 1fr auto auto;
  gap: 0px;
  grid-template-areas:
    'top2 top2 top2 top2 top2'
    'top1 top1 top1 top1 top1'
    'left2 left1 center right1 right2'
    'bottom1 bottom1 bottom1 bottom1 bottom1'
    'bottom2 bottom2 bottom2 bottom2 bottom2';

  .sliderBox {
    grid-area: center;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: ${({gap:e})=>e!=null&&e.value?e.value+((e==null?void 0:e.unit)||"px"):"15px"};
  }

  .top1,
  .top2,
  .bottom1,
  .bottom2,
  .left1,
  .left2,
  .right1,
  .right2 {
    display: flex;
    align-items: center;
    justify-content: center;
    /* padding: 7.5px; */
  }

  .top1 {
    grid-area: top1;
    padding-bottom: ${({gap:e})=>e!=null&&e.value?e.value+((e==null?void 0:e.unit)||"px"):"15px"};
  }
  .top2 {
    grid-area: top2;
    padding-bottom: ${({gap:e})=>e!=null&&e.value?e.value+((e==null?void 0:e.unit)||"px"):"15px"};
  }
  .bottom1 {
    grid-area: bottom1;
    padding-top: ${({gap:e})=>e!=null&&e.value?e.value+((e==null?void 0:e.unit)||"px"):"15px"};
  }
  .bottom2 {
    grid-area: bottom2;
    padding-top: ${({gap:e})=>e!=null&&e.value?e.value+((e==null?void 0:e.unit)||"px"):"15px"};
  }
  .left1 {
    grid-area: left1;
    padding-right: ${({gap:e})=>e!=null&&e.value?e.value+((e==null?void 0:e.unit)||"px"):"15px"};
  }
  .left2 {
    grid-area: left2;
    padding-right: ${({gap:e})=>e!=null&&e.value?e.value+((e==null?void 0:e.unit)||"px"):"15px"};
  }
  .right1 {
    grid-area: right1;
    padding-left: ${({gap:e})=>e!=null&&e.value?e.value+((e==null?void 0:e.unit)||"px"):"15px"};
  }
  .right2 {
    grid-area: right2;
    padding-left: ${({gap:e})=>e!=null&&e.value?e.value+((e==null?void 0:e.unit)||"px"):"15px"};
  }

  &.isVertical {
    .sliderBox {
      flex-flow: column-reverse;
    }
  }

  .sliderLabel {
    color: ${({theme:e})=>e.colors.textColor};
  }

  .valueLabel {
    color: ${({theme:e})=>e.colors.textColor};
  }

  .sliderControls > * {
    cursor: pointer;
    &:hover {
      color: #fff;
    }
  }

  .rcslider {
    &.rc-slider-horizontal {
      width: 100%;
      min-width: 70px;
    }

    &.rc-slider-vertical {
      height: 100%;
      min-height: 70px;
    }

    .rc-slider-handle {
      opacity: 1;
      border: 0;
      background: ${({theme:e})=>e.colors.textColor};
      /* border: 1px
        ${({theme:e})=>on(e.backgroundColor).alpha(.2)} solid; */

      &::after {
        content: '';
        position: absolute;
        left: 50%;
        top: 50%;
        width: 400%;
        /* max-width: 100px;
        max-height: 100px; */
        height: 400%;
        transform: translate(-50%, -50%);
        /* background-color: red; */
      }
    }

    .rc-slider-handle-dragging {
      box-shadow: 0 0 10px 5px rgba(255, 255, 255, 0.2);
      will-change: all;
    }

    .rc-slider-rail {
      background: ${({minBackground:e})=>e};
      will-change: all;
    }

    .rc-slider-track {
      background: ${({maxBackground:e})=>e};
      will-change: all;
    }
  }

  &.hideThumb {
    .rc-slider-handle {
      opacity: 0;
    }
  }

  &.isBarSlider .rcslider {
    .rc-slider-handle {
      opacity: 0;
    }
    .rc-slider-rail,
    .rc-slider-track {
      border-radius: 0px;
    }

    &.rc-slider-vertical {
      .rc-slider-rail,
      .rc-slider-track {
        width: 100%;
        left: 0;
      }
    }
    &.rc-slider-horizontal {
      .rc-slider-rail,
      .rc-slider-track {
        height: 100%;
        top: 0;
      }
    }
  }
`;function Gi(e,r,i){return(e-r)/(i-r)}function oa(e,r,i,o){var l=Gi(r,i,o),f={};switch(e){case"rtl":f.right="".concat(l*100,"%"),f.transform="translateX(50%)";break;case"btt":f.bottom="".concat(l*100,"%"),f.transform="translateY(50%)";break;case"ttb":f.top="".concat(l*100,"%"),f.transform="translateY(-50%)";break;default:f.left="".concat(l*100,"%"),f.transform="translateX(-50%)";break}return f}function ln(e,r){return Array.isArray(e)?e[r]:e}var Kr=I.createContext({min:0,max:0,direction:"ltr",step:1,includedStart:0,includedEnd:0,tabIndex:0,keyboard:!0,styles:{},classNames:{}}),cd=["prefixCls","value","valueIndex","onStartMove","style","render","dragging","onOffsetChange","onChangeComplete","onFocus","onMouseEnter"],es=I.forwardRef(function(e,r){var i=e.prefixCls,o=e.value,l=e.valueIndex,f=e.onStartMove,s=e.style,g=e.render,p=e.dragging,d=e.onOffsetChange,h=e.onChangeComplete,L=e.onFocus,_=e.onMouseEnter,x=As(e,cd),T=I.useContext(Kr),b=T.min,M=T.max,R=T.direction,k=T.disabled,j=T.keyboard,N=T.range,H=T.tabIndex,G=T.ariaLabelForHandle,V=T.ariaLabelledByForHandle,J=T.ariaValueTextFormatterForHandle,Z=T.styles,ee=T.classNames,ge="".concat(i,"-handle"),pe=function(q){k||f(q,l)},Ee=function(q){L==null||L(q,l)},be=function(q){_(q,l)},Me=function(q){if(!k&&j){var oe=null;switch(q.which||q.keyCode){case Wt.LEFT:oe=R==="ltr"||R==="btt"?-1:1;break;case Wt.RIGHT:oe=R==="ltr"||R==="btt"?1:-1;break;case Wt.UP:oe=R!=="ttb"?1:-1;break;case Wt.DOWN:oe=R!=="ttb"?-1:1;break;case Wt.HOME:oe="min";break;case Wt.END:oe="max";break;case Wt.PAGE_UP:oe=2;break;case Wt.PAGE_DOWN:oe=-2;break}oe!==null&&(q.preventDefault(),d(oe,l))}},ce=function(q){switch(q.which||q.keyCode){case Wt.LEFT:case Wt.RIGHT:case Wt.UP:case Wt.DOWN:case Wt.HOME:case Wt.END:case Wt.PAGE_UP:case Wt.PAGE_DOWN:h==null||h();break}},ve=oa(R,o,b,M),fe={};if(l!==null){var xe;fe={tabIndex:k?null:ln(H,l),role:"slider","aria-valuemin":b,"aria-valuemax":M,"aria-valuenow":o,"aria-disabled":k,"aria-label":ln(G,l),"aria-labelledby":ln(V,l),"aria-valuetext":(xe=ln(J,l))===null||xe===void 0?void 0:xe(o),"aria-orientation":R==="ltr"||R==="rtl"?"horizontal":"vertical",onMouseDown:pe,onTouchStart:pe,onFocus:Ee,onMouseEnter:be,onKeyDown:Me,onKeyUp:ce}}var we=I.createElement("div",Fi({ref:r,className:nt(ge,pr(pr({},"".concat(ge,"-").concat(l+1),l!==null&&N),"".concat(ge,"-dragging"),p),ee.handle),style:Dt(Dt(Dt({},ve),s),Z.handle)},fe,x));return g&&(we=g(we,{index:l,prefixCls:i,value:o,dragging:p})),we}),dd=["prefixCls","style","onStartMove","onOffsetChange","values","handleRender","activeHandleRender","draggingIndex","onFocus"],fd=I.forwardRef(function(e,r){var i=e.prefixCls,o=e.style,l=e.onStartMove,f=e.onOffsetChange,s=e.values,g=e.handleRender,p=e.activeHandleRender,d=e.draggingIndex,h=e.onFocus,L=As(e,dd),_=I.useRef({});I.useImperativeHandle(r,function(){return{focus:function(H){var G;(G=_.current[H])===null||G===void 0||G.focus()}}});var x=I.useState(-1),T=dr(x,2),b=T[0],M=T[1],R=function(H,G){M(G),h==null||h(H)},k=function(H,G){M(G)},j=Dt({prefixCls:i,onStartMove:l,onOffsetChange:f,render:g,onFocus:R,onMouseEnter:k},L);return I.createElement(I.Fragment,null,s.map(function(N,H){return I.createElement(es,Fi({ref:function(V){V?_.current[H]=V:delete _.current[H]},dragging:d===H,style:ln(o,H),key:H,value:N,valueIndex:H},j))}),p&&I.createElement(es,Fi({key:"a11y"},j,{value:s[b],valueIndex:null,dragging:d!==-1,render:p,style:{pointerEvents:"none"},tabIndex:null,"aria-hidden":!0})))}),hd=function(r){var i=r.prefixCls,o=r.style,l=r.children,f=r.value,s=r.onClick,g=I.useContext(Kr),p=g.min,d=g.max,h=g.direction,L=g.includedStart,_=g.includedEnd,x=g.included,T="".concat(i,"-text"),b=oa(h,f,p,d);return I.createElement("span",{className:nt(T,pr({},"".concat(T,"-active"),x&&L<=f&&f<=_)),style:Dt(Dt({},b),o),onMouseDown:function(R){R.stopPropagation()},onClick:function(){s(f)}},l)},gd=function(r){var i=r.prefixCls,o=r.marks,l=r.onClick,f="".concat(i,"-mark");return o.length?I.createElement("div",{className:f},o.map(function(s){var g=s.value,p=s.style,d=s.label;return I.createElement(hd,{key:g,prefixCls:f,style:p,value:g,onClick:l},d)})):null},md=function(r){var i=r.prefixCls,o=r.value,l=r.style,f=r.activeStyle,s=I.useContext(Kr),g=s.min,p=s.max,d=s.direction,h=s.included,L=s.includedStart,_=s.includedEnd,x="".concat(i,"-dot"),T=h&&L<=o&&o<=_,b=Dt(Dt({},oa(d,o,g,p)),typeof l=="function"?l(o):l);return T&&(b=Dt(Dt({},b),typeof f=="function"?f(o):f)),I.createElement("span",{className:nt(x,pr({},"".concat(x,"-active"),T)),style:b})},pd=function(r){var i=r.prefixCls,o=r.marks,l=r.dots,f=r.style,s=r.activeStyle,g=I.useContext(Kr),p=g.min,d=g.max,h=g.step,L=I.useMemo(function(){var _=new Set;if(o.forEach(function(T){_.add(T.value)}),l&&h!==null)for(var x=p;x<=d;)_.add(x),x+=h;return Array.from(_)},[p,d,h,l,o]);return I.createElement("div",{className:"".concat(i,"-step")},L.map(function(_){return I.createElement(md,{prefixCls:i,key:_,value:_,style:f,activeStyle:s})}))},ts=function(r){var i=r.prefixCls,o=r.style,l=r.start,f=r.end,s=r.index,g=r.onStartMove,p=r.replaceCls,d=I.useContext(Kr),h=d.direction,L=d.min,_=d.max,x=d.disabled,T=d.range,b=d.classNames,M="".concat(i,"-track"),R=Gi(l,L,_),k=Gi(f,L,_),j=function(V){!x&&g&&g(V,-1)},N={};switch(h){case"rtl":N.right="".concat(R*100,"%"),N.width="".concat(k*100-R*100,"%");break;case"btt":N.bottom="".concat(R*100,"%"),N.height="".concat(k*100-R*100,"%");break;case"ttb":N.top="".concat(R*100,"%"),N.height="".concat(k*100-R*100,"%");break;default:N.left="".concat(R*100,"%"),N.width="".concat(k*100-R*100,"%")}var H=p||nt(M,pr(pr({},"".concat(M,"-").concat(s+1),s!==null&&T),"".concat(i,"-track-draggable"),g),b.track);return I.createElement("div",{className:H,style:Dt(Dt({},N),o),onMouseDown:j,onTouchStart:j})},vd=function(r){var i=r.prefixCls,o=r.style,l=r.values,f=r.startPoint,s=r.onStartMove,g=I.useContext(Kr),p=g.included,d=g.range,h=g.min,L=g.styles,_=g.classNames,x=I.useMemo(function(){if(!d){if(l.length===0)return[];var b=f??h,M=l[0];return[{start:Math.min(b,M),end:Math.max(b,M)}]}for(var R=[],k=0;k<l.length-1;k+=1)R.push({start:l[k],end:l[k+1]});return R},[l,d,f,h]);if(!p)return null;var T=_.tracks||L.tracks?I.createElement(ts,{index:null,prefixCls:i,start:x[0].start,end:x[x.length-1].end,replaceCls:nt(_.tracks,"".concat(i,"-tracks")),style:L.tracks}):null;return I.createElement(I.Fragment,null,T,x.map(function(b,M){var R=b.start,k=b.end;return I.createElement(ts,{index:M,prefixCls:i,style:Dt(Dt({},ln(o,M)),L.track),start:R,end:k,key:M,onStartMove:s})}))};function rs(e){var r="touches"in e?e.touches[0]:e;return{pageX:r.pageX,pageY:r.pageY}}function _d(e,r,i,o,l,f,s,g,p){var d=I.useState(null),h=dr(d,2),L=h[0],_=h[1],x=I.useState(-1),T=dr(x,2),b=T[0],M=T[1],R=I.useState(i),k=dr(R,2),j=k[0],N=k[1],H=I.useState(i),G=dr(H,2),V=G[0],J=G[1],Z=I.useRef(null),ee=I.useRef(null);I.useLayoutEffect(function(){b===-1&&N(i)},[i,b]),I.useEffect(function(){return function(){document.removeEventListener("mousemove",Z.current),document.removeEventListener("mouseup",ee.current),document.removeEventListener("touchmove",Z.current),document.removeEventListener("touchend",ee.current)}},[]);var ge=function(ce,ve){j.some(function(fe,xe){return fe!==ce[xe]})&&(ve!==void 0&&_(ve),N(ce),s(ce))},pe=ku(function(Me,ce){if(Me===-1){var ve=V[0],fe=V[V.length-1],xe=o-ve,we=l-fe,ye=ce*(l-o);ye=Math.max(ye,xe),ye=Math.min(ye,we);var q=f(ve+ye);ye=q-ve;var oe=V.map(function(ke){return ke+ye});ge(oe)}else{var ae=(l-o)*ce,Re=Ar(j);Re[Me]=V[Me];var Ce=p(Re,ae,Me,"dist");ge(Ce.values,Ce.value)}}),Ee=function(ce,ve,fe){ce.stopPropagation();var xe=fe||i,we=xe[ve];M(ve),_(we),J(xe);var ye=rs(ce),q=ye.pageX,oe=ye.pageY,ae=function(ke){ke.preventDefault();var De=rs(ke),Ne=De.pageX,je=De.pageY,Fe=Ne-q,ze=je-oe,Ge=e.current.getBoundingClientRect(),Ve=Ge.width,Xe=Ge.height,me;switch(r){case"btt":me=-ze/Xe;break;case"ttb":me=ze/Xe;break;case"rtl":me=-Fe/Ve;break;default:me=Fe/Ve}pe(ve,me)},Re=function Ce(ke){ke.preventDefault(),document.removeEventListener("mouseup",Ce),document.removeEventListener("mousemove",ae),document.removeEventListener("touchend",Ce),document.removeEventListener("touchmove",ae),Z.current=null,ee.current=null,M(-1),g()};document.addEventListener("mouseup",Re),document.addEventListener("mousemove",ae),document.addEventListener("touchend",Re),document.addEventListener("touchmove",ae),Z.current=ae,ee.current=Re},be=I.useMemo(function(){var Me=Ar(i).sort(function(ve,fe){return ve-fe}),ce=Ar(j).sort(function(ve,fe){return ve-fe});return Me.every(function(ve,fe){return ve===ce[fe]})?j:i},[i,j]);return[b,L,be,Ee]}function yd(e,r,i,o,l,f){var s=I.useCallback(function(x){return Math.max(e,Math.min(r,x))},[e,r]),g=I.useCallback(function(x){if(i!==null){var T=e+Math.round((s(x)-e)/i)*i,b=function(j){return(String(j).split(".")[1]||"").length},M=Math.max(b(i),b(r),b(e)),R=Number(T.toFixed(M));return e<=R&&R<=r?R:null}return null},[i,e,r,s]),p=I.useCallback(function(x){var T=s(x),b=o.map(function(k){return k.value});i!==null&&b.push(g(x)),b.push(e,r);var M=b[0],R=r-e;return b.forEach(function(k){var j=Math.abs(T-k);j<=R&&(M=k,R=j)}),M},[e,r,o,i,s,g]),d=function x(T,b,M){var R=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit";if(typeof b=="number"){var k,j=T[M],N=j+b,H=[];o.forEach(function(ee){H.push(ee.value)}),H.push(e,r),H.push(g(j));var G=b>0?1:-1;R==="unit"?H.push(g(j+G*i)):H.push(g(N)),H=H.filter(function(ee){return ee!==null}).filter(function(ee){return b<0?ee<=j:ee>=j}),R==="unit"&&(H=H.filter(function(ee){return ee!==j}));var V=R==="unit"?j:N;k=H[0];var J=Math.abs(k-V);if(H.forEach(function(ee){var ge=Math.abs(ee-V);ge<J&&(k=ee,J=ge)}),k===void 0)return b<0?e:r;if(R==="dist")return k;if(Math.abs(b)>1){var Z=Ar(T);return Z[M]=k,x(Z,b-G,M,R)}return k}else{if(b==="min")return e;if(b==="max")return r}},h=function(T,b,M){var R=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",k=T[M],j=d(T,b,M,R);return{value:j,changed:j!==k}},L=function(T){return f===null&&T===0||typeof f=="number"&&T<f},_=function(T,b,M){var R=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",k=T.map(p),j=k[M],N=d(k,b,M,R);if(k[M]=N,l===!1){var H=f||0;M>0&&k[M-1]!==j&&(k[M]=Math.max(k[M],k[M-1]+H)),M<k.length-1&&k[M+1]!==j&&(k[M]=Math.min(k[M],k[M+1]-H))}else if(typeof f=="number"||f===null){for(var G=M+1;G<k.length;G+=1)for(var V=!0;L(k[G]-k[G-1])&&V;){var J=h(k,1,G);k[G]=J.value,V=J.changed}for(var Z=M;Z>0;Z-=1)for(var ee=!0;L(k[Z]-k[Z-1])&&ee;){var ge=h(k,-1,Z-1);k[Z-1]=ge.value,ee=ge.changed}for(var pe=k.length-1;pe>0;pe-=1)for(var Ee=!0;L(k[pe]-k[pe-1])&&Ee;){var be=h(k,-1,pe-1);k[pe-1]=be.value,Ee=be.changed}for(var Me=0;Me<k.length-1;Me+=1)for(var ce=!0;L(k[Me+1]-k[Me])&&ce;){var ve=h(k,1,Me+1);k[Me+1]=ve.value,ce=ve.changed}}return{value:k[M],values:k}};return[p,_]}var jr=I.forwardRef(function(e,r){var i=e.prefixCls,o=i===void 0?"rc-slider":i,l=e.className,f=e.style,s=e.classNames,g=e.styles,p=e.disabled,d=p===void 0?!1:p,h=e.keyboard,L=h===void 0?!0:h,_=e.autoFocus,x=e.onFocus,T=e.onBlur,b=e.min,M=b===void 0?0:b,R=e.max,k=R===void 0?100:R,j=e.step,N=j===void 0?1:j,H=e.value,G=e.defaultValue,V=e.range,J=e.count,Z=e.onChange,ee=e.onBeforeChange,ge=e.onAfterChange,pe=e.onChangeComplete,Ee=e.allowCross,be=Ee===void 0?!0:Ee,Me=e.pushable,ce=Me===void 0?!1:Me,ve=e.draggableTrack,fe=e.reverse,xe=e.vertical,we=e.included,ye=we===void 0?!0:we,q=e.startPoint,oe=e.trackStyle,ae=e.handleStyle,Re=e.railStyle,Ce=e.dotStyle,ke=e.activeDotStyle,De=e.marks,Ne=e.dots,je=e.handleRender,Fe=e.activeHandleRender,ze=e.tabIndex,Ge=ze===void 0?0:ze,Ve=e.ariaLabelForHandle,Xe=e.ariaLabelledByForHandle,me=e.ariaValueTextFormatterForHandle,te=I.useRef(null),de=I.useRef(null),Ae=I.useMemo(function(){return xe?fe?"ttb":"btt":fe?"rtl":"ltr"},[fe,xe]),O=I.useMemo(function(){return isFinite(M)?M:0},[M]),U=I.useMemo(function(){return isFinite(k)?k:100},[k]),A=I.useMemo(function(){return N!==null&&N<=0?1:N},[N]),S=I.useMemo(function(){return typeof ce=="boolean"?ce?A:!1:ce>=0?ce:!1},[ce,A]),P=I.useMemo(function(){return Object.keys(De||{}).map(function(at){var Je=De[at],ot={value:Number(at)};return Je&&Au(Je)==="object"&&!I.isValidElement(Je)&&("label"in Je||"style"in Je)?(ot.style=Je.style,ot.label=Je.label):ot.label=Je,ot}).filter(function(at){var Je=at.label;return Je||typeof Je=="number"}).sort(function(at,Je){return at.value-Je.value})},[De]),F=yd(O,U,A,P,be,S),z=dr(F,2),$=z[0],W=z[1],X=Fu(G,{value:H}),se=dr(X,2),ie=se[0],re=se[1],le=I.useMemo(function(){var at=ie==null?[]:Array.isArray(ie)?ie:[ie],Je=dr(at,1),ot=Je[0],ft=ot===void 0?O:ot,mt=ie===null?[]:[ft];if(V){if(mt=Ar(at),J||ie===void 0){var ne=J>=0?J+1:2;for(mt=mt.slice(0,ne);mt.length<ne;){var vt;mt.push((vt=mt[mt.length-1])!==null&&vt!==void 0?vt:O)}}mt.sort(function(Ut,qt){return Ut-qt})}return mt.forEach(function(Ut,qt){mt[qt]=$(Ut)}),mt},[ie,V,O,J,$]),he=I.useRef(le);he.current=le;var Se=function(Je){return V?Je:Je[0]},ue=function(Je){var ot=Ar(Je).sort(function(ft,mt){return ft-mt});Z&&!Nu(ot,he.current,!0)&&Z(Se(ot)),re(ot)},Ie=function(){var Je=Se(he.current);ge==null||ge(Je),Ru(!ge,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),pe==null||pe(Je)},Pe=_d(de,Ae,le,O,U,$,ue,Ie,W),He=dr(Pe,4),Ye=He[0],Oe=He[1],Te=He[2],qe=He[3],We=function(Je,ot){if(!d){var ft=0,mt=U-O;le.forEach(function(qt,Vt){var ur=Math.abs(Je-qt);ur<=mt&&(mt=ur,ft=Vt)});var ne=Ar(le);if(ne[ft]=Je,V&&!le.length&&J===void 0&&ne.push(Je),ee==null||ee(Se(ne)),ue(ne),ot){var vt,Ut;(vt=document.activeElement)===null||vt===void 0||(Ut=vt.blur)===null||Ut===void 0||Ut.call(vt),te.current.focus(ft),qe(ot,ft,ne)}}},lt=function(Je){Je.preventDefault();var ot=de.current.getBoundingClientRect(),ft=ot.width,mt=ot.height,ne=ot.left,vt=ot.top,Ut=ot.bottom,qt=ot.right,Vt=Je.clientX,ur=Je.clientY,br;switch(Ae){case"btt":br=(Ut-ur)/mt;break;case"ttb":br=(ur-vt)/mt;break;case"rtl":br=(qt-Vt)/ft;break;default:br=(Vt-ne)/ft}var qr=O+br*(U-O);We($(qr),Je)},dt=I.useState(null),kt=dr(dt,2),bt=kt[0],gt=kt[1],Ot=function(Je,ot){if(!d){var ft=W(le,Je,ot);ee==null||ee(Se(le)),ue(ft.values),gt(ft.value)}};I.useEffect(function(){if(bt!==null){var at=le.indexOf(bt);at>=0&&te.current.focus(at)}gt(null)},[bt]);var Mt=I.useMemo(function(){return ve&&A===null?!1:ve},[ve,A]),Ft=function(Je,ot){qe(Je,ot),ee==null||ee(Se(he.current))},St=Ye!==-1;I.useEffect(function(){if(!St){var at=le.lastIndexOf(Oe);te.current.focus(at)}},[St]);var ut=I.useMemo(function(){return Ar(Te).sort(function(at,Je){return at-Je})},[Te]),tr=I.useMemo(function(){return V?[ut[0],ut[ut.length-1]]:[O,ut[0]]},[ut,V,O]),Jt=dr(tr,2),Ht=Jt[0],At=Jt[1];I.useImperativeHandle(r,function(){return{focus:function(){te.current.focus(0)},blur:function(){var Je,ot=document,ft=ot.activeElement;(Je=de.current)!==null&&Je!==void 0&&Je.contains(ft)&&(ft==null||ft.blur())}}}),I.useEffect(function(){_&&te.current.focus(0)},[]);var Zt=I.useMemo(function(){return{min:O,max:U,direction:Ae,disabled:d,keyboard:L,step:A,included:ye,includedStart:Ht,includedEnd:At,range:V,tabIndex:Ge,ariaLabelForHandle:Ve,ariaLabelledByForHandle:Xe,ariaValueTextFormatterForHandle:me,styles:g||{},classNames:s||{}}},[O,U,Ae,d,L,A,ye,Ht,At,V,Ge,Ve,Xe,me,g,s]);return I.createElement(Kr.Provider,{value:Zt},I.createElement("div",{ref:de,className:nt(o,l,pr(pr(pr(pr({},"".concat(o,"-disabled"),d),"".concat(o,"-vertical"),xe),"".concat(o,"-horizontal"),!xe),"".concat(o,"-with-marks"),P.length)),style:f,onMouseDown:lt},I.createElement("div",{className:nt("".concat(o,"-rail"),s==null?void 0:s.rail),style:Dt(Dt({},Re),g==null?void 0:g.rail)}),I.createElement(vd,{prefixCls:o,style:oe,values:ut,startPoint:q,onStartMove:Mt?Ft:void 0}),I.createElement(pd,{prefixCls:o,marks:P,dots:Ne,style:Ce,activeStyle:ke}),I.createElement(fd,{ref:te,prefixCls:o,style:ae,values:Te,draggingIndex:Ye,onStartMove:Ft,onOffsetChange:Ot,onFocus:x,onBlur:T,handleRender:je,activeHandleRender:Fe,onChangeComplete:Ie}),I.createElement(gd,{prefixCls:o,marks:P,onClick:We})))});function bd(e,r,i){const o=r-e;return(i-e)/o*100}const no=e=>{const{size:r,cssClass:i,state:o,minBackground:l,maxBackground:f,isVertical:s=!1,isBarSlider:g=!1,hideThumb:p=!1,reverse:d=!1,showControls:h=!1,useDynamicBackround:L=!1,labelPosition:_="top",valuePosition:x="bottom",sliderLabelText:T,sliderValueText:b,input_signal_a_fb:M,sliderLabelTextFontSize:R,sliderValueTextFontSize:k,width:j,height:N,minValue:H=0,maxValue:G=100,increment_signal_d:V,decrement_signal_d:J,thumbBackgroundColor:Z,thumbBorder:ee,elementRenderId:ge,actions:pe,fontFamily:Ee="inherit",boxReflect:be,constraintsVertical:Me,constraintsHorizontal:ce,isStaticElement:ve,left:fe,top:xe,right:we,bottom:ye,staticDevMoveableRef:q,index:oe,deltaCenterX:ae,deltaCenterY:Re}=e,Ce=I.useContext(Cu),ke=Et(R),De=Et(k),Ne=on(Ce.colors.textColor).alpha(.2).string(),je=Ce.colors.primaryColor,Fe=Pt(o,oe),ze=Hr(M),[Ge,Ve]=I.useState(ze),Xe=I.useRef(Ge),[me,te]=I.useState(!1);I.useEffect(()=>{me||Ve(ue=>(console.log(`Sync slider value started, remote:${ze}, local:${ue}`),ue===ze?ue:ze))},[me,ze]),I.useEffect(()=>{console.log(me?"remote sync is locked":"remote sync is unlocked - use remote value")},[me]);const de=wt({width:j,height:N,constraintsVertical:Me,constraintsHorizontal:ce,isStaticElement:ve,left:fe,top:xe,right:we,bottom:ye,deltaCenterX:ae,deltaCenterY:Re}),Ae=Xt(be),O=wr({signalName:V}),U=wr({signalName:J});let A={};const{useBorder:S,...P}=ee||{};S?A=P:A={};const{onBeforeChangeActions:F,onAfterChangeActions:z,onChangeActions:$,isActiveOverlayTrigger:W}=lr({actions:pe,elementRenderId:ge}),X=nt({[`element_${e.type}`]:!0,[`${i}`]:i,[`size-${r}`]:r,isVertical:s,hideThumb:p,isBarSlider:g,isActiveOverlayTrigger:!!W,...Fe}),se=I.useCallback(()=>{if(L&&Ge!==void 0){const ue=Lt.getState().updateEnvStore;ue({dynamicBg:{show:!0,value:bd(H,G,Ge),minColor:l||Ne,maxColor:f||je}})}},[je,Ne,f,G,l,H,Ge,L]),ie=I.useRef(),re=I.useRef(),le=I.useRef(),he=I.useCallback(ue=>{const Ie=()=>{if(!me){console.log("slider runBeforeChangeActions");for(const Oe of F)Oe(Xe.current)}},Pe=()=>{console.log("slider runOnChangeActions");for(const Oe of $)Oe(Xe.current)},He=({runAfter:Oe})=>{clearTimeout(re.current),re.current=setTimeout(()=>{console.log("slider runAfterChangeActions"),(async()=>{clearTimeout(le.current);const qe=z.map(We=>We(Xe.current));await Promise.all(qe),le.current=setTimeout(()=>{te(We=>We&&!1)},1e3)})()},Oe)};(({unlockAfter:Oe})=>{clearTimeout(ie.current),te(Te=>Te||!0),z.length||(ie.current=setTimeout(()=>{te(Te=>Te&&!1)},Oe))})({unlockAfter:3e3}),Ve(ue),Xe.current=ue,se(),Ie(),Pe(),He({runAfter:1e3})},[me,z,F,$,se]),Se=s?{paddingTop:8,paddingBottom:8}:{paddingLeft:8,paddingRight:8};return D.jsxs(ud,{ref:ue=>{q&&(q.current=ue)},style:{...de,fontFamily:Ee,...Ae,...Se},...e,minBackground:l||Ne,maxBackground:f||je,className:X,children:[D.jsxs("div",{className:"sliderBox",children:[h&&D.jsx("div",{className:"sliderControls",children:d?D.jsx(Wa,{...O}):D.jsx(Xa,{...U})}),D.jsx(jr,{value:Ge,onChange:ue=>{he(ue)},className:"rcslider",handleStyle:{background:Z??"white",...A},reverse:d,vertical:s,min:Number(H),max:Number(G)}),h&&D.jsx("div",{className:"sliderControls",children:d?D.jsx(Xa,{...U}):D.jsx(Wa,{...O})})]}),b&&D.jsx("div",{className:`${x}1`,children:D.jsx("div",{style:De,className:"valueLabel",children:D.jsx(Ct,{...e,text:b})})}),T!==void 0&&D.jsx("div",{className:`${_}2`,children:D.jsx("div",{style:ke,className:"sliderLabel",children:D.jsx(Ct,{...e,text:T})})})]})};no.displayName="SliderElement";const Sd=ct(jt)`
  display: flex;
  align-items: center;
  gap: 0.4em;

  overflow: hidden;

  &.size-small {
    font-size: 0.7em;
  }

  /* color: ${({color:e})=>e}; */

  .ant-switch-checked {
    background: ${({color:e})=>e};
  }

  &.reverseOrder {
    flex-direction: row-reverse;
  }

  &.isEditedNow {
   
    &:before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;

      opacity: 0.1;
      background-size: 10px 10px;
      background-image: repeating-linear-gradient(45deg, #0078ff 0, #0078ff 1px, #090e43 0, #090e43 50%);
    }
  }
`;async function Cr(e,r){if(typeof e!="object"||e===null)return e;if(Array.isArray(e))return await Promise.all(e.map(l=>Cr(l,r)));const i={};for(const o in e)if(e.hasOwnProperty(o)){const l=e[o];typeof l=="object"&&l!==null?await Cr(l,r).then(f=>i[o]=f):typeof l=="string"?r(l).then(f=>i[o]=f):i[o]=l}return i}async function Ed(e,r){if((e==null?void 0:e.length)>1&&e.startsWith("%")&&e.endsWith("%")){const i=e.replace(/%/g,""),o=r.find(l=>l.name===i);return(o==null?void 0:o.currentValue)??(o==null?void 0:o.defaultValue)}else return e}const la=et.memo(e=>{const{size:r,cssClass:i,state:o,subpageId:l,width:f,height:s,actions:g,inputParameters:p,listIndex:d,parentData:h,parentArrayIndex:L,indexInList:_,datasetPath:x,filter:T,backgroundColor:b,border:M,boxReflect:R,backgroundElementsBlur:k,fontFamily:j="inherit",boxShadow:N,constraintsVertical:H,constraintsHorizontal:G,isStaticElement:V,left:J,top:Z,right:ee,bottom:ge,staticDevMoveableRef:pe,index:Ee,deltaCenterX:be,deltaCenterY:Me}=e;console.log("size debug",r);const ce=Pt(o,Ee),ve=I.useRef(null),{tapActionsArr:fe,isActiveOverlayTrigger:xe}=lr({indexInList:_,actions:g,datasetPath:x,filter:T,elementRef:ve,parentData:h,elementRenderId:l}),we=nt({[`element_${e.type}`]:!0,[`${i}`]:i,[`size-${r}`]:r,isActiveOverlayTrigger:!!xe,...ce}),ye=$t(Ve=>{var Xe;return(Xe=Ve.workingProject)==null?void 0:Xe.attributes.pages.data}),q=I.useMemo(()=>(ye==null?void 0:ye.filter(Ve=>Ve.attributes.isSubpage))||[],[ye]),oe=zr(Ve=>Ve.calculatedVariables),[ae,Re]=I.useState();I.useEffect(()=>{const Ve=te=>{Re(de=>ra.isEqual(de,te)?de:te)};async function Xe(te,de){if(!(!te||te===void 0))if(typeof te=="string"&&te.length>2&&te.startsWith("#")&&te.endsWith("#")){let Ae=te.replaceAll("#",""),O;const U=/<varString variableName="([^"]+)"/g,A=/<parameter name="([^"]+)"/g,S=[],P=[];for(;(O=U.exec(Ae))!==null;)S.push(O[1]);for(;(O=A.exec(Ae))!==null;)P.push(O[1]);const F=S.map(async $=>{const W=oe==null?void 0:oe.find(X=>X.name===$);if(W){const{currentValue:X,defaultValue:se}=W;if(W.datasetID){const ie=await Yi(W.datasetID.dataset,W.dynamicValue);Ae=Ae.replace(`<varString variableName="${$}"`,ie)}else{const ie=X===void 0?se:X;Ae=Ae.replace(`<varString variableName="${$}"/>`,ie.toString())}}});await Promise.all(F);const z=P.map(async $=>{const W=de.find(se=>se.name===$);let X;W&&W!==void 0&&(W.currentValue!==void 0&&(X=W.currentValue),X===void 0&&W.defaultValue!==void 0&&(X=W.defaultValue),X!==void 0&&(Ae=Ae.replace(`<parameter name="${$}"/>`,X.toString())))});return await Promise.all(z),Ae}else return te}async function me(){var Ae,O;let te;const de=q==null?void 0:q.find(U=>U.id===l);if(de!=null&&de.attributes.isSubpage&&(p!=null&&p.length)&&((Ae=de.attributes.parameters)!=null&&Ae.length)&&(te=structuredClone(de==null?void 0:de.attributes.parameters).map(A=>{var P;const S=(P=p.find(F=>F.parameterName===A.name))==null?void 0:P.passedValue;if(S!==void 0&&(A.currentValue=S),A.currentValue!==void 0&&A.currentValue!==null&&typeof A.currentValue=="string"&&A.currentValue.startsWith("{")&&A.currentValue.endsWith("}"))Ln("%"+A.name+"%",d,h,"subpage - get stored parameter value",void 0,A.currentValue).then(F=>(F!==void 0&&F!==""&&(A.currentValue=F),A)).catch(()=>A);else return A;return A})),de){const U=structuredClone(de);if(te){U.attributes.parameters=te;const A=await Cr(U.attributes,S=>Ed(S,U.attributes.parameters));A!=null&&A.actions&&((O=A==null?void 0:A.actions)==null?void 0:O.length)>0&&(A.actions=await Cr(A.actions,S=>Xe(S,U.attributes.parameters))),U.attributes=A,Ve(U)}Ve(U)}}me()},[oe,p,d,L,h,q,l]);const Ce=wt({width:ae==null?void 0:ae.attributes.width,height:ae==null?void 0:ae.attributes.height}),ke=wt({width:f,height:s,constraintsVertical:H,constraintsHorizontal:G,isStaticElement:V,left:J,top:Z,right:ee,bottom:ge,deltaCenterX:be,deltaCenterY:Me,fallbackWidth:Ce==null?void 0:Ce.width,fallbackHeight:Ce==null?void 0:Ce.height}),De={...fe};let Ne={};b&&(Ne={backgroundColor:b});const je=$r(M),Fe=Vr(N),ze=k?{backdropFilter:`blur(${k}px)`,WebkitBackdropFilter:`blur(${k}px)`}:{},Ge=Xt(R);return ae?D.jsx(Sd,{ref:Ve=>{pe&&(pe.current=Ve),ve.current=Ve},...e,style:{...Ce,...ke,...Ne,...je,...Fe,...ze,...Ge,fontFamily:j},...De,className:we,children:ae&&D.jsx(li,{data:ae,renderAsElement:!0,listIndex:d,parentData:h})}):null});la.displayName="SubPageElement";function Qt(e){return e?e+"px":"1px"}const xd=Pr`
  from {
    opacity:0;

  }

  to {
    opacity:1;

  }
`,Td=ct(jt)`
  position: relative;
  width: 100%;
  height: 100%;
  /* max-height: 100%;
  max-width: 100%; */
  /* aspect-ratio: 1/1; */

  .box {
    position: relative;
    top: 50%;
    transform: translateY(-50%);
    aspect-ratio: 1/1;
    max-height: 100%;
    /* max-width: 100%; */
    min-width: 50px;
    /* min-height: 50px; */
    overflow: hidden;
    margin: auto;
  }

  .center {
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
    left: 50%;
    top: 50%;
    width: 25%;
    aspect-ratio: 1/1;
    transform: translate(-50%, -50%);
    border-width: ${({thickness:e})=>Qt(e)};
    border-style: solid;
    border-color: ${({theme:e,color:r})=>r||e.colors.primaryColor};
    border-radius: ${"50%"};
    cursor: pointer;
    z-index: 10;
    &:active {
      border-color: ${({theme:e,pressedColor:r})=>r||e.colors.primaryColor};
      transform: translate(-50%, -50%) scale(0.9);
    }
    transition: 200ms;
  }

  .control {
    animation: ${xd} 500ms linear;
    animation-fill-mode: backwards;
    aspect-ratio: 1/1;
    width: 30%;
    /* background-color: red; */
    position: absolute;
    cursor: pointer;
    border-width: ${({thickness:e})=>Qt(e)};
    border-style: solid;
    border-color: ${({theme:e,color:r})=>r||e.colors.primaryColor};

    will-change: transform;
    backface-visibility: hidden;
    transition: 200ms;

    &:active {
      border-color: ${({theme:e,pressedColor:r})=>r||e.colors.primaryColor};
    }

    .inner {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      transform: rotate(-45deg);
    }
  }

  .top {
    left: 50%;
    top: 0;
    transform: translateX(-50%) translateY(20%) rotate(45deg);
    border-width: ${({thickness:e})=>Qt(e)} 0px 0px ${({thickness:e})=>Qt(e)};
    border-radius: ${({cornersRaduis:e})=>Qt(e)} 0px 0px 0px;
    &:active {
      transform: translateX(-50%) translateY(20%) rotate(45deg) scale(0.9);
    }
    animation-delay: 100ms;
  }

  .bottom {
    left: 50%;
    bottom: 0;
    transform: translateX(-50%) translateY(-20%) rotate(45deg);
    border-width: 0px ${({thickness:e})=>Qt(e)} ${({thickness:e})=>Qt(e)} 0px;
    border-radius: 0px 0px ${({cornersRaduis:e})=>Qt(e)} 0px;
    &:active {
      transform: translateX(-50%) translateY(-20%) rotate(45deg) scale(0.9);
    }
    animation-delay: 300ms;
  }

  .right {
    top: 50%;
    right: 0;
    transform: translateY(-50%) translateX(-20%) rotate(45deg);
    border-width: ${({thickness:e})=>Qt(e)} ${({thickness:e})=>Qt(e)} 0px 0px;
    border-radius: 0px ${({cornersRaduis:e})=>Qt(e)} 0px 0px;
    &:active {
      transform: translateY(-50%) translateX(-20%) rotate(45deg) scale(0.9);
    }
    animation-delay: 200ms;
  }

  .left {
    top: 50%;
    left: 0;
    transform: translateY(-50%) translateX(20%) rotate(45deg);
    border-width: 0px 0px ${({thickness:e})=>Qt(e)} ${({thickness:e})=>Qt(e)};
    border-radius: 0px 0px 0px ${({cornersRaduis:e})=>Qt(e)};
    &:active {
      transform: translateY(-50%) translateX(20%) rotate(45deg) scale(0.9);
    }
    animation-delay: 400ms;
  }
`,io=e=>{const{cssClass:r,state:i,thickness:o=1,hideCetralButton:l,width:f,height:s,topText:g,rightText:p,bottomText:d,leftText:h,centerText:L,topButton_signal_d:_,rightButton_signal_d:x,bottomButton_signal_d:T,leftButton_signal_d:b,centerButton_signal_d:M,boxReflect:R,staticDevMoveableRef:k,constraintsVertical:j,constraintsHorizontal:N,isStaticElement:H,left:G,top:V,right:J,bottom:Z,index:ee,deltaCenterX:ge,deltaCenterY:pe}=e,Ee=pt(oe=>oe.showBoundingBox),be=Pt(i,ee),Me=nt({[`element_${e.type}`]:!0,[`${r}`]:r,showBoundingBox:Ee,...be}),ce=wr({signalName:_}),ve=wr({signalName:x}),fe=wr({signalName:T}),xe=wr({signalName:b}),we=wr({signalName:M}),ye=Xt(R),q=wt({width:f,height:s,constraintsVertical:j,constraintsHorizontal:N,isStaticElement:H,left:G,top:V,right:J,bottom:Z,deltaCenterX:ge,deltaCenterY:pe});return D.jsx(Td,{ref:oe=>{k&&(k.current=oe)},thickness:o,...e,style:{...q,...ye},className:Me,children:D.jsxs("div",{className:"box",children:[!l&&D.jsx("div",{...we,className:"center",children:L}),D.jsx("div",{...ce,className:"top control",children:D.jsx("div",{className:"inner",children:g})}),D.jsx("div",{...ve,className:"right control",children:D.jsx("div",{className:"inner",children:p})}),D.jsx("div",{...fe,className:"bottom control",children:D.jsx("div",{className:"inner",children:d})}),D.jsx("div",{...xe,className:"left control",children:D.jsx("div",{className:"inner",children:h})})]})})};io.displayName="DpadElement";const wd=ct(jt)`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  grid-auto-rows: 1fr;

  .el {
    font-size: inherit;
    display: flex;
    flex-flow: column;
    gap: 0.5em;

    .letters {
      text-transform: uppercase;
      font-size: 0.8em;
      /* opacity: 0.6; */
      display: ${({hideLetters:e})=>e?"none":"block"};
      min-height: 1em;

      /* &:empty {
        display: none;
      } */
    }
  }
`,Md=["1","2","3","4","5","6","7","8","9","Extra1","0","Extra2"],ao=e=>{const{size:r,cssClass:i,state:o,textFontSize:l,lettersFontSize:f,gap:s,width:g,height:p,fontFamily:d="inherit",textColor:h,lettersColor:L,backgroundColor:_,border:x,boxReflect:T,staticDevMoveableRef:b,constraintsVertical:M,constraintsHorizontal:R,isStaticElement:k,left:j,top:N,right:H,bottom:G,index:V,deltaCenterX:J,deltaCenterY:Z}=e,ee=Pt(o,V),ge=nt({[`element_${e.type}`]:!0,[`${i}`]:i,[`size-${r}`]:r,...ee}),pe=Et(l),Ee=Et(f),be=Xt(T),Me=yt({sizeObj:(s==null?void 0:s.value)===void 0||(s==null?void 0:s.value)===null?{value:10,unit:"px"}:s,sizePropName:"gap"}),ce=$r(x),ve=wt({width:g,height:p,constraintsVertical:M,constraintsHorizontal:R,isStaticElement:k,left:j,top:N,right:H,bottom:G,deltaCenterX:J,deltaCenterY:Z});return D.jsx(wd,{ref:fe=>{b&&(b.current=fe)},...e,style:{...Me,...ve,...be,fontFamily:d},className:ge,children:Md.map(fe=>{let xe="";switch(fe){case"Extra1":xe="✱";break;case"Extra2":xe="#";break;default:xe=fe;break}let we="";switch(fe){case"2":we="abc";break;case"3":we="def";break;case"4":we="ghi";break;case"5":we="jkl";break;case"6":we="mno";break;case"7":we="pqrs";break;case"8":we="tuv";break;case"9":we="wxyz";break;case"0":we="+";break;default:we="";break}const ye=_?{backgroundColor:_}:{};return D.jsxs(xn,{onClick:()=>{Ur(e[`button${fe}_signal_d`])},className:"element_button el",style:{...ye,...ce},children:[D.jsx("span",{style:{color:h||"inherit",...pe},children:e[`button${fe}Text`]||xe}),D.jsx("span",{style:{color:L||"inherit",opacity:L?1:.6,...Ee},className:"letters",children:e[`button${fe}SubText`]||we})]},fe)})})};ao.displayName="KeypadElement";const Ld=ct(jt)`
  display: flex;
  align-items: center;
  justify-content: center;
  flex-flow: column;
  gap: 1em;

  .react-clock {
    aspect-ratio: 1/1;
    height: auto !important;
  }

  .react-clock__face {
    border-color: transparent;
  }
  .react-clock__mark__body {
    background-color: ${({theme:e,minuteMarkColor:r})=>r||e.colors.textColor};
  }
  .react-clock__hour-mark__body {
    background-color: ${({theme:e,hourMarkColor:r})=>r||e.colors.primaryColor};
  }
  .react-clock__hour-hand div {
    background-color: ${({theme:e,hourHandColor:r})=>r||e.colors.textColor};
  }
  .react-clock__minute-hand div {
    background-color: ${({theme:e,minuteHandColor:r})=>r||e.colors.textColor};
  }
  .react-clock__second-hand div {
    background-color: ${({secondHandColor:e})=>e||"red"};
  }
`;function so(e){var r,i,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var l=e.length;for(r=0;r<l;r++)e[r]&&(i=so(e[r]))&&(o&&(o+=" "),o+=i)}else for(i in e)e[i]&&(o&&(o+=" "),o+=i);return o}function kd(){for(var e,r,i=0,o="",l=arguments.length;i<l;i++)(e=arguments[i])&&(r=so(e))&&(o&&(o+=" "),o+=r);return o}function ns(e){if(e instanceof Date)return e.getHours();if(typeof e=="string"){var r=e.split(":");if(r.length>=2){var i=r[0];if(i){var o=parseInt(i,10);if(!isNaN(o))return o}}}throw new Error("Failed to get hours from date: ".concat(e,"."))}function Li(e){if(e instanceof Date)return e.getMinutes();if(typeof e=="string"){var r=e.split(":");if(r.length>=2){var i=r[1]||"0",o=parseInt(i,10);if(!isNaN(o))return o}}throw new Error("Failed to get minutes from date: ".concat(e,"."))}function ki(e){if(e instanceof Date)return e.getSeconds();if(typeof e=="string"){var r=e.split(":");if(r.length>=2){var i=r[2]||"0",o=parseInt(i,10);if(!isNaN(o))return o}}throw new Error("Failed to get seconds from date: ".concat(e,"."))}function Ai(e){if(e instanceof Date)return e.getMilliseconds();if(typeof e=="string"){var r=e.split(":");if(r.length>=2){var i=r[2]||"0",o=i.split(".")[1]||"0",l=parseInt(o,10);if(!isNaN(l))return l}}throw new Error("Failed to get seconds from date: ".concat(e,"."))}function Ri(e){var r=e.angle,i=r===void 0?0:r,o=e.name,l=e.length,f=l===void 0?100:l,s=e.oppositeLength,g=s===void 0?10:s,p=e.width,d=p===void 0?1:p;return et.createElement("div",{className:"react-clock__hand react-clock__".concat(o,"-hand"),style:{transform:"rotate(".concat(i,"deg)")}},et.createElement("div",{className:"react-clock__hand__body react-clock__".concat(o,"-hand__body"),style:{width:"".concat(d,"px"),top:"".concat(50-f/2,"%"),bottom:"".concat(50-g/2,"%")}}))}function oo(e){var r=e.angle,i=r===void 0?0:r,o=e.length,l=o===void 0?10:o,f=e.name,s=e.width,g=s===void 0?1:s,p=e.number;return et.createElement("div",{className:"react-clock__mark react-clock__".concat(f,"-mark"),style:{transform:"rotate(".concat(i,"deg)")}},et.createElement("div",{className:"react-clock__mark__body react-clock__".concat(f,"-mark__body"),style:{width:"".concat(g,"px"),top:0,bottom:"".concat(100-l/2,"%")}}),p?et.createElement("div",{className:"react-clock__mark__number",style:{transform:"rotate(-".concat(i,"deg)"),top:"".concat(l/2,"%")}},p):null)}var $i=function(){return $i=Object.assign||function(e){for(var r,i=1,o=arguments.length;i<o;i++){r=arguments[i];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},$i.apply(this,arguments)},Ad=I.memo(function(r){return et.createElement(oo,$i({},r))});const Rd=(e,r,i,o)=>{if(i==="length"||i==="prototype"||i==="arguments"||i==="caller")return;const l=Object.getOwnPropertyDescriptor(e,i),f=Object.getOwnPropertyDescriptor(r,i);!Cd(l,f)&&o||Object.defineProperty(e,i,f)},Cd=function(e,r){return e===void 0||e.configurable||e.writable===r.writable&&e.enumerable===r.enumerable&&e.configurable===r.configurable&&(e.writable||e.value===r.value)},Dd=(e,r)=>{const i=Object.getPrototypeOf(r);i!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,i)},Id=(e,r)=>`/* Wrapped ${e}*/
${r}`,Pd=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),Od=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),Fd=(e,r,i)=>{const o=i===""?"":`with ${i.trim()}() `,l=Id.bind(null,o,r.toString());Object.defineProperty(l,"name",Od),Object.defineProperty(e,"toString",{...Pd,value:l})},Nd=(e,r,{ignoreNonConfigurable:i=!1}={})=>{const{name:o}=e;for(const l of Reflect.ownKeys(r))Rd(e,r,l,i);return Dd(e,r),Fd(e,r,o),e};var Yd=Nd,Vi={exports:{}},Bd=()=>{const e={};return e.promise=new Promise((r,i)=>{e.resolve=r,e.reject=i}),e};(function(e,r){var i=Qe&&Qe.__awaiter||function(s,g,p,d){return new(p||(p=Promise))(function(h,L){function _(b){try{T(d.next(b))}catch(M){L(M)}}function x(b){try{T(d.throw(b))}catch(M){L(M)}}function T(b){b.done?h(b.value):new p(function(M){M(b.value)}).then(_,x)}T((d=d.apply(s,g||[])).next())})},o=Qe&&Qe.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(r,"__esModule",{value:!0});const l=o(Bd);function f(s,g="maxAge"){let p,d,h;const L=()=>i(this,void 0,void 0,function*(){if(p!==void 0)return;const T=b=>i(this,void 0,void 0,function*(){h=l.default();const M=b[1][g]-Date.now();if(M<=0){s.delete(b[0]),h.resolve();return}return p=b[0],d=setTimeout(()=>{s.delete(b[0]),h&&h.resolve()},M),typeof d.unref=="function"&&d.unref(),h.promise});try{for(const b of s)yield T(b)}catch{}p=void 0}),_=()=>{p=void 0,d!==void 0&&(clearTimeout(d),d=void 0),h!==void 0&&(h.reject(void 0),h=void 0)},x=s.set.bind(s);return s.set=(T,b)=>{s.has(T)&&s.delete(T);const M=x(T,b);return p&&p===T&&_(),L(),M},L(),s}r.default=f,e.exports=f,e.exports.default=f})(Vi,Vi.exports);var jd=Vi.exports;const Hd=Yd,Ud=jd,Ci=new WeakMap,lo=new WeakMap,ti=(e,{cacheKey:r,cache:i=new Map,maxAge:o}={})=>{typeof o=="number"&&Ud(i);const l=function(...f){const s=r?r(f):f[0],g=i.get(s);if(g)return g.data;const p=e.apply(this,f);return i.set(s,{data:p,maxAge:o?Date.now()+o:Number.POSITIVE_INFINITY}),p};return Hd(l,e,{ignoreNonConfigurable:!0}),lo.set(l,i),l};ti.decorator=(e={})=>(r,i,o)=>{const l=r[i];if(typeof l!="function")throw new TypeError("The decorated value must be a function");delete o.value,delete o.writable,o.get=function(){if(!Ci.has(this)){const f=ti(l,e);return Ci.set(this,f),f}return Ci.get(this)}};ti.clear=e=>{const r=lo.get(e);if(!r)throw new TypeError("Can't clear a function that was not memoized!");if(typeof r.clear!="function")throw new TypeError("The cache Map can't be cleared!");r.clear()};var zd=ti;const uo=Or(zd);function Gd(e){return typeof e=="string"}function $d(e,r,i){return i.indexOf(e)===r}function Vd(e){return e.toLowerCase()===e}function is(e){return e.indexOf(",")===-1?e:e.split(",")}function Wi(e){if(!e)return e;if(e==="C"||e==="posix"||e==="POSIX")return"en-US";if(e.indexOf(".")!==-1){var r=e.split(".")[0],i=r===void 0?"":r;return Wi(i)}if(e.indexOf("@")!==-1){var o=e.split("@")[0],i=o===void 0?"":o;return Wi(i)}if(e.indexOf("-")===-1||!Vd(e))return e;var l=e.split("-"),f=l[0],s=l[1],g=s===void 0?"":s;return"".concat(f,"-").concat(g.toUpperCase())}function Wd(e){var r=e===void 0?{}:e,i=r.useFallbackLocale,o=i===void 0?!0:i,l=r.fallbackLocale,f=l===void 0?"en-US":l,s=[];if(typeof navigator<"u"){for(var g=navigator.languages||[],p=[],d=0,h=g;d<h.length;d++){var L=h[d];p=p.concat(is(L))}var _=navigator.language,x=_&&is(_);s=s.concat(p,x)}return o&&s.push(f),s.filter(Gd).map(Wi).filter($d)}var Kd=uo(Wd,{cacheKey:JSON.stringify});function Xd(e){return Kd(e)[0]||null}var qd=uo(Xd,{cacheKey:JSON.stringify});function Jd(e,r){return r.toLocaleString(e||qd()||void 0)}var Ki=function(){return Ki=Object.assign||function(e){for(var r,i=1,o=arguments.length;i<o;i++){r=arguments[i];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},Ki.apply(this,arguments)},Zd=function(e,r){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&r.indexOf(o)<0&&(i[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,o=Object.getOwnPropertySymbols(e);l<o.length;l++)r.indexOf(o[l])<0&&Object.prototype.propertyIsEnumerable.call(e,o[l])&&(i[o[l]]=e[o[l]]);return i},Qd=I.memo(function(r){var i=r.formatHour,o=i===void 0?Jd:i,l=r.locale,f=r.number,s=Zd(r,["formatHour","locale","number"]);return et.createElement(oo,Ki({number:f?o(l,f):null},s))});function co(e,r){return function(i,o,l){var f=i,s=o,g=f[s];if(typeof g<"u"){if(typeof g!="number")return new Error("Invalid prop `".concat(o,"` of type `").concat(typeof g,"` supplied to `").concat(l,"`, expected `number`."));if(g<e||g>r)return new Error("Invalid prop `".concat(o,"` of type `").concat(typeof g,"` supplied to `").concat(l,"`, length must be between ").concat(e," and ").concat(r,"."))}return null}}var Vn=co(0,100),Di=co(-100,100),Wn=function(r,i,o){var l=r,f=i,s=l[f];if(typeof s<"u"){if(typeof s!="number")return new Error("Invalid prop `".concat(i,"` of type `").concat(typeof s,"` supplied to `").concat(o,"`, expected `number`."));if(s<0)return new Error("Invalid prop `".concat(i,"` of type `").concat(typeof s,"` supplied to `").concat(o,"`, width must be greater or equal to 0."))}return null},as=Vn,ss=Wn,fo=function(r){var i=r.className,o=r.formatHour,l=r.hourHandLength,f=l===void 0?50:l,s=r.hourHandOppositeLength,g=r.hourHandWidth,p=g===void 0?4:g,d=r.hourMarksLength,h=d===void 0?10:d,L=r.hourMarksWidth,_=L===void 0?3:L,x=r.locale,T=r.minuteHandLength,b=T===void 0?70:T,M=r.minuteHandOppositeLength,R=r.minuteHandWidth,k=R===void 0?2:R,j=r.minuteMarksLength,N=j===void 0?6:j,H=r.minuteMarksWidth,G=H===void 0?1:H,V=r.renderHourMarks,J=V===void 0?!0:V,Z=r.renderMinuteHand,ee=Z===void 0?!0:Z,ge=r.renderMinuteMarks,pe=ge===void 0?!0:ge,Ee=r.renderNumbers,be=r.renderSecondHand,Me=be===void 0?!0:be,ce=r.secondHandLength,ve=ce===void 0?90:ce,fe=r.secondHandOppositeLength,xe=r.secondHandWidth,we=xe===void 0?1:xe,ye=r.size,q=ye===void 0?150:ye,oe=r.useMillisecondPrecision,ae=r.value;function Re(){if(!pe)return null;for(var Fe=[],ze=1;ze<=60;ze+=1){var Ge=J&&!(ze%5);Ge||Fe.push(et.createElement(Ad,{key:"minute_".concat(ze),angle:ze*6,length:N,name:"minute",width:G}))}return Fe}function Ce(){if(!J)return null;for(var Fe=[],ze=1;ze<=12;ze+=1)Fe.push(et.createElement(Qd,{key:"hour_".concat(ze),angle:ze*30,formatHour:o,length:h,locale:x,name:"hour",number:Ee?ze:void 0,width:_}));return Fe}function ke(){return et.createElement("div",{className:"react-clock__face"},Re(),Ce())}function De(){var Fe=ae?ns(ae)*30+Li(ae)/2+ki(ae)/120+(oe?Ai(ae)/12e4:0):0;return et.createElement(Ri,{angle:Fe,length:f,name:"hour",oppositeLength:s,width:p})}function Ne(){if(!ee)return null;var Fe=ae?ns(ae)*360+Li(ae)*6+ki(ae)/10+(oe?Ai(ae)/1e4:0):0;return et.createElement(Ri,{angle:Fe,length:b,name:"minute",oppositeLength:M,width:k})}function je(){if(!Me)return null;var Fe=ae?Li(ae)*360+ki(ae)*6+(oe?Ai(ae)*.006:0):0;return et.createElement(Ri,{angle:Fe,length:ve,name:"second",oppositeLength:fe,width:we})}return et.createElement("time",{className:kd("react-clock",i),dateTime:ae instanceof Date?ae.toISOString():ae||void 0,style:{width:q,height:q}},ke(),De(),Ne(),je())};fo.propTypes={className:Gt.oneOfType([Gt.string,Gt.arrayOf(Gt.string)]),formatHour:Gt.func,hourHandLength:Vn,hourHandOppositeLength:Di,hourHandWidth:Wn,hourMarksLength:as,hourMarksWidth:ss,locale:Gt.string,minuteHandLength:Vn,minuteHandOppositeLength:Di,minuteHandWidth:Wn,minuteMarksLength:as,minuteMarksWidth:ss,renderHourMarks:Gt.bool,renderMinuteHand:Gt.bool,renderMinuteMarks:Gt.bool,renderNumbers:Gt.bool,renderSecondHand:Gt.bool,secondHandLength:Vn,secondHandOppositeLength:Di,secondHandWidth:Wn,size:Gt.oneOfType([Gt.number,Gt.string]),value:Gt.oneOfType([Gt.string,Gt.instanceOf(Date)])};const ho=e=>{const{text:r,cssClass:i,state:o,textFontSize:l,gap:f,width:s,height:g,labelPosition:p,fontFamily:d="inherit",boxReflect:h,staticDevMoveableRef:L,constraintsVertical:_,constraintsHorizontal:x,isStaticElement:T,left:b,top:M,right:R,bottom:k,index:j,deltaCenterX:N,deltaCenterY:H}=e,G=Pt(o,j),V=pt(ce=>ce.showBoundingBox),J=nt({[`element_${e.type}`]:!0,[`${i}`]:i,showBoundingBox:V,...G}),Z=yt({sizeObj:f,sizePropName:"gap"}),ee=Et(l),ge=wt({width:s,height:g,constraintsVertical:_,constraintsHorizontal:x,isStaticElement:T,left:b,top:M,right:R,bottom:k,deltaCenterX:N,deltaCenterY:H}),pe={flexFlow:p==="bottom"?"column":"column-reverse"},Ee=Xt(h),[be,Me]=I.useState(new Date);return I.useEffect(()=>{const ce=setInterval(()=>{Me(new Date)},1e3);return()=>{clearInterval(ce)}},[]),D.jsxs(Ld,{...e,ref:ce=>{L&&(L.current=ce)},style:{...ge,...Z,...pe,fontFamily:d,...Ee},className:J,children:[D.jsx(fo,{size:"90%",renderNumbers:!1,value:be}),r?D.jsx(Ct,{...e,style:ee,text:r}):null]})};ho.displayName="ClockWidget";const go=""+new URL("poster-Ow2yuuT1.png",import.meta.url).href,ef=ct(jt)`
  position: relative;
  width: 100%;
  border-radius: ${({theme:e})=>e.borderRadius};
  display: flex;
  background: rgba(17, 19, 22, 0.25);
  border: 0.5px rgba(255, 255, 255, 0.1) solid;

  .sidebar {
    padding: 1.3em;
    position: relative;
    min-width: 250px;
    border-radius: 0 ${({theme:e})=>e.borderRadius}
      ${({theme:e})=>e.borderRadius} 0;
    background: rgba(77, 78, 86, 0.25);
    border-left: 0.5px rgba(255, 255, 255, 0.1) solid;
    display: flex;
    flex-flow: column;
    gap: 1em;

    .headline {
      display: flex;
      align-items: center;

      .text {
        color: ${({theme:e})=>on(e.colors.textColor).alpha(.5)};
        font-weight: 250;
        flex: 1;
        text-align: center;
      }
    }

    .sideContent {
      position: relative;
      flex: 1;

      .playerScroller {
        position: absolute;
        width: 100%;
        height: 100%;
        overflow-y: auto;
        height: 100%;
        max-height: 100%;
      }
    }

    .item {
      padding: 1em 0;
      text-transform: capitalize;
      border-bottom: 0.5px rgba(255, 255, 255, 0.1) dashed;

      display: flex;
      align-items: center;
      gap: 0.5em;

      .poster {
        width: 30px;
        min-width: 30px;
      }

      .label {
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
      }
    }
  }

  .body {
    flex: 1;
    width: 100%;
    /* height: 100%; */
    display: flex;
    flex-flow: column;
    gap: 1em;
    align-items: center;
    padding: 1.5em;
    overflow: hidden;

    .info {
      display: flex;
      flex-flow: column;
      gap: 1em;
      align-items: center;
      justify-content: center;
      flex: 1;
      padding: 1em 0;
    }
  }
  .header {
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.8em;
    color: ${({theme:e})=>on(e.colors.textColor).alpha(.5)};
    font-weight: 250;

    & > * {
      flex: 1;
      width: 33.333%;
      display: flex;

      &.center {
        justify-content: center;
      }

      &.right {
        text-align: right;
        justify-content: flex-end;
      }
    }
  }
  .title {
    font-size: 2.5em;
  }
  .subTitle {
    color: ${({theme:e})=>on(e.colors.textColor).alpha(.5)};
    font-weight: 300;

    span:not(:last-child) {
      &::after {
        content: ' • ';
      }
    }
  }
  .poster {
    position: relative;
    width: 150px;
    aspect-ratio: 1/1;
    border-radius: ${({theme:e})=>e.borderRadius};
    overflow: hidden;

    img {
      position: relative;
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: 50% 50%;
    }
  }
  .seekBar {
    padding: 1em 0;
    width: 100%;
    position: relative;
    display: flex;
    align-items: center;
    gap: 1em;

    .timeStamp {
      font-size: 0.8em;
      color: ${({theme:e})=>on(e.colors.textColor).alpha(.5)};
      font-weight: 300;
    }

    .rc-slider-handle {
      width: 30px;
      height: 30px;
      margin-top: -12px;
      opacity: 0;
      cursor: not-allowed;
    }

    &.isSeekingAvailable {
      cursor: grab;
    }

    .rc-slider-rail {
      background: ${({theme:e})=>e.colors.textColor};
      will-change: all;
    }

    .rc-slider-track {
      background: ${({theme:e})=>e.colors.primaryColor};
      will-change: all;
    }
  }
  .repeatControls {
    display: flex;
    align-items: center;
    gap: 1.5em;
    font-size: 1.5em;
  }
  .controls {
    display: flex;
    align-items: center;
    gap: 1.5em;
    font-size: 1.5em;
  }

  .clickable {
    will-change: transform;
    cursor: pointer;
    transition: 200ms;
    &:active {
      transform: scale(0.8);
    }
  }

  .pressed {
    color: ${({theme:e})=>e.colors.primaryColor};
  }
`,os=({isPressed:e,iconName:r,onClick:i,isAvailable:o,isConnected:l})=>{let f=nt({clickable:!0,pressed:e});return!l||o?D.jsx(fr,{className:f,icon:r,onClick:i}):null},tf=({isPlaying_signal_d_fb:e,isPaused_signal_d_fb:r,togglePlayPause_signal_d:i})=>{const[o,l]=I.useState(!1),f=Kt(e),s=Kt(r);return I.useEffect(()=>{f&&!s?l(!0):!f&&s&&l(!1)},[f,s]),D.jsx(fr,{onClick:()=>{Ur(i)},style:{fontSize:"2.5em"},icon:o?"IoPauseCircle":"IoPlayCircle"})};function rf(e,r){const o=(r-e)/2;return e+o}function ls(e){const r=Math.floor(e/60),i=e%60;return`${r.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}const nf=({seekingAvailable_signal_d_fb:e,nowPlayingLengthSeconds_signal_a_fb:r,nowPlayingPositionSeconds_signal_a_fb:i,nowPlayingPositionGaudgePercent_signal_a_fb:o,pushSeekPercent_signal_a:l})=>{const f=Lt(R=>R.envState),s=Hs(R=>R.xPanelStatus),g=Kt(e),p=Hr(r),d=Hr(i),h=Hr(o)/65535*100,L=0,_=100,[x,T]=I.useState(),b=h;I.useEffect(()=>{T(rf(L,_))},[]);let M=nt({seekBar:!0,isSeekingAvailable:g});return D.jsxs("div",{className:M,children:[D.jsx("div",{className:"timeStamp",children:ls(d)}),D.jsx(jr,{value:s==="connected"||f==="build"?b:x,onChange:R=>{s==="connected"||f==="build"?g&&Ys({signalName:l,value:R*65535/100}):T(R)},className:"seekBarSlider",reverse:!1,vertical:!1,min:L,max:_}),D.jsx("div",{className:"timeStamp",children:ls(p)})]})},af=({data:e,i:r,sourceItemSelector:i})=>{const o=or({signalName:e[`sourceItemImage_${r}_signal_s_fb`],placeHolder:""}),l=or({signalName:e[`sourceItemTitle_${r}_signal_s_fb`],placeHolder:"Source Title"});return D.jsxs("div",{onClick:()=>{e[`sourceItemSelect_${r}_signal_d`]&&Ur(e[`sourceItemSelect_${r}_signal_d`]),i&&Ys({signalName:i,value:r})},className:"item clickable",children:[D.jsx("div",{className:"poster",children:D.jsx("img",{src:o||go,alt:"poster"})}),D.jsx("div",{className:"label",children:l})]})},mo=e=>{const{cssClass:r,state:i,gap:o,width:l,height:f,headerTextLeft:s,headerTextCenter:g,headerTextRight:p,metaTitle_signal_s_fb:d,metaSubTitle1_signal_s_fb:h,metaSubTitle2_signal_s_fb:L,metaSubTitle3_signal_s_fb:_,isPlaying_signal_d_fb:x,isPaused_signal_d_fb:T,togglePlayPause_signal_d:b,metaImage_signal_s_fb:M,repeatAllAvailable_signal_d_fb:R,repeatAllIsOn_signal_d_fb:k,toggleRepeatMode_signal_d:j,shuffleAvailable_signal_d_fb:N,shuffleIsOn_signal_d_fb:H,toggleShuffleMode_signal_d:G,seekingAvailable_signal_d_fb:V,nowPlayingLengthSeconds_signal_a_fb:J,nowPlayingPositionSeconds_signal_a_fb:Z,nowPlayingPositionGaudgePercent_signal_a_fb:ee,pushSeekPercent_signal_a:ge,nextTrackAvailable_signal_d_fb:pe,previousTrackAvailable_signal_d_fb:Ee,nextTrack_signal_d:be,previousTrack_signal_d:Me,pulseSeekForward_signal_d:ce,pulseSeekBack_signal_d:ve,sourceBack_signal_d:fe,sourceBackVisibility_signal_d_fb:xe,sourceTitle_signal_s_fb:we,sourceItems:ye,sourceItemSelector_signal_a:q,staticDevMoveableRef:oe,constraintsVertical:ae,constraintsHorizontal:Re,isStaticElement:Ce,left:ke,top:De,right:Ne,bottom:je,index:Fe,deltaCenterX:ze,deltaCenterY:Ge}=e,Ve=ic(),Xe=Hs(Oe=>Oe.xPanelStatus),me=pt(Oe=>Oe.showBoundingBox),te=Xe==="connected",de=or({signalName:d,placeHolder:"Meta Title"}),Ae=or({signalName:h,placeHolder:te?"":"SubTitle 1"}),O=or({signalName:L,placeHolder:te?"":"SubTitle 2"}),U=or({signalName:_,placeHolder:te?"":"SubTitle 3"}),A=or({signalName:M,placeHolder:""}),S=Kt(V),P=Pt(i,Fe),F=nt({[`widget_${e.type}`]:!0,[`${r}`]:r,showBoundingBox:me,...P}),z=Kt(k),$=Kt(R),W=Kt(H),X=Kt(N),se=Kt(pe),ie=Kt(Ee),re=wr({signalName:ce}),le=wr({signalName:ve}),he=nt({clickable:!0,isDisabled:!ie}),Se=nt({clickable:!0,isDisabled:!se}),ue=nt({clickable:!0,isDisabled:!S}),Ie=or({signalName:we,placeHolder:"Source Title"}),Pe=Kt(xe),He=yt({sizeObj:o,sizePropName:"gap"}),Ye=wt({width:l,height:f,constraintsVertical:ae,constraintsHorizontal:Re,isStaticElement:Ce,left:ke,top:De,right:Ne,bottom:je,deltaCenterX:ze,deltaCenterY:Ge});return D.jsxs(ef,{...e,ref:Oe=>{oe&&(oe.current=Oe)},style:{...Ye,...He},className:F,children:[D.jsxs("div",{className:"body",children:[D.jsxs("div",{className:"header",children:[D.jsx("div",{className:"left",children:s&&D.jsx(Ct,{...e,text:s})}),D.jsx("div",{className:"center",children:g&&D.jsx(Ct,{...e,text:g})}),D.jsx("div",{className:"right",children:p&&D.jsx(Ct,{...e,text:p})})]}),D.jsxs("div",{className:"info",children:[D.jsx("div",{className:"title",children:de}),D.jsxs("div",{className:"subTitle",children:[Ae?D.jsxs("span",{children:[" ",Ae," "]}):null,O?D.jsxs("span",{children:[" ",O," "]}):null,U?D.jsxs("span",{children:[" ",U," "]}):null]}),D.jsx("div",{className:"poster",children:D.jsx("img",{src:A||go,alt:"poster"})}),D.jsxs("div",{className:"repeatControls",children:[D.jsx(os,{isConnected:te,isAvailable:$,iconName:"IoRepeat",isPressed:z,onClick:()=>{Ka({signalName:j,value:!z})}}),D.jsx(os,{isConnected:te,isAvailable:X,iconName:"IoShuffleOutline",isPressed:W,onClick:()=>{Ka({signalName:G,value:!W})}})]})]}),D.jsx(nf,{seekingAvailable_signal_d_fb:V,nowPlayingLengthSeconds_signal_a_fb:J,nowPlayingPositionSeconds_signal_a_fb:Z,nowPlayingPositionGaudgePercent_signal_a_fb:ee,pushSeekPercent_signal_a:ge}),D.jsxs("div",{className:"controls",children:[D.jsx(fr,{className:he,icon:"IoPlaySkipBackOutline",onClick:()=>{Ur(Me)}}),(!te||S)&&D.jsx(fr,{...le,className:ue,icon:"IoPlayBackOutline"}),D.jsx(tf,{isPlaying_signal_d_fb:x,isPaused_signal_d_fb:T,togglePlayPause_signal_d:b}),(!te||S)&&D.jsx(fr,{...re,className:ue,icon:"IoPlayForwardOutline"}),D.jsx(fr,{className:Se,icon:"IoPlaySkipForwardOutline",onClick:()=>{Ur(be)}})]})]}),D.jsxs("div",{className:"sidebar",children:[D.jsxs("div",{className:"headline",children:[Pe&&D.jsx(fr,{onClick:()=>{Ur(fe)},className:"clickable",style:{fontSize:"1.2em"},icon:"IoArrowUndoCircle"}),D.jsx("div",{className:"text",children:Ie})]}),D.jsx("div",{className:"sideContent",children:D.jsx("div",{ref:Ve.ref,className:"playerScroller",children:D.jsx("div",{children:ye==null?void 0:ye.map((Oe,Te)=>D.jsx(af,{sourceItemSelector:q,data:Oe,i:Te},Te))})})})]})]})};mo.displayName="PlayerWidget";const po=et.memo(({elements:e})=>{const[i,o]=I.useState(0);return I.useEffect(()=>{let l=0;const f=setInterval(()=>{l||(l=100),o(s=>{const g=s+50;return g>=e.length?(clearInterval(f),e.length):g})},l);return()=>clearInterval(f)},[e]),D.jsx(D.Fragment,{children:e.slice(0,i).map((l,f)=>D.jsx(et.Fragment,{children:l},f))})}),vo=et.memo(({passProps:e,renderElementType:r,style:i})=>{switch(r){case"button":return D.jsx(sa,{style:i,...e});case"subpage":return D.jsx(la,{style:i,...e});default:return D.jsx("div",{children:"NoName Element"})}}),sf=et.memo(({listNumberOfItems:e,staticListOverrides:r,listData:i,renderElementType:o})=>{const f=I.useCallback(()=>{let s=[];const g=i[0]||[];"cssClass"in g&&(g.cssClass=null);const p=Object.keys(r||{});return s=new Array(e).fill(g).map((h,L)=>{var x,T;const _=L+1;return p.includes(String(_))&&(h={...h,...r==null?void 0:r[_]}),((x=h==null?void 0:h.width)==null?void 0:x.width.unit)==="%"&&(h.width.width.unit="cqw"),((T=h==null?void 0:h.height)==null?void 0:T.height.unit)==="%"&&(h.height.height.unit="cqh"),D.jsx(vo,{renderElementType:o,passProps:{...h,indexInList:L}},L)}),s},[i,r,e,o])();return D.jsx(po,{elements:f})}),of=et.memo(({listData:e,renderElementType:r})=>{function i(){return e.map((l,f)=>{var s,g,p,d;return((g=(s=l==null?void 0:l.width)==null?void 0:s.width)==null?void 0:g.unit)==="%"&&(l.width.width.unit="cqw"),((d=(p=l==null?void 0:l.height)==null?void 0:p.height)==null?void 0:d.unit)==="%"&&(l.height.height.unit="cqh"),D.jsx(vo,{renderElementType:r,passProps:{...l,indexInList:f}},f)})}const o=i();return o.length>200?D.jsx(po,{elements:o}):o}),lf=(e,r)=>{const{listWidth:i,listHeight:o,listGap:l,listPadding:f,listBackgroundColor:s,listBorder:g,listElementsFlow:p,listRows:d=1,listColumns:h=1,listVerticalPosition:L,listHorisontalPosition:_,isDynamic:x,listNumberOfItems:T,data:b,listState:M,staticListOverrides:R,cssClass:k,listForceFillHeight:j,listForceFillWidth:N,listEmptyText:H,constraintsVertical:G,constraintsHorizontal:V,isStaticElement:J,left:Z,top:ee,right:ge,bottom:pe,staticDevMoveableRef:Ee}=e,be=zr(A=>A.calculatedVariables),Me=si(A=>A.entries),[ce,ve]=I.useState(),[fe,xe]=I.useState();I.useEffect(()=>{const A=qu(b,be);ve(A)},[be,b,Me]),I.useEffect(()=>{ce&&ce.then(A=>{xe(S=>ra.isEqual(A,S)?S:A)})},[ce]);const we=Pt(M,null),ye=nt({[`${k}`]:k,listForceFillWidth:N,listForceFillHeight:j,...we});let q=wt({width:i,height:o,replacePercentWithContainerUnits:!0,constraintsVertical:G,constraintsHorizontal:V,isStaticElement:J,left:Z,top:ee,right:ge,bottom:pe});const{width:oe,height:ae}=q;oe!=="auto"&&ae!=="auto"?q={...q,containerType:"size"}:oe!=="auto"&&(q={...q,containerType:"inline-size"});let Re=yt({sizeObj:l,sizePropName:"gap"});Object.keys(Re).length===0&&(Re={gap:"5px"});const Ce=yt({sizeObj:f,sizePropName:"padding"}),ke=s?{backgroundColor:s}:{};let De={};const{useBorder:Ne,...je}=g||{};Ne?De=je:De={};let Fe={};switch(L){case"top":Fe={alignContent:"start"};break;case"bottom":Fe={alignContent:"end"};break;case"space-between":Fe={alignContent:"space-between"};break;case"space-around":Fe={alignContent:"space-around"};break}let ze={};switch(_){case"left":ze={justifyContent:"start"};break;case"right":ze={justifyContent:"right"};break;case"space-between":ze={justifyContent:"space-between"};break;case"space-around":ze={justifyContent:"space-around"};break}const Ge=I.useMemo(()=>fe!=null&&fe.length?p==="column"?{gridAutoFlow:p,gridAutoColumns:N?"1fr":"min-content",gridTemplateRows:`repeat(${d||1}, ${j?"1fr":"min-content"})`}:{gridAutoFlow:p,gridAutoRows:j?"1fr":"min-content",gridTemplateColumns:`repeat(${h||1}, ${N?"1fr":"min-content"})`}:{},[h,fe,p,j,N,d]),Ve=Lt(A=>A.envState);let Xe=H||"Empty List...";Ve!=="editor"&&(Xe=null);const[me,te]=I.useState(!1);function de(A){const S=A.target.tagName.toLowerCase();(S==="circle"||S==="path")&&(console.log("The target is a circle element"),te(!0))}const Ae=I.useRef(!1),O=I.useRef(!1);return I.useMemo(()=>fe&&Ge?D.jsx($a,{...e,ref:A=>{Ee&&(Ee.current=A)},style:{...q,...ke,...De,...Ce},className:ye,children:D.jsx(ac,{onScroll:()=>{O.current&&(Ae.current=!0)},onTouchStartCapture:A=>{O.current=!0,de(A)},onTouchEndCapture:A=>{Ae.current&&A.stopPropagation(),Ae.current=!1,O.current=!1,te(!1)},mouseScroll:{activationDistance:50,ignoreElements:'[class*="rc-slider"], path, circle'},style:{overflow:me?"hidden":"auto"},className:"listScroller",children:D.jsx("div",{style:{...Re,...Ge,...Fe,...ze},className:"grid",children:x?D.jsx(of,{listData:fe,renderElementType:r,listWidth:i,listHeight:o}):D.jsx(sf,{listNumberOfItems:T,staticListOverrides:R,listWidth:i,listHeight:o,listData:fe,renderElementType:r})})})}):fe===void 0?null:D.jsx($a,{style:{display:"flex",alignItems:"center",justifyContent:"center",...q,...ke,...De,...Ce},className:ye,children:Xe}),[Xe,ze,x,me,ke,De,ye,Ge,fe,Re,o,T,Ce,i,q,e,r,Ee,R,Fe])},_o=et.memo(e=>lf(e,"subpage"));_o.displayName="SubpageListElement";const uf=ct(jt)`
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.4em;

  .antCheckbox {
    color: inherit;
    position: relative;

    .tapcatcher {
      position: absolute;
      top: -25px;
      left: -25px;
      width: calc(100% + 50px);
      height: calc(100% + 50px);
      /* background-color: rgba(0, 0, 0, 0.5); */
    }

    .ant-checkbox-inner {
      border-color: transparent;
    }

    & .ant-checkbox-checked {
      &:after {
        border-color: ${({theme:e,color:r})=>r||e.colors.primaryColor};
      }
      .ant-checkbox-inner {
        background-color: ${({theme:e,color:r})=>r||e.colors.primaryColor};
        border-color: ${({theme:e,color:r})=>r||e.colors.primaryColor};

        &:after {
          border-color: ${({tickColor:e})=>e||"rgba(0, 0, 0, 0.75)"};
        }
      }
    }
  }
`,yo=e=>{const{text:r,cssClass:i,state:o,textFontSize:l,gap:f,actions:s,elementRenderId:g,fontFamily:p="inherit",boxReflect:d,width:h,height:L,constraintsVertical:_,constraintsHorizontal:x,isStaticElement:T,left:b,top:M,right:R,bottom:k,staticDevMoveableRef:j,index:N,deltaCenterX:H,deltaCenterY:G}=e,V=Pt(o,N),J=Kt(o==null?void 0:o.checkedState_signal),[Z,ee]=I.useState(J),ge=I.useRef(),pe=I.useRef(J);I.useEffect(()=>{pe.current=J,ee(J)},[J]);const Ee=Et(l),be=yt({sizeObj:f,sizePropName:"marginLeft"}),{onBeforeChangeActions:Me,onAfterChangeActions:ce,onChangeActions:ve,isActiveOverlayTrigger:fe}=lr({actions:s,elementRenderId:g}),xe=nt({[`element_${e.type}`]:!0,[`${i}`]:i,isActiveOverlayTrigger:!!fe,...V});function we(oe){function ae(){clearTimeout(ge.current),ge.current=setTimeout(()=>{ee(pe.current)},3e3)}if(ae(),Me.length)for(const Re of Me)Re(oe);if(ve.length)for(const Re of ve)Re(oe);if(ee(oe),ce.length)for(const Re of ce)Re(oe)}const ye=Xt(d),q=wt({width:h,height:L,constraintsVertical:_,constraintsHorizontal:x,isStaticElement:T,left:b,top:M,right:R,bottom:k,deltaCenterX:H,deltaCenterY:G});return D.jsx(uf,{ref:oe=>{j&&(j.current=oe)},style:{fontFamily:p,...ye,...q},...e,className:xe,children:D.jsxs(Zu,{checked:Z,onChange:oe=>{we(oe.target.checked)},className:"antCheckbox",children:[r?D.jsx(Ct,{...e,style:{...Ee,...be},text:r}):null,D.jsx("div",{className:"tapcatcher"})]})})};yo.displayName="CheckboxElement";const cf=ct(jt)`
  position: relative;
  cursor: pointer;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;

  .playIcon {
    height: 40%;
    width: 40%;
    max-width: 120px;
    position: relative;
    object-fit: contain;
    transition: 200ms;

    &:active {
      scale: 0.8;
    }
  }

  video {
    position: absolute;
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: 50% 50%;

    /* &::-webkit-media-controls {
      display: none;
    } */

    &:-webkit-full-page-media {
    }

    &::-webkit-media-controls-panel {
    }

    &::-webkit-media-controls-enclosure {
    }

    &::-webkit-media-controls-play-button {
    }

    &::-webkit-media-controls-volume-slider {
    }

    &::-webkit-media-controls-mute-button {
      /* display: none; */
    }

    &::-webkit-media-controls-timeline-container {
    }

    &::-webkit-media-controls-timeline {
    }

    &::-webkit-media-controls-current-time-display {
    }

    &::-webkit-media-controls-seek-back-button {
    }

    &::-webkit-media-controls-seek-forward-button {
    }

    &::-webkit-media-controls-fullscreen-button {
    }

    &::-webkit-media-controls-return-to-realtime-button {
    }

    &::-webkit-media-controls-toggle-closed-captions-button {
    }

    &::-webkit-media-controls-closed-captions-container {
    }

    &::-webkit-media-controls-closed-captions-track-list {
    }

    &::-webkit-media-controls-fullscreen-volume-slider {
    }

    &::-webkit-media-controls-fullscreen-volume-min-button {
    }

    &::-webkit-media-controls-fullscreen-volume-max-button {
    }

    &::-webkit-media-text-track-container {
    }

    &::-webkit-media-controls {
      overflow: hidden !important;
    }
    &::-webkit-media-controls-enclosure {
      /* width: calc(100% + 32px);
      margin-left: auto; */
    }
  }
`;var bo={exports:{}};(function(e,r){typeof window<"u"&&function(o,l){e.exports=l()}(Qe,function(){return function(i){var o={};function l(f){if(o[f])return o[f].exports;var s=o[f]={i:f,l:!1,exports:{}};return i[f].call(s.exports,s,s.exports,l),s.l=!0,s.exports}return l.m=i,l.c=o,l.d=function(f,s,g){l.o(f,s)||Object.defineProperty(f,s,{enumerable:!0,get:g})},l.r=function(f){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(f,"__esModule",{value:!0})},l.t=function(f,s){if(s&1&&(f=l(f)),s&8||s&4&&typeof f=="object"&&f&&f.__esModule)return f;var g=Object.create(null);if(l.r(g),Object.defineProperty(g,"default",{enumerable:!0,value:f}),s&2&&typeof f!="string")for(var p in f)l.d(g,p,(function(d){return f[d]}).bind(null,p));return g},l.n=function(f){var s=f&&f.__esModule?function(){return f.default}:function(){return f};return l.d(s,"a",s),s},l.o=function(f,s){return Object.prototype.hasOwnProperty.call(f,s)},l.p="/dist/",l(l.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(i,o,l){var f=Object.prototype.hasOwnProperty,s="~";function g(){}Object.create&&(g.prototype=Object.create(null),new g().__proto__||(s=!1));function p(_,x,T){this.fn=_,this.context=x,this.once=T||!1}function d(_,x,T,b,M){if(typeof T!="function")throw new TypeError("The listener must be a function");var R=new p(T,b||_,M),k=s?s+x:x;return _._events[k]?_._events[k].fn?_._events[k]=[_._events[k],R]:_._events[k].push(R):(_._events[k]=R,_._eventsCount++),_}function h(_,x){--_._eventsCount===0?_._events=new g:delete _._events[x]}function L(){this._events=new g,this._eventsCount=0}L.prototype.eventNames=function(){var x=[],T,b;if(this._eventsCount===0)return x;for(b in T=this._events)f.call(T,b)&&x.push(s?b.slice(1):b);return Object.getOwnPropertySymbols?x.concat(Object.getOwnPropertySymbols(T)):x},L.prototype.listeners=function(x){var T=s?s+x:x,b=this._events[T];if(!b)return[];if(b.fn)return[b.fn];for(var M=0,R=b.length,k=new Array(R);M<R;M++)k[M]=b[M].fn;return k},L.prototype.listenerCount=function(x){var T=s?s+x:x,b=this._events[T];return b?b.fn?1:b.length:0},L.prototype.emit=function(x,T,b,M,R,k){var j=s?s+x:x;if(!this._events[j])return!1;var N=this._events[j],H=arguments.length,G,V;if(N.fn){switch(N.once&&this.removeListener(x,N.fn,void 0,!0),H){case 1:return N.fn.call(N.context),!0;case 2:return N.fn.call(N.context,T),!0;case 3:return N.fn.call(N.context,T,b),!0;case 4:return N.fn.call(N.context,T,b,M),!0;case 5:return N.fn.call(N.context,T,b,M,R),!0;case 6:return N.fn.call(N.context,T,b,M,R,k),!0}for(V=1,G=new Array(H-1);V<H;V++)G[V-1]=arguments[V];N.fn.apply(N.context,G)}else{var J=N.length,Z;for(V=0;V<J;V++)switch(N[V].once&&this.removeListener(x,N[V].fn,void 0,!0),H){case 1:N[V].fn.call(N[V].context);break;case 2:N[V].fn.call(N[V].context,T);break;case 3:N[V].fn.call(N[V].context,T,b);break;case 4:N[V].fn.call(N[V].context,T,b,M);break;default:if(!G)for(Z=1,G=new Array(H-1);Z<H;Z++)G[Z-1]=arguments[Z];N[V].fn.apply(N[V].context,G)}}return!0},L.prototype.on=function(x,T,b){return d(this,x,T,b,!1)},L.prototype.once=function(x,T,b){return d(this,x,T,b,!0)},L.prototype.removeListener=function(x,T,b,M){var R=s?s+x:x;if(!this._events[R])return this;if(!T)return h(this,R),this;var k=this._events[R];if(k.fn)k.fn===T&&(!M||k.once)&&(!b||k.context===b)&&h(this,R);else{for(var j=0,N=[],H=k.length;j<H;j++)(k[j].fn!==T||M&&!k[j].once||b&&k[j].context!==b)&&N.push(k[j]);N.length?this._events[R]=N.length===1?N[0]:N:h(this,R)}return this},L.prototype.removeAllListeners=function(x){var T;return x?(T=s?s+x:x,this._events[T]&&h(this,T)):(this._events=new g,this._eventsCount=0),this},L.prototype.off=L.prototype.removeListener,L.prototype.addListener=L.prototype.on,L.prefixed=s,L.EventEmitter=L,i.exports=L},"./node_modules/url-toolkit/src/url-toolkit.js":function(i,o,l){(function(f){var s=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,g=/^([^\/?#]*)(.*)$/,p=/(?:\/|^)\.(?=\/)/g,d=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,h={buildAbsoluteURL:function(L,_,x){if(x=x||{},L=L.trim(),_=_.trim(),!_){if(!x.alwaysNormalize)return L;var T=h.parseURL(L);if(!T)throw new Error("Error trying to parse base URL.");return T.path=h.normalizePath(T.path),h.buildURLFromParts(T)}var b=h.parseURL(_);if(!b)throw new Error("Error trying to parse relative URL.");if(b.scheme)return x.alwaysNormalize?(b.path=h.normalizePath(b.path),h.buildURLFromParts(b)):_;var M=h.parseURL(L);if(!M)throw new Error("Error trying to parse base URL.");if(!M.netLoc&&M.path&&M.path[0]!=="/"){var R=g.exec(M.path);M.netLoc=R[1],M.path=R[2]}M.netLoc&&!M.path&&(M.path="/");var k={scheme:M.scheme,netLoc:b.netLoc,path:null,params:b.params,query:b.query,fragment:b.fragment};if(!b.netLoc&&(k.netLoc=M.netLoc,b.path[0]!=="/"))if(!b.path)k.path=M.path,b.params||(k.params=M.params,b.query||(k.query=M.query));else{var j=M.path,N=j.substring(0,j.lastIndexOf("/")+1)+b.path;k.path=h.normalizePath(N)}return k.path===null&&(k.path=x.alwaysNormalize?h.normalizePath(b.path):b.path),h.buildURLFromParts(k)},parseURL:function(L){var _=s.exec(L);return _?{scheme:_[1]||"",netLoc:_[2]||"",path:_[3]||"",params:_[4]||"",query:_[5]||"",fragment:_[6]||""}:null},normalizePath:function(L){for(L=L.split("").reverse().join("").replace(p,"");L.length!==(L=L.replace(d,"")).length;);return L.split("").reverse().join("")},buildURLFromParts:function(L){return L.scheme+L.netLoc+L.path+L.params+L.query+L.fragment}};i.exports=h})()},"./node_modules/webworkify-webpack/index.js":function(i,o,l){function f(x){var T={};function b(R){if(T[R])return T[R].exports;var k=T[R]={i:R,l:!1,exports:{}};return x[R].call(k.exports,k,k.exports,b),k.l=!0,k.exports}b.m=x,b.c=T,b.i=function(R){return R},b.d=function(R,k,j){b.o(R,k)||Object.defineProperty(R,k,{configurable:!1,enumerable:!0,get:j})},b.r=function(R){Object.defineProperty(R,"__esModule",{value:!0})},b.n=function(R){var k=R&&R.__esModule?function(){return R.default}:function(){return R};return b.d(k,"a",k),k},b.o=function(R,k){return Object.prototype.hasOwnProperty.call(R,k)},b.p="/",b.oe=function(R){throw console.error(R),R};var M=b(b.s=ENTRY_MODULE);return M.default||M}var s="[\\.|\\-|\\+|\\w|/|@]+",g="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+s+").*?\\)";function p(x){return(x+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function d(x){return!isNaN(1*x)}function h(x,T,b){var M={};M[b]=[];var R=T.toString(),k=R.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!k)return M;for(var j=k[1],N=new RegExp("(\\\\n|\\W)"+p(j)+g,"g"),H;H=N.exec(R);)H[3]!=="dll-reference"&&M[b].push(H[3]);for(N=new RegExp("\\("+p(j)+'\\("(dll-reference\\s('+s+'))"\\)\\)'+g,"g");H=N.exec(R);)x[H[2]]||(M[b].push(H[1]),x[H[2]]=l(H[1]).m),M[H[2]]=M[H[2]]||[],M[H[2]].push(H[4]);for(var G=Object.keys(M),V=0;V<G.length;V++)for(var J=0;J<M[G[V]].length;J++)d(M[G[V]][J])&&(M[G[V]][J]=1*M[G[V]][J]);return M}function L(x){var T=Object.keys(x);return T.reduce(function(b,M){return b||x[M].length>0},!1)}function _(x,T){for(var b={main:[T]},M={main:[]},R={main:{}};L(b);)for(var k=Object.keys(b),j=0;j<k.length;j++){var N=k[j],H=b[N],G=H.pop();if(R[N]=R[N]||{},!(R[N][G]||!x[N][G])){R[N][G]=!0,M[N]=M[N]||[],M[N].push(G);for(var V=h(x,x[N][G],N),J=Object.keys(V),Z=0;Z<J.length;Z++)b[J[Z]]=b[J[Z]]||[],b[J[Z]]=b[J[Z]].concat(V[J[Z]])}}return M}i.exports=function(x,T){T=T||{};var b={main:l.m},M=T.all?{main:Object.keys(b.main)}:_(b,x),R="";Object.keys(M).filter(function(G){return G!=="main"}).forEach(function(G){for(var V=0;M[G][V];)V++;M[G].push(V),b[G][V]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",R=R+"var "+G+" = ("+f.toString().replace("ENTRY_MODULE",JSON.stringify(V))+")({"+M[G].map(function(J){return""+JSON.stringify(J)+": "+b[G][J].toString()}).join(",")+`});
`}),R=R+"new (("+f.toString().replace("ENTRY_MODULE",JSON.stringify(x))+")({"+M.main.map(function(G){return""+JSON.stringify(G)+": "+b.main[G].toString()}).join(",")+"}))(self);";var k=new window.Blob([R],{type:"text/javascript"});if(T.bare)return k;var j=window.URL||window.webkitURL||window.mozURL||window.msURL,N=j.createObjectURL(k),H=new window.Worker(N);return H.objectURL=N,H}},"./src/crypt/decrypter.js":function(i,o,l){l.r(o);var f=function(){function R(j,N){this.subtle=j,this.aesIV=N}var k=R.prototype;return k.decrypt=function(N,H){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},H,N)},R}(),s=function(){function R(j,N){this.subtle=j,this.key=N}var k=R.prototype;return k.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},R}(),g=s;function p(R){var k=R.byteLength,j=k&&new DataView(R).getUint8(k-1);return j?R.slice(0,k-j):R}var d=function(){function R(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var k=R.prototype;return k.uint8ArrayToUint32Array_=function(N){for(var H=new DataView(N),G=new Uint32Array(4),V=0;V<4;V++)G[V]=H.getUint32(V*4);return G},k.initTable=function(){var N=this.sBox,H=this.invSBox,G=this.subMix,V=G[0],J=G[1],Z=G[2],ee=G[3],ge=this.invSubMix,pe=ge[0],Ee=ge[1],be=ge[2],Me=ge[3],ce=new Uint32Array(256),ve=0,fe=0,xe=0;for(xe=0;xe<256;xe++)xe<128?ce[xe]=xe<<1:ce[xe]=xe<<1^283;for(xe=0;xe<256;xe++){var we=fe^fe<<1^fe<<2^fe<<3^fe<<4;we=we>>>8^we&255^99,N[ve]=we,H[we]=ve;var ye=ce[ve],q=ce[ye],oe=ce[q],ae=ce[we]*257^we*16843008;V[ve]=ae<<24|ae>>>8,J[ve]=ae<<16|ae>>>16,Z[ve]=ae<<8|ae>>>24,ee[ve]=ae,ae=oe*16843009^q*65537^ye*257^ve*16843008,pe[we]=ae<<24|ae>>>8,Ee[we]=ae<<16|ae>>>16,be[we]=ae<<8|ae>>>24,Me[we]=ae,ve?(ve=ye^ce[ce[ce[oe^ye]]],fe^=ce[ce[fe]]):ve=fe=1}},k.expandKey=function(N){for(var H=this.uint8ArrayToUint32Array_(N),G=!0,V=0;V<H.length&&G;)G=H[V]===this.key[V],V++;if(!G){this.key=H;var J=this.keySize=H.length;if(J!==4&&J!==6&&J!==8)throw new Error("Invalid aes key size="+J);var Z=this.ksRows=(J+6+1)*4,ee,ge,pe=this.keySchedule=new Uint32Array(Z),Ee=this.invKeySchedule=new Uint32Array(Z),be=this.sBox,Me=this.rcon,ce=this.invSubMix,ve=ce[0],fe=ce[1],xe=ce[2],we=ce[3],ye,q;for(ee=0;ee<Z;ee++){if(ee<J){ye=pe[ee]=H[ee];continue}q=ye,ee%J===0?(q=q<<8|q>>>24,q=be[q>>>24]<<24|be[q>>>16&255]<<16|be[q>>>8&255]<<8|be[q&255],q^=Me[ee/J|0]<<24):J>6&&ee%J===4&&(q=be[q>>>24]<<24|be[q>>>16&255]<<16|be[q>>>8&255]<<8|be[q&255]),pe[ee]=ye=(pe[ee-J]^q)>>>0}for(ge=0;ge<Z;ge++)ee=Z-ge,ge&3?q=pe[ee]:q=pe[ee-4],ge<4||ee<=4?Ee[ge]=q:Ee[ge]=ve[be[q>>>24]]^fe[be[q>>>16&255]]^xe[be[q>>>8&255]]^we[be[q&255]],Ee[ge]=Ee[ge]>>>0}},k.networkToHostOrderSwap=function(N){return N<<24|(N&65280)<<8|(N&16711680)>>8|N>>>24},k.decrypt=function(N,H,G,V){for(var J=this.keySize+6,Z=this.invKeySchedule,ee=this.invSBox,ge=this.invSubMix,pe=ge[0],Ee=ge[1],be=ge[2],Me=ge[3],ce=this.uint8ArrayToUint32Array_(G),ve=ce[0],fe=ce[1],xe=ce[2],we=ce[3],ye=new Int32Array(N),q=new Int32Array(ye.length),oe,ae,Re,Ce,ke,De,Ne,je,Fe,ze,Ge,Ve,Xe,me,te=this.networkToHostOrderSwap;H<ye.length;){for(Fe=te(ye[H]),ze=te(ye[H+1]),Ge=te(ye[H+2]),Ve=te(ye[H+3]),ke=Fe^Z[0],De=Ve^Z[1],Ne=Ge^Z[2],je=ze^Z[3],Xe=4,me=1;me<J;me++)oe=pe[ke>>>24]^Ee[De>>16&255]^be[Ne>>8&255]^Me[je&255]^Z[Xe],ae=pe[De>>>24]^Ee[Ne>>16&255]^be[je>>8&255]^Me[ke&255]^Z[Xe+1],Re=pe[Ne>>>24]^Ee[je>>16&255]^be[ke>>8&255]^Me[De&255]^Z[Xe+2],Ce=pe[je>>>24]^Ee[ke>>16&255]^be[De>>8&255]^Me[Ne&255]^Z[Xe+3],ke=oe,De=ae,Ne=Re,je=Ce,Xe=Xe+4;oe=ee[ke>>>24]<<24^ee[De>>16&255]<<16^ee[Ne>>8&255]<<8^ee[je&255]^Z[Xe],ae=ee[De>>>24]<<24^ee[Ne>>16&255]<<16^ee[je>>8&255]<<8^ee[ke&255]^Z[Xe+1],Re=ee[Ne>>>24]<<24^ee[je>>16&255]<<16^ee[ke>>8&255]<<8^ee[De&255]^Z[Xe+2],Ce=ee[je>>>24]<<24^ee[ke>>16&255]<<16^ee[De>>8&255]<<8^ee[Ne&255]^Z[Xe+3],Xe=Xe+3,q[H]=te(oe^ve),q[H+1]=te(Ce^fe),q[H+2]=te(Re^xe),q[H+3]=te(ae^we),ve=Fe,fe=ze,xe=Ge,we=Ve,H=H+4}return V?p(q.buffer):q.buffer},k.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},R}(),h=d,L=l("./src/errors.ts"),_=l("./src/utils/logger.js"),x=l("./src/events.js"),T=l("./src/utils/get-self-scope.js"),b=Object(T.getSelfScope)(),M=function(){function R(j,N,H){var G=H===void 0?{}:H,V=G.removePKCS7Padding,J=V===void 0?!0:V;if(this.logEnabled=!0,this.observer=j,this.config=N,this.removePKCS7Padding=J,J)try{var Z=b.crypto;Z&&(this.subtle=Z.subtle||Z.webkitSubtle)}catch{}this.disableWebCrypto=!this.subtle}var k=R.prototype;return k.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},k.decrypt=function(N,H,G,V){var J=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(_.logger.log("JS AES decrypt"),this.logEnabled=!1);var Z=this.decryptor;Z||(this.decryptor=Z=new h),Z.expandKey(H),V(Z.decrypt(N,0,G,this.removePKCS7Padding))}else{this.logEnabled&&(_.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var ee=this.subtle;this.key!==H&&(this.key=H,this.fastAesKey=new g(ee,H)),this.fastAesKey.expandKey().then(function(ge){var pe=new f(ee,G);pe.decrypt(N,ge).catch(function(Ee){J.onWebCryptoError(Ee,N,H,G,V)}).then(function(Ee){V(Ee)})}).catch(function(ge){J.onWebCryptoError(ge,N,H,G,V)})}},k.onWebCryptoError=function(N,H,G,V,J){this.config.enableSoftwareAES?(_.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(H,G,V,J)):(_.logger.error("decrypting error : "+N.message),this.observer.trigger(x.default.ERROR,{type:L.ErrorTypes.MEDIA_ERROR,details:L.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:N.message}))},k.destroy=function(){var N=this.decryptor;N&&(N.destroy(),this.decryptor=void 0)},R}();o.default=M},"./src/demux/demuxer-inline.js":function(i,o,l){l.r(o);var f=l("./src/events.js"),s=l("./src/errors.ts"),g=l("./src/crypt/decrypter.js"),p=l("./src/polyfills/number.js"),d=l("./src/utils/logger.js"),h=l("./src/utils/get-self-scope.js");function L(O,U,A,S){var P,F,z,$,W,X=navigator.userAgent.toLowerCase(),se=S,ie=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(P=((U[A+2]&192)>>>6)+1,F=(U[A+2]&60)>>>2,F>ie.length-1){O.trigger(f.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+F});return}return $=(U[A+2]&1)<<2,$|=(U[A+3]&192)>>>6,d.logger.log("manifest codec:"+S+",ADTS data:type:"+P+",sampleingIndex:"+F+"["+ie[F]+"Hz],channelConfig:"+$),/firefox/i.test(X)?F>=6?(P=5,W=new Array(4),z=F-3):(P=2,W=new Array(2),z=F):X.indexOf("android")!==-1?(P=2,W=new Array(2),z=F):(P=5,W=new Array(4),S&&(S.indexOf("mp4a.40.29")!==-1||S.indexOf("mp4a.40.5")!==-1)||!S&&F>=6?z=F-3:((S&&S.indexOf("mp4a.40.2")!==-1&&(F>=6&&$===1||/vivaldi/i.test(X))||!S&&$===1)&&(P=2,W=new Array(2)),z=F)),W[0]=P<<3,W[0]|=(F&14)>>1,W[1]|=(F&1)<<7,W[1]|=$<<3,P===5&&(W[1]|=(z&14)>>1,W[2]=(z&1)<<7,W[2]|=8,W[3]=0),{config:W,samplerate:ie[F],channelCount:$,codec:"mp4a.40."+P,manifestCodec:se}}function _(O,U){return O[U]===255&&(O[U+1]&246)===240}function x(O,U){return O[U+1]&1?7:9}function T(O,U){return(O[U+3]&3)<<11|O[U+4]<<3|(O[U+5]&224)>>>5}function b(O,U){return!!(U+1<O.length&&_(O,U))}function M(O,U){if(b(O,U)){var A=x(O,U);if(U+A>=O.length)return!1;var S=T(O,U);if(S<=A)return!1;var P=U+S;if(P===O.length||P+1<O.length&&_(O,P))return!0}return!1}function R(O,U,A,S,P){if(!O.samplerate){var F=L(U,A,S,P);O.config=F.config,O.samplerate=F.samplerate,O.channelCount=F.channelCount,O.codec=F.codec,O.manifestCodec=F.manifestCodec,d.logger.log("parsed codec:"+O.codec+",rate:"+F.samplerate+",nb channel:"+F.channelCount)}}function k(O){return 1024*9e4/O}function j(O,U,A,S,P){var F,z,$,W=O.length;if(F=x(O,U),z=T(O,U),z-=F,z>0&&U+F+z<=W)return $=A+S*P,{headerLength:F,frameLength:z,stamp:$}}function N(O,U,A,S,P){var F=k(O.samplerate),z=j(U,A,S,P,F);if(z){var $=z.stamp,W=z.headerLength,X=z.frameLength,se={unit:U.subarray(A+W,A+W+X),pts:$,dts:$};return O.samples.push(se),{sample:se,length:X+W}}}var H=l("./src/demux/id3.js"),G=function(){function O(A,S,P){this.observer=A,this.config=P,this.remuxer=S}var U=O.prototype;return U.resetInitSegment=function(S,P,F,z){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:P,duration:z,inputTimeScale:9e4}},U.resetTimeStamp=function(){},O.probe=function(S){if(!S)return!1;for(var P=H.default.getID3Data(S,0)||[],F=P.length,z=S.length;F<z;F++)if(M(S,F))return d.logger.log("ADTS sync word found !"),!0;return!1},U.append=function(S,P,F,z){for(var $=this._audioTrack,W=H.default.getID3Data(S,0)||[],X=H.default.getTimeStamp(W),se=Object(p.isFiniteNumber)(X)?X*90:P*9e4,ie=0,re=se,le=S.length,he=W.length,Se=[{pts:re,dts:re,data:W}];he<le-1;)if(b(S,he)&&he+5<le){R($,this.observer,S,he,$.manifestCodec);var ue=N($,S,he,se,ie);if(ue)he+=ue.length,re=ue.sample.pts,ie++;else{d.logger.log("Unable to parse AAC frame");break}}else H.default.isHeader(S,he)?(W=H.default.getID3Data(S,he),Se.push({pts:re,dts:re,data:W}),he+=W.length):he++;this.remuxer.remux($,{samples:[]},{samples:Se,inputTimeScale:9e4},{samples:[]},P,F,z)},U.destroy=function(){},O}(),V=G,J=l("./src/demux/mp4demuxer.js"),Z={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(U,A,S,P,F){if(!(S+24>A.length)){var z=this.parseHeader(A,S);if(z&&S+z.frameLength<=A.length){var $=z.samplesPerFrame*9e4/z.sampleRate,W=P+F*$,X={unit:A.subarray(S,S+z.frameLength),pts:W,dts:W};return U.config=[],U.channelCount=z.channelCount,U.samplerate=z.sampleRate,U.samples.push(X),{sample:X,length:z.frameLength}}}},parseHeader:function(U,A){var S=U[A+1]>>3&3,P=U[A+1]>>1&3,F=U[A+2]>>4&15,z=U[A+2]>>2&3,$=U[A+2]>>1&1;if(S!==1&&F!==0&&F!==15&&z!==3){var W=S===3?3-P:P===3?3:4,X=Z.BitratesMap[W*14+F-1]*1e3,se=S===3?0:S===2?1:2,ie=Z.SamplingRateMap[se*3+z],re=U[A+3]>>6===3?1:2,le=Z.SamplesCoefficients[S][P],he=Z.BytesInSlot[P],Se=le*8*he,ue=parseInt(le*X/ie+$,10)*he;return{sampleRate:ie,channelCount:re,frameLength:ue,samplesPerFrame:Se}}},isHeaderPattern:function(U,A){return U[A]===255&&(U[A+1]&224)===224&&(U[A+1]&6)!==0},isHeader:function(U,A){return!!(A+1<U.length&&this.isHeaderPattern(U,A))},probe:function(U,A){if(A+1<U.length&&this.isHeaderPattern(U,A)){var S=4,P=this.parseHeader(U,A),F=S;P&&P.frameLength&&(F=P.frameLength);var z=A+F;if(z===U.length||z+1<U.length&&this.isHeaderPattern(U,z))return!0}return!1}},ee=Z,ge=function(){function O(A){this.data=A,this.bytesAvailable=A.byteLength,this.word=0,this.bitsAvailable=0}var U=O.prototype;return U.loadWord=function(){var S=this.data,P=this.bytesAvailable,F=S.byteLength-P,z=new Uint8Array(4),$=Math.min(4,P);if($===0)throw new Error("no bytes available");z.set(S.subarray(F,F+$)),this.word=new DataView(z.buffer).getUint32(0),this.bitsAvailable=$*8,this.bytesAvailable-=$},U.skipBits=function(S){var P;this.bitsAvailable>S?(this.word<<=S,this.bitsAvailable-=S):(S-=this.bitsAvailable,P=S>>3,S-=P>>3,this.bytesAvailable-=P,this.loadWord(),this.word<<=S,this.bitsAvailable-=S)},U.readBits=function(S){var P=Math.min(this.bitsAvailable,S),F=this.word>>>32-P;return S>32&&d.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=P,this.bitsAvailable>0?this.word<<=P:this.bytesAvailable>0&&this.loadWord(),P=S-P,P>0&&this.bitsAvailable?F<<P|this.readBits(P):F},U.skipLZ=function(){var S;for(S=0;S<this.bitsAvailable;++S)if(this.word&2147483648>>>S)return this.word<<=S,this.bitsAvailable-=S,S;return this.loadWord(),S+this.skipLZ()},U.skipUEG=function(){this.skipBits(1+this.skipLZ())},U.skipEG=function(){this.skipBits(1+this.skipLZ())},U.readUEG=function(){var S=this.skipLZ();return this.readBits(S+1)-1},U.readEG=function(){var S=this.readUEG();return 1&S?1+S>>>1:-1*(S>>>1)},U.readBoolean=function(){return this.readBits(1)===1},U.readUByte=function(){return this.readBits(8)},U.readUShort=function(){return this.readBits(16)},U.readUInt=function(){return this.readBits(32)},U.skipScalingList=function(S){var P=8,F=8,z,$;for(z=0;z<S;z++)F!==0&&($=this.readEG(),F=(P+$+256)%256),P=F===0?P:F},U.readSPS=function(){var S=0,P=0,F=0,z=0,$,W,X,se,ie,re,le,he=this.readUByte.bind(this),Se=this.readBits.bind(this),ue=this.readUEG.bind(this),Ie=this.readBoolean.bind(this),Pe=this.skipBits.bind(this),He=this.skipEG.bind(this),Ye=this.skipUEG.bind(this),Oe=this.skipScalingList.bind(this);if(he(),$=he(),Se(5),Pe(3),he(),Ye(),$===100||$===110||$===122||$===244||$===44||$===83||$===86||$===118||$===128){var Te=ue();if(Te===3&&Pe(1),Ye(),Ye(),Pe(1),Ie())for(re=Te!==3?8:12,le=0;le<re;le++)Ie()&&(le<6?Oe(16):Oe(64))}Ye();var qe=ue();if(qe===0)ue();else if(qe===1)for(Pe(1),He(),He(),W=ue(),le=0;le<W;le++)He();Ye(),Pe(1),X=ue(),se=ue(),ie=Se(1),ie===0&&Pe(1),Pe(1),Ie()&&(S=ue(),P=ue(),F=ue(),z=ue());var We=[1,1];if(Ie()&&Ie()){var lt=he();switch(lt){case 1:We=[1,1];break;case 2:We=[12,11];break;case 3:We=[10,11];break;case 4:We=[16,11];break;case 5:We=[40,33];break;case 6:We=[24,11];break;case 7:We=[20,11];break;case 8:We=[32,11];break;case 9:We=[80,33];break;case 10:We=[18,11];break;case 11:We=[15,11];break;case 12:We=[64,33];break;case 13:We=[160,99];break;case 14:We=[4,3];break;case 15:We=[3,2];break;case 16:We=[2,1];break;case 255:{We=[he()<<8|he(),he()<<8|he()];break}}}return{width:Math.ceil((X+1)*16-S*2-P*2),height:(2-ie)*(se+1)*16-(ie?2:4)*(F+z),pixelRatio:We}},U.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},O}(),pe=ge,Ee=function(){function O(A,S,P,F){this.decryptdata=P,this.discardEPB=F,this.decrypter=new g.default(A,S,{removePKCS7Padding:!1})}var U=O.prototype;return U.decryptBuffer=function(S,P){this.decrypter.decrypt(S,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,P)},U.decryptAacSample=function(S,P,F,z){var $=S[P].unit,W=$.subarray(16,$.length-$.length%16),X=W.buffer.slice(W.byteOffset,W.byteOffset+W.length),se=this;this.decryptBuffer(X,function(ie){ie=new Uint8Array(ie),$.set(ie,16),z||se.decryptAacSamples(S,P+1,F)})},U.decryptAacSamples=function(S,P,F){for(;;P++){if(P>=S.length){F();return}if(!(S[P].unit.length<32)){var z=this.decrypter.isSync();if(this.decryptAacSample(S,P,F,z),!z)return}}},U.getAvcEncryptedData=function(S){for(var P=Math.floor((S.length-48)/160)*16+16,F=new Int8Array(P),z=0,$=32;$<=S.length-16;$+=160,z+=16)F.set(S.subarray($,$+16),z);return F},U.getAvcDecryptedUnit=function(S,P){P=new Uint8Array(P);for(var F=0,z=32;z<=S.length-16;z+=160,F+=16)S.set(P.subarray(F,F+16),z);return S},U.decryptAvcSample=function(S,P,F,z,$,W){var X=this.discardEPB($.data),se=this.getAvcEncryptedData(X),ie=this;this.decryptBuffer(se.buffer,function(re){$.data=ie.getAvcDecryptedUnit(X,re),W||ie.decryptAvcSamples(S,P,F+1,z)})},U.decryptAvcSamples=function(S,P,F,z){for(;;P++,F=0){if(P>=S.length){z();return}for(var $=S[P].units;!(F>=$.length);F++){var W=$[F];if(!(W.data.length<=48||W.type!==1&&W.type!==5)){var X=this.decrypter.isSync();if(this.decryptAvcSample(S,P,F,z,W,X),!X)return}}}},O}(),be=Ee,Me={video:1,audio:2,id3:3,text:4},ce=function(){function O(A,S,P,F){this.observer=A,this.config=P,this.typeSupported=F,this.remuxer=S,this.sampleAes=null,this.pmtUnknownTypes={}}var U=O.prototype;return U.setDecryptData=function(S){S!=null&&S.key!=null&&S.method==="SAMPLE-AES"?this.sampleAes=new be(this.observer,this.config,S,this.discardEPB):this.sampleAes=null},O.probe=function(S){var P=O._syncOffset(S);return P<0?!1:(P&&d.logger.warn("MPEG2-TS detected but first sync word found @ offset "+P+", junk ahead ?"),!0)},O._syncOffset=function(S){for(var P=Math.min(1e3,S.length-564),F=0;F<P;){if(S[F]===71&&S[F+188]===71&&S[F+2*188]===71)return F;F++}return-1},O.createTrack=function(S,P){return{container:S==="video"||S==="audio"?"video/mp2t":void 0,type:S,id:Me[S],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:S==="video"?0:void 0,isAAC:S==="audio"?!0:void 0,duration:S==="audio"?P:void 0}},U.resetInitSegment=function(S,P,F,z){this.pmtParsed=!1,this._pmtId=-1,this.pmtUnknownTypes={},this._avcTrack=O.createTrack("video",z),this._audioTrack=O.createTrack("audio",z),this._id3Track=O.createTrack("id3",z),this._txtTrack=O.createTrack("text",z),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=P,this.videoCodec=F,this._duration=z},U.resetTimeStamp=function(){},U.append=function(S,P,F,z){var $,W=S.length,X,se,ie,re,le,he=!1;this.pmtUnknownTypes={},this.contiguous=F;var Se=this.pmtParsed,ue=this._avcTrack,Ie=this._audioTrack,Pe=this._id3Track,He=ue.pid,Ye=Ie.pid,Oe=Pe.pid,Te=this._pmtId,qe=ue.pesData,We=Ie.pesData,lt=Pe.pesData,dt=this._parsePAT,kt=this._parsePMT.bind(this),bt=this._parsePES,gt=this._parseAVCPES.bind(this),Ot=this._parseAACPES.bind(this),Mt=this._parseMPEGPES.bind(this),Ft=this._parseID3PES.bind(this),St=O._syncOffset(S);for(W-=(W+St)%188,$=St;$<W;$+=188)if(S[$]===71){if(X=!!(S[$+1]&64),se=((S[$+1]&31)<<8)+S[$+2],ie=(S[$+3]&48)>>4,ie>1){if(re=$+5+S[$+4],re===$+188)continue}else re=$+4;switch(se){case He:X&&(qe&&(le=bt(qe))&&gt(le,!1),qe={data:[],size:0}),qe&&(qe.data.push(S.subarray(re,$+188)),qe.size+=$+188-re);break;case Ye:X&&(We&&(le=bt(We))&&(Ie.isAAC?Ot(le):Mt(le)),We={data:[],size:0}),We&&(We.data.push(S.subarray(re,$+188)),We.size+=$+188-re);break;case Oe:X&&(lt&&(le=bt(lt))&&Ft(le),lt={data:[],size:0}),lt&&(lt.data.push(S.subarray(re,$+188)),lt.size+=$+188-re);break;case 0:X&&(re+=S[re]+1),Te=this._pmtId=dt(S,re);break;case Te:X&&(re+=S[re]+1);var ut=kt(S,re,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,this.sampleAes!=null);He=ut.avc,He>0&&(ue.pid=He),Ye=ut.audio,Ye>0&&(Ie.pid=Ye,Ie.isAAC=ut.isAAC),Oe=ut.id3,Oe>0&&(Pe.pid=Oe),he&&!Se&&(d.logger.log("reparse from beginning"),he=!1,$=St-188),Se=this.pmtParsed=!0;break;case 17:case 8191:break;default:he=!0;break}}else this.observer.trigger(f.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});qe&&(le=bt(qe))?(gt(le,!0),ue.pesData=null):ue.pesData=qe,We&&(le=bt(We))?(Ie.isAAC?Ot(le):Mt(le),Ie.pesData=null):(We&&We.size&&d.logger.log("last AAC PES packet truncated,might overlap between fragments"),Ie.pesData=We),lt&&(le=bt(lt))?(Ft(le),Pe.pesData=null):Pe.pesData=lt,this.sampleAes==null?this.remuxer.remux(Ie,ue,Pe,this._txtTrack,P,F,z):this.decryptAndRemux(Ie,ue,Pe,this._txtTrack,P,F,z)},U.decryptAndRemux=function(S,P,F,z,$,W,X){if(S.samples&&S.isAAC){var se=this;this.sampleAes.decryptAacSamples(S.samples,0,function(){se.decryptAndRemuxAvc(S,P,F,z,$,W,X)})}else this.decryptAndRemuxAvc(S,P,F,z,$,W,X)},U.decryptAndRemuxAvc=function(S,P,F,z,$,W,X){if(P.samples){var se=this;this.sampleAes.decryptAvcSamples(P.samples,0,0,function(){se.remuxer.remux(S,P,F,z,$,W,X)})}else this.remuxer.remux(S,P,F,z,$,W,X)},U.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},U._parsePAT=function(S,P){return(S[P+10]&31)<<8|S[P+11]},U._trackUnknownPmt=function(S,P,F){var z=this.pmtUnknownTypes[S]||0;return z===0&&(this.pmtUnknownTypes[S]=0,P.call(d.logger,F)),this.pmtUnknownTypes[S]++,z},U._parsePMT=function(S,P,F,z){var $,W,X,se,ie={audio:-1,avc:-1,id3:-1,isAAC:!0};for($=(S[P+1]&15)<<8|S[P+2],W=P+3+$-4,X=(S[P+10]&15)<<8|S[P+11],P+=12+X;P<W;){switch(se=(S[P+1]&31)<<8|S[P+2],S[P]){case 207:if(!z){this._trackUnknownPmt(S[P],d.logger.warn,"ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:ie.audio===-1&&(ie.audio=se);break;case 21:ie.id3===-1&&(ie.id3=se);break;case 219:if(!z){this._trackUnknownPmt(S[P],d.logger.warn,"H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:ie.avc===-1&&(ie.avc=se);break;case 3:case 4:F?ie.audio===-1&&(ie.audio=se,ie.isAAC=!1):this._trackUnknownPmt(S[P],d.logger.warn,"MPEG audio found, not supported in this browser");break;case 36:this._trackUnknownPmt(S[P],d.logger.warn,"Unsupported HEVC stream type found");break;default:this._trackUnknownPmt(S[P],d.logger.log,"Unknown stream type:"+S[P]);break}P+=((S[P+3]&15)<<8|S[P+4])+5}return ie},U._parsePES=function(S){var P=0,F,z,$,W,X,se,ie,re,le,he=S.data;if(!S||S.size===0)return null;for(;he[0].length<19&&he.length>1;){var Se=new Uint8Array(he[0].length+he[1].length);Se.set(he[0]),Se.set(he[1],he[0].length),he[0]=Se,he.splice(1,1)}if(F=he[0],$=(F[0]<<16)+(F[1]<<8)+F[2],$===1){if(W=(F[4]<<8)+F[5],W&&W>S.size-6||(z=F[7],z&192&&(ie=(F[9]&14)*536870912+(F[10]&255)*4194304+(F[11]&254)*16384+(F[12]&255)*128+(F[13]&254)/2,z&64?(re=(F[14]&14)*536870912+(F[15]&255)*4194304+(F[16]&254)*16384+(F[17]&255)*128+(F[18]&254)/2,ie-re>60*9e4&&(d.logger.warn(Math.round((ie-re)/9e4)+"s delta between PTS and DTS, align them"),ie=re)):re=ie),X=F[8],le=X+9,S.size<=le))return null;S.size-=le,se=new Uint8Array(S.size);for(var ue=0,Ie=he.length;ue<Ie;ue++){F=he[ue];var Pe=F.byteLength;if(le)if(le>Pe){le-=Pe;continue}else F=F.subarray(le),Pe-=le,le=0;se.set(F,P),P+=Pe}return W&&(W-=X+3),{data:se,pts:ie,dts:re,len:W}}else return null},U.pushAccesUnit=function(S,P){if(S.units.length&&S.frame){var F=P.samples,z=F.length;if(isNaN(S.pts))if(z){var $=F[z-1];S.pts=$.pts,S.dts=$.dts}else{P.dropped++;return}!this.config.forceKeyFrameOnDiscontinuity||S.key===!0||P.sps&&(z||this.contiguous)?(S.id=z,F.push(S)):P.dropped++}S.debug.length&&d.logger.log(S.pts+"/"+S.dts+":"+S.debug)},U._parseAVCPES=function(S,P){var F=this,z=this._avcTrack,$=this._parseAVCNALu(S.data),W,X=this.avcSample,se,ie=!1,re,le=this.pushAccesUnit.bind(this),he=function(ue,Ie,Pe,He){return{key:ue,pts:Ie,dts:Pe,units:[],debug:He}};S.data=null,X&&$.length&&!z.audFound&&(le(X,z),X=this.avcSample=he(!1,S.pts,S.dts,"")),$.forEach(function(Se){switch(Se.type){case 1:se=!0,X||(X=F.avcSample=he(!0,S.pts,S.dts,"")),X.frame=!0;var ue=Se.data;if(ie&&ue.length>4){var Ie=new pe(ue).readSliceType();(Ie===2||Ie===4||Ie===7||Ie===9)&&(X.key=!0)}break;case 5:se=!0,X||(X=F.avcSample=he(!0,S.pts,S.dts,"")),X.key=!0,X.frame=!0;break;case 6:se=!0,W=new pe(F.discardEPB(Se.data)),W.readUByte();for(var Pe=0,He=0,Ye=!1,Oe=0;!Ye&&W.bytesAvailable>1;){Pe=0;do Oe=W.readUByte(),Pe+=Oe;while(Oe===255);He=0;do Oe=W.readUByte(),He+=Oe;while(Oe===255);if(Pe===4&&W.bytesAvailable!==0){Ye=!0;var Te=W.readUByte();if(Te===181){var qe=W.readUShort();if(qe===49){var We=W.readUInt();if(We===1195456820){var lt=W.readUByte();if(lt===3){var dt=W.readUByte(),kt=W.readUByte(),bt=31&dt,gt=[dt,kt];for(re=0;re<bt;re++)gt.push(W.readUByte()),gt.push(W.readUByte()),gt.push(W.readUByte());F._insertSampleInOrder(F._txtTrack.samples,{type:3,pts:S.pts,bytes:gt})}}}}}else if(Pe===5&&W.bytesAvailable!==0){if(Ye=!0,He>16){var Ot=[];for(re=0;re<16;re++)Ot.push(W.readUByte().toString(16)),(re===3||re===5||re===7||re===9)&&Ot.push("-");var Mt=He-16,Ft=new Uint8Array(Mt);for(re=0;re<Mt;re++)Ft[re]=W.readUByte();F._insertSampleInOrder(F._txtTrack.samples,{pts:S.pts,payloadType:Pe,uuid:Ot.join(""),userDataBytes:Ft,userData:Object(H.utf8ArrayToStr)(Ft.buffer)})}}else if(He<W.bytesAvailable)for(re=0;re<He;re++)W.readUByte()}break;case 7:if(se=!0,ie=!0,!z.sps){W=new pe(Se.data);var St=W.readSPS();z.width=St.width,z.height=St.height,z.pixelRatio=St.pixelRatio,z.sps=[Se.data],z.duration=F._duration;var ut=Se.data.subarray(1,4),tr="avc1.";for(re=0;re<3;re++){var Jt=ut[re].toString(16);Jt.length<2&&(Jt="0"+Jt),tr+=Jt}z.codec=tr}break;case 8:se=!0,z.pps||(z.pps=[Se.data]);break;case 9:se=!1,z.audFound=!0,X&&le(X,z),X=F.avcSample=he(!1,S.pts,S.dts,"");break;case 12:se=!1;break;default:se=!1,X&&(X.debug+="unknown NAL "+Se.type+" ");break}if(X&&se){var Ht=X.units;Ht.push(Se)}}),P&&X&&(le(X,z),this.avcSample=null)},U._insertSampleInOrder=function(S,P){var F=S.length;if(F>0){if(P.pts>=S[F-1].pts)S.push(P);else for(var z=F-1;z>=0;z--)if(P.pts<S[z].pts){S.splice(z,0,P);break}}else S.push(P)},U._getLastNalUnit=function(){var S=this.avcSample,P;if(!S||S.units.length===0){var F=this._avcTrack,z=F.samples;S=z[z.length-1]}if(S){var $=S.units;P=$[$.length-1]}return P},U._parseAVCNALu=function(S){var P=0,F=S.byteLength,z,$,W=this._avcTrack,X=W.naluState||0,se=X,ie=[],re,le,he=-1,Se;for(X===-1&&(he=0,Se=S[0]&31,X=0,P=1);P<F;){if(z=S[P++],!X){X=z?0:1;continue}if(X===1){X=z?0:2;continue}if(!z)X=3;else if(z===1){if(he>=0)re={data:S.subarray(he,P-X-1),type:Se},ie.push(re);else{var ue=this._getLastNalUnit();if(ue&&(se&&P<=4-se&&ue.state&&(ue.data=ue.data.subarray(0,ue.data.byteLength-se)),$=P-X-1,$>0)){var Ie=new Uint8Array(ue.data.byteLength+$);Ie.set(ue.data,0),Ie.set(S.subarray(0,$),ue.data.byteLength),ue.data=Ie}}P<F?(le=S[P]&31,he=P,Se=le,X=0):X=-1}else X=0}if(he>=0&&X>=0&&(re={data:S.subarray(he,F),type:Se,state:X},ie.push(re)),ie.length===0){var Pe=this._getLastNalUnit();if(Pe){var He=new Uint8Array(Pe.data.byteLength+S.byteLength);He.set(Pe.data,0),He.set(S,Pe.data.byteLength),Pe.data=He}}return W.naluState=X,ie},U.discardEPB=function(S){for(var P=S.byteLength,F=[],z=1,$,W;z<P-2;)S[z]===0&&S[z+1]===0&&S[z+2]===3?(F.push(z+2),z+=2):z++;if(F.length===0)return S;$=P-F.length,W=new Uint8Array($);var X=0;for(z=0;z<$;X++,z++)X===F[0]&&(X++,F.shift()),W[z]=S[X];return W},U._parseAACPES=function(S){var P=this._audioTrack,F=S.data,z=S.pts,$=0,W=this.aacOverFlow,X=this.aacLastPTS,se,ie,re,le,he;if(W){var Se=new Uint8Array(W.byteLength+F.byteLength);Se.set(W,0),Se.set(F,W.byteLength),F=Se}for(re=$,he=F.length;re<he-1&&!b(F,re);re++);if(re){var ue,Ie;if(re<he-1?(ue="AAC PES did not start with ADTS header,offset:"+re,Ie=!1):(ue="no ADTS header found in AAC PES",Ie=!0),d.logger.warn("parsing error:"+ue),this.observer.trigger(f.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_PARSING_ERROR,fatal:Ie,reason:ue}),Ie)return}if(R(P,this.observer,F,re,this.audioCodec),ie=0,se=k(P.samplerate),W&&X){var Pe=X+se;Math.abs(Pe-z)>1&&(d.logger.log("AAC: align PTS for overlapping frames by "+Math.round((Pe-z)/90)),z=Pe)}for(;re<he;)if(b(F,re)){if(re+5<he){var He=N(P,F,re,z,ie);if(He){re+=He.length,le=He.sample.pts,ie++;continue}}break}else re++;re<he?W=F.subarray(re,he):W=null,this.aacOverFlow=W,this.aacLastPTS=le},U._parseMPEGPES=function(S){for(var P=S.data,F=P.length,z=0,$=0,W=S.pts;$<F;)if(ee.isHeader(P,$)){var X=ee.appendFrame(this._audioTrack,P,$,W,z);if(X)$+=X.length,z++;else break}else $++},U._parseID3PES=function(S){this._id3Track.samples.push(S)},O}(),ve=ce,fe=function(){function O(A,S,P){this.observer=A,this.config=P,this.remuxer=S}var U=O.prototype;return U.resetInitSegment=function(S,P,F,z){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:P,duration:z,inputTimeScale:9e4}},U.resetTimeStamp=function(){},O.probe=function(S){var P,F,z=H.default.getID3Data(S,0);if(z&&H.default.getTimeStamp(z)!==void 0){for(P=z.length,F=Math.min(S.length-1,P+100);P<F;P++)if(ee.probe(S,P))return d.logger.log("MPEG Audio sync word found !"),!0}return!1},U.append=function(S,P,F,z){for(var $=H.default.getID3Data(S,0)||[],W=H.default.getTimeStamp($),X=W!==void 0?90*W:P*9e4,se=$.length,ie=S.length,re=0,le=0,he=this._audioTrack,Se=[{pts:X,dts:X,data:$}];se<ie;)if(ee.isHeader(S,se)){var ue=ee.appendFrame(he,S,se,X,re);if(ue)se+=ue.length,le=ue.sample.pts,re++;else break}else H.default.isHeader(S,se)?($=H.default.getID3Data(S,se),Se.push({pts:le,dts:le,data:$}),se+=$.length):se++;this.remuxer.remux(he,{samples:[]},{samples:Se,inputTimeScale:9e4},{samples:[]},P,F,z)},U.destroy=function(){},O}(),xe=fe,we=function(){function O(){}return O.getSilentFrame=function(A,S){switch(A){case"mp4a.40.2":if(S===1)return new Uint8Array([0,200,0,128,35,128]);if(S===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(S===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(S===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(S===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(S===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(S===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(S===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(S===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}return null},O}(),ye=we,q=Math.pow(2,32)-1,oe=function(){function O(){}return O.init=function(){O.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var A;for(A in O.types)O.types.hasOwnProperty(A)&&(O.types[A]=[A.charCodeAt(0),A.charCodeAt(1),A.charCodeAt(2),A.charCodeAt(3)]);var S=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),P=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);O.HDLR_TYPES={video:S,audio:P};var F=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),z=new Uint8Array([0,0,0,0,0,0,0,0]);O.STTS=O.STSC=O.STCO=z,O.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),O.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),O.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),O.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var $=new Uint8Array([105,115,111,109]),W=new Uint8Array([97,118,99,49]),X=new Uint8Array([0,0,0,1]);O.FTYP=O.box(O.types.ftyp,$,X,$,W),O.DINF=O.box(O.types.dinf,O.box(O.types.dref,F))},O.box=function(A){for(var S=Array.prototype.slice.call(arguments,1),P=8,F=S.length,z=F,$;F--;)P+=S[F].byteLength;for($=new Uint8Array(P),$[0]=P>>24&255,$[1]=P>>16&255,$[2]=P>>8&255,$[3]=P&255,$.set(A,4),F=0,P=8;F<z;F++)$.set(S[F],P),P+=S[F].byteLength;return $},O.hdlr=function(A){return O.box(O.types.hdlr,O.HDLR_TYPES[A])},O.mdat=function(A){return O.box(O.types.mdat,A)},O.mdhd=function(A,S){S*=A;var P=Math.floor(S/(q+1)),F=Math.floor(S%(q+1));return O.box(O.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,A>>24&255,A>>16&255,A>>8&255,A&255,P>>24,P>>16&255,P>>8&255,P&255,F>>24,F>>16&255,F>>8&255,F&255,85,196,0,0]))},O.mdia=function(A){return O.box(O.types.mdia,O.mdhd(A.timescale,A.duration),O.hdlr(A.type),O.minf(A))},O.mfhd=function(A){return O.box(O.types.mfhd,new Uint8Array([0,0,0,0,A>>24,A>>16&255,A>>8&255,A&255]))},O.minf=function(A){return A.type==="audio"?O.box(O.types.minf,O.box(O.types.smhd,O.SMHD),O.DINF,O.stbl(A)):O.box(O.types.minf,O.box(O.types.vmhd,O.VMHD),O.DINF,O.stbl(A))},O.moof=function(A,S,P){return O.box(O.types.moof,O.mfhd(A),O.traf(P,S))},O.moov=function(A){for(var S=A.length,P=[];S--;)P[S]=O.trak(A[S]);return O.box.apply(null,[O.types.moov,O.mvhd(A[0].timescale,A[0].duration)].concat(P).concat(O.mvex(A)))},O.mvex=function(A){for(var S=A.length,P=[];S--;)P[S]=O.trex(A[S]);return O.box.apply(null,[O.types.mvex].concat(P))},O.mvhd=function(A,S){S*=A;var P=Math.floor(S/(q+1)),F=Math.floor(S%(q+1)),z=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,A>>24&255,A>>16&255,A>>8&255,A&255,P>>24,P>>16&255,P>>8&255,P&255,F>>24,F>>16&255,F>>8&255,F&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return O.box(O.types.mvhd,z)},O.sdtp=function(A){var S=A.samples||[],P=new Uint8Array(4+S.length),F,z;for(z=0;z<S.length;z++)F=S[z].flags,P[z+4]=F.dependsOn<<4|F.isDependedOn<<2|F.hasRedundancy;return O.box(O.types.sdtp,P)},O.stbl=function(A){return O.box(O.types.stbl,O.stsd(A),O.box(O.types.stts,O.STTS),O.box(O.types.stsc,O.STSC),O.box(O.types.stsz,O.STSZ),O.box(O.types.stco,O.STCO))},O.avc1=function(A){var S=[],P=[],F,z,$;for(F=0;F<A.sps.length;F++)z=A.sps[F],$=z.byteLength,S.push($>>>8&255),S.push($&255),S=S.concat(Array.prototype.slice.call(z));for(F=0;F<A.pps.length;F++)z=A.pps[F],$=z.byteLength,P.push($>>>8&255),P.push($&255),P=P.concat(Array.prototype.slice.call(z));var W=O.box(O.types.avcC,new Uint8Array([1,S[3],S[4],S[5],255,224|A.sps.length].concat(S).concat([A.pps.length]).concat(P))),X=A.width,se=A.height,ie=A.pixelRatio[0],re=A.pixelRatio[1];return O.box(O.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,X>>8&255,X&255,se>>8&255,se&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),W,O.box(O.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),O.box(O.types.pasp,new Uint8Array([ie>>24,ie>>16&255,ie>>8&255,ie&255,re>>24,re>>16&255,re>>8&255,re&255])))},O.esds=function(A){var S=A.config.length;return new Uint8Array([0,0,0,0,3,23+S,0,1,0,4,15+S,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([S]).concat(A.config).concat([6,1,2]))},O.mp4a=function(A){var S=A.samplerate;return O.box(O.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,A.channelCount,0,16,0,0,0,0,S>>8&255,S&255,0,0]),O.box(O.types.esds,O.esds(A)))},O.mp3=function(A){var S=A.samplerate;return O.box(O.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,A.channelCount,0,16,0,0,0,0,S>>8&255,S&255,0,0]))},O.stsd=function(A){return A.type==="audio"?!A.isAAC&&A.codec==="mp3"?O.box(O.types.stsd,O.STSD,O.mp3(A)):O.box(O.types.stsd,O.STSD,O.mp4a(A)):O.box(O.types.stsd,O.STSD,O.avc1(A))},O.tkhd=function(A){var S=A.id,P=A.duration*A.timescale,F=A.width,z=A.height,$=Math.floor(P/(q+1)),W=Math.floor(P%(q+1));return O.box(O.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,S>>24&255,S>>16&255,S>>8&255,S&255,0,0,0,0,$>>24,$>>16&255,$>>8&255,$&255,W>>24,W>>16&255,W>>8&255,W&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,F>>8&255,F&255,0,0,z>>8&255,z&255,0,0]))},O.traf=function(A,S){var P=O.sdtp(A),F=A.id,z=Math.floor(S/(q+1)),$=Math.floor(S%(q+1));return O.box(O.types.traf,O.box(O.types.tfhd,new Uint8Array([0,0,0,0,F>>24,F>>16&255,F>>8&255,F&255])),O.box(O.types.tfdt,new Uint8Array([1,0,0,0,z>>24,z>>16&255,z>>8&255,z&255,$>>24,$>>16&255,$>>8&255,$&255])),O.trun(A,P.length+16+20+8+16+8+8),P)},O.trak=function(A){return A.duration=A.duration||4294967295,O.box(O.types.trak,O.tkhd(A),O.mdia(A))},O.trex=function(A){var S=A.id;return O.box(O.types.trex,new Uint8Array([0,0,0,0,S>>24,S>>16&255,S>>8&255,S&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},O.trun=function(A,S){var P=A.samples||[],F=P.length,z=12+16*F,$=new Uint8Array(z),W,X,se,ie,re,le;for(S+=8+z,$.set([0,0,15,1,F>>>24&255,F>>>16&255,F>>>8&255,F&255,S>>>24&255,S>>>16&255,S>>>8&255,S&255],0),W=0;W<F;W++)X=P[W],se=X.duration,ie=X.size,re=X.flags,le=X.cts,$.set([se>>>24&255,se>>>16&255,se>>>8&255,se&255,ie>>>24&255,ie>>>16&255,ie>>>8&255,ie&255,re.isLeading<<2|re.dependsOn,re.isDependedOn<<6|re.hasRedundancy<<4|re.paddingValue<<1|re.isNonSync,re.degradPrio&61440,re.degradPrio&15,le>>>24&255,le>>>16&255,le>>>8&255,le&255],12+16*W);return O.box(O.types.trun,$)},O.initSegment=function(A){O.types||O.init();var S=O.moov(A),P;return P=new Uint8Array(O.FTYP.byteLength+S.byteLength),P.set(O.FTYP),P.set(S,O.FTYP.byteLength),P},O}(),ae=oe,Re=9e4;function Ce(O,U,A,S){A===void 0&&(A=1),S===void 0&&(S=!1);var P=O*U*A;return S?Math.round(P):P}function ke(O,U){return U===void 0&&(U=!1),Ce(O,1e3,1/Re,U)}function De(O,U){return U===void 0&&(U=1),Ce(O,Re,1/U)}var Ne=De(10),je=De(.2),Fe=null,ze=function(){function O(A,S,P,F){if(this.observer=A,this.config=S,this.typeSupported=P,this.ISGenerated=!1,Fe===null){var z=navigator.userAgent.match(/Chrome\/(\d+)/i);Fe=z?parseInt(z[1]):0}}var U=O.prototype;return U.destroy=function(){},U.resetTimeStamp=function(S){this._initPTS=this._initDTS=S},U.resetInitSegment=function(){this.ISGenerated=!1},U.getVideoStartPts=function(S){var P=!1,F=S.reduce(function(z,$){var W=$.pts-z;return W<-4294967296?(P=!0,Ge(z,$.pts)):W>0?z:$.pts},S[0].pts);return P&&d.logger.debug("PTS rollover detected"),F},U.remux=function(S,P,F,z,$,W,X){if(this.ISGenerated||this.generateIS(S,P,$),this.ISGenerated){var se=S.samples.length,ie=P.samples.length,re=$,le=$;if(se&&ie){var he=this.getVideoStartPts(P.samples),Se=Ge(S.samples[0].pts,he)-he,ue=Se/P.inputTimeScale;re+=Math.max(0,ue),le+=Math.max(0,-ue)}if(se){S.timescale||(d.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(S,P,$));var Ie=this.remuxAudio(S,re,W,X);if(ie){var Pe;Ie&&(Pe=Ie.endPTS-Ie.startPTS),P.timescale||(d.logger.warn("regenerate InitSegment as video detected"),this.generateIS(S,P,$)),this.remuxVideo(P,le,W,Pe)}}else if(ie){var He=this.remuxVideo(P,le,W,0,X);He&&S.codec&&this.remuxEmptyAudio(S,re,W,He)}}F.samples.length&&this.remuxID3(F,$),z.samples.length&&this.remuxText(z,$),this.observer.trigger(f.default.FRAG_PARSED)},U.generateIS=function(S,P,F){var z=this.observer,$=S.samples,W=P.samples,X=this.typeSupported,se="audio/mp4",ie={},re={tracks:ie},le=this._initPTS===void 0,he,Se;if(le&&(he=Se=1/0),S.config&&$.length&&(S.timescale=S.samplerate,d.logger.log("audio sampling rate : "+S.samplerate),S.isAAC||(X.mpeg?(se="audio/mpeg",S.codec=""):X.mp3&&(S.codec="mp3")),ie.audio={container:se,codec:S.codec,initSegment:!S.isAAC&&X.mpeg?new Uint8Array:ae.initSegment([S]),metadata:{channelCount:S.channelCount}},le&&(he=Se=$[0].pts-Math.round(S.inputTimeScale*F))),P.sps&&P.pps&&W.length){var ue=P.inputTimeScale;if(P.timescale=ue,ie.video={container:"video/mp4",codec:P.codec,initSegment:ae.initSegment([P]),metadata:{width:P.width,height:P.height}},le){var Ie=this.getVideoStartPts(W),Pe=Math.round(ue*F);Se=Math.min(Se,Ge(W[0].dts,Ie)-Pe),he=Math.min(he,Ie-Pe),this.observer.trigger(f.default.INIT_PTS_FOUND,{initPTS:he})}}else le&&ie.audio&&this.observer.trigger(f.default.INIT_PTS_FOUND,{initPTS:he});Object.keys(ie).length?(z.trigger(f.default.FRAG_PARSING_INIT_SEGMENT,re),this.ISGenerated=!0,le&&(this._initPTS=he,this._initDTS=Se)):z.trigger(f.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},U.remuxVideo=function(S,P,F,z){var $=S.timescale,W=S.samples,X=[],se=W.length,ie=this._initPTS,re=8,le,he,Se,ue,Ie,Pe=Number.POSITIVE_INFINITY,He=Number.NEGATIVE_INFINITY,Ye=0,Oe=!1,Te=this.nextAvcDts;if(se!==0){if(!F){var qe=P*$,We=W[0].pts-Ge(W[0].dts,W[0].pts);Te=qe-We}for(var lt=0;lt<se;lt++){var dt=W[lt];dt.pts=Ge(dt.pts-ie,Te),dt.dts=Ge(dt.dts-ie,Te),dt.dts>dt.pts&&(Ye=Math.max(Math.min(Ye,dt.pts-dt.dts),-1*je)),dt.dts<W[lt>0?lt-1:lt].dts&&(Oe=!0)}Oe&&W.sort(function(Zr,pn){var mi=Zr.dts-pn.dts,pi=Zr.pts-pn.pts;return mi||pi||Zr.id-pn.id}),ue=W[0].dts,Ie=W[se-1].dts;var kt=Math.round((Ie-ue)/(se-1));if(Ye<0){if(Ye<kt*-2){d.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+ke(-kt,!0)+" ms");for(var bt=Ye,gt=0;gt<se;gt++)W[gt].dts=bt=Math.max(bt,W[gt].pts-kt),W[gt].pts=Math.max(bt,W[gt].pts)}else{d.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+ke(Ye,!0)+" ms to overcome this issue");for(var Ot=0;Ot<se;Ot++)W[Ot].dts=W[Ot].dts+Ye}ue=W[0].dts,Ie=W[se-1].dts}if(F){var Mt=ue-Te,Ft=Mt>kt,St=Mt<-1;if(Ft||St){Ft?d.logger.warn("AVC: "+ke(Mt,!0)+" ms ("+Mt+"dts) hole between fragments detected, filling it"):d.logger.warn("AVC: "+ke(-Mt,!0)+" ms ("+Mt+"dts) overlapping between fragments detected"),ue=Te;var ut=W[0].pts-Mt;W[0].dts=ue,W[0].pts=ut,d.logger.log("Video: First PTS/DTS adjusted: "+ke(ut,!0)+"/"+ke(ue,!0)+", delta: "+ke(Mt,!0)+" ms")}}Fe&&Fe<75&&(ue=Math.max(0,ue));for(var tr=0,Jt=0,Ht=0;Ht<se;Ht++){for(var At=W[Ht],Zt=At.units,at=Zt.length,Je=0,ot=0;ot<at;ot++)Je+=Zt[ot].data.length;Jt+=Je,tr+=at,At.length=Je,At.dts=Math.max(At.dts,ue),At.pts=Math.max(At.pts,At.dts,0),Pe=Math.min(At.pts,Pe),He=Math.max(At.pts,He)}Ie=W[se-1].dts;var ft=Jt+4*tr+8;try{he=new Uint8Array(ft)}catch{this.observer.trigger(f.default.ERROR,{type:s.ErrorTypes.MUX_ERROR,details:s.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:ft,reason:"fail allocating video mdat "+ft});return}var mt=new DataView(he.buffer);mt.setUint32(0,ft),he.set(ae.types.mdat,4);for(var ne=0;ne<se;ne++){for(var vt=W[ne],Ut=vt.units,qt=0,Vt=void 0,ur=0,br=Ut.length;ur<br;ur++){var qr=Ut[ur],hi=qr.data,gn=qr.data.byteLength;mt.setUint32(re,gn),re+=4,he.set(hi,re),re+=gn,qt+=4+gn}if(ne<se-1)le=W[ne+1].dts-vt.dts;else{var In=this.config,Nr=vt.dts-W[ne>0?ne-1:ne].dts;if(In.stretchShortVideoTrack){var gi=In.maxBufferHole,mn=Math.floor(gi*$),Jr=(z?Pe+z*$:this.nextAudioPts)-vt.pts;Jr>mn?(le=Jr-Nr,le<0&&(le=Nr),d.logger.log("It is approximately "+ke(Jr,!1)+" ms to the next segment; using duration "+ke(le,!1)+" ms for the last video frame.")):le=Nr}else le=Nr}Vt=Math.round(vt.pts-vt.dts),X.push({size:qt,duration:le,cts:Vt,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:vt.key?2:1,isNonSync:vt.key?0:1}})}this.nextAvcDts=Ie+le;var Yr=S.dropped;if(S.nbNalu=0,S.dropped=0,X.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var Pn=X[0].flags;Pn.dependsOn=2,Pn.isNonSync=0}S.samples=X,Se=ae.moof(S.sequenceNumber++,ue,S),S.samples=[];var On={data1:Se,data2:he,startPTS:Pe/$,endPTS:(He+le)/$,startDTS:ue/$,endDTS:this.nextAvcDts/$,type:"video",hasAudio:!1,hasVideo:!0,nb:X.length,dropped:Yr};return this.observer.trigger(f.default.FRAG_PARSING_DATA,On),On}},U.remuxAudio=function(S,P,F,z){var $=S.inputTimeScale,W=S.timescale,X=$/W,se=S.isAAC?1024:1152,ie=se*X,re=this._initPTS,le=!S.isAAC&&this.typeSupported.mpeg,he,Se,ue,Ie,Pe,He,Ye=le?0:8,Oe=S.samples,Te=[],qe=this.nextAudioPts;if(F|=Oe.length&&qe&&(z&&Math.abs(P-qe/$)<.1||Math.abs(Oe[0].pts-qe-re)<20*ie),Oe.forEach(function(Vt){Vt.pts=Vt.dts=Ge(Vt.pts-re,P*$)}),Oe=Oe.filter(function(Vt){return Vt.pts>=0}),Oe.length!==0){if(F||(z?qe=Math.max(0,P*$):qe=Oe[0].pts),S.isAAC)for(var We=this.config.maxAudioFramesDrift,lt=0,dt=qe;lt<Oe.length;){var kt=Oe[lt],bt=kt.pts,gt=bt-dt;if(gt<=-We*ie)F||lt>0?(d.logger.warn("Dropping 1 audio frame @ "+ke(dt,!0)/1e3+"s due to "+ke(gt,!0)+" ms overlap."),Oe.splice(lt,1)):(d.logger.warn("Audio frame @ "+ke(bt,!0)/1e3+"s overlaps nextAudioPts by "+ke(gt,!0)+" ms."),dt=bt+ie,lt++);else if(gt>=We*ie&&gt<Ne&&dt){var Ot=Math.round(gt/ie);d.logger.warn("Injecting "+Ot+" audio frames @ "+ke(dt,!0)/1e3+"s due to "+ke(gt,!0)+" ms gap.");for(var Mt=0;Mt<Ot;Mt++){var Ft=Math.max(dt,0);Se=ye.getSilentFrame(S.manifestCodec||S.codec,S.channelCount),Se||(d.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),Se=kt.unit.subarray()),Oe.splice(lt,0,{unit:Se,pts:Ft,dts:Ft}),dt+=ie,lt++}kt.pts=kt.dts=dt,dt+=ie,lt++}else kt.pts=kt.dts=dt,dt+=ie,lt++}for(var St=Oe.length,ut=0;St--;)ut+=Oe[St].unit.byteLength;for(var tr=0,Jt=Oe.length;tr<Jt;tr++){var Ht=Oe[tr],At=Ht.unit,Zt=Ht.pts;if(He!==void 0&&he)he.duration=Math.round((Zt-He)/X);else{var at=Zt-qe,Je=0;if(F&&S.isAAC&&at){if(at>0&&at<Ne)Je=Math.round((Zt-qe)/ie),d.logger.log(ke(at,!0)+" ms hole between AAC samples detected,filling it"),Je>0&&(Se=ye.getSilentFrame(S.manifestCodec||S.codec,S.channelCount),Se||(Se=At.subarray()),ut+=Je*Se.length);else if(at<-12){d.logger.log("drop overlapping AAC sample, expected/parsed/delta: "+ke(qe,!0)+" ms / "+ke(Zt,!0)+" ms / "+ke(-at,!0)+" ms"),ut-=At.byteLength;continue}Zt=qe}if(Pe=Zt,ut>0){ut+=Ye;try{ue=new Uint8Array(ut)}catch{this.observer.trigger(f.default.ERROR,{type:s.ErrorTypes.MUX_ERROR,details:s.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:ut,reason:"fail allocating audio mdat "+ut});return}if(!le){var ot=new DataView(ue.buffer);ot.setUint32(0,ut),ue.set(ae.types.mdat,4)}}else return;for(var ft=0;ft<Je;ft++)Se=ye.getSilentFrame(S.manifestCodec||S.codec,S.channelCount),Se||(d.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),Se=At.subarray()),ue.set(Se,Ye),Ye+=Se.byteLength,he={size:Se.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},Te.push(he)}ue.set(At,Ye);var mt=At.byteLength;Ye+=mt,he={size:mt,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},Te.push(he),He=Zt}var ne=0;if(St=Te.length,St>=2&&(ne=Te[St-2].duration,he.duration=ne),St){this.nextAudioPts=qe=He+X*ne,S.samples=Te,le?Ie=new Uint8Array:Ie=ae.moof(S.sequenceNumber++,Pe/X,S),S.samples=[];var vt=Pe/$,Ut=qe/$,qt={data1:Ie,data2:ue,startPTS:vt,endPTS:Ut,startDTS:vt,endDTS:Ut,type:"audio",hasAudio:!0,hasVideo:!1,nb:St};return this.observer.trigger(f.default.FRAG_PARSING_DATA,qt),qt}return null}},U.remuxEmptyAudio=function(S,P,F,z){var $=S.inputTimeScale,W=S.samplerate?S.samplerate:$,X=$/W,se=this.nextAudioPts,ie=(se!==void 0?se:z.startDTS*$)+this._initDTS,re=z.endDTS*$+this._initDTS,le=1024,he=X*le,Se=Math.ceil((re-ie)/he),ue=ye.getSilentFrame(S.manifestCodec||S.codec,S.channelCount);if(d.logger.warn("remux empty Audio"),!ue){d.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");return}for(var Ie=[],Pe=0;Pe<Se;Pe++){var He=ie+Pe*he;Ie.push({unit:ue,pts:He,dts:He})}S.samples=Ie,this.remuxAudio(S,P,F)},U.remuxID3=function(S,P){var F=S.samples.length;if(F){for(var z=S.inputTimeScale,$=this._initPTS,W=this._initDTS,X=0;X<F;X++){var se=S.samples[X];se.pts=Ge(se.pts-$,P*z)/z,se.dts=Ge(se.dts-W,P*z)/z}this.observer.trigger(f.default.FRAG_PARSING_METADATA,{samples:S.samples}),S.samples=[]}},U.remuxText=function(S,P){var F=S.samples.length,z=S.inputTimeScale,$=this._initPTS;if(F){for(var W=0;W<F;W++){var X=S.samples[W];X.pts=Ge(X.pts-$,P*z)/z}S.samples.sort(function(se,ie){return se.pts-ie.pts}),this.observer.trigger(f.default.FRAG_PARSING_USERDATA,{samples:S.samples})}S.samples=[]},O}();function Ge(O,U){var A;if(U===void 0)return O;for(U<O?A=-8589934592:A=8589934592;Math.abs(O-U)>4294967296;)O+=A;return O}var Ve=ze,Xe=function(){function O(A){this.observer=A}var U=O.prototype;return U.destroy=function(){},U.resetTimeStamp=function(){},U.resetInitSegment=function(){},U.remux=function(S,P,F,z,$,W,X,se){var ie=this.observer,re="";S&&(re+="audio"),P&&(re+="video"),ie.trigger(f.default.FRAG_PARSING_DATA,{data1:se,startPTS:$,startDTS:$,type:re,hasAudio:!!S,hasVideo:!!P,nb:1,dropped:0}),ie.trigger(f.default.FRAG_PARSED)},O}(),me=Xe,te=Object(h.getSelfScope)(),de;try{de=te.performance.now.bind(te.performance)}catch{d.logger.debug("Unable to use Performance API on this environment"),de=te.Date.now}var Ae=function(){function O(A,S,P,F){this.observer=A,this.typeSupported=S,this.config=P,this.vendor=F}var U=O.prototype;return U.destroy=function(){var S=this.demuxer;S&&S.destroy()},U.push=function(S,P,F,z,$,W,X,se,ie,re,le,he){var Se=this;if(S.byteLength>0&&P!=null&&P.key!=null&&P.method==="AES-128"){var ue=this.decrypter;ue==null&&(ue=this.decrypter=new g.default(this.observer,this.config));var Ie=de();ue.decrypt(S,P.key.buffer,P.iv.buffer,function(Pe){var He=de();Se.observer.trigger(f.default.FRAG_DECRYPTED,{stats:{tstart:Ie,tdecrypt:He}}),Se.pushDecrypted(new Uint8Array(Pe),P,new Uint8Array(F),z,$,W,X,se,ie,re,le,he)})}else this.pushDecrypted(new Uint8Array(S),P,new Uint8Array(F),z,$,W,X,se,ie,re,le,he)},U.pushDecrypted=function(S,P,F,z,$,W,X,se,ie,re,le,he){var Se=this.demuxer,ue=this.remuxer;if(!Se||X||se){for(var Ie=this.observer,Pe=this.typeSupported,He=this.config,Ye=[{demux:ve,remux:Ve},{demux:J.default,remux:me},{demux:V,remux:Ve},{demux:xe,remux:Ve}],Oe,Te=0,qe=Ye.length;Te<qe&&(Oe=Ye[Te],!Oe.demux.probe(S));Te++);if(!Oe){Ie.trigger(f.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});return}(!ue||!(ue instanceof Oe.remux))&&(ue=new Oe.remux(Ie,He,Pe,this.vendor)),(!Se||!(Se instanceof Oe.demux))&&(Se=new Oe.demux(Ie,ue,He,Pe),this.probe=Oe.demux.probe),this.demuxer=Se,this.remuxer=ue}(X||se)&&(Se.resetInitSegment(F,z,$,re),ue.resetInitSegment()),X&&(Se.resetTimeStamp(he),ue.resetTimeStamp(he)),typeof Se.setDecryptData=="function"&&Se.setDecryptData(P),Se.append(S,W,ie,le)},O}();o.default=Ae},"./src/demux/demuxer-worker.js":function(i,o,l){l.r(o);var f=l("./src/demux/demuxer-inline.js"),s=l("./src/events.js"),g=l("./src/utils/logger.js"),p=l("./node_modules/eventemitter3/index.js"),d=function(L){var _=new p.EventEmitter;_.trigger=function(b){for(var M=arguments.length,R=new Array(M>1?M-1:0),k=1;k<M;k++)R[k-1]=arguments[k];_.emit.apply(_,[b,b].concat(R))},_.off=function(b){for(var M=arguments.length,R=new Array(M>1?M-1:0),k=1;k<M;k++)R[k-1]=arguments[k];_.removeListener.apply(_,[b].concat(R))};var x=function(b,M){L.postMessage({event:b,data:M})};L.addEventListener("message",function(T){var b=T.data;switch(b.cmd){case"init":var M=JSON.parse(b.config);L.demuxer=new f.default(_,b.typeSupported,M,b.vendor),Object(g.enableLogs)(M.debug),x("init",null);break;case"demux":L.demuxer.push(b.data,b.decryptdata,b.initSegment,b.audioCodec,b.videoCodec,b.timeOffset,b.discontinuity,b.trackSwitch,b.contiguous,b.duration,b.accurateTimeOffset,b.defaultInitPTS);break}}),_.on(s.default.FRAG_DECRYPTED,x),_.on(s.default.FRAG_PARSING_INIT_SEGMENT,x),_.on(s.default.FRAG_PARSED,x),_.on(s.default.ERROR,x),_.on(s.default.FRAG_PARSING_METADATA,x),_.on(s.default.FRAG_PARSING_USERDATA,x),_.on(s.default.INIT_PTS_FOUND,x),_.on(s.default.FRAG_PARSING_DATA,function(T,b){var M=[],R={event:T,data:b};b.data1&&(R.data1=b.data1.buffer,M.push(b.data1.buffer),delete b.data1),b.data2&&(R.data2=b.data2.buffer,M.push(b.data2.buffer),delete b.data2),L.postMessage(R,M)})};o.default=d},"./src/demux/id3.js":function(i,o,l){l.r(o),l.d(o,"utf8ArrayToStr",function(){return d});var f=l("./src/utils/get-self-scope.js"),s=function(){function h(){}return h.isHeader=function(_,x){return x+10<=_.length&&_[x]===73&&_[x+1]===68&&_[x+2]===51&&_[x+3]<255&&_[x+4]<255&&_[x+6]<128&&_[x+7]<128&&_[x+8]<128&&_[x+9]<128},h.isFooter=function(_,x){return x+10<=_.length&&_[x]===51&&_[x+1]===68&&_[x+2]===73&&_[x+3]<255&&_[x+4]<255&&_[x+6]<128&&_[x+7]<128&&_[x+8]<128&&_[x+9]<128},h.getID3Data=function(_,x){for(var T=x,b=0;h.isHeader(_,x);){b+=10;var M=h._readSize(_,x+6);b+=M,h.isFooter(_,x+10)&&(b+=10),x+=b}if(b>0)return _.subarray(T,T+b)},h._readSize=function(_,x){var T=0;return T=(_[x]&127)<<21,T|=(_[x+1]&127)<<14,T|=(_[x+2]&127)<<7,T|=_[x+3]&127,T},h.getTimeStamp=function(_){for(var x=h.getID3Frames(_),T=0;T<x.length;T++){var b=x[T];if(h.isTimeStampFrame(b))return h._readTimeStamp(b)}},h.isTimeStampFrame=function(_){return _&&_.key==="PRIV"&&_.info==="com.apple.streaming.transportStreamTimestamp"},h._getFrameData=function(_){var x=String.fromCharCode(_[0],_[1],_[2],_[3]),T=h._readSize(_,4),b=10;return{type:x,size:T,data:_.subarray(b,b+T)}},h.getID3Frames=function(_){for(var x=0,T=[];h.isHeader(_,x);){var b=h._readSize(_,x+6);x+=10;for(var M=x+b;x+8<M;){var R=h._getFrameData(_.subarray(x)),k=h._decodeFrame(R);k&&T.push(k),x+=R.size+10}h.isFooter(_,x)&&(x+=10)}return T},h._decodeFrame=function(_){return _.type==="PRIV"?h._decodePrivFrame(_):_.type[0]==="W"?h._decodeURLFrame(_):h._decodeTextFrame(_)},h._readTimeStamp=function(_){if(_.data.byteLength===8){var x=new Uint8Array(_.data),T=x[3]&1,b=(x[4]<<23)+(x[5]<<15)+(x[6]<<7)+x[7];return b/=45,T&&(b+=4772185884e-2),Math.round(b)}},h._decodePrivFrame=function(_){if(!(_.size<2)){var x=h._utf8ArrayToStr(_.data,!0),T=new Uint8Array(_.data.subarray(x.length+1));return{key:_.type,info:x,data:T.buffer}}},h._decodeTextFrame=function(_){if(!(_.size<2))if(_.type==="TXXX"){var x=1,T=h._utf8ArrayToStr(_.data.subarray(x),!0);x+=T.length+1;var b=h._utf8ArrayToStr(_.data.subarray(x));return{key:_.type,info:T,data:b}}else{var M=h._utf8ArrayToStr(_.data.subarray(1));return{key:_.type,data:M}}},h._decodeURLFrame=function(_){if(_.type==="WXXX"){if(_.size<2)return;var x=1,T=h._utf8ArrayToStr(_.data.subarray(x),!0);x+=T.length+1;var b=h._utf8ArrayToStr(_.data.subarray(x));return{key:_.type,info:T,data:b}}else{var M=h._utf8ArrayToStr(_.data);return{key:_.type,data:M}}},h._utf8ArrayToStr=function(_,x){x===void 0&&(x=!1);var T=p();if(T){var b=T.decode(_);if(x){var M=b.indexOf("\0");return M!==-1?b.substring(0,M):b}return b.replace(/\0/g,"")}for(var R=_.length,k,j,N,H="",G=0;G<R;){if(k=_[G++],k===0&&x)return H;if(k===0||k===3)continue;switch(k>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:H+=String.fromCharCode(k);break;case 12:case 13:j=_[G++],H+=String.fromCharCode((k&31)<<6|j&63);break;case 14:j=_[G++],N=_[G++],H+=String.fromCharCode((k&15)<<12|(j&63)<<6|(N&63)<<0);break}}return H},h}(),g;function p(){var h=Object(f.getSelfScope)();return!g&&typeof h.TextDecoder<"u"&&(g=new h.TextDecoder("utf-8")),g}var d=s._utf8ArrayToStr;o.default=s},"./src/demux/mp4demuxer.js":function(i,o,l){l.r(o);var f=l("./src/utils/logger.js"),s=l("./src/events.js"),g=Math.pow(2,32)-1,p=function(){function d(L,_){this.observer=L,this.remuxer=_}var h=d.prototype;return h.resetTimeStamp=function(_){this.initPTS=_},h.resetInitSegment=function(_,x,T,b){if(_&&_.byteLength){var M=this.initData=d.parseInitSegment(_);x==null&&(x="mp4a.40.5"),T==null&&(T="avc1.42e01e");var R={};M.audio&&M.video?R.audiovideo={container:"video/mp4",codec:x+","+T,initSegment:b?_:null}:(M.audio&&(R.audio={container:"audio/mp4",codec:x,initSegment:b?_:null}),M.video&&(R.video={container:"video/mp4",codec:T,initSegment:b?_:null})),this.observer.trigger(s.default.FRAG_PARSING_INIT_SEGMENT,{tracks:R})}else x&&(this.audioCodec=x),T&&(this.videoCodec=T)},d.probe=function(_){return d.findBox({data:_,start:0,end:Math.min(_.length,16384)},["moof"]).length>0},d.bin2str=function(_){return String.fromCharCode.apply(null,_)},d.readUint16=function(_,x){_.data&&(x+=_.start,_=_.data);var T=_[x]<<8|_[x+1];return T<0?65536+T:T},d.readUint32=function(_,x){_.data&&(x+=_.start,_=_.data);var T=_[x]<<24|_[x+1]<<16|_[x+2]<<8|_[x+3];return T<0?4294967296+T:T},d.writeUint32=function(_,x,T){_.data&&(x+=_.start,_=_.data),_[x]=T>>24,_[x+1]=T>>16&255,_[x+2]=T>>8&255,_[x+3]=T&255},d.findBox=function(_,x){var T=[],b,M,R,k,j,N,H;if(_.data?(N=_.start,k=_.end,_=_.data):(N=0,k=_.byteLength),!x.length)return null;for(b=N;b<k;)M=d.readUint32(_,b),R=d.bin2str(_.subarray(b+4,b+8)),H=M>1?b+M:k,R===x[0]&&(x.length===1?T.push({data:_,start:b+8,end:H}):(j=d.findBox({data:_,start:b+8,end:H},x.slice(1)),j.length&&(T=T.concat(j)))),b=H;return T},d.parseSegmentIndex=function(_){var x=d.findBox(_,["moov"])[0],T=x?x.end:null,b=0,M=d.findBox(_,["sidx"]),R;if(!M||!M[0])return null;R=[],M=M[0];var k=M.data[0];b=k===0?8:16;var j=d.readUint32(M,b);b+=4;var N=0,H=0;k===0?b+=8:b+=16,b+=2;var G=M.end+H,V=d.readUint16(M,b);b+=2;for(var J=0;J<V;J++){var Z=b,ee=d.readUint32(M,Z);Z+=4;var ge=ee&2147483647,pe=(ee&2147483648)>>>31;if(pe===1){console.warn("SIDX has hierarchical references (not supported)");return}var Ee=d.readUint32(M,Z);Z+=4,R.push({referenceSize:ge,subsegmentDuration:Ee,info:{duration:Ee/j,start:G,end:G+ge-1}}),G+=ge,Z+=4,b=Z}return{earliestPresentationTime:N,timescale:j,version:k,referencesCount:V,references:R,moovEndOffset:T}},d.parseInitSegment=function(_){var x=[],T=d.findBox(_,["moov","trak"]);return T.forEach(function(b){var M=d.findBox(b,["tkhd"])[0];if(M){var R=M.data[M.start],k=R===0?12:20,j=d.readUint32(M,k),N=d.findBox(b,["mdia","mdhd"])[0];if(N){R=N.data[N.start],k=R===0?12:20;var H=d.readUint32(N,k),G=d.findBox(b,["mdia","hdlr"])[0];if(G){var V=d.bin2str(G.data.subarray(G.start+8,G.start+12)),J={soun:"audio",vide:"video"}[V];if(J){var Z=d.findBox(b,["mdia","minf","stbl","stsd"]);if(Z.length){Z=Z[0];var ee=d.bin2str(Z.data.subarray(Z.start+12,Z.start+16));f.logger.log("MP4Demuxer:"+J+":"+ee+" found")}x[j]={timescale:H,type:J},x[J]={timescale:H,id:j}}}}}}),x},d.getStartDTS=function(_,x){var T,b,M;return T=d.findBox(x,["moof","traf"]),b=[].concat.apply([],T.map(function(R){return d.findBox(R,["tfhd"]).map(function(k){var j,N,H;return j=d.readUint32(k,4),N=_[j].timescale||9e4,H=d.findBox(R,["tfdt"]).map(function(G){var V,J;return V=G.data[G.start],J=d.readUint32(G,4),V===1&&(J*=Math.pow(2,32),J+=d.readUint32(G,8)),J})[0],H/N})})),M=Math.min.apply(null,b),isFinite(M)?M:0},d.offsetStartDTS=function(_,x,T){d.findBox(x,["moof","traf"]).map(function(b){return d.findBox(b,["tfhd"]).map(function(M){var R=d.readUint32(M,4),k=_[R].timescale||9e4;d.findBox(b,["tfdt"]).map(function(j){var N=j.data[j.start],H=d.readUint32(j,4);if(N===0)d.writeUint32(j,4,H-T*k);else{H*=Math.pow(2,32),H+=d.readUint32(j,8),H-=T*k,H=Math.max(H,0);var G=Math.floor(H/(g+1)),V=Math.floor(H%(g+1));d.writeUint32(j,4,G),d.writeUint32(j,8,V)}})})})},h.append=function(_,x,T,b){var M=this.initData;M||(this.resetInitSegment(_,this.audioCodec,this.videoCodec,!1),M=this.initData);var R,k=this.initPTS;if(k===void 0){var j=d.getStartDTS(M,_);this.initPTS=k=j-x,this.observer.trigger(s.default.INIT_PTS_FOUND,{initPTS:k})}d.offsetStartDTS(M,_,k),R=d.getStartDTS(M,_),this.remuxer.remux(M.audio,M.video,null,null,R,T,b,_)},h.destroy=function(){},d}();o.default=p},"./src/errors.ts":function(i,o,l){l.r(o),l.d(o,"ErrorTypes",function(){return f}),l.d(o,"ErrorDetails",function(){return s});var f;(function(g){g.NETWORK_ERROR="networkError",g.MEDIA_ERROR="mediaError",g.KEY_SYSTEM_ERROR="keySystemError",g.MUX_ERROR="muxError",g.OTHER_ERROR="otherError"})(f||(f={}));var s;(function(g){g.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",g.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",g.KEY_SYSTEM_NO_SESSION="keySystemNoSession",g.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",g.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",g.MANIFEST_LOAD_ERROR="manifestLoadError",g.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",g.MANIFEST_PARSING_ERROR="manifestParsingError",g.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",g.LEVEL_EMPTY_ERROR="levelEmptyError",g.LEVEL_LOAD_ERROR="levelLoadError",g.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",g.LEVEL_SWITCH_ERROR="levelSwitchError",g.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",g.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",g.FRAG_LOAD_ERROR="fragLoadError",g.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",g.FRAG_DECRYPT_ERROR="fragDecryptError",g.FRAG_PARSING_ERROR="fragParsingError",g.REMUX_ALLOC_ERROR="remuxAllocError",g.KEY_LOAD_ERROR="keyLoadError",g.KEY_LOAD_TIMEOUT="keyLoadTimeOut",g.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",g.BUFFER_APPEND_ERROR="bufferAppendError",g.BUFFER_APPENDING_ERROR="bufferAppendingError",g.BUFFER_STALLED_ERROR="bufferStalledError",g.BUFFER_FULL_ERROR="bufferFullError",g.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",g.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",g.INTERNAL_EXCEPTION="internalException"})(s||(s={}))},"./src/events.js":function(i,o,l){l.r(o);var f={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVELS_UPDATED:"hlsLevelsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",CUES_PARSED:"hlsCuesParsed",NON_NATIVE_TEXT_TRACKS_FOUND:"hlsNonNativeTextTracksFound",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"};o.default=f},"./src/hls.ts":function(i,o,l){l.r(o),l.d(o,"default",function(){return Ha});var f={};l.r(f),l.d(f,"newCue",function(){return Ol});var s=l("./node_modules/url-toolkit/src/url-toolkit.js"),g=l("./src/errors.ts"),p=l("./src/polyfills/number.js"),d=l("./src/events.js"),h=l("./src/utils/logger.js"),L={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},_=function(){function y(u){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=u,this.onEvent=this.onEvent.bind(this);for(var a=arguments.length,t=new Array(a>1?a-1:0),n=1;n<a;n++)t[n-1]=arguments[n];this.handledEvents=t,this.useGenericHandler=!0,this.registerListeners()}var m=y.prototype;return m.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},m.onHandlerDestroying=function(){},m.onHandlerDestroyed=function(){},m.isEventHandler=function(){return typeof this.handledEvents=="object"&&this.handledEvents.length&&typeof this.onEvent=="function"},m.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(a){if(L[a])throw new Error("Forbidden event-name: "+a);this.hls.on(a,this.onEvent)},this)},m.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(a){this.hls.off(a,this.onEvent)},this)},m.onEvent=function(a,t){this.onEventGeneric(a,t)},m.onEventGeneric=function(a,t){var n=function(v,E){var w="on"+v.replace("hls","");if(typeof this[w]!="function")throw new Error("Event "+v+" has no generic handler in this "+this.constructor.name+" class (tried "+w+")");return this[w].bind(this,E)};try{n.call(this,a,t).call()}catch(c){h.logger.error("An internal error happened while handling event "+a+'. Error message: "'+c.message+'". Here is a stacktrace:',c),this.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.OTHER_ERROR,details:g.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:a,err:c})}},y}(),x=_,T;(function(y){y.MANIFEST="manifest",y.LEVEL="level",y.AUDIO_TRACK="audioTrack",y.SUBTITLE_TRACK="subtitleTrack"})(T||(T={}));var b;(function(y){y.MAIN="main",y.AUDIO="audio",y.SUBTITLE="subtitle"})(b||(b={}));var M=l("./src/demux/mp4demuxer.js");function R(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function k(y,m,u){return m&&R(y.prototype,m),y}var j=function(){function y(m,u){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=m,this.reluri=u}return k(y,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(s.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),y}();function N(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function H(y,m,u){return m&&N(y.prototype,m),y}var G;(function(y){y.AUDIO="audio",y.VIDEO="video"})(G||(G={}));var V=function(){function y(){var u;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=(u={},u[G.AUDIO]=!1,u[G.VIDEO]=!1,u),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var m=y.prototype;return m.setByteRange=function(a,t){var n=a.split("@",2),c=[];n.length===1?c[0]=t?t.byteRangeEndOffset:0:c[0]=parseInt(n[1]),c[1]=parseInt(n[0])+c[0],this._byteRange=c},m.addElementaryStream=function(a){this._elementaryStreams[a]=!0},m.hasElementaryStream=function(a){return this._elementaryStreams[a]===!0},m.createInitializationVector=function(a){for(var t=new Uint8Array(16),n=12;n<16;n++)t[n]=a>>8*(15-n)&255;return t},m.setDecryptDataFromLevelKey=function(a,t){var n=a;return a!=null&&a.method&&a.uri&&!a.iv&&(n=new j(a.baseuri,a.reluri),n.method=a.method,n.iv=this.createInitializationVector(t)),n},H(y,[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(s.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(a){this._url=a}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var a=this.sn;typeof a!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&h.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),a=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,a)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(p.isFiniteNumber)(this.programDateTime))return null;var a=Object(p.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+a*1e3}},{key:"encrypted",get:function(){return!!(this.decryptdata&&this.decryptdata.uri!==null&&this.decryptdata.key===null)}}]),y}();function J(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function Z(y,m,u){return m&&J(y.prototype,m),y}var ee=function(){function y(m){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=m,this.version=null}return Z(y,[{key:"hasProgramDateTime",get:function(){return!!(this.fragments[0]&&Object(p.isFiniteNumber)(this.fragments[0].programDateTime))}}]),y}(),ge=/^(\d+)x(\d+)$/,pe=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,Ee=function(){function y(u){typeof u=="string"&&(u=y.parseAttrList(u));for(var a in u)u.hasOwnProperty(a)&&(this[a]=u[a])}var m=y.prototype;return m.decimalInteger=function(a){var t=parseInt(this[a],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},m.hexadecimalInteger=function(a){if(this[a]){var t=(this[a]||"0x").slice(2);t=(t.length&1?"0":"")+t;for(var n=new Uint8Array(t.length/2),c=0;c<t.length/2;c++)n[c]=parseInt(t.slice(c*2,c*2+2),16);return n}else return null},m.hexadecimalIntegerAsNumber=function(a){var t=parseInt(this[a],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},m.decimalFloatingPoint=function(a){return parseFloat(this[a])},m.enumeratedString=function(a){return this[a]},m.decimalResolution=function(a){var t=ge.exec(this[a]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},y.parseAttrList=function(a){var t,n={};for(pe.lastIndex=0;(t=pe.exec(a))!==null;){var c=t[2],v='"';c.indexOf(v)===0&&c.lastIndexOf(v)===c.length-1&&(c=c.slice(1,-1)),n[t[1]]=c}return n},y}(),be=Ee,Me={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function ce(y,m){var u=Me[m];return!!u&&u[y.slice(0,4)]===!0}function ve(y,m){return MediaSource.isTypeSupported((m||"video")+'/mp4;codecs="'+y+'"')}var fe=/(?:#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)|#EXT-X-SESSION-DATA:([^\n\r]*)[\r\n]+)/g,xe=/#EXT-X-MEDIA:(.*)/g,we=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),ye=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,q=/\.(mp4|m4s|m4v|m4a)$/i,oe=function(){function y(){}return y.findGroup=function(u,a){for(var t=0;t<u.length;t++){var n=u[t];if(n.id===a)return n}},y.convertAVC1ToAVCOTI=function(u){var a=u.split("."),t;return a.length>2?(t=a.shift()+".",t+=parseInt(a.shift()).toString(16),t+=("000"+parseInt(a.shift()).toString(16)).substr(-4)):t=u,t},y.resolve=function(u,a){return s.buildAbsoluteURL(a,u,{alwaysNormalize:!0})},y.parseMasterPlaylist=function(u,a){var t=[],n={},c=!1;fe.lastIndex=0;function v(K,Q){["video","audio"].forEach(function(_e){var Le=K.filter(function(Be){return ce(Be,_e)});if(Le.length){var Ue=Le.filter(function(Be){return Be.lastIndexOf("avc1",0)===0||Be.lastIndexOf("mp4a",0)===0});Q[_e+"Codec"]=Ue.length>0?Ue[0]:Le[0],K=K.filter(function(Be){return Le.indexOf(Be)===-1})}}),Q.unknownCodecs=K}for(var E;(E=fe.exec(u))!=null;)if(E[1]){var w={},C=w.attrs=new be(E[1]);w.url=y.resolve(E[2],a);var Y=C.decimalResolution("RESOLUTION");Y&&(w.width=Y.width,w.height=Y.height),w.bitrate=C.decimalInteger("AVERAGE-BANDWIDTH")||C.decimalInteger("BANDWIDTH"),w.name=C.NAME,v([].concat((C.CODECS||"").split(/[ ,]+/)),w),w.videoCodec&&w.videoCodec.indexOf("avc1")!==-1&&(w.videoCodec=y.convertAVC1ToAVCOTI(w.videoCodec)),t.push(w)}else if(E[3]){var B=new be(E[3]);B["DATA-ID"]&&(c=!0,n[B["DATA-ID"]]=B)}return{levels:t,sessionData:c?n:null}},y.parseMasterPlaylistMedia=function(u,a,t,n){n===void 0&&(n=[]);var c,v=[],E=0;for(xe.lastIndex=0;(c=xe.exec(u))!==null;){var w=new be(c[1]);if(w.TYPE===t){var C={attrs:w,id:E++,groupId:w["GROUP-ID"],instreamId:w["INSTREAM-ID"],name:w.NAME||w.LANGUAGE,type:t,default:w.DEFAULT==="YES",autoselect:w.AUTOSELECT==="YES",forced:w.FORCED==="YES",lang:w.LANGUAGE};if(w.URI&&(C.url=y.resolve(w.URI,a)),n.length){var Y=y.findGroup(n,C.groupId);C.audioCodec=Y?Y.codec:n[0].codec}v.push(C)}}return v},y.parseLevelPlaylist=function(u,a,t,n,c){var v=0,E=0,w=new ee(a),C=0,Y=null,B=new V,K,Q,_e,Le=null;for(we.lastIndex=0;(K=we.exec(u))!==null;){var Ue=K[1];if(Ue){B.duration=parseFloat(Ue);var Be=(" "+K[2]).slice(1);B.title=Be||null,B.tagList.push(Be?["INF",Ue,Be]:["INF",Ue])}else if(K[3]){if(Object(p.isFiniteNumber)(B.duration)){var Ke=v++;B.type=n,B.start=E,_e&&(B.levelkey=_e),B.sn=Ke,B.level=t,B.cc=C,B.urlId=c,B.baseurl=a,B.relurl=(" "+K[3]).slice(1),Re(B,Y),w.fragments.push(B),Y=B,E+=B.duration,B=new V}}else if(K[4]){var Ze=(" "+K[4]).slice(1);Y?B.setByteRange(Ze,Y):B.setByteRange(Ze)}else if(K[5])B.rawProgramDateTime=(" "+K[5]).slice(1),B.tagList.push(["PROGRAM-DATE-TIME",B.rawProgramDateTime]),Le===null&&(Le=w.fragments.length);else{if(K=K[0].match(ye),!K){h.logger.warn("No matches on slow regex match for level playlist!");continue}for(Q=1;Q<K.length&&!(typeof K[Q]<"u");Q++);var st=(" "+K[Q+1]).slice(1),xt=(" "+K[Q+2]).slice(1);switch(K[Q]){case"#":B.tagList.push(xt?[st,xt]:[st]);break;case"PLAYLIST-TYPE":w.type=st.toUpperCase();break;case"MEDIA-SEQUENCE":v=w.startSN=parseInt(st);break;case"TARGETDURATION":w.targetduration=parseFloat(st);break;case"VERSION":w.version=parseInt(st);break;case"EXTM3U":break;case"ENDLIST":w.live=!1;break;case"DIS":C++,B.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":C=parseInt(st);break;case"KEY":{var rr=st,zt=new be(rr),Er=zt.enumeratedString("METHOD"),$e=zt.URI,rt=zt.hexadecimalInteger("IV"),Rt=zt.KEYFORMAT||"identity";if(Rt==="com.apple.streamingkeydelivery"){h.logger.warn("Keyformat com.apple.streamingkeydelivery is not supported");continue}Er&&(_e=new j(a,$e),$e&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(Er)>=0&&(_e.method=Er,_e.key=null,_e.iv=rt));break}case"START":{var tn=new be(st),rn=tn.decimalFloatingPoint("TIME-OFFSET");Object(p.isFiniteNumber)(rn)&&(w.startTimeOffset=rn);break}case"MAP":{var _n=new be(st);B.relurl=_n.URI,_n.BYTERANGE&&B.setByteRange(_n.BYTERANGE),B.baseurl=a,B.level=t,B.type=n,B.sn="initSegment",w.initSegment=B,B=new V,B.rawProgramDateTime=w.initSegment.rawProgramDateTime;break}default:h.logger.warn("line parsed but not handled: "+K);break}}}return B=Y,B&&!B.relurl&&(w.fragments.pop(),E-=B.duration),w.totalduration=E,w.averagetargetduration=E/w.fragments.length,w.endSN=v-1,w.startCC=w.fragments[0]?w.fragments[0].cc:0,w.endCC=C,!w.initSegment&&w.fragments.length&&w.fragments.every(function(Bn){return q.test(Bn.relurl)})&&(h.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),B=new V,B.relurl=w.fragments[0].relurl,B.baseurl=a,B.level=t,B.type=n,B.sn="initSegment",w.initSegment=B,w.needSidxRanges=!0),Le&&ae(w.fragments,Le),w},y}();function ae(y,m){for(var u=y[m],a=m-1;a>=0;a--){var t=y[a];t.programDateTime=u.programDateTime-t.duration*1e3,u=t}}function Re(y,m){y.rawProgramDateTime?y.programDateTime=Date.parse(y.rawProgramDateTime):m!=null&&m.programDateTime&&(y.programDateTime=m.endProgramDateTime),Object(p.isFiniteNumber)(y.programDateTime)||(y.programDateTime=null,y.rawProgramDateTime=null)}function Ce(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var ke=window,De=ke.performance,Ne=function(y){Ce(m,y);function m(a){var t;return t=y.call(this,a,d.default.MANIFEST_LOADING,d.default.LEVEL_LOADING,d.default.AUDIO_TRACK_LOADING,d.default.SUBTITLE_TRACK_LOADING)||this,t.loaders={},t}m.canHaveQualityLevels=function(t){return t!==T.AUDIO_TRACK&&t!==T.SUBTITLE_TRACK},m.mapContextToLevelType=function(t){var n=t.type;switch(n){case T.AUDIO_TRACK:return b.AUDIO;case T.SUBTITLE_TRACK:return b.SUBTITLE;default:return b.MAIN}},m.getResponseUrl=function(t,n){var c=t.url;return(c===void 0||c.indexOf("data:")===0)&&(c=n.url),c};var u=m.prototype;return u.createInternalLoader=function(t){var n=this.hls.config,c=n.pLoader,v=n.loader,E=c||v,w=new E(n);return t.loader=w,this.loaders[t.type]=w,w},u.getInternalLoader=function(t){return this.loaders[t.type]},u.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]},u.destroyInternalLoaders=function(){for(var t in this.loaders){var n=this.loaders[t];n&&n.destroy(),this.resetInternalLoader(t)}},u.destroy=function(){this.destroyInternalLoaders(),y.prototype.destroy.call(this)},u.onManifestLoading=function(t){this.load({url:t.url,type:T.MANIFEST,level:0,id:null,responseType:"text"})},u.onLevelLoading=function(t){this.load({url:t.url,type:T.LEVEL,level:t.level,id:t.id,responseType:"text"})},u.onAudioTrackLoading=function(t){this.load({url:t.url,type:T.AUDIO_TRACK,level:null,id:t.id,responseType:"text"})},u.onSubtitleTrackLoading=function(t){this.load({url:t.url,type:T.SUBTITLE_TRACK,level:null,id:t.id,responseType:"text"})},u.load=function(t){var n=this.hls.config;h.logger.debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id);var c=this.getInternalLoader(t);if(c){var v=c.context;if(v&&v.url===t.url)return h.logger.trace("playlist request ongoing"),!1;h.logger.warn("aborting previous loader for type: "+t.type),c.abort()}var E,w,C,Y;switch(t.type){case T.MANIFEST:E=n.manifestLoadingMaxRetry,w=n.manifestLoadingTimeOut,C=n.manifestLoadingRetryDelay,Y=n.manifestLoadingMaxRetryTimeout;break;case T.LEVEL:E=0,Y=0,C=0,w=n.levelLoadingTimeOut;break;default:E=n.levelLoadingMaxRetry,w=n.levelLoadingTimeOut,C=n.levelLoadingRetryDelay,Y=n.levelLoadingMaxRetryTimeout;break}c=this.createInternalLoader(t);var B={timeout:w,maxRetry:E,retryDelay:C,maxRetryDelay:Y},K={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return h.logger.debug("Calling internal loader delegate for URL: "+t.url),c.load(t,B,K),!0},u.loadsuccess=function(t,n,c,v){if(v===void 0&&(v=null),c.isSidxRequest){this._handleSidxRequest(t,c),this._handlePlaylistLoaded(t,n,c,v);return}if(this.resetInternalLoader(c.type),typeof t.data!="string")throw new Error('expected responseType of "text" for PlaylistLoader');var E=t.data;if(n.tload=De.now(),E.indexOf("#EXTM3U")!==0){this._handleManifestParsingError(t,c,"no EXTM3U delimiter",v);return}E.indexOf("#EXTINF:")>0||E.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(t,n,c,v):this._handleMasterPlaylist(t,n,c,v)},u.loaderror=function(t,n,c){c===void 0&&(c=null),this._handleNetworkError(n,c,!1,t)},u.loadtimeout=function(t,n,c){c===void 0&&(c=null),this._handleNetworkError(n,c,!0)},u._handleMasterPlaylist=function(t,n,c,v){var E=this.hls,w=t.data,C=m.getResponseUrl(t,c),Y=oe.parseMasterPlaylist(w,C),B=Y.levels,K=Y.sessionData;if(!B.length){this._handleManifestParsingError(t,c,"no level found in manifest",v);return}var Q=B.map(function(Ke){return{id:Ke.attrs.AUDIO,codec:Ke.audioCodec}}),_e=oe.parseMasterPlaylistMedia(w,C,"AUDIO",Q),Le=oe.parseMasterPlaylistMedia(w,C,"SUBTITLES"),Ue=oe.parseMasterPlaylistMedia(w,C,"CLOSED-CAPTIONS");if(_e.length){var Be=!1;_e.forEach(function(Ke){Ke.url||(Be=!0)}),Be===!1&&B[0].audioCodec&&!B[0].attrs.AUDIO&&(h.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),_e.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:{},url:""}))}E.trigger(d.default.MANIFEST_LOADED,{levels:B,audioTracks:_e,subtitles:Le,captions:Ue,url:C,stats:n,networkDetails:v,sessionData:K})},u._handleTrackOrLevelPlaylist=function(t,n,c,v){var E=this.hls,w=c.id,C=c.level,Y=c.type,B=m.getResponseUrl(t,c),K=Object(p.isFiniteNumber)(w)?w:0,Q=Object(p.isFiniteNumber)(C)?C:K,_e=m.mapContextToLevelType(c),Le=oe.parseLevelPlaylist(t.data,B,Q,_e,K);if(Le.tload=n.tload,!Le.fragments.length){E.trigger(d.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:B,reason:"no fragments found in level",level:typeof c.level=="number"?c.level:void 0});return}if(Y===T.MANIFEST){var Ue={url:B,details:Le};E.trigger(d.default.MANIFEST_LOADED,{levels:[Ue],audioTracks:[],url:B,stats:n,networkDetails:v,sessionData:null})}if(n.tparsed=De.now(),Le.needSidxRanges){var Be=Le.initSegment.url;this.load({url:Be,isSidxRequest:!0,type:Y,level:C,levelDetails:Le,id:w,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"});return}c.levelDetails=Le,this._handlePlaylistLoaded(t,n,c,v)},u._handleSidxRequest=function(t,n){if(typeof t.data=="string")throw new Error("sidx request must be made with responseType of array buffer");var c=M.default.parseSegmentIndex(new Uint8Array(t.data));if(c){var v=c.references,E=n.levelDetails;v.forEach(function(w,C){var Y=w.info;if(E){var B=E.fragments[C];B.byteRange.length===0&&B.setByteRange(String(1+Y.end-Y.start)+"@"+String(Y.start))}}),E&&E.initSegment.setByteRange(String(c.moovEndOffset)+"@0")}},u._handleManifestParsingError=function(t,n,c,v){this.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:t.url,reason:c,networkDetails:v})},u._handleNetworkError=function(t,n,c,v){c===void 0&&(c=!1),v===void 0&&(v=null),h.logger.info("A network error occured while loading a "+t.type+"-type playlist");var E,w,C=this.getInternalLoader(t);switch(t.type){case T.MANIFEST:E=c?g.ErrorDetails.MANIFEST_LOAD_TIMEOUT:g.ErrorDetails.MANIFEST_LOAD_ERROR,w=!0;break;case T.LEVEL:E=c?g.ErrorDetails.LEVEL_LOAD_TIMEOUT:g.ErrorDetails.LEVEL_LOAD_ERROR,w=!1;break;case T.AUDIO_TRACK:E=c?g.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,w=!1;break;default:w=!1}C&&(C.abort(),this.resetInternalLoader(t.type));var Y={type:g.ErrorTypes.NETWORK_ERROR,details:E,fatal:w,url:t.url,loader:C,context:t,networkDetails:n};v&&(Y.response=v),this.hls.trigger(d.default.ERROR,Y)},u._handlePlaylistLoaded=function(t,n,c,v){var E=c.type,w=c.level,C=c.id,Y=c.levelDetails;if(!Y||!Y.targetduration){this._handleManifestParsingError(t,c,"invalid target duration",v);return}var B=m.canHaveQualityLevels(c.type);if(B)this.hls.trigger(d.default.LEVEL_LOADED,{details:Y,level:w||0,id:C||0,stats:n,networkDetails:v});else switch(E){case T.AUDIO_TRACK:this.hls.trigger(d.default.AUDIO_TRACK_LOADED,{details:Y,id:C,stats:n,networkDetails:v});break;case T.SUBTITLE_TRACK:this.hls.trigger(d.default.SUBTITLE_TRACK_LOADED,{details:Y,id:C,stats:n,networkDetails:v});break}},m}(x),je=Ne;function Fe(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var ze=function(y){Fe(m,y);function m(a){var t;return t=y.call(this,a,d.default.FRAG_LOADING)||this,t.loaders={},t}var u=m.prototype;return u.destroy=function(){var t=this.loaders;for(var n in t){var c=t[n];c&&c.destroy()}this.loaders={},y.prototype.destroy.call(this)},u.onFragLoading=function(t){var n=t.frag,c=n.type,v=this.loaders,E=this.hls.config,w=E.fLoader,C=E.loader;n.loaded=0;var Y=v[c];Y&&(h.logger.warn("abort previous fragment loader for type: "+c),Y.abort()),Y=v[c]=n.loader=E.fLoader?new w(E):new C(E);var B,K,Q;B={url:n.url,frag:n,responseType:"arraybuffer",progressData:!1};var _e=n.byteRangeStartOffset,Le=n.byteRangeEndOffset;Object(p.isFiniteNumber)(_e)&&Object(p.isFiniteNumber)(Le)&&(B.rangeStart=_e,B.rangeEnd=Le),K={timeout:E.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:E.fragLoadingMaxRetryTimeout},Q={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},Y.load(B,K,Q)},u.loadsuccess=function(t,n,c,v){v===void 0&&(v=null);var E=t.data,w=c.frag;w.loader=void 0,this.loaders[w.type]=void 0,this.hls.trigger(d.default.FRAG_LOADED,{payload:E,frag:w,stats:n,networkDetails:v})},u.loaderror=function(t,n,c){c===void 0&&(c=null);var v=n.frag,E=v.loader;E&&E.abort(),this.loaders[v.type]=void 0,this.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:n.frag,response:t,networkDetails:c})},u.loadtimeout=function(t,n,c){c===void 0&&(c=null);var v=n.frag,E=v.loader;E&&E.abort(),this.loaders[v.type]=void 0,this.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:n.frag,networkDetails:c})},u.loadprogress=function(t,n,c,v){v===void 0&&(v=null);var E=n.frag;E.loaded=t.loaded,this.hls.trigger(d.default.FRAG_LOAD_PROGRESS,{frag:E,stats:t,networkDetails:v})},m}(x),Ge=ze;function Ve(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var Xe=function(y){Ve(m,y);function m(a){var t;return t=y.call(this,a,d.default.KEY_LOADING)||this,t.loaders={},t.decryptkey=null,t.decrypturl=null,t}var u=m.prototype;return u.destroy=function(){for(var t in this.loaders){var n=this.loaders[t];n&&n.destroy()}this.loaders={},y.prototype.destroy.call(this)},u.onKeyLoading=function(t){var n=t.frag,c=n.type,v=this.loaders[c];if(!n.decryptdata){h.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var E=n.decryptdata.uri;if(E!==this.decrypturl||this.decryptkey===null){var w=this.hls.config;if(v&&(h.logger.warn("abort previous key loader for type:"+c),v.abort()),!E){h.logger.warn("key uri is falsy");return}n.loader=this.loaders[c]=new w.loader(w),this.decrypturl=E,this.decryptkey=null;var C={url:E,frag:n,responseType:"arraybuffer"},Y={timeout:w.fragLoadingTimeOut,maxRetry:0,retryDelay:w.fragLoadingRetryDelay,maxRetryDelay:w.fragLoadingMaxRetryTimeout},B={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};n.loader.load(C,Y,B)}else this.decryptkey&&(n.decryptdata.key=this.decryptkey,this.hls.trigger(d.default.KEY_LOADED,{frag:n}))},u.loadsuccess=function(t,n,c){var v=c.frag;if(!v.decryptdata){h.logger.error("after key load, decryptdata unset");return}this.decryptkey=v.decryptdata.key=new Uint8Array(t.data),v.loader=void 0,delete this.loaders[v.type],this.hls.trigger(d.default.KEY_LOADED,{frag:v})},u.loaderror=function(t,n){var c=n.frag,v=c.loader;v&&v.abort(),delete this.loaders[c.type],this.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:c,response:t})},u.loadtimeout=function(t,n){var c=n.frag,v=c.loader;v&&v.abort(),delete this.loaders[c.type],this.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:c})},m}(x),me=Xe;function te(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var de={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"},Ae=function(y){te(m,y);function m(a){var t;return t=y.call(this,a,d.default.BUFFER_APPENDED,d.default.FRAG_BUFFERED,d.default.FRAG_LOADED)||this,t.bufferPadding=.2,t.fragments=Object.create(null),t.timeRanges=Object.create(null),t.config=a.config,t}var u=m.prototype;return u.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,x.prototype.destroy.call(this),y.prototype.destroy.call(this)},u.getBufferedFrag=function(t,n){var c=this.fragments,v=Object.keys(c).filter(function(w){var C=c[w];if(C.body.type!==n||!C.buffered)return!1;var Y=C.body;return Y.startPTS<=t&&t<=Y.endPTS});if(v.length===0)return null;var E=v.pop();return c[E].body},u.detectEvictedFragments=function(t,n){var c=this;Object.keys(this.fragments).forEach(function(v){var E=c.fragments[v];if(!(!E||!E.buffered)){var w=E.range[t];if(w)for(var C=w.time,Y=0;Y<C.length;Y++){var B=C[Y];if(!c.isTimeBuffered(B.startPTS,B.endPTS,n)){c.removeFragment(E.body);break}}}})},u.detectPartialFragments=function(t){var n=this,c=this.getFragmentKey(t),v=this.fragments[c];v&&(v.buffered=!0,Object.keys(this.timeRanges).forEach(function(E){if(t.hasElementaryStream(E)){var w=n.timeRanges[E];v.range[E]=n.getBufferedTimes(t.startPTS,t.endPTS,w)}}))},u.getBufferedTimes=function(t,n,c){for(var v=[],E,w,C=!1,Y=0;Y<c.length;Y++)if(E=c.start(Y)-this.bufferPadding,w=c.end(Y)+this.bufferPadding,t>=E&&n<=w){v.push({startPTS:Math.max(t,c.start(Y)),endPTS:Math.min(n,c.end(Y))});break}else if(t<w&&n>E)v.push({startPTS:Math.max(t,c.start(Y)),endPTS:Math.min(n,c.end(Y))}),C=!0;else if(n<=E)break;return{time:v,partial:C}},u.getFragmentKey=function(t){return t.type+"_"+t.level+"_"+t.urlId+"_"+t.sn},u.getPartialFragment=function(t){var n=this,c,v,E,w=null,C=0;return Object.keys(this.fragments).forEach(function(Y){var B=n.fragments[Y];n.isPartial(B)&&(v=B.body.startPTS-n.bufferPadding,E=B.body.endPTS+n.bufferPadding,t>=v&&t<=E&&(c=Math.min(t-v,E-t),C<=c&&(w=B.body,C=c)))}),w},u.getState=function(t){var n=this.getFragmentKey(t),c=this.fragments[n],v=de.NOT_LOADED;return c!==void 0&&(c.buffered?this.isPartial(c)===!0?v=de.PARTIAL:v=de.OK:v=de.APPENDING),v},u.isPartial=function(t){return t.buffered===!0&&(t.range.video!==void 0&&t.range.video.partial===!0||t.range.audio!==void 0&&t.range.audio.partial===!0)},u.isTimeBuffered=function(t,n,c){for(var v,E,w=0;w<c.length;w++){if(v=c.start(w)-this.bufferPadding,E=c.end(w)+this.bufferPadding,t>=v&&n<=E)return!0;if(n<=v)return!1}return!1},u.onFragLoaded=function(t){var n=t.frag;!Object(p.isFiniteNumber)(n.sn)||n.bitrateTest||(this.fragments[this.getFragmentKey(n)]={body:n,range:Object.create(null),buffered:!1})},u.onBufferAppended=function(t){var n=this;this.timeRanges=t.timeRanges,Object.keys(this.timeRanges).forEach(function(c){var v=n.timeRanges[c];n.detectEvictedFragments(c,v)})},u.onFragBuffered=function(t){this.detectPartialFragments(t.frag)},u.hasFragment=function(t){var n=this.getFragmentKey(t);return this.fragments[n]!==void 0},u.removeFragment=function(t){var n=this.getFragmentKey(t);delete this.fragments[n]},u.removeAllFragments=function(){this.fragments=Object.create(null)},m}(x),O={search:function(m,u){for(var a=0,t=m.length-1,n=null,c=null;a<=t;){n=(a+t)/2|0,c=m[n];var v=u(c);if(v>0)a=n+1;else if(v<0)t=n-1;else return c}return null}},U=O,A=function(){function y(){}return y.isBuffered=function(u,a){try{if(u){for(var t=u.buffered,n=0;n<t.length;n++)if(a>=t.start(n)&&a<=t.end(n))return!0}}catch{}return!1},y.bufferInfo=function(u,a,t){try{if(u){var n=u.buffered,c=[],v;for(v=0;v<n.length;v++)c.push({start:n.start(v),end:n.end(v)});return this.bufferedInfo(c,a,t)}}catch{}return{len:0,start:a,end:a,nextStart:void 0}},y.bufferedInfo=function(u,a,t){u.sort(function(Le,Ue){var Be=Le.start-Ue.start;return Be||Ue.end-Le.end});var n=[];if(t)for(var c=0;c<u.length;c++){var v=n.length;if(v){var E=n[v-1].end;u[c].start-E<t?u[c].end>E&&(n[v-1].end=u[c].end):n.push(u[c])}else n.push(u[c])}else n=u;for(var w=0,C,Y=a,B=a,K=0;K<n.length;K++){var Q=n[K].start,_e=n[K].end;if(a+t>=Q&&a<_e)Y=Q,B=_e,w=B-a;else if(a+t<Q){C=Q;break}}return{len:w,start:Y,end:B,nextStart:C}},y}(),S=l("./node_modules/eventemitter3/index.js"),P=l("./node_modules/webworkify-webpack/index.js"),F=l("./src/demux/demuxer-inline.js");function z(){return window.MediaSource||window.WebKitMediaSource}var $=l("./src/utils/get-self-scope.js");function W(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var X=function(y){W(m,y);function m(){return y.apply(this,arguments)||this}var u=m.prototype;return u.trigger=function(t){for(var n=arguments.length,c=new Array(n>1?n-1:0),v=1;v<n;v++)c[v-1]=arguments[v];this.emit.apply(this,[t,t].concat(c))},m}(S.EventEmitter),se=Object($.getSelfScope)(),ie=z()||{isTypeSupported:function(){return!1}},re=function(){function y(u,a){var t=this;this.hls=u,this.id=a;var n=this.observer=new X,c=u.config,v=function(B,K){K=K||{},K.frag=t.frag,K.id=t.id,u.trigger(B,K)};n.on(d.default.FRAG_DECRYPTED,v),n.on(d.default.FRAG_PARSING_INIT_SEGMENT,v),n.on(d.default.FRAG_PARSING_DATA,v),n.on(d.default.FRAG_PARSED,v),n.on(d.default.ERROR,v),n.on(d.default.FRAG_PARSING_METADATA,v),n.on(d.default.FRAG_PARSING_USERDATA,v),n.on(d.default.INIT_PTS_FOUND,v);var E={mp4:ie.isTypeSupported("video/mp4"),mpeg:ie.isTypeSupported("audio/mpeg"),mp3:ie.isTypeSupported('audio/mp4; codecs="mp3"')},w=navigator.vendor;if(c.enableWorker&&typeof Worker<"u"){h.logger.log("demuxing in webworker");var C;try{C=this.w=P("./src/demux/demuxer-worker.js"),this.onwmsg=this.onWorkerMessage.bind(this),C.addEventListener("message",this.onwmsg),C.onerror=function(Y){u.trigger(d.default.ERROR,{type:g.ErrorTypes.OTHER_ERROR,details:g.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:Y.message+" ("+Y.filename+":"+Y.lineno+")"}})},C.postMessage({cmd:"init",typeSupported:E,vendor:w,id:a,config:JSON.stringify(c)})}catch(Y){h.logger.warn("Error in worker:",Y),h.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),C&&se.URL.revokeObjectURL(C.objectURL),this.demuxer=new F.default(n,E,c,w),this.w=void 0}}else this.demuxer=new F.default(n,E,c,w)}var m=y.prototype;return m.destroy=function(){var a=this.w;if(a)a.removeEventListener("message",this.onwmsg),a.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var n=this.observer;n&&(n.removeAllListeners(),this.observer=null)},m.push=function(a,t,n,c,v,E,w,C){var Y=this.w,B=Object(p.isFiniteNumber)(v.startPTS)?v.startPTS:v.start,K=v.decryptdata,Q=this.frag,_e=!(Q&&v.cc===Q.cc),Le=!(Q&&v.level===Q.level),Ue=Q&&v.sn===Q.sn+1,Be=!Le&&Ue;if(_e&&h.logger.log(this.id+":discontinuity detected"),Le&&h.logger.log(this.id+":switch detected"),this.frag=v,Y)Y.postMessage({cmd:"demux",data:a,decryptdata:K,initSegment:t,audioCodec:n,videoCodec:c,timeOffset:B,discontinuity:_e,trackSwitch:Le,contiguous:Be,duration:E,accurateTimeOffset:w,defaultInitPTS:C},a instanceof ArrayBuffer?[a]:[]);else{var Ke=this.demuxer;Ke&&Ke.push(a,K,t,n,c,B,_e,Le,Be,E,w,C)}},m.onWorkerMessage=function(a){var t=a.data,n=this.hls;switch(t.event){case"init":se.URL.revokeObjectURL(this.w.objectURL);break;case d.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data);break}},y}(),le=re;function he(y,m,u){switch(m){case"audio":y.audioGroupIds||(y.audioGroupIds=[]),y.audioGroupIds.push(u);break;case"text":y.textGroupIds||(y.textGroupIds=[]),y.textGroupIds.push(u);break}}function Se(y,m,u){var a=y[m],t=y[u],n=t.startPTS;if(Object(p.isFiniteNumber)(n))u>m?(a.duration=n-a.start,a.duration<0&&h.logger.warn("negative duration computed for frag "+a.sn+",level "+a.level+", there should be some duration drift between playlist and fragment!")):(t.duration=a.start-n,t.duration<0&&h.logger.warn("negative duration computed for frag "+t.sn+",level "+t.level+", there should be some duration drift between playlist and fragment!"));else if(u>m){var c=a.cc===t.cc;t.start=a.start+(c&&a.minEndPTS?a.minEndPTS-a.start:a.duration)}else t.start=Math.max(a.start-t.duration,0)}function ue(y,m,u,a,t,n){var c=u,v=a;if(Object(p.isFiniteNumber)(m.startPTS)){var E=Math.abs(m.startPTS-u);Object(p.isFiniteNumber)(m.deltaPTS)?m.deltaPTS=Math.max(E,m.deltaPTS):m.deltaPTS=E,c=Math.max(u,m.startPTS),u=Math.min(u,m.startPTS),v=Math.min(a,m.endPTS),a=Math.max(a,m.endPTS),t=Math.min(t,m.startDTS),n=Math.max(n,m.endDTS)}var w=u-m.start;m.start=m.startPTS=u,m.maxStartPTS=c,m.endPTS=a,m.minEndPTS=v,m.startDTS=t,m.endDTS=n,m.duration=a-u;var C=m.sn;if(!y||C<y.startSN||C>y.endSN)return 0;var Y,B,K;for(Y=C-y.startSN,B=y.fragments,B[Y]=m,K=Y;K>0;K--)Se(B,K,K-1);for(K=Y;K<B.length-1;K++)Se(B,K,K+1);return y.PTSKnown=!0,w}function Ie(y,m){m.initSegment&&y.initSegment&&(m.initSegment=y.initSegment);var u=0,a;if(He(y,m,function(c,v){u=c.cc-v.cc,Object(p.isFiniteNumber)(c.startPTS)&&(v.start=v.startPTS=c.startPTS,v.endPTS=c.endPTS,v.duration=c.duration,v.backtracked=c.backtracked,v.dropped=c.dropped,a=v),m.PTSKnown=!0}),!!m.PTSKnown){if(u){h.logger.log("discontinuity sliding from playlist, take drift into account");for(var t=m.fragments,n=0;n<t.length;n++)t[n].cc+=u}a?ue(m,a,a.startPTS,a.endPTS,a.startDTS,a.endDTS):Ye(y,m),m.PTSKnown=y.PTSKnown}}function Pe(y,m,u){u===void 0&&(u=0);var a=-1;He(y,m,function(c,v,E){v.start=c.start,a=E});var t=m.fragments;if(a<0){t.forEach(function(c){c.start+=u});return}for(var n=a+1;n<t.length;n++)t[n].start=t[n-1].start+t[n-1].duration}function He(y,m,u){if(!(!y||!m))for(var a=Math.max(y.startSN,m.startSN)-m.startSN,t=Math.min(y.endSN,m.endSN)-m.startSN,n=m.startSN-y.startSN,c=a;c<=t;c++){var v=y.fragments[n+c],E=m.fragments[c];if(!v||!E)break;u(v,E,c)}}function Ye(y,m){var u=m.startSN-y.startSN,a=y.fragments,t=m.fragments;if(!(u<0||u>a.length))for(var n=0;n<t.length;n++)t[n].start+=a[u].start}function Oe(y,m,u){var a=1e3*(m.averagetargetduration?m.averagetargetduration:m.targetduration),t=a/2;return y&&m.endSN===y.endSN&&(a=t),u&&(a=Math.max(t,a-(window.performance.now()-u))),Math.round(a)}var Te={toString:function(m){for(var u="",a=m.length,t=0;t<a;t++)u+="["+m.start(t).toFixed(3)+","+m.end(t).toFixed(3)+"]";return u}},qe=Te;function We(y,m){for(var u=null,a=0;a<y.length;a+=1){var t=y[a];if(t&&t.cc===m){u=t;break}}return u}function lt(y,m){return U.search(y,function(u){return u.cc<m?1:u.cc>m?-1:0})}function dt(y,m,u){var a=!1;return m&&m.details&&u&&(u.endCC>u.startCC||y&&y.cc<u.startCC)&&(a=!0),a}function kt(y,m){var u=y.fragments,a=m.fragments;if(!a.length||!u.length){h.logger.log("No fragments to align");return}var t=We(u,a[0].cc);if(!t||t&&!t.startPTS){h.logger.log("No frag in previous level to align on");return}return t}function bt(y,m){m.fragments.forEach(function(u){if(u){var a=u.start+y;u.start=u.startPTS=a,u.endPTS=a+u.duration}}),m.PTSKnown=!0}function gt(y,m,u){Ot(y,u,m),!u.PTSKnown&&m&&Mt(u,m.details)}function Ot(y,m,u){if(dt(y,u,m)){var a=kt(u.details,m);a&&(h.logger.log("Adjusting PTS using last level due to CC increase within current level"),bt(a.start,m))}}function Mt(y,m){if(m&&m.fragments.length){if(!y.hasProgramDateTime||!m.hasProgramDateTime)return;var u=m.fragments[0].programDateTime,a=y.fragments[0].programDateTime,t=(a-u)/1e3+m.fragments[0].start;Object(p.isFiniteNumber)(t)&&(h.logger.log("adjusting PTS using programDateTime delta, sliding:"+t.toFixed(3)),bt(t,y))}}function Ft(y,m,u){if(m===null||!Array.isArray(y)||!y.length||!Object(p.isFiniteNumber)(m))return null;var a=y[0].programDateTime;if(m<(a||0))return null;var t=y[y.length-1].endProgramDateTime;if(m>=(t||0))return null;u=u||0;for(var n=0;n<y.length;++n){var c=y[n];if(tr(m,u,c))return c}return null}function St(y,m,u,a){u===void 0&&(u=0),a===void 0&&(a=0);var t=null;if(y?t=m[y.sn-m[0].sn+1]:u===0&&m[0].start===0&&(t=m[0]),t&&ut(u,a,t)===0)return t;var n=U.search(m,ut.bind(null,u,a));return n||t}function ut(y,m,u){y===void 0&&(y=0),m===void 0&&(m=0);var a=Math.min(m,u.duration+(u.deltaPTS?u.deltaPTS:0));return u.start+u.duration-a<=y?1:u.start-a>y&&u.start?-1:0}function tr(y,m,u){var a=Math.min(m,u.duration+(u.deltaPTS?u.deltaPTS:0))*1e3,t=u.endProgramDateTime||0;return t-a>y}var Jt=250,Ht=2,At=.1,Zt=.05,at=function(){function y(u,a,t,n){this.config=u,this.media=a,this.fragmentTracker=t,this.hls=n,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var m=y.prototype;return m.poll=function(a){var t=this.config,n=this.media,c=this.stalled,v=n.currentTime,E=n.seeking,w=this.seeking&&!E,C=!this.seeking&&E;if(this.seeking=E,v!==a){if(this.moved=!0,c!==null){if(this.stallReported){var Y=self.performance.now()-c;h.logger.warn("playback not stuck anymore @"+v+", after "+Math.round(Y)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((C||w)&&(this.stalled=null),!(n.paused||n.ended||n.playbackRate===0||!n.buffered.length)){var B=A.bufferInfo(n,v,0),K=B.len>0,Q=B.nextStart||0;if(!(!K&&!Q)){if(E){var _e=B.len>Ht,Le=!Q||Q-v>Ht&&!this.fragmentTracker.getPartialFragment(v);if(_e||Le)return;this.moved=!1}if(!this.moved&&this.stalled){var Ue=Math.max(Q,B.start||0)-v;if(Ue>0&&Ue<=Ht){this._trySkipBufferHole(null);return}}var Be=self.performance.now();if(c===null){this.stalled=Be;return}var Ke=Be-c;!E&&Ke>=Jt&&this._reportStall(B.len);var Ze=A.bufferInfo(n,v,t.maxBufferHole);this._tryFixBufferStall(Ze,Ke)}}},m._tryFixBufferStall=function(a,t){var n=this.config,c=this.fragmentTracker,v=this.media,E=v.currentTime,w=c.getPartialFragment(E);if(w){var C=this._trySkipBufferHole(w);if(C)return}a.len>n.maxBufferHole&&t>n.highBufferWatchdogPeriod*1e3&&(h.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},m._reportStall=function(a){var t=this.hls,n=this.media,c=this.stallReported;c||(this.stallReported=!0,h.logger.warn("Playback stalling at @"+n.currentTime+" due to low buffer (buffer="+a+")"),t.trigger(d.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:a}))},m._trySkipBufferHole=function(a){for(var t=this.config,n=this.hls,c=this.media,v=c.currentTime,E=0,w=0;w<c.buffered.length;w++){var C=c.buffered.start(w);if(v+t.maxBufferHole>=E&&v<C){var Y=Math.max(C+Zt,c.currentTime+At);return h.logger.warn("skipping hole, adjusting currentTime from "+v+" to "+Y),this.moved=!0,this.stalled=null,c.currentTime=Y,a&&n.trigger(d.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+v+" to "+Y,frag:a}),Y}E=c.buffered.end(w)}return 0},m._tryNudgeBuffer=function(){var a=this.config,t=this.hls,n=this.media,c=n.currentTime,v=(this.nudgeRetry||0)+1;if(this.nudgeRetry=v,v<a.nudgeMaxRetry){var E=c+v*a.nudgeOffset;h.logger.warn("Nudging 'currentTime' from "+c+" to "+E),n.currentTime=E,t.trigger(d.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else h.logger.error("Playhead still not moving while enough data buffered @"+c+" after "+a.nudgeMaxRetry+" nudges"),t.trigger(d.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},y}();function Je(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function ot(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var ft=function(y){ot(m,y);function m(a){for(var t,n=arguments.length,c=new Array(n>1?n-1:0),v=1;v<n;v++)c[v-1]=arguments[v];return t=y.call.apply(y,[this,a].concat(c))||this,t._boundTick=void 0,t._tickTimer=null,t._tickInterval=null,t._tickCallCount=0,t._boundTick=t.tick.bind(Je(t)),t}var u=m.prototype;return u.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},u.hasInterval=function(){return!!this._tickInterval},u.hasNextTick=function(){return!!this._tickTimer},u.setInterval=function(t){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,t),!0)},u.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},u.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},u.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},u.doTick=function(){},m}(x);function mt(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var ne={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},vt=function(y){mt(m,y);function m(){return y.apply(this,arguments)||this}var u=m.prototype;return u.doTick=function(){},u.startLoad=function(){},u.stopLoad=function(){var t=this.fragCurrent;t&&(t.loader&&t.loader.abort(),this.fragmentTracker.removeFragment(t)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=ne.STOPPED},u._streamEnded=function(t,n){var c=this.fragCurrent,v=this.fragmentTracker;if(!n.live&&c&&!c.backtracked&&c.sn===n.endSN&&!t.nextStart){var E=v.getState(c);return E===de.PARTIAL||E===de.OK}return!1},u.onMediaSeeking=function(){var t=this.config,n=this.media,c=this.mediaBuffer,v=this.state,E=n?n.currentTime:null,w=A.bufferInfo(c||n,E,this.config.maxBufferHole);if(h.logger.log("media seeking to "+(Object(p.isFiniteNumber)(E)?E.toFixed(3):E)),v===ne.FRAG_LOADING){var C=this.fragCurrent;if(w.len===0&&C){var Y=t.maxFragLookUpTolerance,B=C.start-Y,K=C.start+C.duration+Y;E<B||E>K?(C.loader&&(h.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),C.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=ne.IDLE):h.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else v===ne.ENDED&&(w.len===0&&(this.fragPrevious=null,this.fragCurrent=null),this.state=ne.IDLE);n&&(this.lastCurrentTime=E),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=E),this.tick()},u.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},u.onHandlerDestroying=function(){this.stopLoad(),y.prototype.onHandlerDestroying.call(this)},u.onHandlerDestroyed=function(){this.state=ne.STOPPED,this.fragmentTracker=null},u.computeLivePosition=function(t,n){var c=this.config.liveSyncDuration!==void 0?this.config.liveSyncDuration:this.config.liveSyncDurationCount*n.targetduration;return t+Math.max(0,n.totalduration-c)},m}(ft);function Ut(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function qt(y,m,u){return m&&Ut(y.prototype,m),y}function Vt(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var ur=100,br=function(y){Vt(m,y);function m(a,t){var n;return n=y.call(this,a,d.default.MEDIA_ATTACHED,d.default.MEDIA_DETACHING,d.default.MANIFEST_LOADING,d.default.MANIFEST_PARSED,d.default.LEVEL_LOADED,d.default.LEVELS_UPDATED,d.default.KEY_LOADED,d.default.FRAG_LOADED,d.default.FRAG_LOAD_EMERGENCY_ABORTED,d.default.FRAG_PARSING_INIT_SEGMENT,d.default.FRAG_PARSING_DATA,d.default.FRAG_PARSED,d.default.ERROR,d.default.AUDIO_TRACK_SWITCHING,d.default.AUDIO_TRACK_SWITCHED,d.default.BUFFER_CREATED,d.default.BUFFER_APPENDED,d.default.BUFFER_FLUSHED)||this,n.fragmentTracker=t,n.config=a.config,n.audioCodecSwap=!1,n._state=ne.STOPPED,n.stallReported=!1,n.gapController=null,n.altAudio=!1,n.audioOnly=!1,n.bitrateTest=!1,n}var u=m.prototype;return u.startLoad=function(t){if(this.levels){var n=this.lastCurrentTime,c=this.hls;if(this.stopLoad(),this.setInterval(ur),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var v=c.startLevel;v===-1&&(c.config.testBandwidth?(v=0,this.bitrateTest=!0):v=c.nextAutoLevel),this.level=c.nextLoadLevel=v,this.loadedmetadata=!1}n>0&&t===-1&&(h.logger.log("override startPosition with lastCurrentTime @"+n.toFixed(3)),t=n),this.state=ne.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this.forceStartLoad=!0,this.state=ne.STOPPED},u.stopLoad=function(){this.forceStartLoad=!1,y.prototype.stopLoad.call(this)},u.doTick=function(){switch(this.state){case ne.BUFFER_FLUSHING:this.fragLoadError=0;break;case ne.IDLE:this._doTickIdle();break;case ne.WAITING_LEVEL:var t=this.levels[this.level];t&&t.details&&(this.state=ne.IDLE);break;case ne.FRAG_LOADING_WAITING_RETRY:var n=window.performance.now(),c=this.retryDate;(!c||n>=c||this.media&&this.media.seeking)&&(h.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=ne.IDLE);break}this._checkBuffer(),this._checkFragmentChanged()},u._doTickIdle=function(){var t=this.hls,n=t.config,c=this.media;if(!(this.levelLastLoaded===void 0||!c&&(this.startFragRequested||!n.startFragPrefetch))){if(this.altAudio&&this.audioOnly){this.demuxer.frag=null;return}var v;this.loadedmetadata?v=c.currentTime:v=this.nextLoadPosition;var E=t.nextLoadLevel,w=this.levels[E];if(w){var C=w.bitrate,Y;C?Y=Math.max(8*n.maxBufferSize/C,n.maxBufferLength):Y=n.maxBufferLength,Y=Math.min(Y,n.maxMaxBufferLength);var B=v<n.maxBufferHole?Math.max(Ht,n.maxBufferHole):n.maxBufferHole,K=A.bufferInfo(this.mediaBuffer?this.mediaBuffer:c,v,B),Q=K.len;if(!(Q>=Y)){h.logger.trace("buffer length of "+Q.toFixed(3)+" is below max of "+Y.toFixed(3)+". checking for more payload ..."),this.level=t.nextLoadLevel=E;var _e=w.details;if(!_e||_e.live&&this.levelLastLoaded!==E){this.state=ne.WAITING_LEVEL;return}if(this._streamEnded(K,_e)){var Le={};this.altAudio&&(Le.type="video"),this.hls.trigger(d.default.BUFFER_EOS,Le),this.state=ne.ENDED;return}this._fetchPayloadOrEos(v,K,_e)}}}},u._fetchPayloadOrEos=function(t,n,c){var v=this.fragPrevious;this.level;var E=c.fragments,w=E.length;if(w!==0){var C=E[0].start,Y=E[w-1].start+E[w-1].duration,B=n.end,K;if(c.initSegment&&!c.initSegment.data)K=c.initSegment;else if(c.live){var Q=this.config.initialLiveManifestSize;if(w<Q){h.logger.warn("Can not start playback of a level, reason: not enough fragments "+w+" < "+Q);return}if(K=this._ensureFragmentAtLivePoint(c,B,C,Y,v,E),K===null)return}else B<C&&(K=E[0]);K||(K=this._findFragment(C,v,w,E,B,Y,c)),K&&(K.encrypted?this._loadKey(K,c):this._loadFragment(K,c,t,B))}},u._ensureFragmentAtLivePoint=function(t,n,c,v,E,w){var C=this.hls.config,Y=this.media,B,K=1/0;if(C.liveMaxLatencyDuration!==void 0?K=C.liveMaxLatencyDuration:Object(p.isFiniteNumber)(C.liveMaxLatencyDurationCount)&&(K=C.liveMaxLatencyDurationCount*t.targetduration),n<Math.max(c-C.maxFragLookUpTolerance,v-K)){var Q=this.liveSyncPosition=this.computeLivePosition(c,t);n=Q,Y&&!Y.paused&&Y.readyState&&Y.duration>Q&&Q>Y.currentTime&&(h.logger.log("buffer end: "+n.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+Q.toFixed(3)),Y.currentTime=Q),this.nextLoadPosition=Q}if(t.PTSKnown&&n>v&&Y&&Y.readyState)return null;if(this.startFragRequested&&!t.PTSKnown&&E)if(t.hasProgramDateTime)h.logger.log("live playlist, switching playlist, load frag with same PDT: "+E.programDateTime),B=Ft(w,E.endProgramDateTime,C.maxFragLookUpTolerance);else{var _e=E.sn+1;if(_e>=t.startSN&&_e<=t.endSN){var Le=w[_e-t.startSN];E.cc===Le.cc&&(B=Le,h.logger.log("live playlist, switching playlist, load frag with next SN: "+B.sn))}B||(B=U.search(w,function(Ue){return E.cc-Ue.cc}),B&&h.logger.log("live playlist, switching playlist, load frag with same CC: "+B.sn))}return B},u._findFragment=function(t,n,c,v,E,w,C){var Y=this.hls.config,B;if(E<w){var K=E>w-Y.maxFragLookUpTolerance?0:Y.maxFragLookUpTolerance;B=St(n,v,E,K)}else B=v[c-1];if(B){var Q=B.sn-C.startSN,_e=n&&B.level===n.level,Le=v[Q-1],Ue=v[Q+1];if(n&&B.sn===n.sn)if(_e&&!B.backtracked)if(B.sn<C.endSN){var Be=n.deltaPTS;Be&&Be>Y.maxBufferHole&&n.dropped&&Q?(B=Le,h.logger.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):(B=Ue,this.fragmentTracker.getState(B)!==de.OK&&h.logger.log("Re-loading fragment with SN: "+B.sn))}else B=null;else B.backtracked&&(Ue&&Ue.backtracked?(h.logger.warn("Already backtracked from fragment "+Ue.sn+", will not backtrack to fragment "+B.sn+". Loading fragment "+Ue.sn),B=Ue):(h.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),B.dropped=0,Le?(B=Le,B.backtracked=!0):Q&&(B=null)))}return B},u._loadKey=function(t,n){h.logger.log("Loading key for "+t.sn+" of ["+n.startSN+"-"+n.endSN+"], level "+this.level),this.state=ne.KEY_LOADING,this.hls.trigger(d.default.KEY_LOADING,{frag:t})},u._loadFragment=function(t,n,c,v){var E=this.fragmentTracker.getState(t);this.fragCurrent=t,t.sn!=="initSegment"&&(this.startFragRequested=!0),Object(p.isFiniteNumber)(t.sn)&&!t.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),t.backtracked||E===de.NOT_LOADED||E===de.PARTIAL?(t.autoLevel=this.hls.autoLevelEnabled,t.bitrateTest=this.bitrateTest,h.logger.log("Loading "+t.sn+" of ["+n.startSN+"-"+n.endSN+"], level "+this.level+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+parseFloat(c.toFixed(3))+", bufferEnd: "+parseFloat(v.toFixed(3))),this.hls.trigger(d.default.FRAG_LOADING,{frag:t}),this.demuxer||(this.demuxer=new le(this.hls,"main")),this.state=ne.FRAG_LOADING):E===de.APPENDING&&this._reduceMaxBufferLength(t.duration)&&this.fragmentTracker.removeFragment(t)},u.getBufferedFrag=function(t){return this.fragmentTracker.getBufferedFrag(t,b.MAIN)},u.followingBufferedFrag=function(t){return t?this.getBufferedFrag(t.endPTS+.5):null},u._checkFragmentChanged=function(){var t,n,c=this.media;if(c&&c.readyState&&c.seeking===!1&&(n=c.currentTime,n>this.lastCurrentTime&&(this.lastCurrentTime=n),A.isBuffered(c,n)?t=this.getBufferedFrag(n):A.isBuffered(c,n+.1)&&(t=this.getBufferedFrag(n+.1)),t)){var v=t;if(v!==this.fragPlaying){this.hls.trigger(d.default.FRAG_CHANGED,{frag:v});var E=v.level;(!this.fragPlaying||this.fragPlaying.level!==E)&&this.hls.trigger(d.default.LEVEL_SWITCHED,{level:E}),this.fragPlaying=v}}},u.immediateLevelSwitch=function(){if(h.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var t=this.media,n;t?(n=t.paused,n||t.pause()):n=!0,this.previouslyPaused=n}var c=this.fragCurrent;c&&c.loader&&c.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},u.immediateLevelSwitchEnd=function(){var t=this.media;t&&t.buffered.length&&(this.immediateSwitch=!1,t.currentTime>0&&A.isBuffered(t,t.currentTime)&&(t.currentTime-=1e-4),this.previouslyPaused||t.play())},u.nextLevelSwitch=function(){var t=this.media;if(t&&t.readyState){var n,c=this.getBufferedFrag(t.currentTime);if(c&&c.startPTS>1&&this.flushMainBuffer(0,c.startPTS-1),t.paused)n=0;else{var v=this.hls.nextLoadLevel,E=this.levels[v],w=this.fragLastKbps;w&&this.fragCurrent?n=this.fragCurrent.duration*E.bitrate/(1e3*w)+1:n=0}var C=this.getBufferedFrag(t.currentTime+n);if(C){var Y=this.followingBufferedFrag(C);if(Y){var B=this.fragCurrent;B&&B.loader&&B.loader.abort(),this.fragCurrent=null;var K=Math.max(C.endPTS,Y.maxStartPTS+Math.min(this.config.maxFragLookUpTolerance,Y.duration));this.flushMainBuffer(K,Number.POSITIVE_INFINITY)}}}},u.flushMainBuffer=function(t,n){this.state=ne.BUFFER_FLUSHING;var c={startOffset:t,endOffset:n};this.altAudio&&(c.type="video"),this.hls.trigger(d.default.BUFFER_FLUSHING,c)},u.onMediaAttached=function(t){var n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("seeked",this.onvseeked),n.addEventListener("ended",this.onvended);var c=this.config;this.levels&&c.autoStartLoad&&this.hls.startLoad(c.startPosition),this.gapController=new at(c,n,this.fragmentTracker,this.hls)},u.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(h.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var n=this.levels;n&&n.forEach(function(c){c.details&&c.details.fragments.forEach(function(v){v.backtracked=void 0})}),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("seeked",this.onvseeked),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},u.onMediaSeeked=function(){var t=this.media,n=t?t.currentTime:void 0;Object(p.isFiniteNumber)(n)&&h.logger.log("media seeked to "+n.toFixed(3)),this.tick()},u.onManifestLoading=function(){h.logger.log("trigger BUFFER_RESET"),this.hls.trigger(d.default.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},u.onManifestParsed=function(t){var n=!1,c=!1,v;t.levels.forEach(function(w){v=w.audioCodec,v&&(v.indexOf("mp4a.40.2")!==-1&&(n=!0),v.indexOf("mp4a.40.5")!==-1&&(c=!0))}),this.audioCodecSwitch=n&&c,this.audioCodecSwitch&&h.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=t.altAudio,this.levels=t.levels,this.startFragRequested=!1;var E=this.config;(E.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(E.startPosition)},u.onLevelLoaded=function(t){var n=t.details,c=t.level,v=this.levels[this.levelLastLoaded],E=this.levels[c],w=n.totalduration,C=0;if(h.logger.log("level "+c+" loaded ["+n.startSN+","+n.endSN+"],duration:"+w),n.live||E.details&&E.details.live){var Y=E.details;Y&&n.fragments.length>0?(Ie(Y,n),C=n.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(C,Y),n.PTSKnown&&Object(p.isFiniteNumber)(C)?h.logger.log("live playlist sliding:"+C.toFixed(3)):(h.logger.log("live playlist - outdated PTS, unknown sliding"),gt(this.fragPrevious,v,n))):(h.logger.log("live playlist - first load, unknown sliding"),n.PTSKnown=!1,gt(this.fragPrevious,v,n))}else n.PTSKnown=!1;if(E.details=n,this.levelLastLoaded=c,this.hls.trigger(d.default.LEVEL_UPDATED,{details:n,level:c}),this.startFragRequested===!1){if(this.startPosition===-1||this.lastCurrentTime===-1){var B=n.startTimeOffset;Object(p.isFiniteNumber)(B)?(B<0&&(h.logger.log("negative start time offset "+B+", count from end of last fragment"),B=C+w+B),h.logger.log("start time offset found in playlist, adjust startPosition to "+B),this.startPosition=B):n.live?(this.startPosition=this.computeLivePosition(C,n),h.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===ne.WAITING_LEVEL&&(this.state=ne.IDLE),this.tick()},u.onKeyLoaded=function(){this.state===ne.KEY_LOADING&&(this.state=ne.IDLE,this.tick())},u.onFragLoaded=function(t){var n=this.fragCurrent,c=this.hls,v=this.levels,E=this.media,w=t.frag;if(this.state===ne.FRAG_LOADING&&n&&w.type==="main"&&w.level===n.level&&w.sn===n.sn){var C=t.stats,Y=v[n.level],B=Y.details;if(this.bitrateTest=!1,this.stats=C,h.logger.log("Loaded "+n.sn+" of ["+B.startSN+" ,"+B.endSN+"],level "+n.level),w.bitrateTest&&c.nextLoadLevel)this.state=ne.IDLE,this.startFragRequested=!1,C.tparsed=C.tbuffered=window.performance.now(),c.trigger(d.default.FRAG_BUFFERED,{stats:C,frag:n,id:"main"}),this.tick();else if(w.sn==="initSegment")this.state=ne.IDLE,C.tparsed=C.tbuffered=window.performance.now(),B.initSegment.data=t.payload,c.trigger(d.default.FRAG_BUFFERED,{stats:C,frag:n,id:"main"}),this.tick();else{h.logger.log("Parsing "+n.sn+" of ["+B.startSN+" ,"+B.endSN+"],level "+n.level+", cc "+n.cc),this.state=ne.PARSING,this.pendingBuffering=!0,this.appended=!1,w.bitrateTest&&(w.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:w}));var K=!(E&&E.seeking)&&(B.PTSKnown||!B.live),Q=B.initSegment?B.initSegment.data:[],_e=this._getAudioCodec(Y),Le=this.demuxer=this.demuxer||new le(this.hls,"main");Le.push(t.payload,Q,_e,Y.videoCodec,n,B.totalduration,K)}}this.fragLoadError=0},u.onFragParsingInitSegment=function(t){var n=this.fragCurrent,c=t.frag;if(n&&t.id==="main"&&c.sn===n.sn&&c.level===n.level&&this.state===ne.PARSING){var v=t.tracks,E,w;if(this.audioOnly=v.audio&&!v.video,this.altAudio&&!this.audioOnly&&delete v.audio,w=v.audio,w){var C=this.levels[this.level].audioCodec,Y=navigator.userAgent.toLowerCase();C&&this.audioCodecSwap&&(h.logger.log("swapping playlist audio codec"),C.indexOf("mp4a.40.5")!==-1?C="mp4a.40.2":C="mp4a.40.5"),this.audioCodecSwitch&&w.metadata.channelCount!==1&&Y.indexOf("firefox")===-1&&(C="mp4a.40.5"),Y.indexOf("android")!==-1&&w.container!=="audio/mpeg"&&(C="mp4a.40.2",h.logger.log("Android: force audio codec to "+C)),w.levelCodec=C,w.id=t.id}w=v.video,w&&(w.levelCodec=this.levels[this.level].videoCodec,w.id=t.id),this.hls.trigger(d.default.BUFFER_CODECS,v);for(E in v){w=v[E],h.logger.log("main track:"+E+",container:"+w.container+",codecs[level/parsed]=["+w.levelCodec+"/"+w.codec+"]");var B=w.initSegment;B&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(d.default.BUFFER_APPENDING,{type:E,data:B,parent:"main",content:"initSegment"}))}this.tick()}},u.onFragParsingData=function(t){var n=this,c=this.fragCurrent,v=t.frag;if(c&&t.id==="main"&&v.sn===c.sn&&v.level===c.level&&!(t.type==="audio"&&this.altAudio)&&this.state===ne.PARSING){var E=this.levels[this.level],w=c;if(Object(p.isFiniteNumber)(t.endPTS)||(t.endPTS=t.startPTS+c.duration,t.endDTS=t.startDTS+c.duration),t.hasAudio===!0&&w.addElementaryStream(G.AUDIO),t.hasVideo===!0&&w.addElementaryStream(G.VIDEO),h.logger.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),t.type==="video")if(w.dropped=t.dropped,w.dropped)if(w.backtracked)h.logger.warn("Already backtracked on this fragment, appending with the gap",w.sn);else{var C=E.details;if(C&&w.sn===C.startSN)h.logger.warn("missing video frame(s) on first frag, appending with gap",w.sn);else{h.logger.warn("missing video frame(s), backtracking fragment",w.sn),this.fragmentTracker.removeFragment(w),w.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=ne.IDLE,this.fragPrevious=w,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.tick();return}}else w.backtracked=!1;var Y=ue(E.details,w,t.startPTS,t.endPTS,t.startDTS,t.endDTS),B=this.hls;B.trigger(d.default.LEVEL_PTS_UPDATED,{details:E.details,level:this.level,drift:Y,type:t.type,start:t.startPTS,end:t.endPTS}),[t.data1,t.data2].forEach(function(K){K&&K.length&&n.state===ne.PARSING&&(n.appended=!0,n.pendingBuffering=!0,B.trigger(d.default.BUFFER_APPENDING,{type:t.type,data:K,parent:"main",content:"data"}))}),this.tick()}},u.onFragParsed=function(t){var n=this.fragCurrent,c=t.frag;n&&t.id==="main"&&c.sn===n.sn&&c.level===n.level&&this.state===ne.PARSING&&(this.stats.tparsed=window.performance.now(),this.state=ne.PARSED,this._checkAppendedParsed())},u.onAudioTrackSwitching=function(t){var n=this.altAudio,c=!!t.url,v=t.id;if(!c){if(this.mediaBuffer!==this.media){h.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var E=this.fragCurrent;E.loader&&(h.logger.log("switching to main audio track, cancel main fragment load"),E.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=ne.IDLE}var w=this.hls;n&&w.trigger(d.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),w.trigger(d.default.AUDIO_TRACK_SWITCHED,{id:v})}},u.onAudioTrackSwitched=function(t){var n=t.id,c=!!this.hls.audioTracks[n].url;if(c){var v=this.videoBuffer;v&&this.mediaBuffer!==v&&(h.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=v)}this.altAudio=c,this.tick()},u.onBufferCreated=function(t){var n=t.tracks,c,v,E=!1;for(var w in n){var C=n[w];C.id==="main"?(v=w,c=C,w==="video"&&(this.videoBuffer=n[w].buffer)):E=!0}E&&c?(h.logger.log("alternate track found, use "+v+".buffered to schedule main fragment loading"),this.mediaBuffer=c.buffer):this.mediaBuffer=this.media},u.onBufferAppended=function(t){if(t.parent==="main"){var n=this.state;(n===ne.PARSING||n===ne.PARSED)&&(this.pendingBuffering=t.pending>0,this._checkAppendedParsed())}},u._checkAppendedParsed=function(){if(this.state===ne.PARSED&&(!this.appended||!this.pendingBuffering)){var t=this.fragCurrent;if(t){var n=this.mediaBuffer?this.mediaBuffer:this.media;h.logger.log("main buffered : "+qe.toString(n.buffered)),this.fragPrevious=t;var c=this.stats;c.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*c.total/(c.tbuffered-c.tfirst)),this.hls.trigger(d.default.FRAG_BUFFERED,{stats:c,frag:t,id:"main"}),this.state=ne.IDLE}(this.loadedmetadata||this.startPosition<=0)&&this.tick()}},u.onError=function(t){var n=t.frag||this.fragCurrent;if(!(n&&n.type!=="main")){var c=!!this.media&&A.isBuffered(this.media,this.media.currentTime)&&A.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case g.ErrorDetails.FRAG_LOAD_ERROR:case g.ErrorDetails.FRAG_LOAD_TIMEOUT:case g.ErrorDetails.KEY_LOAD_ERROR:case g.ErrorDetails.KEY_LOAD_TIMEOUT:if(!t.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var v=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);h.logger.warn("mediaController: frag loading failed, retry in "+v+" ms"),this.retryDate=window.performance.now()+v,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=ne.FRAG_LOADING_WAITING_RETRY}else h.logger.error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=ne.ERROR;break;case g.ErrorDetails.LEVEL_LOAD_ERROR:case g.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==ne.ERROR&&(t.fatal?(this.state=ne.ERROR,h.logger.warn("streamController: "+t.details+",switch to "+this.state+" state ...")):!t.levelRetry&&this.state===ne.WAITING_LEVEL&&(this.state=ne.IDLE));break;case g.ErrorDetails.BUFFER_FULL_ERROR:t.parent==="main"&&(this.state===ne.PARSING||this.state===ne.PARSED)&&(c?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=ne.IDLE):(h.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)));break}}},u._reduceMaxBufferLength=function(t){var n=this.config;return n.maxMaxBufferLength>=t?(n.maxMaxBufferLength/=2,h.logger.warn("main:reduce max buffer length to "+n.maxMaxBufferLength+"s"),!0):!1},u._checkBuffer=function(){var t=this.media;if(!(!t||t.readyState===0)){var n=this.mediaBuffer?this.mediaBuffer:t,c=n.buffered;!this.loadedmetadata&&c.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,c)}},u.onFragLoadEmergencyAborted=function(){this.state=ne.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},u.onBufferFlushed=function(){var t=this.mediaBuffer?this.mediaBuffer:this.media;if(t){var n=this.audioOnly?G.AUDIO:G.VIDEO;this.fragmentTracker.detectEvictedFragments(n,t.buffered)}this.state=ne.IDLE,this.fragPrevious=null},u.onLevelsUpdated=function(t){this.levels=t.levels},u.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},u._seekToStartPos=function(){var t=this.media,n=t.currentTime,c=this.startPosition;if(n!==c&&c>=0){if(t.seeking){h.logger.log("could not seek to "+c+", already seeking at "+n);return}var v=t.buffered.length?t.buffered.start(0):0,E=v-c;E>0&&E<this.config.maxBufferHole&&(h.logger.log("adjusting start position by "+E+" to match buffer start"),c+=E,this.startPosition=c),h.logger.log("seek to target start position "+c+" from current time "+n+". ready state "+t.readyState),t.currentTime=c}},u._getAudioCodec=function(t){var n=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&(h.logger.log("swapping playlist audio codec"),n&&(n.indexOf("mp4a.40.5")!==-1?n="mp4a.40.2":n="mp4a.40.5")),n},qt(m,[{key:"state",set:function(t){if(this.state!==t){var n=this.state;this._state=t,h.logger.log("main stream-controller: "+n+"->"+t),this.hls.trigger(d.default.STREAM_STATE_TRANSITION,{previousState:n,nextState:t})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var t=this.media;if(t){var n=this.getBufferedFrag(t.currentTime);if(n)return n.level}return-1}},{key:"nextBufferedFrag",get:function(){var t=this.media;return t?this.followingBufferedFrag(this.getBufferedFrag(t.currentTime)):null}},{key:"nextLevel",get:function(){var t=this.nextBufferedFrag;return t?t.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(t){this._liveSyncPosition=t}}]),m}(vt),qr=br;function hi(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function gn(y,m,u){return m&&hi(y.prototype,m),y}function In(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var Nr,gi=function(y){In(m,y);function m(a){var t;return t=y.call(this,a,d.default.MANIFEST_LOADED,d.default.LEVEL_LOADED,d.default.AUDIO_TRACK_SWITCHED,d.default.FRAG_LOADED,d.default.ERROR)||this,t.canload=!1,t.currentLevelIndex=null,t.manualLevelIndex=-1,t.timer=null,Nr=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),t}var u=m.prototype;return u.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},u.clearTimer=function(){this.timer!==null&&(clearTimeout(this.timer),this.timer=null)},u.startLoad=function(){var t=this._levels;this.canload=!0,this.levelRetryCount=0,t&&t.forEach(function(n){n.loadError=0;var c=n.details;c&&c.live&&(n.details=void 0)}),this.timer!==null&&this.loadLevel()},u.stopLoad=function(){this.canload=!1},u.onManifestLoaded=function(t){var n=[],c=[],v,E={},w=null,C=!1,Y=!1;if(t.levels.forEach(function(Q){var _e=Q.attrs;Q.loadError=0,Q.fragmentError=!1,C=C||!!Q.videoCodec,Y=Y||!!Q.audioCodec,Nr&&Q.audioCodec&&Q.audioCodec.indexOf("mp4a.40.34")!==-1&&(Q.audioCodec=void 0),w=E[Q.bitrate],w?w.url.push(Q.url):(Q.url=[Q.url],Q.urlId=0,E[Q.bitrate]=Q,n.push(Q)),_e&&(_e.AUDIO&&he(w||Q,"audio",_e.AUDIO),_e.SUBTITLES&&he(w||Q,"text",_e.SUBTITLES))}),C&&Y&&(n=n.filter(function(Q){var _e=Q.videoCodec;return!!_e})),n=n.filter(function(Q){var _e=Q.audioCodec,Le=Q.videoCodec;return(!_e||ve(_e,"audio"))&&(!Le||ve(Le,"video"))}),t.audioTracks&&(c=t.audioTracks.filter(function(Q){return!Q.audioCodec||ve(Q.audioCodec,"audio")}),c.forEach(function(Q,_e){Q.id=_e})),n.length>0){v=n[0].bitrate,n.sort(function(Q,_e){return Q.bitrate-_e.bitrate}),this._levels=n;for(var B=0;B<n.length;B++)if(n[B].bitrate===v){this._firstLevel=B,h.logger.log("manifest loaded,"+n.length+" level(s) found, first bitrate:"+v);break}var K=Y&&!C;this.hls.trigger(d.default.MANIFEST_PARSED,{levels:n,audioTracks:c,firstLevel:this._firstLevel,stats:t.stats,audio:Y,video:C,altAudio:!K&&c.some(function(Q){return!!Q.url})})}else this.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},u.setLevelInternal=function(t){var n=this._levels,c=this.hls;if(t>=0&&t<n.length){if(this.clearTimer(),this.currentLevelIndex!==t){h.logger.log("switching to level "+t),this.currentLevelIndex=t;var v=n[t];v.level=t,c.trigger(d.default.LEVEL_SWITCHING,v)}var E=n[t],w=E.details;if(!w||w.live){var C=E.urlId;c.trigger(d.default.LEVEL_LOADING,{url:E.url[C],level:t,id:C})}}else c.trigger(d.default.ERROR,{type:g.ErrorTypes.OTHER_ERROR,details:g.ErrorDetails.LEVEL_SWITCH_ERROR,level:t,fatal:!1,reason:"invalid level idx"})},u.onError=function(t){if(t.fatal){t.type===g.ErrorTypes.NETWORK_ERROR&&this.clearTimer();return}var n=!1,c=!1,v;switch(t.details){case g.ErrorDetails.FRAG_LOAD_ERROR:case g.ErrorDetails.FRAG_LOAD_TIMEOUT:case g.ErrorDetails.KEY_LOAD_ERROR:case g.ErrorDetails.KEY_LOAD_TIMEOUT:v=t.frag.level,c=!0;break;case g.ErrorDetails.LEVEL_LOAD_ERROR:case g.ErrorDetails.LEVEL_LOAD_TIMEOUT:v=t.context.level,n=!0;break;case g.ErrorDetails.REMUX_ALLOC_ERROR:v=t.level,n=!0;break}v!==void 0&&this.recoverLevel(t,v,n,c)},u.recoverLevel=function(t,n,c,v){var E=this,w=this.hls.config,C=t.details,Y=this._levels[n],B,K,Q;if(Y.loadError++,Y.fragmentError=v,c)if(this.levelRetryCount+1<=w.levelLoadingMaxRetry)K=Math.min(Math.pow(2,this.levelRetryCount)*w.levelLoadingRetryDelay,w.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return E.loadLevel()},K),t.levelRetry=!0,this.levelRetryCount++,h.logger.warn("level controller, "+C+", retry in "+K+" ms, current retry count is "+this.levelRetryCount);else{h.logger.error("level controller, cannot recover from "+C+" error"),this.currentLevelIndex=null,this.clearTimer(),t.fatal=!0;return}(c||v)&&(B=Y.url.length,B>1&&Y.loadError<B?(Y.urlId=(Y.urlId+1)%B,Y.details=void 0,h.logger.warn("level controller, "+C+" for level "+n+": switching to redundant URL-id "+Y.urlId)):this.manualLevelIndex===-1?(Q=n===0?this._levels.length-1:n-1,h.logger.warn("level controller, "+C+": switch to "+Q),this.hls.nextAutoLevel=this.currentLevelIndex=Q):v&&(h.logger.warn("level controller, "+C+": reload a fragment"),this.currentLevelIndex=null))},u.onFragLoaded=function(t){var n=t.frag;if(n!==void 0&&n.type==="main"){var c=this._levels[n.level];c!==void 0&&(c.fragmentError=!1,c.loadError=0,this.levelRetryCount=0)}},u.onLevelLoaded=function(t){var n=this,c=t.level,v=t.details;if(c===this.currentLevelIndex){var E=this._levels[c];if(E.fragmentError||(E.loadError=0,this.levelRetryCount=0),v.live){var w=Oe(E.details,v,t.stats.trequest);h.logger.log("live playlist, reload in "+Math.round(w)+" ms"),this.timer=setTimeout(function(){return n.loadLevel()},w)}else this.clearTimer()}},u.onAudioTrackSwitched=function(t){var n=this.hls.audioTracks[t.id].groupId,c=this.hls.levels[this.currentLevelIndex];if(c&&c.audioGroupIds){for(var v=-1,E=0;E<c.audioGroupIds.length;E++)if(c.audioGroupIds[E]===n){v=E;break}v!==c.urlId&&(c.urlId=v,this.startLoad())}},u.loadLevel=function(){if(h.logger.debug("call to loadLevel"),this.currentLevelIndex!==null&&this.canload){var t=this._levels[this.currentLevelIndex];if(typeof t=="object"&&t.url.length>0){var n=this.currentLevelIndex,c=t.urlId,v=t.url[c];h.logger.log("Attempt loading level index "+n+" with URL-id "+c),this.hls.trigger(d.default.LEVEL_LOADING,{url:v,level:n,id:c})}}},u.removeLevel=function(t,n){var c=this.levels.filter(function(v,E){return E!==t?!0:v.url.length>1&&n!==void 0?(v.url=v.url.filter(function(w,C){return C!==n}),v.urlId=0,!0):!1}).map(function(v,E){var w=v.details;return w&&w.fragments&&w.fragments.forEach(function(C){C.level=E}),v});this._levels=c,this.hls.trigger(d.default.LEVELS_UPDATED,{levels:c})},gn(m,[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(t){var n=this._levels;n&&(t=Math.min(t,n.length-1),(this.currentLevelIndex!==t||!n[t].details)&&this.setLevelInternal(t))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(t){this.manualLevelIndex=t,this._startLevel===void 0&&(this._startLevel=t),t!==-1&&(this.level=t)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(t){this._firstLevel=t}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var t=this.hls.config.startLevel;return t!==void 0?t:this._firstLevel}else return this._startLevel},set:function(t){this._startLevel=t}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(t){this.level=t,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=t)}}]),m}(x),mn=l("./src/demux/id3.js");function Jr(y,m){var u;try{u=new Event("addtrack")}catch{u=document.createEvent("Event"),u.initEvent("addtrack",!1,!1)}u.track=y,m.dispatchEvent(u)}function Yr(y){if(y!=null&&y.cues)for(;y.cues.length>0;)y.removeCue(y.cues[0])}function Pn(y,m){if(m<y[0].endTime)return y[0];if(m>y[y.length-1].endTime)return y[y.length-1];for(var u=0,a=y.length-1;u<=a;){var t=Math.floor((a+u)/2);if(m<y[t].endTime)a=t-1;else if(m>y[t].endTime)u=t+1;else return y[t]}return y[u].endTime-m<m-y[a].endTime?y[u]:y[a]}function On(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var Zr=.25,pn=function(y){On(m,y);function m(a){var t;return t=y.call(this,a,d.default.MEDIA_ATTACHED,d.default.MEDIA_DETACHING,d.default.FRAG_PARSING_METADATA,d.default.LIVE_BACK_BUFFER_REACHED)||this,t.id3Track=void 0,t.media=void 0,t}var u=m.prototype;return u.destroy=function(){x.prototype.destroy.call(this)},u.onMediaAttached=function(t){this.media=t.media,this.media},u.onMediaDetaching=function(){Yr(this.id3Track),this.id3Track=void 0,this.media=void 0},u.getID3Track=function(t){for(var n=0;n<t.length;n++){var c=t[n];if(c.kind==="metadata"&&c.label==="id3")return Jr(c,this.media),c}return this.media.addTextTrack("metadata","id3")},u.onFragParsingMetadata=function(t){var n=t.frag,c=t.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var v=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,E=0;E<c.length;E++){var w=mn.default.getID3Frames(c[E].data);if(w){var C=Math.max(c[E].pts,0),Y=E<c.length-1?c[E+1].pts:n.endPTS;Y||(Y=n.start+n.duration);var B=Y-C;B<=0&&(Y=C+Zr);for(var K=0;K<w.length;K++){var Q=w[K];if(!mn.default.isTimeStampFrame(Q)){var _e=new v(C,Y,"");_e.value=Q,this.id3Track.addCue(_e)}}}}},u.onLiveBackBufferReached=function(t){var n=t.bufferEnd,c=this.id3Track;if(!(!c||!c.cues||!c.cues.length)){var v=Pn(c.cues,n);if(v)for(;c.cues[0]!==v;)c.removeCue(c.cues[0])}},m}(x),mi=pn;function pi(){var y=z();if(!y)return!1;var m=self.SourceBuffer||self.WebKitSourceBuffer,u=y&&typeof y.isTypeSupported=="function"&&y.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),a=!m||m.prototype&&typeof m.prototype.appendBuffer=="function"&&typeof m.prototype.remove=="function";return!!u&&!!a}var Xo=function(){function y(u){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=u?Math.exp(Math.log(.5)/u):0,this.estimate_=0,this.totalWeight_=0}var m=y.prototype;return m.sample=function(a,t){var n=Math.pow(this.alpha_,a);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=a},m.getTotalWeight=function(){return this.totalWeight_},m.getEstimate=function(){if(this.alpha_){var a=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/a}else return this.estimate_},y}(),pa=Xo,qo=function(){function y(u,a,t,n){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=u,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new pa(a),this.fast_=new pa(t)}var m=y.prototype;return m.sample=function(a,t){a=Math.max(a,this.minDelayMs_);var n=8*t,c=a/1e3,v=n/c;this.fast_.sample(c,v),this.slow_.sample(c,v)},m.canEstimate=function(){var a=this.fast_;return a&&a.getTotalWeight()>=this.minWeight_},m.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},m.destroy=function(){},y}(),Jo=qo;function Zo(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function Qo(y,m,u){return m&&Zo(y.prototype,m),y}function el(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function tl(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var rl=window,nl=rl.performance,il=function(y){tl(m,y);function m(a){var t;return t=y.call(this,a,d.default.FRAG_LOADING,d.default.FRAG_LOADED,d.default.FRAG_BUFFERED,d.default.ERROR)||this,t.lastLoadedFragLevel=0,t._nextAutoLevel=-1,t.hls=a,t.timer=null,t._bwEstimator=null,t.onCheck=t._abandonRulesCheck.bind(el(t)),t}var u=m.prototype;return u.destroy=function(){this.clearTimer(),x.prototype.destroy.call(this)},u.onFragLoading=function(t){var n=t.frag;if(n.type==="main"&&(this.timer||(this.fragCurrent=n,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var c=this.hls,v=c.config,E=n.level,w=c.levels[E].details.live,C,Y;w?(C=v.abrEwmaFastLive,Y=v.abrEwmaSlowLive):(C=v.abrEwmaFastVoD,Y=v.abrEwmaSlowVoD),this._bwEstimator=new Jo(c,Y,C,v.abrEwmaDefaultEstimate)}},u._abandonRulesCheck=function(){var t=this.hls,n=t.media,c=this.fragCurrent;if(c){var v=c.loader;if(!v||v.stats&&v.stats.aborted){h.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}var E=v.stats;if(n&&E&&(!n.paused&&n.playbackRate!==0||!n.readyState)&&c.autoLevel&&c.level){var w=nl.now()-E.trequest,C=Math.abs(n.playbackRate);if(w>500*c.duration/C){var Y=t.levels,B=Math.max(1,E.bw?E.bw/8:E.loaded*1e3/w),K=Y[c.level];if(!K)return;var Q=K.realBitrate?Math.max(K.realBitrate,K.bitrate):K.bitrate,_e=E.total?E.total:Math.max(E.loaded,Math.round(c.duration*Q/8)),Le=n.currentTime,Ue=(_e-E.loaded)/B,Be=(A.bufferInfo(n,Le,t.config.maxBufferHole).end-Le)/C;if(Be<2*c.duration/C&&Ue>Be){var Ke=t.minAutoLevel,Ze,st;for(st=c.level-1;st>Ke;st--){var xt=Y[st].realBitrate?Math.max(Y[st].realBitrate,Y[st].bitrate):Y[st].bitrate,rr=c.duration*xt/(8*.8*B);if(rr<Be)break}Ze<Ue&&(h.logger.warn("loading too slow, abort fragment loading and switch to level "+st+":fragLoadedDelay["+st+"]<fragLoadedDelay["+(c.level-1)+"];bufferStarvationDelay:"+Ze.toFixed(1)+"<"+Ue.toFixed(1)+":"+Be.toFixed(1)),t.nextLoadLevel=st,this._bwEstimator.sample(w,E.loaded),v.abort(),this.clearTimer(),t.trigger(d.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:c,stats:E}))}}}}},u.onFragLoaded=function(t){var n=t.frag;if(n.type==="main"&&Object(p.isFiniteNumber)(n.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=n.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var c=this.hls.levels[n.level],v=(c.loaded?c.loaded.bytes:0)+t.stats.loaded,E=(c.loaded?c.loaded.duration:0)+t.frag.duration;c.loaded={bytes:v,duration:E},c.realBitrate=Math.round(8*v/E)}if(t.frag.bitrateTest){var w=t.stats;w.tparsed=w.tbuffered=w.tload,this.onFragBuffered(t)}}},u.onFragBuffered=function(t){var n=t.stats,c=t.frag;if(n.aborted!==!0&&c.type==="main"&&Object(p.isFiniteNumber)(c.sn)&&(!c.bitrateTest||n.tload===n.tbuffered)){var v=n.tparsed-n.trequest;h.logger.log("latency/loading/parsing/append/kbps:"+Math.round(n.tfirst-n.trequest)+"/"+Math.round(n.tload-n.tfirst)+"/"+Math.round(n.tparsed-n.tload)+"/"+Math.round(n.tbuffered-n.tparsed)+"/"+Math.round(8*n.loaded/(n.tbuffered-n.trequest))),this._bwEstimator.sample(v,n.loaded),n.bwEstimate=this._bwEstimator.getEstimate(),c.bitrateTest?this.bitrateTestDelay=v/1e3:this.bitrateTestDelay=0}},u.onError=function(t){switch(t.details){case g.ErrorDetails.FRAG_LOAD_ERROR:case g.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},u.clearTimer=function(){clearInterval(this.timer),this.timer=null},u._findBestLevel=function(t,n,c,v,E,w,C,Y,B){for(var K=E;K>=v;K--){var Q=B[K];if(Q){var _e=Q.details,Le=_e?_e.totalduration/_e.fragments.length:n,Ue=_e?_e.live:!1,Be=void 0;K<=t?Be=C*c:Be=Y*c;var Ke=B[K].realBitrate?Math.max(B[K].realBitrate,B[K].bitrate):B[K].bitrate,Ze=Ke*Le/Be;if(h.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+K+"/"+Math.round(Be)+"/"+Ke+"/"+Le+"/"+w+"/"+Ze),Be>Ke&&(!Ze||Ue&&!this.bitrateTestDelay||Ze<w))return K}}return-1},Qo(m,[{key:"nextAutoLevel",get:function(){var t=this._nextAutoLevel,n=this._bwEstimator;if(t!==-1&&(!n||!n.canEstimate()))return t;var c=this._nextABRAutoLevel;return t!==-1&&(c=Math.min(t,c)),c},set:function(t){this._nextAutoLevel=t}},{key:"_nextABRAutoLevel",get:function(){var t=this.hls,n=t.maxAutoLevel,c=t.levels,v=t.config,E=t.minAutoLevel,w=t.media,C=this.lastLoadedFragLevel,Y=this.fragCurrent?this.fragCurrent.duration:0,B=w?w.currentTime:0,K=w&&w.playbackRate!==0?Math.abs(w.playbackRate):1,Q=this._bwEstimator?this._bwEstimator.getEstimate():v.abrEwmaDefaultEstimate,_e=(A.bufferInfo(w,B,v.maxBufferHole).end-B)/K,Le=this._findBestLevel(C,Y,Q,E,n,_e,v.abrBandWidthFactor,v.abrBandWidthUpFactor,c);if(Le>=0)return Le;h.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var Ue=Y?Math.min(Y,v.maxStarvationDelay):v.maxStarvationDelay,Be=v.abrBandWidthFactor,Ke=v.abrBandWidthUpFactor;if(_e===0){var Ze=this.bitrateTestDelay;if(Ze){var st=Y?Math.min(Y,v.maxLoadingDelay):v.maxLoadingDelay;Ue=st-Ze,h.logger.trace("bitrate test took "+Math.round(1e3*Ze)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*Ue)+" ms"),Be=Ke=1}}return Le=this._findBestLevel(C,Y,Q,E,n,_e+Ue,Be,Ke,c),Math.max(Le,0)}}]),m}(x),al=il;function sl(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var va=z(),ol=function(y){sl(m,y);function m(a){var t;return t=y.call(this,a,d.default.MEDIA_ATTACHING,d.default.MEDIA_DETACHING,d.default.MANIFEST_PARSED,d.default.BUFFER_RESET,d.default.BUFFER_APPENDING,d.default.BUFFER_CODECS,d.default.BUFFER_EOS,d.default.BUFFER_FLUSHING,d.default.LEVEL_PTS_UPDATED,d.default.LEVEL_UPDATED)||this,t._msDuration=null,t._levelDuration=null,t._levelTargetDuration=10,t._live=null,t._objectUrl=null,t._needsFlush=!1,t._needsEos=!1,t.config=void 0,t.audioTimestampOffset=void 0,t.bufferCodecEventsExpected=0,t._bufferCodecEventsTotal=0,t.media=null,t.mediaSource=null,t.segments=[],t.parent=void 0,t.appending=!1,t.appended=0,t.appendError=0,t.flushBufferCounter=0,t.tracks={},t.pendingTracks={},t.sourceBuffer={},t.flushRange=[],t._onMediaSourceOpen=function(){h.logger.log("media source opened"),t.hls.trigger(d.default.MEDIA_ATTACHED,{media:t.media});var n=t.mediaSource;n&&n.removeEventListener("sourceopen",t._onMediaSourceOpen),t.checkPendingTracks()},t._onMediaSourceClose=function(){h.logger.log("media source closed")},t._onMediaSourceEnded=function(){h.logger.log("media source ended")},t._onSBUpdateEnd=function(){if(t.audioTimestampOffset&&t.sourceBuffer.audio){var n=t.sourceBuffer.audio;h.logger.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+t.audioTimestampOffset),n.timestampOffset=t.audioTimestampOffset,delete t.audioTimestampOffset}t._needsFlush&&t.doFlush(),t._needsEos&&t.checkEos(),t.appending=!1;var c=t.parent,v=t.segments.reduce(function(B,K){return K.parent===c?B+1:B},0),E={},w=t.sourceBuffer;for(var C in w){var Y=w[C];if(!Y)throw Error("handling source buffer update end error: source buffer for "+C+" uninitilized and unable to update buffered TimeRanges.");E[C]=Y.buffered}t.hls.trigger(d.default.BUFFER_APPENDED,{parent:c,pending:v,timeRanges:E}),t._needsFlush||t.doAppending(),t.updateMediaElementDuration(),v===0&&t.flushLiveBackBuffer()},t._onSBUpdateError=function(n){h.logger.error("sourceBuffer error:",n),t.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},t.config=a.config,t}var u=m.prototype;return u.destroy=function(){x.prototype.destroy.call(this)},u.onLevelPtsUpdated=function(t){var n=t.type,c=this.tracks.audio;if(n==="audio"&&c&&c.container==="audio/mpeg"){var v=this.sourceBuffer.audio;if(!v)throw Error("Level PTS Updated and source buffer for audio uninitalized");var E=Math.abs(v.timestampOffset-t.start);if(E>.1){var w=v.updating;try{v.abort()}catch(C){h.logger.warn("can not abort audio buffer: "+C)}w?this.audioTimestampOffset=t.start:(h.logger.warn("change mpeg audio timestamp offset from "+v.timestampOffset+" to "+t.start),v.timestampOffset=t.start)}}},u.onManifestParsed=function(t){var n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,h.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},u.onMediaAttaching=function(t){var n=this.media=t.media;if(n&&va){var c=this.mediaSource=new va;c.addEventListener("sourceopen",this._onMediaSourceOpen),c.addEventListener("sourceended",this._onMediaSourceEnded),c.addEventListener("sourceclose",this._onMediaSourceClose),n.src=window.URL.createObjectURL(c),this._objectUrl=n.src}},u.onMediaDetaching=function(){h.logger.log("media source detaching");var t=this.mediaSource;if(t){if(t.readyState==="open")try{t.endOfStream()}catch(n){h.logger.warn("onMediaDetaching:"+n.message+" while calling endOfStream")}t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):h.logger.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(d.default.MEDIA_DETACHED)},u.checkPendingTracks=function(){var t=this.bufferCodecEventsExpected,n=this.pendingTracks,c=Object.keys(n).length;(c&&!t||c===2)&&(this.createSourceBuffers(n),this.pendingTracks={},this.doAppending())},u.onBufferReset=function(){var t=this.sourceBuffer;for(var n in t){var c=t[n];try{c&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(c),c.removeEventListener("updateend",this._onSBUpdateEnd),c.removeEventListener("error",this._onSBUpdateError))}catch{}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},u.onBufferCodecs=function(t){var n=this;Object.keys(this.sourceBuffer).length||(Object.keys(t).forEach(function(c){n.pendingTracks[c]=t[c]}),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},u.createSourceBuffers=function(t){var n=this.sourceBuffer,c=this.mediaSource;if(!c)throw Error("createSourceBuffers called when mediaSource was null");for(var v in t)if(!n[v]){var E=t[v];if(!E)throw Error("source buffer exists for track "+v+", however track does not");var w=E.levelCodec||E.codec,C=E.container+";codecs="+w;h.logger.log("creating sourceBuffer("+C+")");try{var Y=n[v]=c.addSourceBuffer(C);Y.addEventListener("updateend",this._onSBUpdateEnd),Y.addEventListener("error",this._onSBUpdateError),this.tracks[v]={buffer:Y,codec:w,id:E.id,container:E.container,levelCodec:E.levelCodec}}catch(B){h.logger.error("error while trying to add sourceBuffer:"+B.message),this.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:B,mimeType:C})}}this.hls.trigger(d.default.BUFFER_CREATED,{tracks:this.tracks})},u.onBufferAppending=function(t){this._needsFlush||(this.segments?this.segments.push(t):this.segments=[t],this.doAppending())},u.onBufferEos=function(t){for(var n in this.sourceBuffer)if(!t.type||t.type===n){var c=this.sourceBuffer[n];c&&!c.ended&&(c.ended=!0,h.logger.log(n+" sourceBuffer now EOS"))}this.checkEos()},u.checkEos=function(){var t=this.sourceBuffer,n=this.mediaSource;if(!n||n.readyState!=="open"){this._needsEos=!1;return}for(var c in t){var v=t[c];if(v){if(!v.ended)return;if(v.updating){this._needsEos=!0;return}}}h.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{n.endOfStream()}catch{h.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1},u.onBufferFlushing=function(t){t.type?this.flushRange.push({start:t.startOffset,end:t.endOffset,type:t.type}):(this.flushRange.push({start:t.startOffset,end:t.endOffset,type:"video"}),this.flushRange.push({start:t.startOffset,end:t.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},u.flushLiveBackBuffer=function(){if(this._live){var t=this.config.liveBackBufferLength;if(!(!isFinite(t)||t<0)){if(!this.media){h.logger.error("flushLiveBackBuffer called without attaching media");return}for(var n=this.media.currentTime,c=this.sourceBuffer,v=Object.keys(c),E=n-Math.max(t,this._levelTargetDuration),w=v.length-1;w>=0;w--){var C=v[w],Y=c[C];if(Y){var B=Y.buffered;B.length>0&&E>B.start(0)&&this.removeBufferRange(C,Y,0,E)&&this.hls.trigger(d.default.LIVE_BACK_BUFFER_REACHED,{bufferEnd:E})}}}}},u.onLevelUpdated=function(t){var n=t.details;n.fragments.length>0&&(this._levelDuration=n.totalduration+n.fragments[0].start,this._levelTargetDuration=n.averagetargetduration||n.targetduration||10,this._live=n.live,this.updateMediaElementDuration())},u.updateMediaElementDuration=function(){var t=this.config,n;if(!(this._levelDuration===null||!this.media||!this.mediaSource||!this.sourceBuffer||this.media.readyState===0||this.mediaSource.readyState!=="open")){for(var c in this.sourceBuffer){var v=this.sourceBuffer[c];if(v&&v.updating===!0)return}n=this.media.duration,this._msDuration===null&&(this._msDuration=this.mediaSource.duration),this._live===!0&&t.liveDurationInfinity===!0?(h.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>n||!Object(p.isFiniteNumber)(n))&&(h.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},u.doFlush=function(){for(;this.flushRange.length;){var t=this.flushRange[0];if(this.flushBuffer(t.start,t.end,t.type))this.flushRange.shift(),this.flushBufferCounter=0;else{this._needsFlush=!0;return}}if(this.flushRange.length===0){this._needsFlush=!1;var n=0,c=this.sourceBuffer;try{for(var v in c){var E=c[v];E&&(n+=E.buffered.length)}}catch{h.logger.error("error while accessing sourceBuffer.buffered")}this.appended=n,this.hls.trigger(d.default.BUFFER_FLUSHED)}},u.doAppending=function(){var t=this.config,n=this.hls,c=this.segments,v=this.sourceBuffer;if(Object.keys(v).length){if(!this.media||this.media.error){this.segments=[],h.logger.error("trying to append although a media error occured, flush segment and abort");return}if(!this.appending){var E=c.shift();if(E)try{var w=v[E.type];if(!w){this._onSBUpdateEnd();return}if(w.updating){c.unshift(E);return}w.ended=!1,this.parent=E.parent,w.appendBuffer(E.data),this.appendError=0,this.appended++,this.appending=!0}catch(Y){h.logger.error("error while trying to append buffer:"+Y.message),c.unshift(E);var C={type:g.ErrorTypes.MEDIA_ERROR,parent:E.parent,details:"",fatal:!1};Y.code===22?(this.segments=[],C.details=g.ErrorDetails.BUFFER_FULL_ERROR):(this.appendError++,C.details=g.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>t.appendErrorMaxRetry&&(h.logger.log("fail "+t.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],C.fatal=!0)),n.trigger(d.default.ERROR,C)}}}},u.flushBuffer=function(t,n,c){var v=this.sourceBuffer;if(!Object.keys(v).length)return!0;var E="null";if(this.media&&(E=this.media.currentTime.toFixed(3)),h.logger.log("flushBuffer,pos/start/end: "+E+"/"+t+"/"+n),this.flushBufferCounter>=this.appended)return h.logger.warn("abort flushing too many retries"),!0;var w=v[c];if(w){if(w.ended=!1,w.updating)return h.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(c,w,t,n))return this.flushBufferCounter++,!1}return h.logger.log("buffer flushed"),!0},u.removeBufferRange=function(t,n,c,v){try{for(var E=0;E<n.buffered.length;E++){var w=n.buffered.start(E),C=n.buffered.end(E),Y=Math.max(w,c),B=Math.min(C,v);if(Math.min(B,C)-Y>.5){var K="null";return this.media&&(K=this.media.currentTime.toString()),h.logger.log("sb remove "+t+" ["+Y+","+B+"], of ["+w+","+C+"], pos:"+K),n.remove(Y,B),!0}}}catch(Q){h.logger.warn("removeBufferRange failed",Q)}return!1},m}(x),ll=ol;function _a(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function ul(y,m,u){return m&&_a(y.prototype,m),u&&_a(y,u),y}function cl(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var dl=function(y){cl(m,y);function m(a){var t;return t=y.call(this,a,d.default.FPS_DROP_LEVEL_CAPPING,d.default.MEDIA_ATTACHING,d.default.MANIFEST_PARSED,d.default.LEVELS_UPDATED,d.default.BUFFER_CODECS,d.default.MEDIA_DETACHING)||this,t.autoLevelCapping=Number.POSITIVE_INFINITY,t.firstLevel=null,t.levels=[],t.media=null,t.restrictedLevels=[],t.timer=null,t.clientRect=null,t}var u=m.prototype;return u.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.clientRect=null,this.stopCapping())},u.onFpsDropLevelCapping=function(t){m.isLevelAllowed(t.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(t.droppedLevel)},u.onMediaAttaching=function(t){this.media=t.media instanceof window.HTMLVideoElement?t.media:null},u.onManifestParsed=function(t){var n=this.hls;this.restrictedLevels=[],this.levels=t.levels,this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()},u.onBufferCodecs=function(t){var n=this.hls;n.config.capLevelToPlayerSize&&t.video&&this.startCapping()},u.onLevelsUpdated=function(t){this.levels=t.levels},u.onMediaDetaching=function(){this.stopCapping()},u.detectPlayerSize=function(){if(this.media){var t=this.levels?this.levels.length:0;if(t){var n=this.hls;n.autoLevelCapping=this.getMaxLevel(t-1),n.autoLevelCapping>this.autoLevelCapping&&n.streamController.nextLevelSwitch(),this.autoLevelCapping=n.autoLevelCapping}}},u.getMaxLevel=function(t){var n=this;if(!this.levels)return-1;var c=this.levels.filter(function(v,E){return m.isLevelAllowed(E,n.restrictedLevels)&&E<=t});return this.clientRect=null,m.getMaxLevelByMediaSize(c,this.mediaWidth,this.mediaHeight)},u.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},u.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},u.getDimensions=function(){if(this.clientRect)return this.clientRect;var t=this.media,n={width:0,height:0};if(t){var c=t.getBoundingClientRect();n.width=c.width,n.height=c.height,!n.width&&!n.height&&(n.width=c.right-c.left||t.width||0,n.height=c.bottom-c.top||t.height||0)}return this.clientRect=n,n},m.isLevelAllowed=function(t,n){return n===void 0&&(n=[]),n.indexOf(t)===-1},m.getMaxLevelByMediaSize=function(t,n,c){if(!t||t&&!t.length)return-1;for(var v=function(B,K){return K?B.width!==K.width||B.height!==K.height:!0},E=t.length-1,w=0;w<t.length;w+=1){var C=t[w];if((C.width>=n||C.height>=c)&&v(C,t[w+1])){E=w;break}}return E},ul(m,[{key:"mediaWidth",get:function(){return this.getDimensions().width*m.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*m.contentScaleFactor}}],[{key:"contentScaleFactor",get:function(){var t=1;try{t=window.devicePixelRatio}catch{}return t}}]),m}(x),fl=dl;function hl(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var gl=window,ml=gl.performance,pl=function(y){hl(m,y);function m(a){return y.call(this,a,d.default.MEDIA_ATTACHING)||this}var u=m.prototype;return u.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},u.onMediaAttaching=function(t){var n=this.hls.config;if(n.capLevelOnFPSDrop){var c=this.video=t.media instanceof window.HTMLVideoElement?t.media:null;typeof c.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}},u.checkFPS=function(t,n,c){var v=ml.now();if(n){if(this.lastTime){var E=v-this.lastTime,w=c-this.lastDroppedFrames,C=n-this.lastDecodedFrames,Y=1e3*w/E,B=this.hls;if(B.trigger(d.default.FPS_DROP,{currentDropped:w,currentDecoded:C,totalDroppedFrames:c}),Y>0&&w>B.config.fpsDroppedMonitoringThreshold*C){var K=B.currentLevel;h.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+K),K>0&&(B.autoLevelCapping===-1||B.autoLevelCapping>=K)&&(K=K-1,B.trigger(d.default.FPS_DROP_LEVEL_CAPPING,{level:K,droppedLevel:B.currentLevel}),B.autoLevelCapping=K,B.streamController.nextLevelSwitch())}}this.lastTime=v,this.lastDroppedFrames=c,this.lastDecodedFrames=n}},u.checkFPSInterval=function(){var t=this.video;if(t)if(this.isVideoPlaybackQualityAvailable){var n=t.getVideoPlaybackQuality();this.checkFPS(t,n.totalVideoFrames,n.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)},m}(x),vl=pl,_l=function(){function y(u){u&&u.xhrSetup&&(this.xhrSetup=u.xhrSetup)}var m=y.prototype;return m.destroy=function(){this.abort(),this.loader=null},m.abort=function(){var a=this.loader;a&&a.readyState!==4&&(this.stats.aborted=!0,a.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},m.load=function(a,t,n){this.context=a,this.config=t,this.callbacks=n,this.stats={trequest:window.performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},m.loadInternal=function(){var a,t=this.context;a=this.loader=new window.XMLHttpRequest;var n=this.stats;n.tfirst=0,n.loaded=0;var c=this.xhrSetup;try{if(c)try{c(a,t.url)}catch{a.open("GET",t.url,!0),c(a,t.url)}a.readyState||a.open("GET",t.url,!0)}catch(v){this.callbacks.onError({code:a.status,text:v.message},t,a);return}t.rangeEnd&&a.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),a.onreadystatechange=this.readystatechange.bind(this),a.onprogress=this.loadprogress.bind(this),a.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),a.send()},m.readystatechange=function(a){var t=a.currentTarget,n=t.readyState,c=this.stats,v=this.context,E=this.config;if(!c.aborted&&n>=2)if(window.clearTimeout(this.requestTimeout),c.tfirst===0&&(c.tfirst=Math.max(window.performance.now(),c.trequest)),n===4){var w=t.status;if(w>=200&&w<300){c.tload=Math.max(c.tfirst,window.performance.now());var C,Y;v.responseType==="arraybuffer"?(C=t.response,Y=C.byteLength):(C=t.responseText,Y=C.length),c.loaded=c.total=Y;var B={url:t.responseURL,data:C};this.callbacks.onSuccess(B,c,v,t)}else c.retry>=E.maxRetry||w>=400&&w<499?(h.logger.error(w+" while loading "+v.url),this.callbacks.onError({code:w,text:t.statusText},v,t)):(h.logger.warn(w+" while loading "+v.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,E.maxRetryDelay),c.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),E.timeout)},m.loadtimeout=function(){h.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},m.loadprogress=function(a){var t=a.currentTarget,n=this.stats;n.loaded=a.loaded,a.lengthComputable&&(n.total=a.total);var c=this.callbacks.onProgress;c&&c(n,this.context,null,t)},y}(),yl=_l;function bl(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function Sl(y,m,u){return m&&bl(y.prototype,m),y}function El(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var xl=function(y){El(m,y);function m(a){var t;return t=y.call(this,a,d.default.MANIFEST_LOADING,d.default.MANIFEST_PARSED,d.default.AUDIO_TRACK_LOADED,d.default.AUDIO_TRACK_SWITCHED,d.default.LEVEL_LOADED,d.default.ERROR)||this,t._trackId=-1,t._selectDefaultTrack=!0,t.tracks=[],t.trackIdBlacklist=Object.create(null),t.audioGroupId=null,t}var u=m.prototype;return u.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},u.onManifestParsed=function(t){var n=this.tracks=t.audioTracks||[];this.hls.trigger(d.default.AUDIO_TRACKS_UPDATED,{audioTracks:n}),this._selectAudioGroup(this.hls.nextLoadLevel)},u.onAudioTrackLoaded=function(t){if(t.id>=this.tracks.length){h.logger.warn("Invalid audio track id:",t.id);return}if(h.logger.log("audioTrack "+t.id+" loaded"),this.tracks[t.id].details=t.details,t.details.live&&!this.hasInterval()){var n=t.details.targetduration*1e3;this.setInterval(n)}!t.details.live&&this.hasInterval()&&this.clearInterval()},u.onAudioTrackSwitched=function(t){var n=this.tracks[t.id].groupId;n&&this.audioGroupId!==n&&(this.audioGroupId=n)},u.onLevelLoaded=function(t){this._selectAudioGroup(t.level)},u.onError=function(t){t.type===g.ErrorTypes.NETWORK_ERROR&&(t.fatal&&this.clearInterval(),t.details===g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(h.logger.warn("Network failure on audio-track id:",t.context.id),this._handleLoadError()))},u._setAudioTrack=function(t){if(this._trackId===t&&this.tracks[this._trackId].details){h.logger.debug("Same id as current audio-track passed, and track details available -> no-op");return}if(t<0||t>=this.tracks.length){h.logger.warn("Invalid id passed to audio-track controller");return}var n=this.tracks[t];h.logger.log("Now switching to audio-track index "+t),this.clearInterval(),this._trackId=t;var c=n.url,v=n.type,E=n.id;this.hls.trigger(d.default.AUDIO_TRACK_SWITCHING,{id:E,type:v,url:c}),this._loadTrackDetailsIfNeeded(n)},u.doTick=function(){this._updateTrack(this._trackId)},u._selectAudioGroup=function(t){var n=this.hls.levels[t];if(!(!n||!n.audioGroupIds)){var c=n.audioGroupIds[n.urlId];this.audioGroupId!==c&&(this.audioGroupId=c,this._selectInitialAudioTrack())}},u._selectInitialAudioTrack=function(){var t=this,n=this.tracks;if(n.length){var c=this.tracks[this._trackId],v=null;if(c&&(v=c.name),this._selectDefaultTrack){var E=n.filter(function(Y){return Y.default});E.length?n=E:h.logger.warn("No default audio tracks defined")}var w=!1,C=function(){n.forEach(function(B){w||(!t.audioGroupId||B.groupId===t.audioGroupId)&&(!v||v===B.name)&&(t._setAudioTrack(B.id),w=!0)})};C(),w||(v=null,C()),w||(h.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},u._needsTrackLoading=function(t){var n=t.details,c=t.url;return!n||n.live?!!c:!1},u._loadTrackDetailsIfNeeded=function(t){if(this._needsTrackLoading(t)){var n=t.url,c=t.id;h.logger.log("loading audio-track playlist for id: "+c),this.hls.trigger(d.default.AUDIO_TRACK_LOADING,{url:n,id:c})}},u._updateTrack=function(t){if(!(t<0||t>=this.tracks.length)){this.clearInterval(),this._trackId=t,h.logger.log("trying to update audio-track "+t);var n=this.tracks[t];this._loadTrackDetailsIfNeeded(n)}},u._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var t=this._trackId,n=this.tracks[t],c=n.name,v=n.language,E=n.groupId;h.logger.warn("Loading failed on audio track id: "+t+", group-id: "+E+', name/language: "'+c+'" / "'+v+'"');for(var w=t,C=0;C<this.tracks.length;C++)if(!this.trackIdBlacklist[C]){var Y=this.tracks[C];if(Y.name===c){w=C;break}}if(w===t){h.logger.warn('No fallback audio-track found for name/language: "'+c+'" / "'+v+'"');return}h.logger.log("Attempting audio-track fallback id:",w,"group-id:",this.tracks[w].groupId),this._setAudioTrack(w)},Sl(m,[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(t){this._setAudioTrack(t),this._selectDefaultTrack=!1}}]),m}(ft),Tl=xl;function wl(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function Ml(y,m,u){return m&&wl(y.prototype,m),y}function Ll(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var kl=window,vn=kl.performance,ya=100,Al=function(y){Ll(m,y);function m(a,t){var n;return n=y.call(this,a,d.default.MEDIA_ATTACHED,d.default.MEDIA_DETACHING,d.default.AUDIO_TRACKS_UPDATED,d.default.AUDIO_TRACK_SWITCHING,d.default.AUDIO_TRACK_LOADED,d.default.KEY_LOADED,d.default.FRAG_LOADED,d.default.FRAG_PARSING_INIT_SEGMENT,d.default.FRAG_PARSING_DATA,d.default.FRAG_PARSED,d.default.ERROR,d.default.BUFFER_RESET,d.default.BUFFER_CREATED,d.default.BUFFER_APPENDED,d.default.BUFFER_FLUSHED,d.default.INIT_PTS_FOUND)||this,n.fragmentTracker=t,n.config=a.config,n.audioCodecSwap=!1,n._state=ne.STOPPED,n.initPTS=[],n.waitingFragment=null,n.videoTrackCC=null,n.waitingVideoCC=null,n}var u=m.prototype;return u.onInitPtsFound=function(t){var n=t.id,c=t.frag.cc,v=t.initPTS;n==="main"&&(this.initPTS[c]=v,this.videoTrackCC=c,h.logger.log("InitPTS for cc: "+c+" found from main: "+v),this.state===ne.WAITING_INIT_PTS&&this.tick())},u.startLoad=function(t){if(this.tracks){var n=this.lastCurrentTime;this.stopLoad(),this.setInterval(ya),this.fragLoadError=0,n>0&&t===-1?(h.logger.log("audio:override startPosition with lastCurrentTime @"+n.toFixed(3)),this.state=ne.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:t,this.state=ne.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=t,this.state=ne.STOPPED},u.doTick=function(){var t,n,c,v=this.hls,E=v.config;switch(this.state){case ne.ERROR:case ne.PAUSED:case ne.BUFFER_FLUSHING:break;case ne.STARTING:this.state=ne.WAITING_TRACK,this.loadedmetadata=!1;break;case ne.IDLE:var w=this.tracks;if(!w||!this.media&&(this.startFragRequested||!E.startFragPrefetch))break;if(this.loadedmetadata)t=this.media.currentTime;else if(t=this.nextLoadPosition,t===void 0)break;var C=this.mediaBuffer?this.mediaBuffer:this.media,Y=this.videoBuffer?this.videoBuffer:this.media,B=t<E.maxBufferHole?Math.max(Ht,E.maxBufferHole):E.maxBufferHole,K=A.bufferInfo(C,t,B),Q=A.bufferInfo(Y,t,B),_e=K.len,Le=K.end,Ue=this.fragPrevious,Be=Math.min(E.maxBufferLength,E.maxMaxBufferLength),Ke=Math.max(Be,Q.len),Ze=this.audioSwitch,st=this.trackId;if((_e<Ke||Ze)&&st<w.length){if(c=w[st].details,typeof c>"u"){this.state=ne.WAITING_TRACK;break}if(!Ze&&this._streamEnded(K,c)){this.hls.trigger(d.default.BUFFER_EOS,{type:"audio"}),this.state=ne.ENDED;return}var xt=c.fragments,rr=xt.length,zt=xt[0].start,Er=xt[rr-1].start+xt[rr-1].duration,$e;if(Ze){if(c.live&&!c.PTSKnown)h.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),Le=0;else if(Le=t,c.PTSKnown&&t<zt)if(K.end>zt||K.nextStart)h.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=zt+.05;else return}if(c.initSegment&&!c.initSegment.data)$e=c.initSegment;else if(Le<=zt){if($e=xt[0],this.videoTrackCC!==null&&$e.cc!==this.videoTrackCC&&($e=lt(xt,this.videoTrackCC)),c.live&&$e.loadIdx&&$e.loadIdx===this.fragLoadIdx){var rt=K.nextStart?K.nextStart:zt;h.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(rt+.05)),this.media.currentTime=rt+.05;return}}else{var Rt,tn=E.maxFragLookUpTolerance,rn=Ue?xt[Ue.sn-xt[0].sn+1]:void 0;Le<Er?(Le>Er-tn&&(tn=0),rn&&!ut(Le,tn,rn)?Rt=rn:Rt=U.search(xt,function(wu){return ut(Le,tn,wu)})):Rt=xt[rr-1],Rt&&($e=Rt,zt=Rt.start,Ue&&$e.level===Ue.level&&$e.sn===Ue.sn&&($e.sn<c.endSN?($e=xt[$e.sn+1-c.startSN],this.fragmentTracker.getState($e)!==de.OK&&h.logger.log("SN just loaded, load next one: "+$e.sn)):$e=null))}$e&&($e.encrypted?(h.logger.log("Loading key for "+$e.sn+" of ["+c.startSN+" ,"+c.endSN+"],track "+st),this.state=ne.KEY_LOADING,v.trigger(d.default.KEY_LOADING,{frag:$e})):(this.fragCurrent=$e,(Ze||this.fragmentTracker.getState($e)===de.NOT_LOADED)&&(h.logger.log("Loading "+$e.sn+", cc: "+$e.cc+" of ["+c.startSN+" ,"+c.endSN+"],track "+st+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+t+", bufferEnd: "+Le.toFixed(3)),$e.sn!=="initSegment"&&(this.startFragRequested=!0),Object(p.isFiniteNumber)($e.sn)&&(this.nextLoadPosition=$e.start+$e.duration),v.trigger(d.default.FRAG_LOADING,{frag:$e}),this.state=ne.FRAG_LOADING)))}break;case ne.WAITING_TRACK:n=this.tracks[this.trackId],n&&n.details&&(this.state=ne.IDLE);break;case ne.FRAG_LOADING_WAITING_RETRY:var _n=vn.now(),Bn=this.retryDate;C=this.media;var xu=C&&C.seeking;(!Bn||_n>=Bn||xu)&&(h.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=ne.IDLE);break;case ne.WAITING_INIT_PTS:var yn=this.waitingFragment;if(yn){var xi=yn.frag.cc;if(this.initPTS[xi]!==void 0)this.waitingFragment=null,this.state=ne.FRAG_LOADING,this.onFragLoaded(yn);else if(this.videoTrackCC!==this.waitingVideoCC)h.logger.log("Waiting fragment cc ("+xi+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var Ua=A.bufferInfo(this.mediaBuffer,this.media.currentTime,E.maxBufferHole),Tu=ut(Ua.end,E.maxFragLookUpTolerance,yn.frag);Tu<0&&(h.logger.log("Waiting fragment cc ("+xi+") @ "+yn.frag.start+" cancelled because another fragment at "+Ua.end+" is needed"),this.clearWaitingFragment())}}else this.state=ne.IDLE;break}},u.clearWaitingFragment=function(){var t=this.waitingFragment;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingFragment=null,this.waitingVideoCC=null,this.state=ne.IDLE)},u.onMediaAttached=function(t){var n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);var c=this.config;this.tracks&&c.autoStartLoad&&this.startLoad(c.startPosition)},u.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(h.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},u.onAudioTracksUpdated=function(t){h.logger.log("audio tracks updated"),this.tracks=t.audioTracks},u.onAudioTrackSwitching=function(t){var n=!!t.url;this.trackId=t.id,this.fragCurrent=null,this.clearWaitingFragment(),this.state=ne.PAUSED,n?this.setInterval(ya):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),n&&(this.audioSwitch=!0,this.state=ne.IDLE),this.tick()},u.onAudioTrackLoaded=function(t){var n=t.details,c=t.id,v=this.tracks[c],E=v.details,w=n.totalduration,C=0;if(h.logger.log("track "+c+" loaded ["+n.startSN+","+n.endSN+"],duration:"+w),n.live||E&&E.live?E&&n.fragments.length>0?(Ie(E,n),C=n.fragments[0].start,n.PTSKnown?h.logger.log("live audio playlist sliding:"+C.toFixed(3)):h.logger.log("live audio playlist - outdated PTS, unknown sliding")):(n.PTSKnown=!1,h.logger.log("live audio playlist - first load, unknown sliding")):n.PTSKnown=!1,v.details=n,!this.startFragRequested){if(this.startPosition===-1){var Y=n.startTimeOffset;Object(p.isFiniteNumber)(Y)?(h.logger.log("start time offset found in playlist, adjust startPosition to "+Y),this.startPosition=Y):n.live?(this.startPosition=this.computeLivePosition(C,n),h.logger.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===ne.WAITING_TRACK&&(this.state=ne.IDLE),this.tick()},u.onKeyLoaded=function(){this.state===ne.KEY_LOADING&&(this.state=ne.IDLE,this.tick())},u.onFragLoaded=function(t){var n=this.fragCurrent,c=t.frag;if(this.state===ne.FRAG_LOADING&&n&&c.type==="audio"&&c.level===n.level&&c.sn===n.sn){var v=this.tracks[this.trackId],E=v.details,w=E.totalduration,C=n.level,Y=n.sn,B=n.cc,K=this.config.defaultAudioCodec||v.audioCodec||"mp4a.40.2",Q=this.stats=t.stats;if(Y==="initSegment")this.state=ne.IDLE,Q.tparsed=Q.tbuffered=vn.now(),E.initSegment.data=t.payload,this.hls.trigger(d.default.FRAG_BUFFERED,{stats:Q,frag:n,id:"audio"}),this.tick();else{this.state=ne.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new le(this.hls,"audio"));var _e=this.initPTS[B],Le=E.initSegment?E.initSegment.data:[];if(_e!==void 0){this.pendingBuffering=!0,h.logger.log("Demuxing "+Y+" of ["+E.startSN+" ,"+E.endSN+"],track "+C);var Ue=!1;this.demuxer.push(t.payload,Le,K,null,n,w,Ue,_e)}else h.logger.log("Unknown video PTS for cc "+B+", waiting for video PTS before demuxing audio frag "+Y+" of ["+E.startSN+" ,"+E.endSN+"],track "+C),this.waitingFragment=t,this.waitingVideoCC=this.videoTrackCC,this.state=ne.WAITING_INIT_PTS}}this.fragLoadError=0},u.onFragParsingInitSegment=function(t){var n=this.fragCurrent,c=t.frag;if(n&&t.id==="audio"&&c.sn===n.sn&&c.level===n.level&&this.state===ne.PARSING){var v=t.tracks,E;if(v.video&&delete v.video,E=v.audio,E){E.levelCodec=E.codec,E.id=t.id,this.hls.trigger(d.default.BUFFER_CODECS,v),h.logger.log("audio track:audio,container:"+E.container+",codecs[level/parsed]=["+E.levelCodec+"/"+E.codec+"]");var w=E.initSegment;if(w){var C={type:"audio",data:w,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[C]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(d.default.BUFFER_APPENDING,C))}this.tick()}}},u.onFragParsingData=function(t){var n=this,c=this.fragCurrent,v=t.frag;if(c&&t.id==="audio"&&t.type==="audio"&&v.sn===c.sn&&v.level===c.level&&this.state===ne.PARSING){var E=this.trackId,w=this.tracks[E],C=this.hls;Object(p.isFiniteNumber)(t.endPTS)||(t.endPTS=t.startPTS+c.duration,t.endDTS=t.startDTS+c.duration),c.addElementaryStream(G.AUDIO),h.logger.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb),ue(w.details,c,t.startPTS,t.endPTS);var Y=this.media,B=!1;if(this.audioSwitch)if(Y&&Y.readyState){var K=Y.currentTime;h.logger.log("switching audio track : currentTime:"+K),K>=t.startPTS&&(h.logger.log("switching audio track : flushing all audio"),this.state=ne.BUFFER_FLUSHING,C.trigger(d.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),B=!0,this.audioSwitch=!1,C.trigger(d.default.AUDIO_TRACK_SWITCHED,{id:E}))}else this.audioSwitch=!1,C.trigger(d.default.AUDIO_TRACK_SWITCHED,{id:E});var Q=this.pendingData;if(!Q){h.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),C.trigger(d.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});return}this.audioSwitch||([t.data1,t.data2].forEach(function(_e){_e&&_e.length&&Q.push({type:t.type,data:_e,parent:"audio",content:"data"})}),!B&&Q.length&&(Q.forEach(function(_e){n.state===ne.PARSING&&(n.pendingBuffering=!0,n.hls.trigger(d.default.BUFFER_APPENDING,_e))}),this.pendingData=[],this.appended=!0)),this.tick()}},u.onFragParsed=function(t){var n=this.fragCurrent,c=t.frag;n&&t.id==="audio"&&c.sn===n.sn&&c.level===n.level&&this.state===ne.PARSING&&(this.stats.tparsed=vn.now(),this.state=ne.PARSED,this._checkAppendedParsed())},u.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},u.onBufferCreated=function(t){var n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer,this.loadedmetadata=!0),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer)},u.onBufferAppended=function(t){if(t.parent==="audio"){var n=this.state;(n===ne.PARSING||n===ne.PARSED)&&(this.pendingBuffering=t.pending>0,this._checkAppendedParsed())}},u._checkAppendedParsed=function(){if(this.state===ne.PARSED&&(!this.appended||!this.pendingBuffering)){var t=this.fragCurrent,n=this.stats,c=this.hls;if(t){this.fragPrevious=t,n.tbuffered=vn.now(),c.trigger(d.default.FRAG_BUFFERED,{stats:n,frag:t,id:"audio"});var v=this.mediaBuffer?this.mediaBuffer:this.media;v&&h.logger.log("audio buffered : "+qe.toString(v.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,c.trigger(d.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=ne.IDLE}this.tick()}},u.onError=function(t){var n=t.frag;if(!(n&&n.type!=="audio"))switch(t.details){case g.ErrorDetails.FRAG_LOAD_ERROR:case g.ErrorDetails.FRAG_LOAD_TIMEOUT:var c=t.frag;if(c&&c.type!=="audio")break;if(!t.fatal){var v=this.fragLoadError;v?v++:v=1;var E=this.config;if(v<=E.fragLoadingMaxRetry){this.fragLoadError=v;var w=Math.min(Math.pow(2,v-1)*E.fragLoadingRetryDelay,E.fragLoadingMaxRetryTimeout);h.logger.warn("AudioStreamController: frag loading failed, retry in "+w+" ms"),this.retryDate=vn.now()+w,this.state=ne.FRAG_LOADING_WAITING_RETRY}else h.logger.error("AudioStreamController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=ne.ERROR}break;case g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case g.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case g.ErrorDetails.KEY_LOAD_ERROR:case g.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==ne.ERROR&&(this.state=t.fatal?ne.ERROR:ne.IDLE,h.logger.warn("AudioStreamController: "+t.details+" while loading frag, now switching to "+this.state+" state ..."));break;case g.ErrorDetails.BUFFER_FULL_ERROR:if(t.parent==="audio"&&(this.state===ne.PARSING||this.state===ne.PARSED)){var C=this.mediaBuffer,Y=this.media.currentTime,B=C&&A.isBuffered(C,Y)&&A.isBuffered(C,Y+.5);if(B){var K=this.config;K.maxMaxBufferLength>=K.maxBufferLength&&(K.maxMaxBufferLength/=2,h.logger.warn("AudioStreamController: reduce max buffer length to "+K.maxMaxBufferLength+"s")),this.state=ne.IDLE}else h.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=ne.BUFFER_FLUSHING,this.hls.trigger(d.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}break}},u.onBufferFlushed=function(){var t=this,n=this.pendingData;n&&n.length?(h.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),n.forEach(function(c){t.hls.trigger(d.default.BUFFER_APPENDING,c)}),this.appended=!0,this.pendingData=[],this.state=ne.PARSED):(this.state=ne.IDLE,this.fragPrevious=null,this.tick())},Ml(m,[{key:"state",set:function(t){if(this.state!==t){var n=this.state;this._state=t,h.logger.log("audio stream:"+n+"->"+t)}},get:function(){return this._state}}]),m}(vt),Rl=Al,ba=function(){if(typeof window<"u"&&window.VTTCue)return window.VTTCue;var y="auto",m={"":!0,lr:!0,rl:!0},u={start:!0,middle:!0,end:!0,left:!0,right:!0};function a(v){if(typeof v!="string")return!1;var E=m[v.toLowerCase()];return E?v.toLowerCase():!1}function t(v){if(typeof v!="string")return!1;var E=u[v.toLowerCase()];return E?v.toLowerCase():!1}function n(v){for(var E=1;E<arguments.length;E++){var w=arguments[E];for(var C in w)v[C]=w[C]}return v}function c(v,E,w){var C=this,Y={};Y.enumerable=!0,C.hasBeenReset=!1;var B="",K=!1,Q=v,_e=E,Le=w,Ue=null,Be="",Ke=!0,Ze="auto",st="start",xt=50,rr="middle",zt=50,Er="middle";Object.defineProperty(C,"id",n({},Y,{get:function(){return B},set:function(rt){B=""+rt}})),Object.defineProperty(C,"pauseOnExit",n({},Y,{get:function(){return K},set:function(rt){K=!!rt}})),Object.defineProperty(C,"startTime",n({},Y,{get:function(){return Q},set:function(rt){if(typeof rt!="number")throw new TypeError("Start time must be set to a number.");Q=rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"endTime",n({},Y,{get:function(){return _e},set:function(rt){if(typeof rt!="number")throw new TypeError("End time must be set to a number.");_e=rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"text",n({},Y,{get:function(){return Le},set:function(rt){Le=""+rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"region",n({},Y,{get:function(){return Ue},set:function(rt){Ue=rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"vertical",n({},Y,{get:function(){return Be},set:function(rt){var Rt=a(rt);if(Rt===!1)throw new SyntaxError("An invalid or illegal string was specified.");Be=Rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"snapToLines",n({},Y,{get:function(){return Ke},set:function(rt){Ke=!!rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"line",n({},Y,{get:function(){return Ze},set:function(rt){if(typeof rt!="number"&&rt!==y)throw new SyntaxError("An invalid number or illegal string was specified.");Ze=rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"lineAlign",n({},Y,{get:function(){return st},set:function(rt){var Rt=t(rt);if(!Rt)throw new SyntaxError("An invalid or illegal string was specified.");st=Rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"position",n({},Y,{get:function(){return xt},set:function(rt){if(rt<0||rt>100)throw new Error("Position must be between 0 and 100.");xt=rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"positionAlign",n({},Y,{get:function(){return rr},set:function(rt){var Rt=t(rt);if(!Rt)throw new SyntaxError("An invalid or illegal string was specified.");rr=Rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"size",n({},Y,{get:function(){return zt},set:function(rt){if(rt<0||rt>100)throw new Error("Size must be between 0 and 100.");zt=rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"align",n({},Y,{get:function(){return Er},set:function(rt){var Rt=t(rt);if(!Rt)throw new SyntaxError("An invalid or illegal string was specified.");Er=Rt,this.hasBeenReset=!0}})),C.displayState=void 0}return c.prototype.getCueAsHTML=function(){var v=window.WebVTT;return v.convertCueToDOMTree(window,this.text)},c}(),Cl=function(){return{decode:function(u){if(!u)return"";if(typeof u!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(u))}}};function Sa(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new Cl,this.regionList=[]}function Dl(y){function m(a,t,n,c){return(a|0)*3600+(t|0)*60+(n|0)+(c|0)/1e3}var u=y.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return u?u[3]?m(u[1],u[2],u[3].replace(":",""),u[4]):u[1]>59?m(u[1],u[2],0,u[4]):m(0,u[1],u[2],u[4]):null}function Ea(){this.values=Object.create(null)}Ea.prototype={set:function(m,u){!this.get(m)&&u!==""&&(this.values[m]=u)},get:function(m,u,a){return a?this.has(m)?this.values[m]:u[a]:this.has(m)?this.values[m]:u},has:function(m){return m in this.values},alt:function(m,u,a){for(var t=0;t<a.length;++t)if(u===a[t]){this.set(m,u);break}},integer:function(m,u){/^-?\d+$/.test(u)&&this.set(m,parseInt(u,10))},percent:function(m,u){return u.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(u=parseFloat(u),u>=0&&u<=100)?(this.set(m,u),!0):!1}};function xa(y,m,u,a){var t=a?y.split(a):[y];for(var n in t)if(typeof t[n]=="string"){var c=t[n].split(u);if(c.length===2){var v=c[0],E=c[1];m(v,E)}}}var vi=new ba(0,0,0),Fn=vi.align==="middle"?"middle":"center";function Il(y,m,u){var a=y;function t(){var v=Dl(y);if(v===null)throw new Error("Malformed timestamp: "+a);return y=y.replace(/^[^\sa-zA-Z-]+/,""),v}function n(v,E){var w=new Ea;xa(v,function(B,K){switch(B){case"region":for(var Q=u.length-1;Q>=0;Q--)if(u[Q].id===K){w.set(B,u[Q].region);break}break;case"vertical":w.alt(B,K,["rl","lr"]);break;case"line":var _e=K.split(","),Le=_e[0];w.integer(B,Le),w.percent(B,Le)&&w.set("snapToLines",!1),w.alt(B,Le,["auto"]),_e.length===2&&w.alt("lineAlign",_e[1],["start",Fn,"end"]);break;case"position":_e=K.split(","),w.percent(B,_e[0]),_e.length===2&&w.alt("positionAlign",_e[1],["start",Fn,"end","line-left","line-right","auto"]);break;case"size":w.percent(B,K);break;case"align":w.alt(B,K,["start",Fn,"end","left","right"]);break}},/:/,/\s/),E.region=w.get("region",null),E.vertical=w.get("vertical","");var C=w.get("line","auto");C==="auto"&&vi.line===-1&&(C=-1),E.line=C,E.lineAlign=w.get("lineAlign","start"),E.snapToLines=w.get("snapToLines",!0),E.size=w.get("size",100),E.align=w.get("align",Fn);var Y=w.get("position","auto");Y==="auto"&&vi.position===50&&(Y=E.align==="start"||E.align==="left"?0:E.align==="end"||E.align==="right"?100:50),E.position=Y}function c(){y=y.replace(/^\s+/,"")}if(c(),m.startTime=t(),c(),y.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+a);y=y.substr(3),c(),m.endTime=t(),c(),n(y,m)}function Ta(y){return y.replace(/<br(?: \/)?>/gi,`
`)}Sa.prototype={parse:function(m){var u=this;m&&(u.buffer+=u.decoder.decode(m,{stream:!0}));function a(){var w=u.buffer,C=0;for(w=Ta(w);C<w.length&&w[C]!=="\r"&&w[C]!==`
`;)++C;var Y=w.substr(0,C);return w[C]==="\r"&&++C,w[C]===`
`&&++C,u.buffer=w.substr(C),Y}function t(w){xa(w,function(C,Y){},/:/)}try{var n;if(u.state==="INITIAL"){if(!/\r\n|\n/.test(u.buffer))return this;n=a();var c=n.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!c||!c[0])throw new Error("Malformed WebVTT signature.");u.state="HEADER"}for(var v=!1;u.buffer;){if(!/\r\n|\n/.test(u.buffer))return this;switch(v?v=!1:n=a(),u.state){case"HEADER":/:/.test(n)?t(n):n||(u.state="ID");continue;case"NOTE":n||(u.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){u.state="NOTE";break}if(!n)continue;if(u.cue=new ba(0,0,""),u.state="CUE",n.indexOf("-->")===-1){u.cue.id=n;continue}case"CUE":try{Il(n,u.cue,u.regionList)}catch{u.cue=null,u.state="BADCUE";continue}u.state="CUETEXT";continue;case"CUETEXT":var E=n.indexOf("-->")!==-1;if(!n||E&&(v=!0)){u.oncue&&u.oncue(u.cue),u.cue=null,u.state="ID";continue}u.cue.text&&(u.cue.text+=`
`),u.cue.text+=n;continue;case"BADCUE":n||(u.state="ID");continue}}}catch{u.state==="CUETEXT"&&u.cue&&u.oncue&&u.oncue(u.cue),u.cue=null,u.state=u.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var m=this;try{if(m.buffer+=m.decoder.decode(),(m.cue||m.state==="HEADER")&&(m.buffer+=`

`,m.parse()),m.state==="INITIAL")throw new Error("Malformed WebVTT signature.")}catch(u){throw u}return m.onflush&&m.onflush(),this}};var Pl=Sa;function Ol(y,m,u,a){for(var t=[],n,c,v,E,w,C=window.VTTCue||TextTrackCue,Y=0;Y<a.rows.length;Y++)if(n=a.rows[Y],v=!0,E=0,w="",!n.isEmpty()){for(var B=0;B<n.chars.length;B++)n.chars[B].uchar.match(/\s/)&&v?E++:(w+=n.chars[B].uchar,v=!1);n.cueStartTime=m,m===u&&(u+=1e-4),c=new C(m,u,Ta(w.trim())),E>=16?E--:E++,navigator.userAgent.match(/Firefox\//)?c.line=Y+1:c.line=Y>7?Y-2:Y+1,c.align="left",c.position=Math.max(0,Math.min(100,100*(E/32))),t.push(c),y&&y.addCue(c)}return t}var wa={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Ma=function(m){var u=m;return wa.hasOwnProperty(m)&&(u=wa[m]),String.fromCharCode(u)},cr=15,Sr=100,Fl={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Nl={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Yl={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Bl={25:2,26:4,29:6,30:8,31:10,27:13,28:15},jl=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],it;(function(y){y[y.ERROR=0]="ERROR",y[y.TEXT=1]="TEXT",y[y.WARNING=2]="WARNING",y[y.INFO=2]="INFO",y[y.DEBUG=3]="DEBUG",y[y.DATA=3]="DATA"})(it||(it={}));var Hl=function(){function y(){this.time=null,this.verboseLevel=it.ERROR}var m=y.prototype;return m.log=function(a,t){this.verboseLevel>=a&&h.logger.log(this.time+" ["+a+"] "+t)},y}(),Br=function(m){for(var u=[],a=0;a<m.length;a++)u.push(m[a].toString(16));return u},La=function(){function y(u,a,t,n,c){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=u||"white",this.underline=a||!1,this.italics=t||!1,this.background=n||"black",this.flash=c||!1}var m=y.prototype;return m.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},m.setStyles=function(a){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var c=t[n];a.hasOwnProperty(c)&&(this[c]=a[c])}},m.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},m.equals=function(a){return this.foreground===a.foreground&&this.underline===a.underline&&this.italics===a.italics&&this.background===a.background&&this.flash===a.flash},m.copy=function(a){this.foreground=a.foreground,this.underline=a.underline,this.italics=a.italics,this.background=a.background,this.flash=a.flash},m.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},y}(),Ul=function(){function y(u,a,t,n,c,v){this.uchar=void 0,this.penState=void 0,this.uchar=u||" ",this.penState=new La(a,t,n,c,v)}var m=y.prototype;return m.reset=function(){this.uchar=" ",this.penState.reset()},m.setChar=function(a,t){this.uchar=a,this.penState.copy(t)},m.setPenState=function(a){this.penState.copy(a)},m.equals=function(a){return this.uchar===a.uchar&&this.penState.equals(a.penState)},m.copy=function(a){this.uchar=a.uchar,this.penState.copy(a.penState)},m.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},y}(),zl=function(){function y(u){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var a=0;a<Sr;a++)this.chars.push(new Ul);this.logger=u,this.pos=0,this.currPenState=new La}var m=y.prototype;return m.equals=function(a){for(var t=!0,n=0;n<Sr;n++)if(!this.chars[n].equals(a.chars[n])){t=!1;break}return t},m.copy=function(a){for(var t=0;t<Sr;t++)this.chars[t].copy(a.chars[t])},m.isEmpty=function(){for(var a=!0,t=0;t<Sr;t++)if(!this.chars[t].isEmpty()){a=!1;break}return a},m.setCursor=function(a){this.pos!==a&&(this.pos=a),this.pos<0?(this.logger.log(it.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>Sr&&(this.logger.log(it.DEBUG,"Too large cursor position "+this.pos),this.pos=Sr)},m.moveCursor=function(a){var t=this.pos+a;if(a>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},m.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},m.insertChar=function(a){a>=144&&this.backSpace();var t=Ma(a);if(this.pos>=Sr){this.logger.log(it.ERROR,"Cannot insert "+a.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)},m.clearFromPos=function(a){var t;for(t=a;t<Sr;t++)this.chars[t].reset()},m.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},m.clearToEndOfRow=function(){this.clearFromPos(this.pos)},m.getTextString=function(){for(var a=[],t=!0,n=0;n<Sr;n++){var c=this.chars[n].uchar;c!==" "&&(t=!1),a.push(c)}return t?"":a.join("")},m.setPenStyles=function(a){this.currPenState.setStyles(a);var t=this.chars[this.pos];t.setPenState(this.currPenState)},y}(),_i=function(){function y(u){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var a=0;a<cr;a++)this.rows.push(new zl(u));this.logger=u,this.currRow=cr-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var m=y.prototype;return m.reset=function(){for(var a=0;a<cr;a++)this.rows[a].clear();this.currRow=cr-1},m.equals=function(a){for(var t=!0,n=0;n<cr;n++)if(!this.rows[n].equals(a.rows[n])){t=!1;break}return t},m.copy=function(a){for(var t=0;t<cr;t++)this.rows[t].copy(a.rows[t])},m.isEmpty=function(){for(var a=!0,t=0;t<cr;t++)if(!this.rows[t].isEmpty()){a=!1;break}return a},m.backSpace=function(){var a=this.rows[this.currRow];a.backSpace()},m.clearToEndOfRow=function(){var a=this.rows[this.currRow];a.clearToEndOfRow()},m.insertChar=function(a){var t=this.rows[this.currRow];t.insertChar(a)},m.setPen=function(a){var t=this.rows[this.currRow];t.setPenStyles(a)},m.moveCursor=function(a){var t=this.rows[this.currRow];t.moveCursor(a)},m.setCursor=function(a){this.logger.log(it.INFO,"setCursor: "+a);var t=this.rows[this.currRow];t.setCursor(a)},m.setPAC=function(a){this.logger.log(it.INFO,"pacData = "+JSON.stringify(a));var t=a.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var n=0;n<cr;n++)this.rows[n].clear();var c=this.currRow+1-this.nrRollUpRows,v=this.lastOutputScreen;if(v){var E=v.rows[c].cueStartTime,w=this.logger.time;if(E&&w!==null&&E<w)for(var C=0;C<this.nrRollUpRows;C++)this.rows[t-this.nrRollUpRows+C+1].copy(v.rows[c+C])}}this.currRow=t;var Y=this.rows[this.currRow];if(a.indent!==null){var B=a.indent,K=Math.max(B-1,0);Y.setCursor(a.indent),a.color=Y.chars[K].penState.foreground}var Q={foreground:a.color,underline:a.underline,italics:a.italics,background:"black",flash:!1};this.setPen(Q)},m.setBkgData=function(a){this.logger.log(it.INFO,"bkgData = "+JSON.stringify(a)),this.backSpace(),this.setPen(a),this.insertChar(32)},m.setRollUpRows=function(a){this.nrRollUpRows=a},m.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(it.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(it.TEXT,this.getDisplayText());var a=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(a,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(it.INFO,"Rolling up")},m.getDisplayText=function(a){a=a||!1;for(var t=[],n="",c=-1,v=0;v<cr;v++){var E=this.rows[v].getTextString();E&&(c=v+1,a?t.push("Row "+c+": '"+E+"'"):t.push(E.trim()))}return t.length>0&&(a?n="["+t.join(" | ")+"]":n=t.join(`
`)),n},m.getTextAndFormat=function(){return this.rows},y}(),ka=function(){function y(u,a,t){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=u,this.outputFilter=a,this.mode=null,this.verbose=0,this.displayedMemory=new _i(t),this.nonDisplayedMemory=new _i(t),this.lastOutputScreen=new _i(t),this.currRollUpRow=this.displayedMemory.rows[cr-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=t}var m=y.prototype;return m.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[cr-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},m.getHandler=function(){return this.outputFilter},m.setHandler=function(a){this.outputFilter=a},m.setPAC=function(a){this.writeScreen.setPAC(a)},m.setBkgData=function(a){this.writeScreen.setBkgData(a)},m.setMode=function(a){a!==this.mode&&(this.mode=a,this.logger.log(it.INFO,"MODE="+a),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=a)},m.insertChars=function(a){for(var t=0;t<a.length;t++)this.writeScreen.insertChar(a[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(it.INFO,n+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(it.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},m.ccRCL=function(){this.logger.log(it.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},m.ccBS=function(){this.logger.log(it.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},m.ccAOF=function(){},m.ccAON=function(){},m.ccDER=function(){this.logger.log(it.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},m.ccRU=function(a){this.logger.log(it.INFO,"RU("+a+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(a)},m.ccFON=function(){this.logger.log(it.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},m.ccRDC=function(){this.logger.log(it.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},m.ccTR=function(){this.logger.log(it.INFO,"TR"),this.setMode("MODE_TEXT")},m.ccRTD=function(){this.logger.log(it.INFO,"RTD"),this.setMode("MODE_TEXT")},m.ccEDM=function(){this.logger.log(it.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},m.ccCR=function(){this.logger.log(it.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},m.ccENM=function(){this.logger.log(it.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},m.ccEOC=function(){if(this.logger.log(it.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var a=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=a,this.writeScreen=this.nonDisplayedMemory,this.logger.log(it.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},m.ccTO=function(a){this.logger.log(it.INFO,"TO("+a+") - Tab Offset"),this.writeScreen.moveCursor(a)},m.ccMIDROW=function(a){var t={flash:!1};if(t.underline=a%2===1,t.italics=a>=46,t.italics)t.foreground="white";else{var n=Math.floor(a/2)-16,c=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=c[n]}this.logger.log(it.INFO,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},m.outputDataUpdate=function(a){a===void 0&&(a=!1);var t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),a&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))},m.cueSplitAtTime=function(a){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,a,this.displayedMemory),this.cueStartTime=a))},y}(),Gl=function(){function y(u,a,t){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var n=new Hl;this.channels=[null,new ka(u,a,n),new ka(u+1,t,n)],this.cmdHistory=Ra(),this.logger=n}var m=y.prototype;return m.getHandler=function(a){return this.channels[a].getHandler()},m.setHandler=function(a,t){this.channels[a].setHandler(t)},m.addData=function(a,t){var n,c,v,E=!1;this.logger.time=a;for(var w=0;w<t.length;w+=2)if(c=t[w]&127,v=t[w+1]&127,!(c===0&&v===0)){if(this.logger.log(it.DATA,"["+Br([t[w],t[w+1]])+"] -> ("+Br([c,v])+")"),n=this.parseCmd(c,v),n||(n=this.parseMidrow(c,v)),n||(n=this.parsePAC(c,v)),n||(n=this.parseBackgroundAttributes(c,v)),!n&&(E=this.parseChars(c,v),E)){var C=this.currentChannel;if(C&&C>0){var Y=this.channels[C];Y.insertChars(E)}else this.logger.log(it.WARNING,"No channel found yet. TEXT-MODE?")}!n&&!E&&this.logger.log(it.WARNING,"Couldn't parse cleaned data "+Br([c,v])+" orig: "+Br([t[w],t[w+1]]))}},m.parseCmd=function(a,t){var n=this.cmdHistory,c=(a===20||a===28||a===21||a===29)&&t>=32&&t<=47,v=(a===23||a===31)&&t>=33&&t<=35;if(!(c||v))return!1;if(Aa(a,t,n))return Qr(null,null,n),this.logger.log(it.DEBUG,"Repeated command ("+Br([a,t])+") is dropped"),!0;var E=a===20||a===21||a===23?1:2,w=this.channels[E];return a===20||a===21||a===28||a===29?t===32?w.ccRCL():t===33?w.ccBS():t===34?w.ccAOF():t===35?w.ccAON():t===36?w.ccDER():t===37?w.ccRU(2):t===38?w.ccRU(3):t===39?w.ccRU(4):t===40?w.ccFON():t===41?w.ccRDC():t===42?w.ccTR():t===43?w.ccRTD():t===44?w.ccEDM():t===45?w.ccCR():t===46?w.ccENM():t===47&&w.ccEOC():w.ccTO(t-32),Qr(a,t,n),this.currentChannel=E,!0},m.parseMidrow=function(a,t){var n=0;if((a===17||a===25)&&t>=32&&t<=47){if(a===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(it.ERROR,"Mismatch channel in midrow parsing"),!1;var c=this.channels[n];return c?(c.ccMIDROW(t),this.logger.log(it.DEBUG,"MIDROW ("+Br([a,t])+")"),!0):!1}return!1},m.parsePAC=function(a,t){var n,c=this.cmdHistory,v=(a>=17&&a<=23||a>=25&&a<=31)&&t>=64&&t<=127,E=(a===16||a===24)&&t>=64&&t<=95;if(!(v||E))return!1;if(Aa(a,t,c))return Qr(null,null,c),!0;var w=a<=23?1:2;t>=64&&t<=95?n=w===1?Fl[a]:Yl[a]:n=w===1?Nl[a]:Bl[a];var C=this.channels[w];return C?(C.setPAC(this.interpretPAC(n,t)),Qr(a,t,c),this.currentChannel=w,!0):!1},m.interpretPAC=function(a,t){var n=t,c={color:null,italics:!1,indent:null,underline:!1,row:a};return t>95?n=t-96:n=t-64,c.underline=(n&1)===1,n<=13?c.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(c.italics=!0,c.color="white"):c.indent=Math.floor((n-16)/2)*4,c},m.parseChars=function(a,t){var n,c=null,v=null;if(a>=25?(n=2,v=a-8):(n=1,v=a),v>=17&&v<=19){var E=t;v===17?E=t+80:v===18?E=t+112:E=t+144,this.logger.log(it.INFO,"Special char '"+Ma(E)+"' in channel "+n),c=[E]}else a>=32&&a<=127&&(c=t===0?[a]:[a,t]);if(c){var w=Br(c);this.logger.log(it.DEBUG,"Char codes =  "+w.join(",")),Qr(a,t,this.cmdHistory)}return c},m.parseBackgroundAttributes=function(a,t){var n=(a===16||a===24)&&t>=32&&t<=47,c=(a===23||a===31)&&t>=45&&t<=47;if(!(n||c))return!1;var v,E={};a===16||a===24?(v=Math.floor((t-32)/2),E.background=jl[v],t%2===1&&(E.background=E.background+"_semi")):t===45?E.background="transparent":(E.foreground="black",t===47&&(E.underline=!0));var w=a<=23?1:2,C=this.channels[w];return C.setBkgData(E),Qr(a,t,this.cmdHistory),!0},m.reset=function(){for(var a=0;a<Object.keys(this.channels).length;a++){var t=this.channels[a];t&&t.reset()}this.cmdHistory=Ra()},m.cueSplitAtTime=function(a){for(var t=0;t<this.channels.length;t++){var n=this.channels[t];n&&n.cueSplitAtTime(a)}},y}();function Qr(y,m,u){u.a=y,u.b=m}function Aa(y,m,u){return u.a===y&&u.b===m}function Ra(){return{a:null,b:null}}var Ca=Gl,Nn=function(){function y(u,a){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=u,this.trackName=a}var m=y.prototype;return m.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},m.newCue=function(a,t,n){(this.startTime===null||this.startTime>a)&&(this.startTime=a),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)},m.reset=function(){this.cueRanges=[]},y}(),yi=function(m,u,a){return m.substr(0,u.length)===u},$l=function(m){var u=parseInt(m.substr(-3)),a=parseInt(m.substr(-6,2)),t=parseInt(m.substr(-9,2)),n=m.length>9?parseInt(m.substr(0,m.indexOf(":"))):0;if(!Object(p.isFiniteNumber)(u)||!Object(p.isFiniteNumber)(a)||!Object(p.isFiniteNumber)(t)||!Object(p.isFiniteNumber)(n))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+m);return u+=1e3*a,u+=60*1e3*t,u+=60*60*1e3*n,u},bi=function(m){for(var u=5381,a=m.length;a;)u=u*33^m.charCodeAt(--a);return(u>>>0).toString()},Vl=function(m,u,a){var t=m[u],n=m[t.prevCC];if(!n||!n.new&&t.new){m.ccOffset=m.presentationOffset=t.start,t.new=!1;return}for(;n&&n.new;)m.ccOffset+=t.start-n.start,t.new=!1,t=n,n=m[t.prevCC];m.presentationOffset=a},Wl={parse:function(m,u,a,t,n,c){var v=/\r\n|\n\r|\n|\r/g,E=Object(mn.utf8ArrayToStr)(new Uint8Array(m)).trim().replace(v,`
`).split(`
`),w="00:00.000",C=0,Y=0,B=0,K=[],Q,_e=!0,Le=!1,Ue=new Pl;Ue.oncue=function(Be){var Ke=a[t],Ze=a.ccOffset;Ke&&Ke.new&&(Y!==void 0?Ze=a.ccOffset=Ke.start:Vl(a,t,B)),B&&(Ze=B-a.presentationOffset),Le&&(Be.startTime+=Ze-Y,Be.endTime+=Ze-Y),Be.id=bi(Be.startTime.toString())+bi(Be.endTime.toString())+bi(Be.text),Be.text=decodeURIComponent(encodeURIComponent(Be.text)),Be.endTime>0&&K.push(Be)},Ue.onparsingerror=function(Be){Q=Be},Ue.onflush=function(){if(Q&&c){c(Q);return}n(K)},E.forEach(function(Be){if(_e)if(yi(Be,"X-TIMESTAMP-MAP=")){_e=!1,Le=!0,Be.substr(16).split(",").forEach(function(Ke){yi(Ke,"LOCAL:")?w=Ke.substr(6):yi(Ke,"MPEGTS:")&&(C=parseInt(Ke.substr(7)))});try{u+(a[t].start*9e4||0)<0&&(u+=8589934592),C-=u,Y=$l(w)/1e3,B=C/9e4}catch(Ke){Le=!1,Q=Ke}return}else Be===""&&(_e=!1);Ue.parse(Be+`
`)}),Ue.flush()}},Kl=Wl;function Yn(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function Xl(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var ql=function(y){Xl(m,y);function m(a){var t;if(t=y.call(this,a,d.default.MEDIA_ATTACHING,d.default.MEDIA_DETACHING,d.default.FRAG_PARSING_USERDATA,d.default.FRAG_DECRYPTED,d.default.MANIFEST_LOADING,d.default.MANIFEST_LOADED,d.default.FRAG_LOADED,d.default.INIT_PTS_FOUND)||this,t.media=null,t.config=void 0,t.enabled=!0,t.Cues=void 0,t.textTracks=[],t.tracks=[],t.initPTS=[],t.unparsedVttFrags=[],t.captionsTracks={},t.nonNativeCaptionsTracks={},t.captionsProperties=void 0,t.cea608Parser1=void 0,t.cea608Parser2=void 0,t.lastSn=-1,t.prevCC=-1,t.vttCCs=Da(),t.hls=a,t.config=a.config,t.Cues=a.config.cueHandler,t.captionsProperties={textTrack1:{label:t.config.captionsTextTrack1Label,languageCode:t.config.captionsTextTrack1LanguageCode},textTrack2:{label:t.config.captionsTextTrack2Label,languageCode:t.config.captionsTextTrack2LanguageCode},textTrack3:{label:t.config.captionsTextTrack3Label,languageCode:t.config.captionsTextTrack3LanguageCode},textTrack4:{label:t.config.captionsTextTrack4Label,languageCode:t.config.captionsTextTrack4LanguageCode}},t.config.enableCEA708Captions){var n=new Nn(Yn(t),"textTrack1"),c=new Nn(Yn(t),"textTrack2"),v=new Nn(Yn(t),"textTrack3"),E=new Nn(Yn(t),"textTrack4");t.cea608Parser1=new Ca(1,n,c),t.cea608Parser2=new Ca(3,v,E)}return t}var u=m.prototype;return u.addCues=function(t,n,c,v,E){for(var w=!1,C=E.length;C--;){var Y=E[C],B=Zl(Y[0],Y[1],n,c);if(B>=0&&(Y[0]=Math.min(Y[0],n),Y[1]=Math.max(Y[1],c),w=!0,B/(c-n)>.5))return}if(w||E.push([n,c]),this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[t],n,c,v);else{var K=this.Cues.newCue(null,n,c,v);this.hls.trigger(d.default.CUES_PARSED,{type:"captions",cues:K,track:t})}},u.onInitPtsFound=function(t){var n=this,c=t.frag,v=t.id,E=t.initPTS,w=this.unparsedVttFrags;v==="main"&&(this.initPTS[c.cc]=E),w.length&&(this.unparsedVttFrags=[],w.forEach(function(C){n.onFragLoaded(C)}))},u.getExistingTrack=function(t){var n=this.media;if(n)for(var c=0;c<n.textTracks.length;c++){var v=n.textTracks[c];if(v[t])return v}return null},u.createCaptionsTrack=function(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)},u.createNativeTrack=function(t){if(!this.captionsTracks[t]){var n=this.captionsProperties,c=this.captionsTracks,v=this.media,E=n[t],w=E.label,C=E.languageCode,Y=this.getExistingTrack(t);if(Y)c[t]=Y,Yr(c[t]),Jr(c[t],v);else{var B=this.createTextTrack("captions",w,C);B&&(B[t]=!0,c[t]=B)}}},u.createNonNativeTrack=function(t){if(!this.nonNativeCaptionsTracks[t]){var n=this.captionsProperties[t];if(n){var c=n.label,v={_id:t,label:c,kind:"captions",default:n.media?!!n.media.default:!1,closedCaptions:n.media};this.nonNativeCaptionsTracks[t]=v,this.hls.trigger(d.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[v]})}}},u.createTextTrack=function(t,n,c){var v=this.media;if(v)return v.addTextTrack(t,n,c)},u.destroy=function(){y.prototype.destroy.call(this)},u.onMediaAttaching=function(t){this.media=t.media,this._cleanTracks()},u.onMediaDetaching=function(){var t=this.captionsTracks;Object.keys(t).forEach(function(n){Yr(t[n]),delete t[n]}),this.nonNativeCaptionsTracks={}},u.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs=Da(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={}},u._cleanTracks=function(){var t=this.media;if(t){var n=t.textTracks;if(n)for(var c=0;c<n.length;c++)Yr(n[c])}},u.onManifestLoaded=function(t){var n=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset()),this.config.enableWebVTT){var c=t.subtitles||[],v=this.tracks&&c&&this.tracks.length===c.length;if(this.tracks=t.subtitles||[],this.config.renderTextTracksNatively){var E=this.media?this.media.textTracks:[];this.tracks.forEach(function(C,Y){var B;if(Y<E.length){for(var K=null,Q=0;Q<E.length;Q++)if(Jl(E[Q],C)){K=E[Q];break}K&&(B=K)}B||(B=n.createTextTrack("subtitles",C.name,C.lang)),C.default?B.mode=n.hls.subtitleDisplay?"showing":"hidden":B.mode="disabled",n.textTracks.push(B)})}else if(!v&&this.tracks&&this.tracks.length){var w=this.tracks.map(function(C){return{label:C.name,kind:C.type.toLowerCase(),default:C.default,subtitleTrack:C}});this.hls.trigger(d.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:w})}}this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(function(C){var Y=/(?:CC|SERVICE)([1-4])/.exec(C.instreamId);if(Y){var B="textTrack"+Y[1],K=n.captionsProperties[B];K&&(K.label=C.name,C.lang&&(K.languageCode=C.lang),K.media=C)}})},u.onFragLoaded=function(t){var n=t.frag,c=t.payload,v=this.cea608Parser1,E=this.cea608Parser2,w=this.initPTS,C=this.lastSn,Y=this.unparsedVttFrags;if(n.type==="main"){var B=n.sn;n.sn!==C+1&&v&&E&&(v.reset(),E.reset()),this.lastSn=B}else if(n.type==="subtitle")if(c.byteLength){if(!Object(p.isFiniteNumber)(w[n.cc])){Y.push(t),w.length&&this.hls.trigger(d.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n});return}var K=n.decryptdata;(K==null||K.key==null||K.method!=="AES-128")&&this._parseVTTs(n,c)}else this.hls.trigger(d.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n})},u._parseVTTs=function(t,n){var c=this,v=this.hls,E=this.prevCC,w=this.textTracks,C=this.vttCCs;C[t.cc]||(C[t.cc]={start:t.start,prevCC:E,new:!0},this.prevCC=t.cc),Kl.parse(n,this.initPTS[t.cc],C,t.cc,function(Y){if(c.config.renderTextTracksNatively){var B=w[t.level];if(B.mode==="disabled"){v.trigger(d.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t});return}Y.forEach(function(Q){if(!B.cues.getCueById(Q.id))try{if(B.addCue(Q),!B.cues.getCueById(Q.id))throw new Error("addCue is failed for: "+Q)}catch(Le){h.logger.debug("Failed occurred on adding cues: "+Le);var _e=new window.TextTrackCue(Q.startTime,Q.endTime,Q.text);_e.id=Q.id,B.addCue(_e)}})}else{var K=c.tracks[t.level].default?"default":"subtitles"+t.level;v.trigger(d.default.CUES_PARSED,{type:"subtitles",cues:Y,track:K})}v.trigger(d.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},function(Y){h.logger.log("Failed to parse VTT cue: "+Y),v.trigger(d.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})})},u.onFragDecrypted=function(t){var n=t.frag,c=t.payload;if(n.type==="subtitle"){if(!Object(p.isFiniteNumber)(this.initPTS[n.cc])){this.unparsedVttFrags.push(t);return}this._parseVTTs(n,c)}},u.onFragParsingUserdata=function(t){var n=this.cea608Parser1,c=this.cea608Parser2;if(!(!this.enabled||!(n&&c)))for(var v=0;v<t.samples.length;v++){var E=t.samples[v].bytes;if(E){var w=this.extractCea608Data(E);n.addData(t.samples[v].pts,w[0]),c.addData(t.samples[v].pts,w[1])}}},u.extractCea608Data=function(t){for(var n=t[0]&31,c=2,v=[[],[]],E=0;E<n;E++){var w=t[c++],C=127&t[c++],Y=127&t[c++],B=(4&w)!==0,K=3&w;C===0&&Y===0||B&&(K===0||K===1)&&(v[K].push(C),v[K].push(Y))}return v},m}(x);function Jl(y,m){return y&&y.label===m.name&&!(y.textTrack1||y.textTrack2)}function Zl(y,m,u,a){return Math.min(m,a)-Math.max(y,u)}function Da(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}}}var Ql=ql;function eu(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function tu(y,m,u){return m&&eu(y.prototype,m),y}function ru(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var nu=function(y){ru(m,y);function m(a){var t;return t=y.call(this,a,d.default.MEDIA_ATTACHED,d.default.MEDIA_DETACHING,d.default.MANIFEST_LOADED,d.default.SUBTITLE_TRACK_LOADED)||this,t.tracks=[],t.trackId=-1,t.media=null,t.stopped=!0,t.subtitleDisplay=!0,t.queuedDefaultTrack=null,t}var u=m.prototype;return u.destroy=function(){x.prototype.destroy.call(this)},u.onMediaAttached=function(t){var n=this;this.media=t.media,this.media&&(Object(p.isFiniteNumber)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){n.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},u.onMediaDetaching=function(){if(this.media){this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(p.isFiniteNumber)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack);var t=Si(this.media.textTracks);t.forEach(function(n){Yr(n)}),this.subtitleTrack=-1,this.media=null}},u.onManifestLoaded=function(t){var n=this,c=t.subtitles||[];this.tracks=c,this.hls.trigger(d.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:c}),c.forEach(function(v){v.default&&(n.media?n.subtitleTrack=v.id:n.queuedDefaultTrack=v.id)})},u.onSubtitleTrackLoaded=function(t){var n=this,c=t.id,v=t.details,E=this.trackId,w=this.tracks,C=w[E];if(c>=w.length||c!==E||!C||this.stopped){this._clearReloadTimer();return}if(h.logger.log("subtitle track "+c+" loaded"),v.live){var Y=Oe(C.details,v,t.stats.trequest);h.logger.log("Reloading live subtitle playlist in "+Y+"ms"),this.timer=setTimeout(function(){n._loadCurrentTrack()},Y)}else this._clearReloadTimer()},u.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},u.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},u._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},u._loadCurrentTrack=function(){var t=this.trackId,n=this.tracks,c=this.hls,v=n[t];t<0||!v||v.details&&!v.details.live||(h.logger.log("Loading subtitle track "+t),c.trigger(d.default.SUBTITLE_TRACK_LOADING,{url:v.url,id:t}))},u._toggleTrackModes=function(t){var n=this.media,c=this.subtitleDisplay,v=this.trackId;if(n){var E=Si(n.textTracks);if(t===-1)[].slice.call(E).forEach(function(Y){Y.mode="disabled"});else{var w=E[v];w&&(w.mode="disabled")}var C=E[t];C&&(C.mode=c?"showing":"hidden")}},u._setSubtitleTrackInternal=function(t){var n=this.hls,c=this.tracks;!Object(p.isFiniteNumber)(t)||t<-1||t>=c.length||(this.trackId=t,h.logger.log("Switching to subtitle track "+t),n.trigger(d.default.SUBTITLE_TRACK_SWITCH,{id:t}),this._loadCurrentTrack())},u._onTextTracksChanged=function(){if(!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var t=-1,n=Si(this.media.textTracks),c=0;c<n.length;c++)if(n[c].mode==="hidden")t=c;else if(n[c].mode==="showing"){t=c;break}this.subtitleTrack=t}},tu(m,[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(t){this.trackId!==t&&(this._toggleTrackModes(t),this._setSubtitleTrackInternal(t))}}]),m}(x);function Si(y){for(var m=[],u=0;u<y.length;u++){var a=y[u];a.kind==="subtitles"&&a.label&&m.push(y[u])}return m}var iu=nu,au=l("./src/crypt/decrypter.js");function su(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function ou(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var lu=window,Ia=lu.performance,Ei=500,uu=function(y){ou(m,y);function m(a,t){var n;return n=y.call(this,a,d.default.MEDIA_ATTACHED,d.default.MEDIA_DETACHING,d.default.ERROR,d.default.KEY_LOADED,d.default.FRAG_LOADED,d.default.SUBTITLE_TRACKS_UPDATED,d.default.SUBTITLE_TRACK_SWITCH,d.default.SUBTITLE_TRACK_LOADED,d.default.SUBTITLE_FRAG_PROCESSED,d.default.LEVEL_UPDATED)||this,n.fragmentTracker=t,n.config=a.config,n.state=ne.STOPPED,n.tracks=[],n.tracksBuffered=[],n.currentTrackId=-1,n.decrypter=new au.default(a,a.config),n.lastAVStart=0,n._onMediaSeeking=n.onMediaSeeking.bind(su(n)),n}var u=m.prototype;return u.startLoad=function(){this.stopLoad(),this.state=ne.IDLE;var t=this.tracks[this.currentTrackId];t&&t.details&&(this.setInterval(Ei),this.tick())},u.onSubtitleFragProcessed=function(t){var n=t.frag,c=t.success;if(this.fragPrevious=n,this.state=ne.IDLE,!!c){var v=this.tracksBuffered[this.currentTrackId];if(v){for(var E,w=n.start,C=0;C<v.length;C++)if(w>=v[C].start&&w<=v[C].end){E=v[C];break}var Y=n.start+n.duration;E?E.end=Y:(E={start:w,end:Y},v.push(E))}}},u.onMediaAttached=function(t){var n=t.media;this.media=n,n.addEventListener("seeking",this._onMediaSeeking),this.state=ne.IDLE},u.onMediaDetaching=function(){var t=this;this.media&&(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach(function(n){t.tracksBuffered[n.id]=[]}),this.media=null,this.state=ne.STOPPED)},u.onError=function(t){var n=t.frag;!n||n.type!=="subtitle"||(this.fragCurrent&&this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.state=ne.IDLE)},u.onSubtitleTracksUpdated=function(t){var n=this;h.logger.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=t.subtitleTracks,this.tracks.forEach(function(c){n.tracksBuffered[c.id]=[]})},u.onSubtitleTrackSwitch=function(t){if(this.currentTrackId=t.id,!this.tracks||!this.tracks.length||this.currentTrackId===-1){this.clearInterval();return}var n=this.tracks[this.currentTrackId];n&&n.details&&this.setInterval(Ei)},u.onSubtitleTrackLoaded=function(t){var n=t.id,c=t.details,v=this.currentTrackId,E=this.tracks,w=E[v];n>=E.length||n!==v||!w||(c.live&&Pe(w.details,c,this.lastAVStart),w.details=c,this.setInterval(Ei))},u.onKeyLoaded=function(){this.state===ne.KEY_LOADING&&(this.state=ne.IDLE)},u.onFragLoaded=function(t){var n=this.fragCurrent,c=t.frag.decryptdata,v=t.frag,E=this.hls;if(this.state===ne.FRAG_LOADING&&n&&t.frag.type==="subtitle"&&n.sn===t.frag.sn&&t.payload.byteLength>0&&c&&c.key&&c.method==="AES-128"){var w=Ia.now();this.decrypter.decrypt(t.payload,c.key.buffer,c.iv.buffer,function(C){var Y=Ia.now();E.trigger(d.default.FRAG_DECRYPTED,{frag:v,payload:C,stats:{tstart:w,tdecrypt:Y}})})}},u.onLevelUpdated=function(t){var n=t.details,c=n.fragments;this.lastAVStart=c.length?c[0].start:0},u.doTick=function(){if(!this.media){this.state=ne.IDLE;return}switch(this.state){case ne.IDLE:{var t=this.config,n=this.currentTrackId,c=this.fragmentTracker,v=this.media,E=this.tracks;if(!E||!E[n]||!E[n].details)break;var w=t.maxBufferHole,C=t.maxFragLookUpTolerance,Y=Math.min(t.maxBufferLength,t.maxMaxBufferLength),B=A.bufferedInfo(this._getBuffered(),v.currentTime,w),K=B.end,Q=B.len,_e=E[n].details,Le=_e.fragments,Ue=Le.length,Be=Le[Ue-1].start+Le[Ue-1].duration;if(Q>Y)return;var Ke,Ze=this.fragPrevious;K<Be?(Ze&&_e.hasProgramDateTime&&(Ke=Ft(Le,Ze.endProgramDateTime,C)),Ke||(Ke=St(Ze,Le,K,C))):Ke=Le[Ue-1],Ke&&Ke.encrypted?(h.logger.log("Loading key for "+Ke.sn),this.state=ne.KEY_LOADING,this.hls.trigger(d.default.KEY_LOADING,{frag:Ke})):Ke&&c.getState(Ke)===de.NOT_LOADED&&(this.fragCurrent=Ke,this.state=ne.FRAG_LOADING,this.hls.trigger(d.default.FRAG_LOADING,{frag:Ke}))}}},u.stopLoad=function(){this.lastAVStart=0,this.fragPrevious=null,y.prototype.stopLoad.call(this)},u._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},u.onMediaSeeking=function(){if(this.fragCurrent){var t=this.media?this.media.currentTime:0,n=this.config.maxFragLookUpTolerance,c=this.fragCurrent.start-n,v=this.fragCurrent.start+this.fragCurrent.duration+n;(t<c||t>v)&&(this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.fragmentTracker.removeFragment(this.fragCurrent),this.fragCurrent=null,this.fragPrevious=null,this.state=ne.IDLE,this.tick())}},m}(vt),en;(function(y){y.WIDEVINE="com.widevine.alpha",y.PLAYREADY="com.microsoft.playready"})(en||(en={}));var cu=function(){return typeof window<"u"&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null}();function du(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function fu(y,m,u){return m&&du(y.prototype,m),y}function hu(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var Pa=3,gu=function(m,u,a){var t={audioCapabilities:[],videoCapabilities:[]};return m.forEach(function(n){t.audioCapabilities.push({contentType:'audio/mp4; codecs="'+n+'"',robustness:a.audioRobustness||""})}),u.forEach(function(n){t.videoCapabilities.push({contentType:'video/mp4; codecs="'+n+'"',robustness:a.videoRobustness||""})}),[t]},mu=function(m,u,a,t){switch(m){case en.WIDEVINE:return gu(u,a,t);default:throw new Error("Unknown key-system: "+m)}},pu=function(y){hu(m,y);function m(a){var t;return t=y.call(this,a,d.default.MEDIA_ATTACHED,d.default.MEDIA_DETACHED,d.default.MANIFEST_PARSED)||this,t._widevineLicenseUrl=void 0,t._licenseXhrSetup=void 0,t._emeEnabled=void 0,t._requestMediaKeySystemAccess=void 0,t._drmSystemOptions=void 0,t._config=void 0,t._mediaKeysList=[],t._media=null,t._hasSetMediaKeys=!1,t._requestLicenseFailureCount=0,t.mediaKeysPromise=null,t._onMediaEncrypted=function(n){if(h.logger.log('Media is encrypted using "'+n.initDataType+'" init data type'),!t.mediaKeysPromise){h.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),t.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var c=function(E){t._media&&(t._attemptSetMediaKeys(E),t._generateRequestWithPreferredKeySession(n.initDataType,n.initData))};t.mediaKeysPromise.then(c).catch(c)},t._config=a.config,t._widevineLicenseUrl=t._config.widevineLicenseUrl,t._licenseXhrSetup=t._config.licenseXhrSetup,t._emeEnabled=t._config.emeEnabled,t._requestMediaKeySystemAccess=t._config.requestMediaKeySystemAccessFunc,t._drmSystemOptions=a.config.drmSystemOptions,t}var u=m.prototype;return u.getLicenseServerUrl=function(t){switch(t){case en.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+t+'"')},u._attemptKeySystemAccess=function(t,n,c){var v=this,E=mu(t,n,c,this._drmSystemOptions);h.logger.log("Requesting encrypted media key-system access");var w=this.requestMediaKeySystemAccess(t,E);this.mediaKeysPromise=w.then(function(C){return v._onMediaKeySystemAccessObtained(t,C)}),w.catch(function(C){h.logger.error('Failed to obtain key-system "'+t+'" access:',C)})},u._onMediaKeySystemAccessObtained=function(t,n){var c=this;h.logger.log('Access for key-system "'+t+'" obtained');var v={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:n,mediaKeySystemDomain:t};this._mediaKeysList.push(v);var E=Promise.resolve().then(function(){return n.createMediaKeys()}).then(function(w){return v.mediaKeys=w,h.logger.log('Media-keys created for key-system "'+t+'"'),c._onMediaKeysCreated(),w});return E.catch(function(w){h.logger.error("Failed to create media-keys:",w)}),E},u._onMediaKeysCreated=function(){var t=this;this._mediaKeysList.forEach(function(n){n.mediaKeysSession||(n.mediaKeysSession=n.mediaKeys.createSession(),t._onNewMediaKeySession(n.mediaKeysSession))})},u._onNewMediaKeySession=function(t){var n=this;h.logger.log("New key-system session "+t.sessionId),t.addEventListener("message",function(c){n._onKeySessionMessage(t,c.message)},!1)},u._onKeySessionMessage=function(t,n){h.logger.log("Got EME message event, creating license request"),this._requestLicense(n,function(c){h.logger.log("Received license data (length: "+(c&&c.byteLength)+"), updating key-session"),t.update(c)})},u._attemptSetMediaKeys=function(t){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var n=this._mediaKeysList[0];if(!n||!n.mediaKeys){h.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}h.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(n.mediaKeys),this._hasSetMediaKeys=!0}},u._generateRequestWithPreferredKeySession=function(t,n){var c=this,v=this._mediaKeysList[0];if(!v){h.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(v.mediaKeysSessionInitialized){h.logger.warn("Key-Session already initialized but requested again");return}var E=v.mediaKeysSession;if(!E){h.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!n){h.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}h.logger.log('Generating key-session request for "'+t+'" init data type'),v.mediaKeysSessionInitialized=!0,E.generateRequest(t,n).then(function(){h.logger.debug("Key-session generation succeeded")}).catch(function(w){h.logger.error("Error generating key-session request:",w),c.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},u._createLicenseXhr=function(t,n,c){var v=new XMLHttpRequest,E=this._licenseXhrSetup;try{if(E)try{E(v,t)}catch{v.open("POST",t,!0),E(v,t)}v.readyState||v.open("POST",t,!0)}catch(w){throw new Error("issue setting up KeySystem license XHR "+w)}return v.responseType="arraybuffer",v.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,v,t,n,c),v},u._onLicenseRequestReadyStageChange=function(t,n,c,v){switch(t.readyState){case 4:if(t.status===200)this._requestLicenseFailureCount=0,h.logger.log("License request succeeded"),t.responseType!=="arraybuffer"&&h.logger.warn("xhr response type was not set to the expected arraybuffer for license request"),v(t.response);else{if(h.logger.error("License Request XHR failed ("+n+"). Status: "+t.status+" ("+t.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>Pa){this.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var E=Pa-this._requestLicenseFailureCount+1;h.logger.warn("Retrying license request, "+E+" attempts left"),this._requestLicense(c,v)}break}},u._generateLicenseRequestChallenge=function(t,n){switch(t.mediaKeySystemDomain){case en.WIDEVINE:return n}throw new Error("unsupported key-system: "+t.mediaKeySystemDomain)},u._requestLicense=function(t,n){h.logger.log("Requesting content license for key-system");var c=this._mediaKeysList[0];if(!c){h.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var v=this.getLicenseServerUrl(c.mediaKeySystemDomain),E=this._createLicenseXhr(v,t,n);h.logger.log("Sending license request to URL: "+v);var w=this._generateLicenseRequestChallenge(c,t);E.send(w)}catch(C){h.logger.error("Failure requesting DRM license: "+C),this.hls.trigger(d.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},u.onMediaAttached=function(t){if(this._emeEnabled){var n=t.media;this._media=n,n.addEventListener("encrypted",this._onMediaEncrypted)}},u.onMediaDetached=function(){var t=this._media,n=this._mediaKeysList;t&&(t.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(n.map(function(c){if(c.mediaKeysSession)return c.mediaKeysSession.close().catch(function(){})})).then(function(){return t.setMediaKeys(null)}).catch(function(){}))},u.onManifestParsed=function(t){if(this._emeEnabled){var n=t.levels.map(function(v){return v.audioCodec}),c=t.levels.map(function(v){return v.videoCodec});this._attemptKeySystemAccess(en.WIDEVINE,n,c)}},fu(m,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),m}(x),vu=pu;function Oa(y,m){var u=Object.keys(y);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(y);m&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(y,t).enumerable})),u.push.apply(u,a)}return u}function Fa(y){for(var m=1;m<arguments.length;m++){var u=arguments[m]!=null?arguments[m]:{};m%2?Oa(Object(u),!0).forEach(function(a){_u(y,a,u[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(u)):Oa(Object(u)).forEach(function(a){Object.defineProperty(y,a,Object.getOwnPropertyDescriptor(u,a))})}return y}function _u(y,m,u){return m in y?Object.defineProperty(y,m,{value:u,enumerable:!0,configurable:!0,writable:!0}):y[m]=u,y}var yu=Fa(Fa({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:60*1e3*1e3,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:yl,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:al,bufferController:ll,capLevelController:fl,fpsController:vl,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:cu,testBandwidth:!0},bu()),{},{subtitleStreamController:uu,subtitleTrackController:iu,timelineController:Ql,audioStreamController:Rl,audioTrackController:Tl,emeController:vu});function bu(){return{cueHandler:f,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function Na(y,m){var u=Object.keys(y);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(y);m&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(y,t).enumerable})),u.push.apply(u,a)}return u}function Ya(y){for(var m=1;m<arguments.length;m++){var u=arguments[m]!=null?arguments[m]:{};m%2?Na(Object(u),!0).forEach(function(a){Su(y,a,u[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(u)):Na(Object(u)).forEach(function(a){Object.defineProperty(y,a,Object.getOwnPropertyDescriptor(u,a))})}return y}function Su(y,m,u){return m in y?Object.defineProperty(y,m,{value:u,enumerable:!0,configurable:!0,writable:!0}):y[m]=u,y}function Nt(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function Ba(y,m){for(var u=0;u<m.length;u++){var a=m[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(y,a.key,a)}}function ja(y,m,u){return m&&Ba(y.prototype,m),u&&Ba(y,u),y}function Eu(y,m){y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.__proto__=m}var Ha=function(y){Eu(m,y),m.isSupported=function(){return pi()},ja(m,null,[{key:"version",get:function(){return"0.14.17"}},{key:"Events",get:function(){return d.default}},{key:"ErrorTypes",get:function(){return g.ErrorTypes}},{key:"ErrorDetails",get:function(){return g.ErrorDetails}},{key:"DefaultConfig",get:function(){return m.defaultConfig?m.defaultConfig:yu},set:function(t){m.defaultConfig=t}}]);function m(a){var t;a===void 0&&(a={}),t=y.call(this)||this,t.config=void 0,t._autoLevelCapping=void 0,t.abrController=void 0,t.capLevelController=void 0,t.levelController=void 0,t.streamController=void 0,t.networkControllers=void 0,t.audioTrackController=void 0,t.subtitleTrackController=void 0,t.emeController=void 0,t.coreComponents=void 0,t.media=null,t.url=null;var n=m.DefaultConfig;if((a.liveSyncDurationCount||a.liveMaxLatencyDurationCount)&&(a.liveSyncDuration||a.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");t.config=Ya(Ya({},n),a);var c=Nt(t),v=c.config;if(v.liveMaxLatencyDurationCount!==void 0&&v.liveMaxLatencyDurationCount<=v.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(v.liveMaxLatencyDuration!==void 0&&(v.liveSyncDuration===void 0||v.liveMaxLatencyDuration<=v.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(h.enableLogs)(v.debug),t._autoLevelCapping=-1;var E=t.abrController=new v.abrController(Nt(t)),w=new v.bufferController(Nt(t)),C=t.capLevelController=new v.capLevelController(Nt(t)),Y=new v.fpsController(Nt(t)),B=new je(Nt(t)),K=new Ge(Nt(t)),Q=new me(Nt(t)),_e=new mi(Nt(t)),Le=t.levelController=new gi(Nt(t)),Ue=new Ae(Nt(t)),Be=t.streamController=new qr(Nt(t),Ue),Ke=[Le,Be],Ze=v.audioStreamController;Ze&&Ke.push(new Ze(Nt(t),Ue)),t.networkControllers=Ke;var st=[B,K,Q,E,w,C,Y,_e,Ue];if(Ze=v.audioTrackController,Ze){var xt=new Ze(Nt(t));t.audioTrackController=xt,st.push(xt)}if(Ze=v.subtitleTrackController,Ze){var rr=new Ze(Nt(t));t.subtitleTrackController=rr,Ke.push(rr)}if(Ze=v.emeController,Ze){var zt=new Ze(Nt(t));t.emeController=zt,st.push(zt)}return Ze=v.subtitleStreamController,Ze&&Ke.push(new Ze(Nt(t),Ue)),Ze=v.timelineController,Ze&&st.push(new Ze(Nt(t))),t.coreComponents=st,t}var u=m.prototype;return u.destroy=function(){h.logger.log("destroy"),this.trigger(d.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(t){t.destroy()}),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},u.attachMedia=function(t){h.logger.log("attachMedia"),this.media=t,this.trigger(d.default.MEDIA_ATTACHING,{media:t})},u.detachMedia=function(){h.logger.log("detachMedia"),this.trigger(d.default.MEDIA_DETACHING),this.media=null},u.loadSource=function(t){t=s.buildAbsoluteURL(window.location.href,t,{alwaysNormalize:!0}),h.logger.log("loadSource:"+t),this.url=t,this.trigger(d.default.MANIFEST_LOADING,{url:t})},u.startLoad=function(t){t===void 0&&(t=-1),h.logger.log("startLoad("+t+")"),this.networkControllers.forEach(function(n){n.startLoad(t)})},u.stopLoad=function(){h.logger.log("stopLoad"),this.networkControllers.forEach(function(t){t.stopLoad()})},u.swapAudioCodec=function(){h.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},u.recoverMediaError=function(){h.logger.log("recoverMediaError");var t=this.media;this.detachMedia(),t&&this.attachMedia(t)},u.removeLevel=function(t,n){n===void 0&&(n=0),this.levelController.removeLevel(t,n)},ja(m,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(t){h.logger.log("set currentLevel:"+t),this.loadLevel=t,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(t){h.logger.log("set nextLevel:"+t),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(t){h.logger.log("set loadLevel:"+t),this.levelController.manualLevel=t}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(t){this.levelController.nextLoadLevel=t}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(t){h.logger.log("set firstLevel:"+t),this.levelController.firstLevel=t}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(t){h.logger.log("set startLevel:"+t),t!==-1&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}},{key:"capLevelToPlayerSize",set:function(t){var n=!!t;n!==this.config.capLevelToPlayerSize&&(n?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=n)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(t){h.logger.log("set autoLevelCapping:"+t),this._autoLevelCapping=t}},{key:"bandwidthEstimate",get:function(){var t=this.abrController._bwEstimator;return t?t.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var t=this.levels,n=this.config.minAutoBitrate,c=t?t.length:0,v=0;v<c;v++){var E=t[v].realBitrate?Math.max(t[v].realBitrate,t[v].bitrate):t[v].bitrate;if(E>n)return v}return 0}},{key:"maxAutoLevel",get:function(){var t=this.levels,n=this.autoLevelCapping,c;return n===-1&&t&&t.length?c=t.length-1:c=n,c}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(t){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,t)}},{key:"audioTracks",get:function(){var t=this.audioTrackController;return t?t.audioTracks:[]}},{key:"audioTrack",get:function(){var t=this.audioTrackController;return t?t.audioTrack:-1},set:function(t){var n=this.audioTrackController;n&&(n.audioTrack=t)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1},set:function(t){var n=this.subtitleTrackController;n&&(n.subtitleTrack=t)}},{key:"subtitleDisplay",get:function(){var t=this.subtitleTrackController;return t?t.subtitleDisplay:!1},set:function(t){var n=this.subtitleTrackController;n&&(n.subtitleDisplay=t)}}]),m}(X);Ha.defaultConfig=void 0},"./src/polyfills/number.js":function(i,o,l){l.r(o),l.d(o,"isFiniteNumber",function(){return f}),l.d(o,"MAX_SAFE_INTEGER",function(){return s});var f=Number.isFinite||function(g){return typeof g=="number"&&isFinite(g)},s=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/utils/get-self-scope.js":function(i,o,l){l.r(o),l.d(o,"getSelfScope",function(){return f});function f(){return typeof window>"u"?self:window}},"./src/utils/logger.js":function(i,o,l){l.r(o),l.d(o,"enableLogs",function(){return x}),l.d(o,"logger",function(){return T});var f=l("./src/utils/get-self-scope.js");function s(){}var g={trace:s,debug:s,log:s,warn:s,info:s,error:s},p=g;function d(b,M){return M="["+b+"] > "+M,M}var h=Object(f.getSelfScope)();function L(b){var M=h.console[b];return M?function(){for(var R=arguments.length,k=new Array(R),j=0;j<R;j++)k[j]=arguments[j];k[0]&&(k[0]=d(b,k[0])),M.apply(h.console,k)}:s}function _(b){for(var M=arguments.length,R=new Array(M>1?M-1:0),k=1;k<M;k++)R[k-1]=arguments[k];R.forEach(function(j){p[j]=b[j]?b[j].bind(b):L(j)})}var x=function(M){if(h.console&&M===!0||typeof M=="object"){_(M,"debug","log","info","warn","error");try{p.log()}catch{p=g}}else p=g},T=p}}).default})})(bo);var df=bo.exports;const Lr=Or(df);var wn=function(){return wn=Object.assign||function(e){for(var r,i=1,o=arguments.length;i<o;i++){r=arguments[i];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},wn.apply(this,arguments)},ff=function(e,r){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&r.indexOf(o)<0&&(i[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,o=Object.getOwnPropertySymbols(e);l<o.length;l++)r.indexOf(o[l])<0&&Object.prototype.propertyIsEnumerable.call(e,o[l])&&(i[o[l]]=e[o[l]]);return i};function hf(e){var r=e.hlsConfig,i=e.playerRef,o=i===void 0?et.createRef():i,l=e.src,f=e.autoPlay,s=ff(e,["hlsConfig","playerRef","src","autoPlay"]);return I.useEffect(function(){var g;function p(){g!=null&&g.destroy();var d=new Lr(wn({enableWorker:!1},r));o.current!=null&&d.attachMedia(o.current),d.on(Lr.Events.MEDIA_ATTACHED,function(){d.loadSource(l),d.on(Lr.Events.MANIFEST_PARSED,function(){var h;f&&((h=o==null?void 0:o.current)===null||h===void 0||h.play().catch(function(){return console.log("Unable to autoplay prior to user interaction with the dom.")}))})}),d.on(Lr.Events.ERROR,function(h,L){if(L.fatal)switch(L.type){case Lr.ErrorTypes.NETWORK_ERROR:d.startLoad();break;case Lr.ErrorTypes.MEDIA_ERROR:d.recoverMediaError();break;default:p();break}}),g=d}return Lr.isSupported()&&p(),function(){g!=null&&g.destroy()}},[f,r,o,l]),Lr.isSupported()?et.createElement("video",wn({ref:o},s)):et.createElement("video",wn({ref:o,src:l,autoPlay:f},s))}const So=e=>{var Ne;const{cssClass:r,state:i,width:o,height:l,border:f,imgId:s,useExternalUrl:g,externalUrl:p,videoUrl:d="",backgroundColor:h,autoplay:L,muted:_,hideAllControls:x,boxShadow:T,boxReflect:b,constraintsVertical:M,constraintsHorizontal:R,isStaticElement:k,left:j,top:N,right:H,bottom:G,staticDevMoveableRef:V,index:J,deltaCenterX:Z,deltaCenterY:ee}=e,ge=Pt(i,J),pe=Lt(je=>je.envState),Ee=pe==="live"||pe==="preview"||pe==="build",be=$r(f),Me=wt({width:o,height:l,constraintsVertical:M,constraintsHorizontal:R,isStaticElement:k,left:j,top:N,right:H,bottom:G,fallbackHeight:"150px",fallbackWidth:"255px",deltaCenterX:Z,deltaCenterY:ee}),ce=nt({[`element_${e.type}`]:!0,[`${r}`]:r,...ge}),ve=h?{backgroundColor:h}:{backgroundImage:"radial-gradient(rgba(21, 25, 60, 0.8), rgba(0, 0, 0, 0.8))"},[fe,xe]=I.useState(null),[we,ye]=I.useState(!!L);I.useEffect(()=>{ia({imgId:s,useExternalUrl:g,externalUrl:p}).then(je=>{xe(je)}).catch(()=>{xe("")})},[p,s,g]);const q=I.useMemo(()=>fe?{backgroundImage:`url(${fe})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}:{},[fe]),oe=I.useRef(null);I.useEffect(()=>{let je;return we&&!d&&(console.info("%cNo Video URL specified","color:#000; background-color:#f93b10"),je=setTimeout(()=>{ye(!1)},500)),we&&!Ee&&ye(!1),L&&Ee&&ye(!0),()=>{je&&clearTimeout(je)}},[L,Ee,we,d]);const ae={src:d,autoPlay:!0,controlsList:"nodownload noplaybackrate",controls:!x,width:"100%",height:"100%",disablePictureInPicture:!0,poster:fe??"",preload:"none",muted:!!_,onError:()=>{setTimeout(()=>{console.info("%cError loading video","color:#000; background-color:#f93b10"),ye(!1)},1e3)}},Re=I.useRef(!1);try{Re.current=!!((Ne=d==null?void 0:d.split(".").slice(-1)[0].toLowerCase())!=null&&Ne.includes("m3u"))}catch(je){Re.current=!1,console.error("Error while trying to get video extension",je)}const Ce=()=>Re.current?D.jsx(hf,{playerRef:oe,hlsConfig:{autoStartLoad:!0,debug:!0},...ae}):D.jsx("video",{...ae}),ke=Vr(T),De=Xt(b);return D.jsx(cf,{onClick:()=>{Ee&&ye(!0)},...e,ref:je=>{V&&(V.current=je)},style:{borderRadius:"8px",...Me,...q,...be,...ve,...ke,...De},className:ce,children:we?D.jsx(Ce,{}):D.jsx(fr,{className:"playIcon",icon:"BsFillPlayCircleFill"})})};So.displayName="VideoElement";const gf=ct(jt)`
  min-width: 150px;
  min-height: 50px;
  position: relative;

  &.isVertical {
    min-height: 150px;
    min-width: 70px;
  }

  .flex {
    position: absolute;
    width: 100%;
    height: 100%;
    overflow: hidden;
    display: flex;
    border-radius: ${({theme:e})=>e.borderRadius};
    background: hsla(0, 0%, 100%, 0.15);

    &.isVertical {
      flex-direction: column-reverse;
    }

    &.reverse {
      flex-direction: row-reverse;
      &.isVertical {
        flex-direction: column;
      }
    }

    .activeBg {
      position: absolute;
      left: 0;
      top: 0;
      width: 50%;
      height: 100%;
      z-index: 1;
      background: rgba(0, 0, 0, 0.8);
      will-change: transform, background;
      transition: background 150ms ease, transform 250ms ease;
    }

    &.isVertical {
      .activeBg {
        width: 100%;
        height: 50%;
        top: auto;
        bottom: 0;
      }
    }

    &.reverse {
      .activeBg {
        left: auto;
        right: 0;
      }
      &.isVertical {
        .activeBg {
          bottom: auto;
          top: 0;
        }
      }
    }

    &.checked {
      .activeBg {
        background: ${({theme:e,stateOnActiveBackground:r})=>r||e.colors.primaryColor};
        transform: translateX(100%);
      }
      &.reverse {
        .activeBg {
          transform: translateX(-100%);
        }
      }

      &.isVertical {
        .activeBg {
          transform: translateY(-100%);
        }
        &.reverse {
          .activeBg {
            transform: translateY(100%);
          }
        }
      }
    }

    .on,
    .off {
      position: relative;
      z-index: 2;
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    &.checked {
      .on {
        color: ${({stateOnActiveTextColor:e})=>e||"#000"};
      }
    }
  }
`,Eo=e=>{const{cssClass:r,state:i,textFontSize:o,reverse:l=!1,isVertical:f=!1,onText:s,offText:g,width:p,height:d,actions:h,elementRenderId:L,fontFamily:_="inherit",boxShadow:x,boxReflect:T,staticDevMoveableRef:b,constraintsVertical:M,constraintsHorizontal:R,isStaticElement:k,left:j,top:N,right:H,bottom:G,index:V,deltaCenterX:J,deltaCenterY:Z}=e,ee=pt(Fe=>Fe.showBoundingBox),ge=Pt(i,V),pe=Kt(i==null?void 0:i.checkedState_signal)??!1,[Ee,be]=I.useState(pe),Me=I.useRef(),ce=I.useRef(pe);I.useEffect(()=>{ce.current=pe,be(pe)},[pe]);const ve=Et(o),fe=nt({on:!0}),xe=nt({off:!0}),we=nt({activeBg:!0}),ye=nt({flex:!0,checked:Ee,reverse:l,isVertical:f}),q=wt({width:p,height:d,constraintsVertical:M,constraintsHorizontal:R,isStaticElement:k,left:j,top:N,right:H,bottom:G,fallbackWidth:"120px",fallbackHeight:"50px",deltaCenterX:J,deltaCenterY:Z}),{onBeforeChangeActions:oe,onAfterChangeActions:ae,onChangeActions:Re,isActiveOverlayTrigger:Ce}=lr({actions:h,elementRenderId:L}),ke=nt({[`element_${e.type}`]:!0,[`${r}`]:r,showBoundingBox:ee,isVertical:f,isActiveOverlayTrigger:!!Ce,...ge});function De(Fe){function ze(){clearTimeout(Me.current),Me.current=setTimeout(()=>{be(ce.current)},3e3)}if(ze(),oe.length)for(const Ge of oe)Ge(Fe);if(Re.length)for(const Ge of Re)Ge(Fe);if(be(Fe),ae.length)for(const Ge of ae)Ge(Fe)}const Ne=Vr(x),je=Xt(T);return D.jsx(gf,{style:{...q,fontFamily:_,...Ne,...je},...e,ref:Fe=>{b&&(b.current=Fe)},className:ke,children:D.jsxs("div",{className:ye,children:[D.jsx("div",{className:we}),D.jsx("div",{onClick:()=>{De(!1)},className:xe,children:g?D.jsx(Ct,{...e,style:ve,text:g}):"OFF"}),D.jsx("div",{onClick:()=>{De(!0)},className:fe,children:s?D.jsx(Ct,{...e,style:ve,text:s}):"ON"})]})})};Eo.displayName="ToggleWidget";const mf=ct(jt)`
  position: relative;
  display: flex;
  align-items: center;
justify-content: center;

  .circleSliderOuter {
    position: relative;

    .circleSliderCenterText {
      pointer-events: none;
      position: absolute;
      left: 20%;
      top: 20%;
      width: 60%;
      height: 60%;
      display: flex;
      flex-flow: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      gap: 5%;
      container-type: size;

      & > * {
        position: relative;
        width: 100%;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        text-align: center;
        line-height: 100%;
      }

      .circleSliderPreTitle,
      .circleSliderPreValue {
        line-height: 100%;
        font-size: 10px;
        text-transform: uppercase;
        opacity: 0.7;
      }

      .circleSliderTitle {
        font-size: 30cqw;
        font-weight: 300;
        line-height: 100%;
        p {
          line-height: 100%;
          margin: 0;
          padding: 0;
        }
      }

      .circleSliderSubTitle {
        font-size: 15cqw;
        font-weight: 100;
        display: flex;
        /* gap: 0.3em; */
        justify-content: center;
        font-family: 'Helvetica';
      }

      .circleSliderDescription {
        font-size: max(6cqw, 6px);
        font-weight: 300;
        opacity: 0.7;
        text-transform: uppercase;
      }
    }
  }
`;function pf(e){const{angle:r,minValue:i,maxValue:o,startAngle:l,endAngle:f}=e;if(f<=l)throw new Error("endAngle must be greater than startAngle");return r<l?i:r>f?o:(r-l)/(f-l)*(o-i)+i}function us(e){const{value:r,minValue:i,maxValue:o,startAngle:l,endAngle:f}=e;if(f<=l)throw new Error("endAngle must be greater than startAngle");return(r-i)/(o-i)*(f-l)+l}function xo(e,r,i){if(i=i||{direction:"ccw",axis:"+x"},r.direction!==i.direction&&(e=e===0?0:360-e),r.axis===i.axis)return e;if(r.axis[1]===i.axis[1])return(180+e)%360;switch(i.direction+r.axis+i.axis){case"ccw+x-y":case"ccw-x+y":case"ccw+y+x":case"ccw-y-x":case"cw+y-x":case"cw-y+x":case"cw-x-y":case"cw+x+y":return(90+e)%360;case"ccw+y-x":case"ccw-y+x":case"ccw+x+y":case"ccw-x-y":case"cw+x-y":case"cw-x+y":case"cw+y+x":case"cw-y-x":return(270+e)%360;default:throw new Error("Unhandled conversion")}}function un(e,r,i){const l=xo(e.degree,e,{direction:"ccw",axis:"+x"})/180*Math.PI;let f,s;l<=Math.PI?l<=Math.PI/2?(s=Math.sin(l)*r,f=Math.cos(l)*r):(s=Math.sin(Math.PI-l)*r,f=Math.cos(Math.PI-l)*r*-1):l<=Math.PI*1.5?(s=Math.sin(l-Math.PI)*r*-1,f=Math.cos(l-Math.PI)*r*-1):(s=Math.sin(2*Math.PI-l)*r*-1,f=Math.cos(2*Math.PI-l)*r);const g=f+i/2,p=i/2-s;return{x:g,y:p}}function vf(e,r,i){const o=e.x-r/2,l=r/2-e.y;let f=Math.atan2(l,o);f<0&&(f=f+2*Math.PI);const s=f/Math.PI*180;return xo(s,{direction:"ccw",axis:"+x"},i)}function bn(e){const{startAngle:r,innerRadius:i,thickness:o,direction:l,angleType:f,svgSize:s}=e;let{endAngle:g}=e;r%360===g%360&&r!==g&&(g=g-.001);const p=g-r>=180,d=i+o,h=un({degree:r,...f},i,s),L=`
    M ${h.x},${h.y}
  `,_=un({degree:g,...f},i,s),x=`
    A ${i} ${i} 0
      ${p?"1":"0"}
      ${l==="cw"?"1":"0"}
      ${_.x} ${_.y}
  `,T=un({degree:g,...f},d,s),b=`
    A ${o/2} ${o/2} 0
      ${p?"1":"0"}
      ${l==="cw"?"0":"1"}
      ${T.x} ${T.y}
  `,M=un({degree:r,...f},d,s),R=`
    A ${d} ${d} 0
      ${p?"1":"0"}
      ${l==="cw"?"0":"1"}
      ${M.x} ${M.y}
  `,k=`
    A ${o/2} ${o/2} 0
      ${p?"1":"0"}
      ${l==="cw"?"0":"1"}
      ${h.x} ${h.y}
  `;return L+x+b+R+k+" Z"}class ri extends I.Component{constructor(){super(...arguments);mr(this,"svgRef",I.createRef());mr(this,"onMouseEnter",i=>{i.buttons===1&&this.onMouseDown(i)});mr(this,"onMouseDown",i=>{if(this.svgRef.current&&i.target instanceof Element){const l=i.target.tagName;(l==="circle"||l==="path")&&(window.addEventListener("mousemove",this.handleMousePosition),window.addEventListener("mouseleave",this.removeMouseListeners),window.addEventListener("mouseup",this.removeMouseListeners))}});mr(this,"removeMouseListeners",()=>{window.removeEventListener("mousemove",this.handleMousePosition),window.removeEventListener("mouseleave",this.removeMouseListeners),window.removeEventListener("mouseup",this.removeMouseListeners),this.props.onControlFinished&&this.props.onControlFinished()});mr(this,"handleMousePosition",i=>{const o=i.clientX,l=i.clientY;this.processSelection(o,l)});mr(this,"onTouch",i=>{if(i.touches.length>1||i.type==="touchend"&&i.touches.length>0)return;const o=i.changedTouches[0],l=o.clientX,f=o.clientY;if(i.target instanceof Element){const s=i.target.tagName;(s==="circle"||s==="path")&&this.processSelection(l,f)}});mr(this,"processSelection",(i,o)=>{var j;const{size:l,maxValue:f,minValue:s,angleType:g,startAngle:p,endAngle:d,handle1:h,disabled:L,handle2:_,coerceToInt:x}=this.props;if(!h.onChange)return;const T=this.svgRef.current;if(!T)return;const b=T.createSVGPoint();b.x=i,b.y=o;const M=b.matrixTransform((j=T.getScreenCTM())==null?void 0:j.inverse()),R=vf(M,l,g);let k=pf({angle:R,minValue:s,maxValue:f,startAngle:p,endAngle:d});x&&(k=Math.round(k)),L||(_&&_.onChange&&Math.abs(k-_.value)<Math.abs(k-h.value)?_.onChange(k):h.onChange(k))})}render(){const{size:i,handle1:o,handle2:l,handleSize:f,maxValue:s,minValue:g,startAngle:p,endAngle:d,angleType:h,disabled:L,arcColor:_,arcBackgroundColor:x,outerShadow:T,trackWidth:b=4,startColor:M,endColor:R,handleColor:k,index:j,interpolatedColor:N}=this.props,H=20,G=i/2-b-H,V=us({value:o.value,minValue:g,maxValue:s,startAngle:p,endAngle:d}),J=l&&us({value:l.value,minValue:g,maxValue:s,startAngle:p,endAngle:d}),Z=un({degree:V,...h},G+b/2,i),ee=J&&un({degree:J,...h},G+b/2,i),ge=!L&&!!o.onChange,pe=Math.abs((o.value/10||1)-100)-50;return D.jsxs("svg",{className:`circleSlider_${j}`,width:i,height:i,ref:this.svgRef,onMouseDown:this.onMouseDown,onClick:Ee=>ge&&Ee.stopPropagation(),onTouchStart:this.onTouch,onTouchEnd:this.onTouch,onTouchMove:this.onTouch,children:[D.jsx("defs",{children:D.jsxs("linearGradient",{id:`linear_${j}`,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[D.jsx("stop",{offset:pe,style:{stopColor:M}}),D.jsx("stop",{offset:"100%",style:{stopColor:R,stopOpacity:1}})]})}),T&&D.jsxs(I.Fragment,{children:[D.jsxs("radialGradient",{id:"outerShadow",children:[D.jsx("stop",{offset:"90%",stopColor:_}),D.jsx("stop",{offset:"100%",stopColor:"white"})]}),D.jsx("circle",{fill:"none",stroke:"url(#outerShadow)",cx:i/2,cy:i/2,r:G+b+H/2-1,strokeWidth:H})]}),J===void 0?D.jsxs(I.Fragment,{children:[D.jsx("path",{d:bn({startAngle:V,endAngle:d,angleType:h,innerRadius:G,thickness:b,svgSize:i,direction:h.direction}),fill:x}),D.jsx("path",{d:bn({startAngle:p,endAngle:V,angleType:h,innerRadius:G,thickness:b,svgSize:i,direction:h.direction}),fill:N||`url(#linear_${j})`})]}):D.jsxs(I.Fragment,{children:[D.jsx("path",{d:bn({startAngle:p,endAngle:V,angleType:h,innerRadius:G,thickness:b,svgSize:i,direction:h.direction}),fill:x}),D.jsx("path",{d:bn({startAngle:J,endAngle:d,angleType:h,innerRadius:G,thickness:b,svgSize:i,direction:h.direction}),fill:x}),D.jsx("path",{d:bn({startAngle:V,endAngle:J,angleType:h,innerRadius:G,thickness:b,svgSize:i,direction:h.direction}),fill:_})]}),ge&&D.jsxs(I.Fragment,{children:[D.jsxs("filter",{id:"handleShadow",x:"-50%",y:"-50%",width:"16",height:"16",children:[D.jsx("feOffset",{result:"offOut",in:"SourceGraphic",dx:"0",dy:"0"}),D.jsx("feColorMatrix",{result:"matrixOut",in:"offOut",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"}),D.jsx("feGaussianBlur",{result:"blurOut",in:"matrixOut",stdDeviation:"5"}),D.jsx("feBlend",{in:"SourceGraphic",in2:"blurOut",mode:"normal"})]}),D.jsx("circle",{r:f,cx:Z.x,cy:Z.y,fill:k,filter:"url(#handleShadow)",stroke:"transparent","stroke-width":"20"})]}),ee&&D.jsx(I.Fragment,{children:D.jsx("circle",{r:f,cx:ee.x,cy:ee.y,fill:"#ffffff",filter:"url(#handleShadow)"})})]},j)}}mr(ri,"defaultProps",{size:200,minValue:0,maxValue:100,startAngle:0,endAngle:360,angleType:{direction:"cw",axis:"-y"},handleSize:8,arcBackgroundColor:"#aaa",trackWidth:6});class _f extends I.Component{render(){const{size:r}=this.props;return D.jsxs("div",{style:{width:r,height:r,position:"relative"},children:[D.jsx(ri,{...this.props}),D.jsx("div",{style:{position:"absolute",top:"25%",left:"50%",transform:"translateX(-50%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:this.props.children})]})}}mr(_f,"defaultProps",ri.defaultProps);var cs=Is(),yf=bf,ds={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function bf(e){var r,i=[],o=1,l;if(typeof e=="string")if(e=e.toLowerCase(),cs[e])i=cs[e].slice(),l="rgb";else if(e==="transparent")o=0,l="rgb",i=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(e)){var f=e.slice(1),s=f.length,g=s<=4;o=1,g?(i=[parseInt(f[0]+f[0],16),parseInt(f[1]+f[1],16),parseInt(f[2]+f[2],16)],s===4&&(o=parseInt(f[3]+f[3],16)/255)):(i=[parseInt(f[0]+f[1],16),parseInt(f[2]+f[3],16),parseInt(f[4]+f[5],16)],s===8&&(o=parseInt(f[6]+f[7],16)/255)),i[0]||(i[0]=0),i[1]||(i[1]=0),i[2]||(i[2]=0),l="rgb"}else if(r=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(e)){var p=r[1],d=p==="rgb",f=p.replace(/a$/,"");l=f;var s=f==="cmyk"?4:f==="gray"?1:3;i=r[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(_,x){if(/%$/.test(_))return x===s?parseFloat(_)/100:f==="rgb"?parseFloat(_)*255/100:parseFloat(_);if(f[x]==="h"){if(/deg$/.test(_))return parseFloat(_);if(ds[_]!==void 0)return ds[_]}return parseFloat(_)}),p===f&&i.push(1),o=d||i[s]===void 0?1:i[s],i=i.slice(0,s)}else e.length>10&&/[0-9](?:\s|\/)/.test(e)&&(i=e.match(/([0-9]+)/g).map(function(h){return parseFloat(h)}),l=e.match(/([a-z])/ig).join("").toLowerCase());else isNaN(e)?Array.isArray(e)||e.length?(i=[e[0],e[1],e[2]],l="rgb",o=e.length===4?e[3]:1):e instanceof Object&&(e.r!=null||e.red!=null||e.R!=null?(l="rgb",i=[e.r||e.red||e.R||0,e.g||e.green||e.G||0,e.b||e.blue||e.B||0]):(l="hsl",i=[e.h||e.hue||e.H||0,e.s||e.saturation||e.S||0,e.l||e.lightness||e.L||e.b||e.brightness]),o=e.a||e.alpha||e.opacity||1,e.opacity!=null&&(o/=100)):(l="rgb",i=[e>>>16,(e&65280)>>>8,e&255]);return{space:l,values:i,alpha:o}}var Sf={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},Ef=Sf,xf={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(e){var r=e[0]/360,i=e[1]/100,o=e[2]/100,l,f,s,g,p;if(i===0)return p=o*255,[p,p,p];o<.5?f=o*(1+i):f=o+i-o*i,l=2*o-f,g=[0,0,0];for(var d=0;d<3;d++)s=r+1/3*-(d-1),s<0?s++:s>1&&s--,6*s<1?p=l+(f-l)*6*s:2*s<1?p=f:3*s<2?p=l+(f-l)*(2/3-s)*6:p=l,g[d]=p*255;return g}};Ef.hsl=function(e){var r=e[0]/255,i=e[1]/255,o=e[2]/255,l=Math.min(r,i,o),f=Math.max(r,i,o),s=f-l,g,p,d;return f===l?g=0:r===f?g=(i-o)/s:i===f?g=2+(o-r)/s:o===f&&(g=4+(r-i)/s),g=Math.min(g*60,360),g<0&&(g+=360),d=(l+f)/2,f===l?p=0:d<=.5?p=s/(f+l):p=s/(2-f-l),[g,p*100,d*100]};function Tf(e,r,i){return e*(1-i)+r*i}var wf=Tf,Mf=Lf;function Lf(e,r,i){return r<i?e<r?r:e>i?i:e:e<i?i:e>r?r:e}const kf=yf,Af=xf,Rf=wf,Cf=Mf;var Df=If;function If(e){return e=e.map(function(r){if(r=kf(r),r.space!="rgb"){if(r.space!="hsl")throw"c.spacespace is not supported.";r.values=Af.rgb(r.values)}return r.values.push(r.alpha),r.values}),function(r,i){i=i||Rf,r=Cf(r,0,1);var o=(e.length-1)*r,l=Math.floor(o),f=Math.ceil(o);r=o-l;var s=e[l],g=e[f],p=s.map(function(d,h){return d=i(d,g[h],r),h<3&&(d=Math.round(d)),d});return p[3]===1?"rgb("+p.slice(0,3)+")":"rgba("+p+")"}}const Pf=Or(Df);function Of(e,r){var i=I.useRef(null),o=I.useRef(null);o.current=r;var l=I.useRef(null);I.useEffect(function(){f()});var f=I.useCallback(function(){var s=l.current,g=o.current,p=s||(g?g instanceof Element?g:g.current:null);i.current&&i.current.element===p&&i.current.subscriber===e||(i.current&&i.current.cleanup&&i.current.cleanup(),i.current={element:p,subscriber:e,cleanup:p?e(p):void 0})},[e]);return I.useEffect(function(){return function(){i.current&&i.current.cleanup&&(i.current.cleanup(),i.current=null)}},[]),I.useCallback(function(s){l.current=s,f()},[f])}function fs(e,r,i){return e[r]?e[r][0]?e[r][0][i]:e[r][i]:r==="contentBoxSize"?e.contentRect[i==="inlineSize"?"width":"height"]:void 0}function To(e){e===void 0&&(e={});var r=e.onResize,i=I.useRef(void 0);i.current=r;var o=e.round||Math.round,l=I.useRef(),f=I.useState({width:void 0,height:void 0}),s=f[0],g=f[1],p=I.useRef(!1);I.useEffect(function(){return p.current=!1,function(){p.current=!0}},[]);var d=I.useRef({width:void 0,height:void 0}),h=Of(I.useCallback(function(L){return(!l.current||l.current.box!==e.box||l.current.round!==o)&&(l.current={box:e.box,round:o,instance:new ResizeObserver(function(_){var x=_[0],T=e.box==="border-box"?"borderBoxSize":e.box==="device-pixel-content-box"?"devicePixelContentBoxSize":"contentBoxSize",b=fs(x,T,"inlineSize"),M=fs(x,T,"blockSize"),R=b?o(b):void 0,k=M?o(M):void 0;if(d.current.width!==R||d.current.height!==k){var j={width:R,height:k};d.current.width=R,d.current.height=k,i.current?i.current(j):p.current||g(j)}})}),l.current.instance.observe(L,{box:e.box}),function(){l.current&&l.current.instance.unobserve(L)}},[e.box,o]),e.ref);return I.useMemo(function(){return{ref:h,width:s.width,height:s.height}},[h,s.width,s.height])}function Ff(e,r,i){const l=(r-e)*i/1e3;return e+l}function Nf(e,r,i){if(i<e)return 0;if(i>r)return 1e3;const o=r-e;return(i-e)/o*1e3}const wo=et.memo(e=>{const{cssClass:r,state:i,gap:o,width:l,backgroundColor:f,handleSize:s,trackWidth:g,handleColor:p,startValue:d=0,endValue:h=100,useColorInterpolation:L=!1,textTitle:_,textBeforeValue:x,textAfterValue:T,textDescription:b,value_signal_a:M,valueSignDisplay:R="auto",textTitleSize:k,textValueSize:j,textDescriptionSize:N,useValueFraction:H,useHalfStep:G,actions:V,elementRenderId:J,textPreTitle:Z,textPreValue:ee,textPreTitleSize:ge,textPreValueSize:pe,fontFamily:Ee="inherit",boxReflect:be,staticDevMoveableRef:Me,height:ce,constraintsVertical:ve,constraintsHorizontal:fe,isStaticElement:xe,left:we,top:ye,right:q,bottom:oe,index:ae,deltaCenterX:Re,deltaCenterY:Ce}=e;let{startColor:ke,endColor:De}=e;ke=ke||"rgb(0, 162, 255)",De=De||"rgb(255, 0, 0)";const Ne=Pt(i,ae),je=Et(ge),Fe=Et(pe),ze=Et(k),Ge=Et(j),Ve=Et(N),Xe=yt({sizeObj:o,sizePropName:"gap"}),me=Hr(M),te=I.useRef(me),[de,Ae]=I.useState(0),O=I.useRef(),U=I.useRef(!1),A=I.useRef(),[S,P]=I.useState("0"),F=I.useRef(S);I.useEffect(()=>{let Ye=Ff(d,h,de);G&&(Ye=Math.round(Ye*2)/2),Ye=Number(Ye.toFixed(H?1:0));const Oe=new Intl.NumberFormat("en-US",{signDisplay:R,maximumFractionDigits:H?1:0,minimumFractionDigits:H?1:0});P(Oe.format(Ye))},[h,de,d,G,H,R]),I.useEffect(()=>{F.current=S},[S]);const z=I.useCallback(({newValue:Ye})=>{if(String(Ye).length>1&&H){const Te=String(Ye).charAt(String(Ye).length-1);Ye=+(String(Ye).slice(0,-1)+"."+Te)}const Oe=Nf(d,h,Ye);Ae(Oe)},[h,d,H]);I.useEffect(()=>{te.current=me,z({newValue:me})},[z,me]),I.useEffect(()=>{z({newValue:me})},[J]);function $(Ye){Ae(Oe=>Math.abs(Ye-Oe)>800?Oe:Ye)}const[W,X]=I.useState();I.useEffect(()=>{if(L){const Oe=Pf([ke,De])(de/1e3);X(Oe)}else X(void 0)},[De,de,ke,L]);const{onBeforeChangeActions:se,onAfterChangeActions:ie,onChangeActions:re,isActiveOverlayTrigger:le}=lr({actions:V,elementRenderId:J}),he=nt({[`element_${e.type}`]:!0,[`${r}`]:r,isActiveOverlayTrigger:!!le,...Ne}),Se=()=>{function Ye(){clearTimeout(O.current),O.current=setTimeout(()=>{z({newValue:te.current})},3e3)}Ye();const Oe=Number(String(S).replace(".",""));if(!U.current){for(const Te of se)Te(Oe);U.current=!0}if(re.length)for(const Te of re)Te(Oe);ie.length&&(clearTimeout(A.current),A.current=setTimeout(()=>{const Te=Number(String(F.current).replace(".",""));for(const qe of ie)qe(Te);U.current=!1},1e3))},ue=Xt(be),Ie=wt({width:l,height:ce,constraintsVertical:ve,constraintsHorizontal:fe,isStaticElement:xe,left:we,top:ye,right:q,bottom:oe,deltaCenterX:Re,deltaCenterY:Ce}),{ref:Pe,width:He}=To();return D.jsx(mf,{...e,ref:Ye=>{Me&&(Me.current=Ye),Pe(Ye)},className:he,style:{...ue,...Ie},children:D.jsxs("div",{className:"circleSliderOuter",children:[D.jsx(ri,{interpolatedColor:W,index:J,handleColor:p||"#fff",startColor:ke,endColor:De,minValue:0,maxValue:1e3,size:He,handleSize:s??10,handle1:{value:de,onChange:Ye=>{$(Ye),Se()}},arcBackgroundColor:f||"rgba(255, 255, 255, 0.3)",startAngle:50,endAngle:310,trackWidth:g??2}),D.jsxs("div",{style:{...Xe,fontFamily:Ee},className:"circleSliderCenterText",children:[Z&&D.jsx("div",{style:{...je},className:"circleSliderPreTitle",children:D.jsx(Ct,{...e,text:Z})}),_&&D.jsx("div",{style:{...ze},className:"circleSliderTitle",children:D.jsx(Ct,{...e,text:_})}),ee&&D.jsx("div",{style:{...Fe},className:"circleSliderPreValue",children:D.jsx(Ct,{...e,text:ee})}),D.jsxs("div",{style:Ge,className:"circleSliderSubTitle",children:[x&&D.jsx(Ct,{...e,text:x}),S,T&&D.jsx(Ct,{...e,text:T})]}),b&&D.jsx("div",{style:{...Ve},className:"circleSliderDescription",children:D.jsx(Ct,{...e,text:b})})]})]})})});wo.displayName="CircleSliderWidget";const Yf=ct(jt)`
  position: relative;
  text-transform: uppercase;
  font-size: 14px;
  display: flex;
  flex-flow: column;
  gap: 1em;

  .rc-slider {
    border-radius: 0;
    pointer-events: none;
    padding: 0;

    .rc-slider-rail {
      display: none;
    }
    .rc-slider-handle {
      display: none;
    }
    .rc-slider-track {
      pointer-events: auto;
      border: 0;
      border-radius: 0;
      min-height: 20px;
      min-width: 20px;
      background-color: ${({shaderBackgroundColor:e})=>e};
      background-image: ${({shadesFabricImageBg:e})=>`url(${e})`};
      -webkit-backdrop-filter: ${({shaderBackgroundBlur:e})=>`blur(${e}px)`};
      backdrop-filter: ${({shaderBackgroundBlur:e})=>`blur(${e}px)`};
      background-size: 'cover';
      background-repeat: no-repeat;
      background-position: 50% 50%;
    }
  }

  .shadeVerticalSlider {
    width: 100%;
    .rc-slider-track {
      width: 100%;
      right: 0;
      cursor: row-resize;
    }
  }

  .shadeHorisontalSliderLeft,
  .shadeHorisontalSliderRight {
    position: absolute;
    height: 100%;
    width: 50%;
    top: 0;

    &.single {
      width: 100%;
    }

    .rc-slider-track {
      height: 100%;
      cursor: col-resize;
      transform: none;
    }
  }

  .shadeHorisontalSliderLeft {
    left: 0;
  }

  .shadeHorisontalSliderRight {
    right: 0;
  }

  .shadesHeader {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
  }

  .shadesMainContainer {
    position: 'relative';
    overflow: hidden;
    width: 100%;
    height: 100%;
    display: flex;
    flex-flow: ${({shadesOrientation:e})=>e==="vertical"?"row":"column"};
    border-style: solid;
  }

  .shadesBg {
    position: relative;
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;

    .frame {
      position: absolute;
      z-index: 1;
      left: 0;
      top: 0;
      background-color: rgba(0, 0, 0, 0.5);

      &.h {
        width: 100%;
        height: 5px;
        transform: translateY(-50%);
      }

      &.v {
        height: 100%;
        width: 5px;
        transform: translateX(-50%);
      }
    }

    img {
      position: absolute;
      width: 100%;
      height: 100%;
    }
  }

  .shadesSidebar {
    position: relative;
    display: flex;
    align-items: center;
    flex-flow: ${({shadesOrientation:e})=>e==="vertical"?"column":"row"};
    min-width: 2em;
    min-height: 2em;

    & > * {
      flex: 1;
      padding: 0 !important;
      font-size: inherit;
    }
  }
`;function Bf({horizontalFramesCount:e,verticalFramesCount:r,horizontalFrameHeight:i,verticalFrameWidth:o,framesBackgroundColor:l}){const f=[],s=[];if(e){const g=100/e;let p=0;for(;p<e;)f.push(D.jsx("div",{style:{top:`${g*p+g/2}%`,...i,backgroundColor:l},className:"frame h"},"h"+p)),p++}if(r){const g=100/r;let p=0;for(;p<r;)s.push(D.jsx("div",{style:{left:`${g*p+g/2}%`,...o,backgroundColor:l},className:"frame v"},"v"+p)),p++}return D.jsxs(D.Fragment,{children:[f,s]})}const Mo=e=>{const{cssClass:r,width:i,height:o,actions:l,state:f,imgId:s,useExternalUrl:g,externalUrl:p,fillType:d,fillAlignX:h,fillAlignY:L,shadesOrientation:_="vertical",headerLeftText:x,headerRightText:T,border:b,windowBackgroundColor:M,controlsBackgroundColor:R,headerLeftTextFontSize:k,headerRightTextFontSize:j,controlsFontSize:N,horizontalFramesCount:H,verticalFramesCount:G,verticalFrameSize:V,horizontalFrameSize:J,framesBackgroundColor:Z,shaderBackgroundColor:ee,shaderBackgroundBlur:ge,shaderBackgroundImage:pe,open_signal_d:Ee,close_signal_d:be,stop_signal_d:Me,closedValue_signal_a_fb:ce,elementRenderId:ve,showOpenPercentValue:fe,horisontalShadesMode:xe="both",boxShadow:we,boxReflect:ye,staticDevMoveableRef:q,constraintsVertical:oe,constraintsHorizontal:ae,isStaticElement:Re,left:Ce,top:ke,right:De,bottom:Ne,index:je,deltaCenterX:Fe,deltaCenterY:ze}=e,Ge=yt({sizeObj:J,sizePropName:"height"}),Ve=yt({sizeObj:V,sizePropName:"width"}),Xe=I.useRef(null),me=Et(k),te=Et(j),de=Et(N),Ae=Pt(f,je),O=Lt(Te=>Te.envState),U=wt({width:i,height:o,constraintsVertical:oe,constraintsHorizontal:ae,isStaticElement:Re,left:Ce,top:ke,right:De,bottom:Ne,fallbackHeight:"200px",fallbackWidth:"300px",deltaCenterX:Fe,deltaCenterY:ze}),A=$r(b),S=Vr(we),{onBeforeChangeActions:P,onAfterChangeActions:F,onChangeActions:z,isActiveOverlayTrigger:$}=lr({actions:l,elementRenderId:ve}),W=nt({[`element_${e.type}`]:!0,[`${r}`]:r,showBoundingBox:O==="editor",isActiveOverlayTrigger:!!$,...Ae});function X(Te){let qe;switch(Te){case"open":qe=Ee;break;case"stop":qe=Me;break;case"close":qe=be;break}if(P.length)for(const We of P)We(Te);if(z.length)for(const We of z)We(Te);if(Ur(qe),F.length)for(const We of F)We(Te)}const se=Hr(ce),ie=I.useRef(!1),re=I.useRef(),[le,he]=I.useState(O==="editor"?50:se),Se=I.useRef(le),[ue,Ie]=I.useState(null);function Pe(Te){if(clearTimeout(re.current),he(Te),z.length)for(const qe of z)qe(Te)}function He(Te){if(ie.current=!0,P.length)for(const qe of P)qe(Te)}function Ye(Te){function qe(){clearTimeout(re.current),re.current=setTimeout(()=>{Lt.getState().envState!=="editor"&&he(Se.current),ie.current=!1},3e3)}if(qe(),F.length)for(const We of F)We(Te)}I.useEffect(()=>{Se.current=se,O==="editor"?he(50):ie.current||he(se)},[O,se]),I.useEffect(()=>{pe&&ia(pe).then(Te=>{Ie(Te)}).catch(()=>{Ie("")})},[pe]);const Oe=Xt(ye);return D.jsxs(Yf,{shaderBackgroundBlur:ge,shaderBackgroundColor:ee,shadesFabricImageBg:ue||"",ref:Te=>{q&&(q.current=Te),Xe.current=Te},...e,shadesOrientation:_,style:{...U,...Oe},className:W,children:[D.jsxs("div",{className:"shadesHeader",children:[D.jsx("div",{style:{...me},children:x?D.jsx(Ct,{...e,text:x}):null}),D.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.3em",...te},children:[fe??!0?le:"",T?D.jsx(Ct,{...e,text:T}):null]})]}),D.jsxs("div",{className:"shadesMainContainer",style:{...A,...S},children:[D.jsxs("div",{className:"shadesBg",style:{backgroundColor:M||"rgba(0, 0, 0, 0.2)"},children:[D.jsx($u,{imgId:s,useExternalUrl:g,externalUrl:p,renderEnvtype:O,fillType:d,fillAlignX:h,fillAlignY:L}),Bf({horizontalFramesCount:H??2,verticalFramesCount:G??3,horizontalFrameHeight:Ge,verticalFrameWidth:Ve,framesBackgroundColor:Z}),_==="vertical"&&D.jsx(jr,{ref:null,value:le,onBeforeChange:Te=>{He(Te)},onChange:Te=>{Pe(Te)},onChangeComplete:Te=>{Ye(Te)},className:"shadeVerticalSlider",reverse:!0,vertical:!0,min:0,max:100,draggableTrack:!0}),_!=="vertical"&&xe==="left"&&D.jsx(jr,{ref:null,value:le,onBeforeChange:Te=>{He(Te)},onChange:Te=>{Pe(Te)},onChangeComplete:Te=>{Ye(Te)},className:"shadeHorisontalSliderLeft single",reverse:!1,vertical:!1,min:0,max:100,draggableTrack:!0}),_!=="vertical"&&xe==="right"&&D.jsx(jr,{ref:null,value:le,onBeforeChange:Te=>{He(Te)},onChange:Te=>{Pe(Te)},onChangeComplete:Te=>{Ye(Te)},className:"shadeHorisontalSliderRight single",reverse:!0,vertical:!1,min:0,max:100,draggableTrack:!0}),_!=="vertical"&&xe==="both"&&D.jsxs(D.Fragment,{children:[D.jsx(jr,{ref:null,value:le,onBeforeChange:Te=>{He(Te)},onChange:Te=>{Pe(Te)},onChangeComplete:Te=>{Ye(Te)},className:"shadeHorisontalSliderLeft",reverse:!1,vertical:!1,min:0,max:100,draggableTrack:!0}),D.jsx(jr,{ref:null,value:le,onBeforeChange:Te=>{He(Te)},onChange:Te=>{Pe(Te)},onChangeComplete:Te=>{Ye(Te)},className:"shadeHorisontalSliderRight",reverse:!0,vertical:!1,min:0,max:100,draggableTrack:!0})]})]}),D.jsxs("div",{style:{backgroundColor:R??"rgba(0, 0, 0, 0.5)",...de},className:"shadesSidebar",children:[D.jsx(xn,{onClick:()=>X("open"),className:"element_button el ghost",children:_==="horizontal"?D.jsx(dc,{}):D.jsx(Qu,{})}),D.jsx(xn,{onClick:()=>X("stop"),className:"element_button el ghost",children:D.jsx(fr,{icon:"RiStopFill"})}),D.jsx(xn,{onClick:()=>X("close"),className:"element_button el ghost",children:_==="horizontal"?D.jsx(gc,{rotate:90}):D.jsx(ec,{})})]})]})]})};Mo.displayName="ShadesWidget";const jf=ct(jt)`
  position: relative;

  &.isEditor {
    background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M54.627 0l.83.828-1.415 1.415L51.8 0h2.827zM5.373 0l-.83.828L5.96 2.243 8.2 0H5.374zM48.97 0l3.657 3.657-1.414 1.414L46.143 0h2.828zM11.03 0L7.372 3.657 8.787 5.07 13.857 0H11.03zm32.284 0L49.8 6.485 48.384 7.9l-7.9-7.9h2.83zM16.686 0L10.2 6.485 11.616 7.9l7.9-7.9h-2.83zm20.97 0l9.315 9.314-1.414 1.414L34.828 0h2.83zM22.344 0L13.03 9.314l1.414 1.414L25.172 0h-2.83zM32 0l12.142 12.142-1.414 1.414L30 .828 17.272 13.556l-1.414-1.414L28 0h4zM.284 0l28 28-1.414 1.414L0 2.544V0h.284zM0 5.373l25.456 25.455-1.414 1.415L0 8.2V5.374zm0 5.656l22.627 22.627-1.414 1.414L0 13.86v-2.83zm0 5.656l19.8 19.8-1.415 1.413L0 19.514v-2.83zm0 5.657l16.97 16.97-1.414 1.415L0 25.172v-2.83zM0 28l14.142 14.142-1.414 1.414L0 30.828V28zm0 5.657L11.314 44.97 9.9 46.386l-9.9-9.9v-2.828zm0 5.657L8.485 47.8 7.07 49.212 0 42.143v-2.83zm0 5.657l5.657 5.657-1.414 1.415L0 47.8v-2.83zm0 5.657l2.828 2.83-1.414 1.413L0 53.456v-2.83zM54.627 60L30 35.373 5.373 60H8.2L30 38.2 51.8 60h2.827zm-5.656 0L30 41.03 11.03 60h2.828L30 43.858 46.142 60h2.83zm-5.656 0L30 46.686 16.686 60h2.83L30 49.515 40.485 60h2.83zm-5.657 0L30 52.343 22.343 60h2.83L30 55.172 34.828 60h2.83zM32 60l-2-2-2 2h4zM59.716 0l-28 28 1.414 1.414L60 2.544V0h-.284zM60 5.373L34.544 30.828l1.414 1.415L60 8.2V5.374zm0 5.656L37.373 33.656l1.414 1.414L60 13.86v-2.83zm0 5.656l-19.8 19.8 1.415 1.413L60 19.514v-2.83zm0 5.657l-16.97 16.97 1.414 1.415L60 25.172v-2.83zM60 28L45.858 42.142l1.414 1.414L60 30.828V28zm0 5.657L48.686 44.97l1.415 1.415 9.9-9.9v-2.828zm0 5.657L51.515 47.8l1.414 1.413 7.07-7.07v-2.83zm0 5.657l-5.657 5.657 1.414 1.415L60 47.8v-2.83zm0 5.657l-2.828 2.83 1.414 1.413L60 53.456v-2.83zM39.9 16.385l1.414-1.414L30 3.658 18.686 14.97l1.415 1.415 9.9-9.9 9.9 9.9zm-2.83 2.828l1.415-1.414L30 9.313 21.515 17.8l1.414 1.413 7.07-7.07 7.07 7.07zm-2.827 2.83l1.414-1.416L30 14.97l-5.657 5.657 1.414 1.415L30 17.8l4.243 4.242zm-2.83 2.827l1.415-1.414L30 20.626l-2.828 2.83 1.414 1.414L30 23.456l1.414 1.414zM56.87 59.414L58.284 58 30 29.716 1.716 58l1.414 1.414L30 32.544l26.87 26.87z' fill='%239C92AC' fill-opacity='0.2' fill-rule='evenodd'/%3E%3C/svg%3E");
  }
`,Lo=e=>{const{cssClass:r,state:i,width:o,height:l,border:f,backgroundColor:s,htmlContent:g,elementRenderId:p,indexInList:d,actions:h,dataset:L,datasetPath:_,filter:x,parentData:T,boxShadow:b,boxReflect:M,staticDevMoveableRef:R,constraintsVertical:k,constraintsHorizontal:j,isStaticElement:N,left:H,top:G,right:V,bottom:J,index:Z,deltaCenterX:ee,deltaCenterY:ge}=e,pe=Pt(i,Z),Ee=Lt(ae=>ae.envState),be=$r(f),Me=wt({width:o,height:l,constraintsVertical:k,constraintsHorizontal:j,isStaticElement:N,left:H,top:G,right:V,bottom:J,deltaCenterX:ee,deltaCenterY:ge}),ce=Vr(b),ve=s?{backgroundColor:s}:{},fe=I.useRef(null),{tapActionsArr:xe,isActiveOverlayTrigger:we}=lr({indexInList:d,actions:h,dataset:L,datasetPath:_,filter:x,elementRef:fe,parentData:T,elementRenderId:p}),ye=nt({[`element_${e.type}`]:!0,[`${r}`]:r,isEditor:Ee==="editor",isActiveOverlayTrigger:!!we,...pe}),q=I.useRef(null);I.useEffect(()=>{var ae,Re;if(q.current)try{const Ce=q.current.contentDocument;if(Ce){Ce.open(),Ce.close(),Ce.write(g??""),(ae=q.current)!=null&&ae.contentWindow&&(q.current.contentWindow.avgatorStudio=window.avgatorStudio);const ke=Ce.querySelectorAll("script");for(const De of ke){const Ne=Ce.createElement("script");for(const je of De.attributes)Ne.setAttribute(je.name,je.value);De.innerHTML&&(Ne.innerHTML=De.innerHTML),(Re=Ce.body)==null||Re.appendChild(Ne)}}}catch(Ce){console.log(Ce)}},[g,p]);const oe=Xt(M);return D.jsx(jf,{...xe,...e,ref:ae=>{R&&(R.current=ae),fe.current=ae},style:{...Me,...be,...ve,...ce,...oe},className:ye,children:D.jsx("iframe",{ref:q,width:"100%",height:"100%",title:"htmlBlockElement"})})};Lo.displayName="HtmlBlockElement";const Hf=ct(jt)`
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
`;var ko={exports:{}};(function(e,r){(function(i,o){e.exports=o()})(Qe,function(){var i="minute",o=/[+-]\d\d(?::?\d\d)?/g,l=/([+-]|\d\d)/g;return function(f,s,g){var p=s.prototype;g.utc=function(b){var M={date:b,utc:!0,args:arguments};return new s(M)},p.utc=function(b){var M=g(this.toDate(),{locale:this.$L,utc:!0});return b?M.add(this.utcOffset(),i):M},p.local=function(){return g(this.toDate(),{locale:this.$L,utc:!1})};var d=p.parse;p.parse=function(b){b.utc&&(this.$u=!0),this.$utils().u(b.$offset)||(this.$offset=b.$offset),d.call(this,b)};var h=p.init;p.init=function(){if(this.$u){var b=this.$d;this.$y=b.getUTCFullYear(),this.$M=b.getUTCMonth(),this.$D=b.getUTCDate(),this.$W=b.getUTCDay(),this.$H=b.getUTCHours(),this.$m=b.getUTCMinutes(),this.$s=b.getUTCSeconds(),this.$ms=b.getUTCMilliseconds()}else h.call(this)};var L=p.utcOffset;p.utcOffset=function(b,M){var R=this.$utils().u;if(R(b))return this.$u?0:R(this.$offset)?L.call(this):this.$offset;if(typeof b=="string"&&(b=function(H){H===void 0&&(H="");var G=H.match(o);if(!G)return null;var V=(""+G[0]).match(l)||["-",0,0],J=V[0],Z=60*+V[1]+ +V[2];return Z===0?0:J==="+"?Z:-Z}(b),b===null))return this;var k=Math.abs(b)<=16?60*b:b,j=this;if(M)return j.$offset=k,j.$u=b===0,j;if(b!==0){var N=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(j=this.local().add(k+N,i)).$offset=k,j.$x.$localOffset=N}else j=this.utc();return j};var _=p.format;p.format=function(b){var M=b||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return _.call(this,M)},p.valueOf=function(){var b=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*b},p.isUTC=function(){return!!this.$u},p.toISOString=function(){return this.toDate().toISOString()},p.toString=function(){return this.toDate().toUTCString()};var x=p.toDate;p.toDate=function(b){return b==="s"&&this.$offset?g(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():x.call(this)};var T=p.diff;p.diff=function(b,M,R){if(b&&this.$u===b.$u)return T.call(this,b,M,R);var k=this.local(),j=g(b).local();return T.call(k,j,M,R)}}})})(ko);var Uf=ko.exports;const zf=Or(Uf);var Ao={exports:{}};(function(e,r){(function(i,o){e.exports=o()})(Qe,function(){var i={year:0,month:1,day:2,hour:3,minute:4,second:5},o={};return function(l,f,s){var g,p=function(_,x,T){T===void 0&&(T={});var b=new Date(_),M=function(R,k){k===void 0&&(k={});var j=k.timeZoneName||"short",N=R+"|"+j,H=o[N];return H||(H=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:R,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:j}),o[N]=H),H}(x,T);return M.formatToParts(b)},d=function(_,x){for(var T=p(_,x),b=[],M=0;M<T.length;M+=1){var R=T[M],k=R.type,j=R.value,N=i[k];N>=0&&(b[N]=parseInt(j,10))}var H=b[3],G=H===24?0:H,V=b[0]+"-"+b[1]+"-"+b[2]+" "+G+":"+b[4]+":"+b[5]+":000",J=+_;return(s.utc(V).valueOf()-(J-=J%1e3))/6e4},h=f.prototype;h.tz=function(_,x){_===void 0&&(_=g);var T,b=this.utcOffset(),M=this.toDate(),R=M.toLocaleString("en-US",{timeZone:_}),k=Math.round((M-new Date(R))/1e3/60),j=15*-Math.round(M.getTimezoneOffset()/15)-k;if(!Number(j))T=this.utcOffset(0,x);else if(T=s(R,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(j,!0),x){var N=T.utcOffset();T=T.add(b-N,"minute")}return T.$x.$timezone=_,T},h.offsetName=function(_){var x=this.$x.$timezone||s.tz.guess(),T=p(this.valueOf(),x,{timeZoneName:_}).find(function(b){return b.type.toLowerCase()==="timezonename"});return T&&T.value};var L=h.startOf;h.startOf=function(_,x){if(!this.$x||!this.$x.$timezone)return L.call(this,_,x);var T=s(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return L.call(T,_,x).tz(this.$x.$timezone,!0)},s.tz=function(_,x,T){var b=T&&x,M=T||x||g,R=d(+s(),M);if(typeof _!="string")return s(_).tz(M);var k=function(G,V,J){var Z=G-60*V*1e3,ee=d(Z,J);if(V===ee)return[Z,V];var ge=d(Z-=60*(ee-V)*1e3,J);return ee===ge?[Z,ee]:[G-60*Math.min(ee,ge)*1e3,Math.max(ee,ge)]}(s.utc(_,b).valueOf(),R,M),j=k[0],N=k[1],H=s(j).utcOffset(N);return H.$x.$timezone=M,H},s.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},s.tz.setDefault=function(_){g=_}}})})(Ao);var Gf=Ao.exports;const $f=Or(Gf);var Vf={exports:{}};(function(e,r){(function(i,o){e.exports=o()})(Qe,function(){return{name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(i){var o=["th","st","nd","rd"],l=i%100;return"["+i+(o[(l-20)%10]||o[l]||o[0])+"]"}}})})(Vf);var Wf={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"pt",weekdays:"domingo_segunda-feira_terça-feira_quarta-feira_quinta-feira_sexta-feira_sábado".split("_"),weekdaysShort:"dom_seg_ter_qua_qui_sex_sab".split("_"),weekdaysMin:"Do_2ª_3ª_4ª_5ª_6ª_Sa".split("_"),months:"janeiro_fevereiro_março_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),ordinal:function(s){return s+"º"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [às] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [às] HH:mm"},relativeTime:{future:"em %s",past:"há %s",s:"alguns segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"}};return l.default.locale(f,null,!0),f})})(Wf);var Kf={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"fr",weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(s){return""+s+(s===1?"er":"")}};return l.default.locale(f,null,!0),f})})(Kf);var Xf={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(p){return p&&typeof p=="object"&&"default"in p?p:{default:p}}var l=o(i),f={s:"ein paar Sekunden",m:["eine Minute","einer Minute"],mm:"%d Minuten",h:["eine Stunde","einer Stunde"],hh:"%d Stunden",d:["ein Tag","einem Tag"],dd:["%d Tage","%d Tagen"],M:["ein Monat","einem Monat"],MM:["%d Monate","%d Monaten"],y:["ein Jahr","einem Jahr"],yy:["%d Jahre","%d Jahren"]};function s(p,d,h){var L=f[h];return Array.isArray(L)&&(L=L[d?0:1]),L.replace("%d",p)}var g={name:"de",weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),months:"Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._März_Apr._Mai_Juni_Juli_Aug._Sept._Okt._Nov._Dez.".split("_"),ordinal:function(p){return p+"."},weekStart:1,yearStart:4,formats:{LTS:"HH:mm:ss",LT:"HH:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},relativeTime:{future:"in %s",past:"vor %s",s,m:s,mm:s,h:s,hh:s,d:s,dd:s,M:s,MM:s,y:s,yy:s}};return l.default.locale(g,null,!0),g})})(Xf);var qf={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"it",weekdays:"domenica_lunedì_martedì_mercoledì_giovedì_venerdì_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),weekStart:1,monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"tra %s",past:"%s fa",s:"qualche secondo",m:"un minuto",mm:"%d minuti",h:"un' ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},ordinal:function(s){return s+"º"}};return l.default.locale(f,null,!0),f})})(qf);var Jf={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(T){return T&&typeof T=="object"&&"default"in T?T:{default:T}}var l=o(i),f="января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_"),s="январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),g="янв._февр._мар._апр._мая_июня_июля_авг._сент._окт._нояб._дек.".split("_"),p="янв._февр._март_апр._май_июнь_июль_авг._сент._окт._нояб._дек.".split("_"),d=/D[oD]?(\[[^[\]]*\]|\s)+MMMM?/;function h(T,b,M){var R,k;return M==="m"?b?"минута":"минуту":T+" "+(R=+T,k={mm:b?"минута_минуты_минут":"минуту_минуты_минут",hh:"час_часа_часов",dd:"день_дня_дней",MM:"месяц_месяца_месяцев",yy:"год_года_лет"}[M].split("_"),R%10==1&&R%100!=11?k[0]:R%10>=2&&R%10<=4&&(R%100<10||R%100>=20)?k[1]:k[2])}var L=function(T,b){return d.test(b)?f[T.month()]:s[T.month()]};L.s=s,L.f=f;var _=function(T,b){return d.test(b)?g[T.month()]:p[T.month()]};_.s=p,_.f=g;var x={name:"ru",weekdays:"воскресенье_понедельник_вторник_среда_четверг_пятница_суббота".split("_"),weekdaysShort:"вск_пнд_втр_срд_чтв_птн_сбт".split("_"),weekdaysMin:"вс_пн_вт_ср_чт_пт_сб".split("_"),months:L,monthsShort:_,weekStart:1,yearStart:4,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY г.",LLL:"D MMMM YYYY г., H:mm",LLLL:"dddd, D MMMM YYYY г., H:mm"},relativeTime:{future:"через %s",past:"%s назад",s:"несколько секунд",m:h,mm:h,h:"час",hh:h,d:"день",dd:h,M:"месяц",MM:h,y:"год",yy:h},ordinal:function(T){return T},meridiem:function(T){return T<4?"ночи":T<12?"утра":T<17?"дня":"вечера"}};return l.default.locale(x,null,!0),x})})(Jf);var Zf={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"ja",weekdays:"日曜日_月曜日_火曜日_水曜日_木曜日_金曜日_土曜日".split("_"),weekdaysShort:"日_月_火_水_木_金_土".split("_"),weekdaysMin:"日_月_火_水_木_金_土".split("_"),months:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(s){return s+"日"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日 HH:mm",LLLL:"YYYY年M月D日 dddd HH:mm",l:"YYYY/MM/DD",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日(ddd) HH:mm"},meridiem:function(s){return s<12?"午前":"午後"},relativeTime:{future:"%s後",past:"%s前",s:"数秒",m:"1分",mm:"%d分",h:"1時間",hh:"%d時間",d:"1日",dd:"%d日",M:"1ヶ月",MM:"%dヶ月",y:"1年",yy:"%d年"}};return l.default.locale(f,null,!0),f})})(Zf);var Qf={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"zh",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(s,g){return g==="W"?s+"周":s+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s后",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(s,g){var p=100*s+g;return p<600?"凌晨":p<900?"早上":p<1100?"上午":p<1300?"中午":p<1800?"下午":"晚上"}};return l.default.locale(f,null,!0),f})})(Qf);var eh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(d){return d&&typeof d=="object"&&"default"in d?d:{default:d}}var l=o(i),f="يناير_فبراير_مارس_أبريل_مايو_يونيو_يوليو_أغسطس_سبتمبر_أكتوبر_نوفمبر_ديسمبر".split("_"),s={1:"١",2:"٢",3:"٣",4:"٤",5:"٥",6:"٦",7:"٧",8:"٨",9:"٩",0:"٠"},g={"١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9","٠":"0"},p={name:"ar",weekdays:"الأحد_الإثنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysShort:"أحد_إثنين_ثلاثاء_أربعاء_خميس_جمعة_سبت".split("_"),weekdaysMin:"ح_ن_ث_ر_خ_ج_س".split("_"),months:f,monthsShort:f,weekStart:6,meridiem:function(d){return d>12?"م":"ص"},relativeTime:{future:"بعد %s",past:"منذ %s",s:"ثانية واحدة",m:"دقيقة واحدة",mm:"%d دقائق",h:"ساعة واحدة",hh:"%d ساعات",d:"يوم واحد",dd:"%d أيام",M:"شهر واحد",MM:"%d أشهر",y:"عام واحد",yy:"%d أعوام"},preparse:function(d){return d.replace(/[١٢٣٤٥٦٧٨٩٠]/g,function(h){return g[h]}).replace(/،/g,",")},postformat:function(d){return d.replace(/\d/g,function(h){return s[h]}).replace(/,/g,"،")},ordinal:function(d){return d},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/‏M/‏YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"}};return l.default.locale(p,null,!0),p})})(eh);var th={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"ko",weekdays:"일요일_월요일_화요일_수요일_목요일_금요일_토요일".split("_"),weekdaysShort:"일_월_화_수_목_금_토".split("_"),weekdaysMin:"일_월_화_수_목_금_토".split("_"),months:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),monthsShort:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),ordinal:function(s){return s+"일"},formats:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY년 MMMM D일",LLL:"YYYY년 MMMM D일 A h:mm",LLLL:"YYYY년 MMMM D일 dddd A h:mm",l:"YYYY.MM.DD.",ll:"YYYY년 MMMM D일",lll:"YYYY년 MMMM D일 A h:mm",llll:"YYYY년 MMMM D일 dddd A h:mm"},meridiem:function(s){return s<12?"오전":"오후"},relativeTime:{future:"%s 후",past:"%s 전",s:"몇 초",m:"1분",mm:"%d분",h:"한 시간",hh:"%d시간",d:"하루",dd:"%d일",M:"한 달",MM:"%d달",y:"일 년",yy:"%d년"}};return l.default.locale(f,null,!0),f})})(th);var rh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"tr",weekdays:"Pazar_Pazartesi_Salı_Çarşamba_Perşembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_Çar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_Ça_Pe_Cu_Ct".split("_"),months:"Ocak_Şubat_Mart_Nisan_Mayıs_Haziran_Temmuz_Ağustos_Eylül_Ekim_Kasım_Aralık".split("_"),monthsShort:"Oca_Şub_Mar_Nis_May_Haz_Tem_Ağu_Eyl_Eki_Kas_Ara".split("_"),weekStart:1,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},relativeTime:{future:"%s sonra",past:"%s önce",s:"birkaç saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gün",dd:"%d gün",M:"bir ay",MM:"%d ay",y:"bir yıl",yy:"%d yıl"},ordinal:function(s){return s+"."}};return l.default.locale(f,null,!0),f})})(rh);var nh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"nl",weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),ordinal:function(s){return"["+s+(s===1||s===8||s>=20?"ste":"de")+"]"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"een minuut",mm:"%d minuten",h:"een uur",hh:"%d uur",d:"een dag",dd:"%d dagen",M:"een maand",MM:"%d maanden",y:"een jaar",yy:"%d jaar"}};return l.default.locale(f,null,!0),f})})(nh);var ih={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(_){return _&&typeof _=="object"&&"default"in _?_:{default:_}}var l=o(i);function f(_){return _%10<5&&_%10>1&&~~(_/10)%10!=1}function s(_,x,T){var b=_+" ";switch(T){case"m":return x?"minuta":"minutę";case"mm":return b+(f(_)?"minuty":"minut");case"h":return x?"godzina":"godzinę";case"hh":return b+(f(_)?"godziny":"godzin");case"MM":return b+(f(_)?"miesiące":"miesięcy");case"yy":return b+(f(_)?"lata":"lat")}}var g="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_września_października_listopada_grudnia".split("_"),p="styczeń_luty_marzec_kwiecień_maj_czerwiec_lipiec_sierpień_wrzesień_październik_listopad_grudzień".split("_"),d=/D MMMM/,h=function(_,x){return d.test(x)?g[_.month()]:p[_.month()]};h.s=p,h.f=g;var L={name:"pl",weekdays:"niedziela_poniedziałek_wtorek_środa_czwartek_piątek_sobota".split("_"),weekdaysShort:"ndz_pon_wt_śr_czw_pt_sob".split("_"),weekdaysMin:"Nd_Pn_Wt_Śr_Cz_Pt_So".split("_"),months:h,monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_paź_lis_gru".split("_"),ordinal:function(_){return _+"."},weekStart:1,yearStart:4,relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",m:s,mm:s,h:s,hh:s,d:"1 dzień",dd:"%d dni",M:"miesiąc",MM:s,y:"rok",yy:s},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"}};return l.default.locale(L,null,!0),L})})(ih);var ah={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"vi",weekdays:"chủ nhật_thứ hai_thứ ba_thứ tư_thứ năm_thứ sáu_thứ bảy".split("_"),months:"tháng 1_tháng 2_tháng 3_tháng 4_tháng 5_tháng 6_tháng 7_tháng 8_tháng 9_tháng 10_tháng 11_tháng 12".split("_"),weekStart:1,weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),ordinal:function(s){return s},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [năm] YYYY",LLL:"D MMMM [năm] YYYY HH:mm",LLLL:"dddd, D MMMM [năm] YYYY HH:mm",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},relativeTime:{future:"%s tới",past:"%s trước",s:"vài giây",m:"một phút",mm:"%d phút",h:"một giờ",hh:"%d giờ",d:"một ngày",dd:"%d ngày",M:"một tháng",MM:"%d tháng",y:"một năm",yy:"%d năm"}};return l.default.locale(f,null,!0),f})})(ah);var sh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"sv",weekdays:"söndag_måndag_tisdag_onsdag_torsdag_fredag_lördag".split("_"),weekdaysShort:"sön_mån_tis_ons_tor_fre_lör".split("_"),weekdaysMin:"sö_må_ti_on_to_fr_lö".split("_"),months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekStart:1,yearStart:4,ordinal:function(s){var g=s%10;return"["+s+(g===1||g===2?"a":"e")+"]"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [kl.] HH:mm",LLLL:"dddd D MMMM YYYY [kl.] HH:mm",lll:"D MMM YYYY HH:mm",llll:"ddd D MMM YYYY HH:mm"},relativeTime:{future:"om %s",past:"för %s sedan",s:"några sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en månad",MM:"%d månader",y:"ett år",yy:"%d år"}};return l.default.locale(f,null,!0),f})})(sh);var oh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"id",weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Agt_Sep_Okt_Nov_Des".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),weekStart:1,formats:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},ordinal:function(s){return s+"."}};return l.default.locale(f,null,!0),f})})(oh);var lh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"th",weekdays:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัสบดี_ศุกร์_เสาร์".split("_"),weekdaysShort:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัส_ศุกร์_เสาร์".split("_"),weekdaysMin:"อา._จ._อ._พ._พฤ._ศ._ส.".split("_"),months:"มกราคม_กุมภาพันธ์_มีนาคม_เมษายน_พฤษภาคม_มิถุนายน_กรกฎาคม_สิงหาคม_กันยายน_ตุลาคม_พฤศจิกายน_ธันวาคม".split("_"),monthsShort:"ม.ค._ก.พ._มี.ค._เม.ย._พ.ค._มิ.ย._ก.ค._ส.ค._ก.ย._ต.ค._พ.ย._ธ.ค.".split("_"),formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY เวลา H:mm",LLLL:"วันddddที่ D MMMM YYYY เวลา H:mm"},relativeTime:{future:"อีก %s",past:"%sที่แล้ว",s:"ไม่กี่วินาที",m:"1 นาที",mm:"%d นาที",h:"1 ชั่วโมง",hh:"%d ชั่วโมง",d:"1 วัน",dd:"%d วัน",M:"1 เดือน",MM:"%d เดือน",y:"1 ปี",yy:"%d ปี"},ordinal:function(s){return s+"."}};return l.default.locale(f,null,!0),f})})(lh);var uh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(g){return g&&typeof g=="object"&&"default"in g?g:{default:g}}var l=o(i);function f(g,p,d,h){var L={s:"muutama sekunti",m:"minuutti",mm:"%d minuuttia",h:"tunti",hh:"%d tuntia",d:"päivä",dd:"%d päivää",M:"kuukausi",MM:"%d kuukautta",y:"vuosi",yy:"%d vuotta",numbers:"nolla_yksi_kaksi_kolme_neljä_viisi_kuusi_seitsemän_kahdeksan_yhdeksän".split("_")},_={s:"muutaman sekunnin",m:"minuutin",mm:"%d minuutin",h:"tunnin",hh:"%d tunnin",d:"päivän",dd:"%d päivän",M:"kuukauden",MM:"%d kuukauden",y:"vuoden",yy:"%d vuoden",numbers:"nollan_yhden_kahden_kolmen_neljän_viiden_kuuden_seitsemän_kahdeksan_yhdeksän".split("_")},x=h&&!p?_:L,T=x[d];return g<10?T.replace("%d",x.numbers[g]):T.replace("%d",g)}var s={name:"fi",weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_kesäkuu_heinäkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kesä_heinä_elo_syys_loka_marras_joulu".split("_"),ordinal:function(g){return g+"."},weekStart:1,yearStart:4,relativeTime:{future:"%s päästä",past:"%s sitten",s:f,m:f,mm:f,h:f,hh:f,d:f,dd:f,M:f,MM:f,y:f,yy:f},formats:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM[ta] YYYY",LLL:"D. MMMM[ta] YYYY, [klo] HH.mm",LLLL:"dddd, D. MMMM[ta] YYYY, [klo] HH.mm",l:"D.M.YYYY",ll:"D. MMM YYYY",lll:"D. MMM YYYY, [klo] HH.mm",llll:"ddd, D. MMM YYYY, [klo] HH.mm"}};return l.default.locale(s,null,!0),s})})(uh);var ch={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"da",weekdays:"søndag_mandag_tirsdag_onsdag_torsdag_fredag_lørdag".split("_"),weekdaysShort:"søn._man._tirs._ons._tors._fre._lør.".split("_"),weekdaysMin:"sø._ma._ti._on._to._fr._lø.".split("_"),months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj_juni_juli_aug._sept._okt._nov._dec.".split("_"),weekStart:1,yearStart:4,ordinal:function(s){return s+"."},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd [d.] D. MMMM YYYY [kl.] HH:mm"},relativeTime:{future:"om %s",past:"%s siden",s:"få sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en måned",MM:"%d måneder",y:"et år",yy:"%d år"}};return l.default.locale(f,null,!0),f})})(ch);var dh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(p){return p&&typeof p=="object"&&"default"in p?p:{default:p}}var l=o(i),f={s:"מספר שניות",ss:"%d שניות",m:"דקה",mm:"%d דקות",h:"שעה",hh:"%d שעות",hh2:"שעתיים",d:"יום",dd:"%d ימים",dd2:"יומיים",M:"חודש",MM:"%d חודשים",MM2:"חודשיים",y:"שנה",yy:"%d שנים",yy2:"שנתיים"};function s(p,d,h){return(f[h+(p===2?"2":"")]||f[h]).replace("%d",p)}var g={name:"he",weekdays:"ראשון_שני_שלישי_רביעי_חמישי_שישי_שבת".split("_"),weekdaysShort:"א׳_ב׳_ג׳_ד׳_ה׳_ו׳_ש׳".split("_"),weekdaysMin:"א׳_ב׳_ג׳_ד׳_ה׳_ו_ש׳".split("_"),months:"ינואר_פברואר_מרץ_אפריל_מאי_יוני_יולי_אוגוסט_ספטמבר_אוקטובר_נובמבר_דצמבר".split("_"),monthsShort:"ינו_פבר_מרץ_אפר_מאי_יונ_יול_אוג_ספט_אוק_נוב_דצמ".split("_"),relativeTime:{future:"בעוד %s",past:"לפני %s",s,m:s,mm:s,h:s,hh:s,d:s,dd:s,M:s,MM:s,y:s,yy:s},ordinal:function(p){return p},format:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [ב]MMMM YYYY",LLL:"D [ב]MMMM YYYY HH:mm",LLLL:"dddd, D [ב]MMMM YYYY HH:mm",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [ב]MMMM YYYY",LLL:"D [ב]MMMM YYYY HH:mm",LLLL:"dddd, D [ב]MMMM YYYY HH:mm",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"}};return l.default.locale(g,null,!0),g})})(dh);var fh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"el",weekdays:"Κυριακή_Δευτέρα_Τρίτη_Τετάρτη_Πέμπτη_Παρασκευή_Σάββατο".split("_"),weekdaysShort:"Κυρ_Δευ_Τρι_Τετ_Πεμ_Παρ_Σαβ".split("_"),weekdaysMin:"Κυ_Δε_Τρ_Τε_Πε_Πα_Σα".split("_"),months:"Ιανουάριος_Φεβρουάριος_Μάρτιος_Απρίλιος_Μάιος_Ιούνιος_Ιούλιος_Αύγουστος_Σεπτέμβριος_Οκτώβριος_Νοέμβριος_Δεκέμβριος".split("_"),monthsShort:"Ιαν_Φεβ_Μαρ_Απρ_Μαι_Ιουν_Ιουλ_Αυγ_Σεπτ_Οκτ_Νοε_Δεκ".split("_"),ordinal:function(s){return s},weekStart:1,relativeTime:{future:"σε %s",past:"πριν %s",s:"μερικά δευτερόλεπτα",m:"ένα λεπτό",mm:"%d λεπτά",h:"μία ώρα",hh:"%d ώρες",d:"μία μέρα",dd:"%d μέρες",M:"ένα μήνα",MM:"%d μήνες",y:"ένα χρόνο",yy:"%d χρόνια"},formats:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"}};return l.default.locale(f,null,!0),f})})(fh);var hh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(p){return p&&typeof p=="object"&&"default"in p?p:{default:p}}var l=o(i);function f(p){return p>1&&p<5&&~~(p/10)!=1}function s(p,d,h,L){var _=p+" ";switch(h){case"s":return d||L?"pár sekund":"pár sekundami";case"m":return d?"minuta":L?"minutu":"minutou";case"mm":return d||L?_+(f(p)?"minuty":"minut"):_+"minutami";case"h":return d?"hodina":L?"hodinu":"hodinou";case"hh":return d||L?_+(f(p)?"hodiny":"hodin"):_+"hodinami";case"d":return d||L?"den":"dnem";case"dd":return d||L?_+(f(p)?"dny":"dní"):_+"dny";case"M":return d||L?"měsíc":"měsícem";case"MM":return d||L?_+(f(p)?"měsíce":"měsíců"):_+"měsíci";case"y":return d||L?"rok":"rokem";case"yy":return d||L?_+(f(p)?"roky":"let"):_+"lety"}}var g={name:"cs",weekdays:"neděle_pondělí_úterý_středa_čtvrtek_pátek_sobota".split("_"),weekdaysShort:"ne_po_út_st_čt_pá_so".split("_"),weekdaysMin:"ne_po_út_st_čt_pá_so".split("_"),months:"leden_únor_březen_duben_květen_červen_červenec_srpen_září_říjen_listopad_prosinec".split("_"),monthsShort:"led_úno_bře_dub_kvě_čvn_čvc_srp_zář_říj_lis_pro".split("_"),weekStart:1,yearStart:4,ordinal:function(p){return p+"."},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},relativeTime:{future:"za %s",past:"před %s",s,m:s,mm:s,h:s,hh:s,d:s,dd:s,M:s,MM:s,y:s,yy:s}};return l.default.locale(g,null,!0),g})})(hh);var gh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"ro",weekdays:"Duminică_Luni_Marți_Miercuri_Joi_Vineri_Sâmbătă".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sâm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_Sâ".split("_"),months:"Ianuarie_Februarie_Martie_Aprilie_Mai_Iunie_Iulie_August_Septembrie_Octombrie_Noiembrie_Decembrie".split("_"),monthsShort:"Ian._Febr._Mart._Apr._Mai_Iun._Iul._Aug._Sept._Oct._Nov._Dec.".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},relativeTime:{future:"peste %s",past:"acum %s",s:"câteva secunde",m:"un minut",mm:"%d minute",h:"o oră",hh:"%d ore",d:"o zi",dd:"%d zile",M:"o lună",MM:"%d luni",y:"un an",yy:"%d ani"},ordinal:function(s){return s}};return l.default.locale(f,null,!0),f})})(gh);var mh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"hu",weekdays:"vasárnap_hétfő_kedd_szerda_csütörtök_péntek_szombat".split("_"),weekdaysShort:"vas_hét_kedd_sze_csüt_pén_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),months:"január_február_március_április_május_június_július_augusztus_szeptember_október_november_december".split("_"),monthsShort:"jan_feb_márc_ápr_máj_jún_júl_aug_szept_okt_nov_dec".split("_"),ordinal:function(s){return s+"."},weekStart:1,relativeTime:{future:"%s múlva",past:"%s",s:function(s,g,p,d){return"néhány másodperc"+(d||g?"":"e")},m:function(s,g,p,d){return"egy perc"+(d||g?"":"e")},mm:function(s,g,p,d){return s+" perc"+(d||g?"":"e")},h:function(s,g,p,d){return"egy "+(d||g?"óra":"órája")},hh:function(s,g,p,d){return s+" "+(d||g?"óra":"órája")},d:function(s,g,p,d){return"egy "+(d||g?"nap":"napja")},dd:function(s,g,p,d){return s+" "+(d||g?"nap":"napja")},M:function(s,g,p,d){return"egy "+(d||g?"hónap":"hónapja")},MM:function(s,g,p,d){return s+" "+(d||g?"hónap":"hónapja")},y:function(s,g,p,d){return"egy "+(d||g?"év":"éve")},yy:function(s,g,p,d){return s+" "+(d||g?"év":"éve")}},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D. H:mm",LLLL:"YYYY. MMMM D., dddd H:mm"}};return l.default.locale(f,null,!0),f})})(mh);var ph={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(p){return p&&typeof p=="object"&&"default"in p?p:{default:p}}var l=o(i);function f(p){return p>1&&p<5&&~~(p/10)!=1}function s(p,d,h,L){var _=p+" ";switch(h){case"s":return d||L?"pár sekúnd":"pár sekundami";case"m":return d?"minúta":L?"minútu":"minútou";case"mm":return d||L?_+(f(p)?"minúty":"minút"):_+"minútami";case"h":return d?"hodina":L?"hodinu":"hodinou";case"hh":return d||L?_+(f(p)?"hodiny":"hodín"):_+"hodinami";case"d":return d||L?"deň":"dňom";case"dd":return d||L?_+(f(p)?"dni":"dní"):_+"dňami";case"M":return d||L?"mesiac":"mesiacom";case"MM":return d||L?_+(f(p)?"mesiace":"mesiacov"):_+"mesiacmi";case"y":return d||L?"rok":"rokom";case"yy":return d||L?_+(f(p)?"roky":"rokov"):_+"rokmi"}}var g={name:"sk",weekdays:"nedeľa_pondelok_utorok_streda_štvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_št_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_št_pi_so".split("_"),months:"január_február_marec_apríl_máj_jún_júl_august_september_október_november_december".split("_"),monthsShort:"jan_feb_mar_apr_máj_jún_júl_aug_sep_okt_nov_dec".split("_"),weekStart:1,yearStart:4,ordinal:function(p){return p+"."},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},relativeTime:{future:"za %s",past:"pred %s",s,m:s,mm:s,h:s,hh:s,d:s,dd:s,M:s,MM:s,y:s,yy:s}};return l.default.locale(g,null,!0),g})})(ph);var vh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(L){return L&&typeof L=="object"&&"default"in L?L:{default:L}}var l=o(i),f="січня_лютого_березня_квітня_травня_червня_липня_серпня_вересня_жовтня_листопада_грудня".split("_"),s="січень_лютий_березень_квітень_травень_червень_липень_серпень_вересень_жовтень_листопад_грудень".split("_"),g=/D[oD]?(\[[^[\]]*\]|\s)+MMMM?/;function p(L,_,x){var T,b;return x==="m"?_?"хвилина":"хвилину":x==="h"?_?"година":"годину":L+" "+(T=+L,b={ss:_?"секунда_секунди_секунд":"секунду_секунди_секунд",mm:_?"хвилина_хвилини_хвилин":"хвилину_хвилини_хвилин",hh:_?"година_години_годин":"годину_години_годин",dd:"день_дні_днів",MM:"місяць_місяці_місяців",yy:"рік_роки_років"}[x].split("_"),T%10==1&&T%100!=11?b[0]:T%10>=2&&T%10<=4&&(T%100<10||T%100>=20)?b[1]:b[2])}var d=function(L,_){return g.test(_)?f[L.month()]:s[L.month()]};d.s=s,d.f=f;var h={name:"uk",weekdays:"неділя_понеділок_вівторок_середа_четвер_п’ятниця_субота".split("_"),weekdaysShort:"ндл_пнд_втр_срд_чтв_птн_сбт".split("_"),weekdaysMin:"нд_пн_вт_ср_чт_пт_сб".split("_"),months:d,monthsShort:"січ_лют_бер_квіт_трав_черв_лип_серп_вер_жовт_лист_груд".split("_"),weekStart:1,relativeTime:{future:"за %s",past:"%s тому",s:"декілька секунд",m:p,mm:p,h:p,hh:p,d:"день",dd:p,M:"місяць",MM:p,y:"рік",yy:p},ordinal:function(L){return L},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY р.",LLL:"D MMMM YYYY р., HH:mm",LLLL:"dddd, D MMMM YYYY р., HH:mm"}};return l.default.locale(h,null,!0),h})})(vh);var _h={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"bg",weekdays:"неделя_понеделник_вторник_сряда_четвъртък_петък_събота".split("_"),weekdaysShort:"нед_пон_вто_сря_чет_пет_съб".split("_"),weekdaysMin:"нд_пн_вт_ср_чт_пт_сб".split("_"),months:"януари_февруари_март_април_май_юни_юли_август_септември_октомври_ноември_декември".split("_"),monthsShort:"яну_фев_мар_апр_май_юни_юли_авг_сеп_окт_ное_дек".split("_"),weekStart:1,ordinal:function(s){var g=s%100;if(g>10&&g<20)return s+"-ти";var p=s%10;return p===1?s+"-ви":p===2?s+"-ри":p===7||p===8?s+"-ми":s+"-ти"},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},relativeTime:{future:"след %s",past:"преди %s",s:"няколко секунди",m:"минута",mm:"%d минути",h:"час",hh:"%d часа",d:"ден",dd:"%d дена",M:"месец",MM:"%d месеца",y:"година",yy:"%d години"}};return l.default.locale(f,null,!0),f})})(_h);var yh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"hi",weekdays:"रविवार_सोमवार_मंगलवार_बुधवार_गुरूवार_शुक्रवार_शनिवार".split("_"),months:"जनवरी_फ़रवरी_मार्च_अप्रैल_मई_जून_जुलाई_अगस्त_सितम्बर_अक्टूबर_नवम्बर_दिसम्बर".split("_"),weekdaysShort:"रवि_सोम_मंगल_बुध_गुरू_शुक्र_शनि".split("_"),monthsShort:"जन._फ़र._मार्च_अप्रै._मई_जून_जुल._अग._सित._अक्टू._नव._दिस.".split("_"),weekdaysMin:"र_सो_मं_बु_गु_शु_श".split("_"),ordinal:function(s){return s},formats:{LT:"A h:mm बजे",LTS:"A h:mm:ss बजे",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm बजे",LLLL:"dddd, D MMMM YYYY, A h:mm बजे"},relativeTime:{future:"%s में",past:"%s पहले",s:"कुछ ही क्षण",m:"एक मिनट",mm:"%d मिनट",h:"एक घंटा",hh:"%d घंटे",d:"एक दिन",dd:"%d दिन",M:"एक महीने",MM:"%d महीने",y:"एक वर्ष",yy:"%d वर्ष"}};return l.default.locale(f,null,!0),f})})(yh);var bh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(p){return p&&typeof p=="object"&&"default"in p?p:{default:p}}var l=o(i),f={1:"১",2:"২",3:"৩",4:"৪",5:"৫",6:"৬",7:"৭",8:"৮",9:"৯",0:"০"},s={"১":"1","২":"2","৩":"3","৪":"4","৫":"5","৬":"6","৭":"7","৮":"8","৯":"9","০":"0"},g={name:"bn",weekdays:"রবিবার_সোমবার_মঙ্গলবার_বুধবার_বৃহস্পতিবার_শুক্রবার_শনিবার".split("_"),months:"জানুয়ারি_ফেব্রুয়ারি_মার্চ_এপ্রিল_মে_জুন_জুলাই_আগস্ট_সেপ্টেম্বর_অক্টোবর_নভেম্বর_ডিসেম্বর".split("_"),weekdaysShort:"রবি_সোম_মঙ্গল_বুধ_বৃহস্পতি_শুক্র_শনি".split("_"),monthsShort:"জানু_ফেব্রু_মার্চ_এপ্রিল_মে_জুন_জুলাই_আগস্ট_সেপ্ট_অক্টো_নভে_ডিসে".split("_"),weekdaysMin:"রবি_সোম_মঙ্গ_বুধ_বৃহঃ_শুক্র_শনি".split("_"),preparse:function(p){return p.replace(/[১২৩৪৫৬৭৮৯০]/g,function(d){return s[d]})},postformat:function(p){return p.replace(/\d/g,function(d){return f[d]})},ordinal:function(p){return p},formats:{LT:"A h:mm সময়",LTS:"A h:mm:ss সময়",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm সময়",LLLL:"dddd, D MMMM YYYY, A h:mm সময়"},relativeTime:{future:"%s পরে",past:"%s আগে",s:"কয়েক সেকেন্ড",m:"এক মিনিট",mm:"%d মিনিট",h:"এক ঘন্টা",hh:"%d ঘন্টা",d:"এক দিন",dd:"%d দিন",M:"এক মাস",MM:"%d মাস",y:"এক বছর",yy:"%d বছর"}};return l.default.locale(g,null,!0),g})})(bh);var Sh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"ta",weekdays:"ஞாயிற்றுக்கிழமை_திங்கட்கிழமை_செவ்வாய்கிழமை_புதன்கிழமை_வியாழக்கிழமை_வெள்ளிக்கிழமை_சனிக்கிழமை".split("_"),months:"ஜனவரி_பிப்ரவரி_மார்ச்_ஏப்ரல்_மே_ஜூன்_ஜூலை_ஆகஸ்ட்_செப்டெம்பர்_அக்டோபர்_நவம்பர்_டிசம்பர்".split("_"),weekdaysShort:"ஞாயிறு_திங்கள்_செவ்வாய்_புதன்_வியாழன்_வெள்ளி_சனி".split("_"),monthsShort:"ஜனவரி_பிப்ரவரி_மார்ச்_ஏப்ரல்_மே_ஜூன்_ஜூலை_ஆகஸ்ட்_செப்டெம்பர்_அக்டோபர்_நவம்பர்_டிசம்பர்".split("_"),weekdaysMin:"ஞா_தி_செ_பு_வி_வெ_ச".split("_"),ordinal:function(s){return s},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, HH:mm",LLLL:"dddd, D MMMM YYYY, HH:mm"},relativeTime:{future:"%s இல்",past:"%s முன்",s:"ஒரு சில விநாடிகள்",m:"ஒரு நிமிடம்",mm:"%d நிமிடங்கள்",h:"ஒரு மணி நேரம்",hh:"%d மணி நேரம்",d:"ஒரு நாள்",dd:"%d நாட்கள்",M:"ஒரு மாதம்",MM:"%d மாதங்கள்",y:"ஒரு வருடம்",yy:"%d ஆண்டுகள்"}};return l.default.locale(f,null,!0),f})})(Sh);var Eh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"te",weekdays:"ఆదివారం_సోమవారం_మంగళవారం_బుధవారం_గురువారం_శుక్రవారం_శనివారం".split("_"),months:"జనవరి_ఫిబ్రవరి_మార్చి_ఏప్రిల్_మే_జూన్_జులై_ఆగస్టు_సెప్టెంబర్_అక్టోబర్_నవంబర్_డిసెంబర్".split("_"),weekdaysShort:"ఆది_సోమ_మంగళ_బుధ_గురు_శుక్ర_శని".split("_"),monthsShort:"జన._ఫిబ్ర._మార్చి_ఏప్రి._మే_జూన్_జులై_ఆగ._సెప్._అక్టో._నవ._డిసె.".split("_"),weekdaysMin:"ఆ_సో_మం_బు_గు_శు_శ".split("_"),ordinal:function(s){return s},formats:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},relativeTime:{future:"%s లో",past:"%s క్రితం",s:"కొన్ని క్షణాలు",m:"ఒక నిమిషం",mm:"%d నిమిషాలు",h:"ఒక గంట",hh:"%d గంటలు",d:"ఒక రోజు",dd:"%d రోజులు",M:"ఒక నెల",MM:"%d నెలలు",y:"ఒక సంవత్సరం",yy:"%d సంవత్సరాలు"}};return l.default.locale(f,null,!0),f})})(Eh);var xh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"mr",weekdays:"रविवार_सोमवार_मंगळवार_बुधवार_गुरूवार_शुक्रवार_शनिवार".split("_"),months:"जानेवारी_फेब्रुवारी_मार्च_एप्रिल_मे_जून_जुलै_ऑगस्ट_सप्टेंबर_ऑक्टोबर_नोव्हेंबर_डिसेंबर".split("_"),weekdaysShort:"रवि_सोम_मंगळ_बुध_गुरू_शुक्र_शनि".split("_"),monthsShort:"जाने._फेब्रु._मार्च._एप्रि._मे._जून._जुलै._ऑग._सप्टें._ऑक्टो._नोव्हें._डिसें.".split("_"),weekdaysMin:"र_सो_मं_बु_गु_शु_श".split("_"),ordinal:function(s){return s},formats:{LT:"A h:mm वाजता",LTS:"A h:mm:ss वाजता",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm वाजता",LLLL:"dddd, D MMMM YYYY, A h:mm वाजता"}};return l.default.locale(f,null,!0),f})})(xh);var Th={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"ur",weekdays:"اتوار_پیر_منگل_بدھ_جمعرات_جمعہ_ہفتہ".split("_"),months:"جنوری_فروری_مارچ_اپریل_مئی_جون_جولائی_اگست_ستمبر_اکتوبر_نومبر_دسمبر".split("_"),weekStart:1,weekdaysShort:"اتوار_پیر_منگل_بدھ_جمعرات_جمعہ_ہفتہ".split("_"),monthsShort:"جنوری_فروری_مارچ_اپریل_مئی_جون_جولائی_اگست_ستمبر_اکتوبر_نومبر_دسمبر".split("_"),weekdaysMin:"اتوار_پیر_منگل_بدھ_جمعرات_جمعہ_ہفتہ".split("_"),ordinal:function(s){return s},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd، D MMMM YYYY HH:mm"},relativeTime:{future:"%s بعد",past:"%s قبل",s:"چند سیکنڈ",m:"ایک منٹ",mm:"%d منٹ",h:"ایک گھنٹہ",hh:"%d گھنٹے",d:"ایک دن",dd:"%d دن",M:"ایک ماہ",MM:"%d ماہ",y:"ایک سال",yy:"%d سال"}};return l.default.locale(f,null,!0),f})})(Th);var wh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"fa",weekdays:"یک‌شنبه_دوشنبه_سه‌شنبه_چهارشنبه_پنج‌شنبه_جمعه_شنبه".split("_"),weekdaysShort:"یک‌شنبه_دوشنبه_سه‌شنبه_چهارشنبه_پنج‌شنبه_جمعه_شنبه".split("_"),weekdaysMin:"ی_د_س_چ_پ_ج_ش".split("_"),weekStart:6,months:"ژانویه_فوریه_مارس_آوریل_مه_ژوئن_ژوئیه_اوت_سپتامبر_اکتبر_نوامبر_دسامبر".split("_"),monthsShort:"ژانویه_فوریه_مارس_آوریل_مه_ژوئن_ژوئیه_اوت_سپتامبر_اکتبر_نوامبر_دسامبر".split("_"),ordinal:function(s){return s},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},relativeTime:{future:"در %s",past:"%s پیش",s:"چند ثانیه",m:"یک دقیقه",mm:"%d دقیقه",h:"یک ساعت",hh:"%d ساعت",d:"یک روز",dd:"%d روز",M:"یک ماه",MM:"%d ماه",y:"یک سال",yy:"%d سال"}};return l.default.locale(f,null,!0),f})})(wh);var Mh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"ms",weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekStart:1,formats:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH.mm",LLLL:"dddd, D MMMM YYYY HH.mm"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},ordinal:function(s){return s+"."}};return l.default.locale(f,null,!0),f})})(Mh);var Lh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"gu",weekdays:"રવિવાર_સોમવાર_મંગળવાર_બુધ્વાર_ગુરુવાર_શુક્રવાર_શનિવાર".split("_"),months:"જાન્યુઆરી_ફેબ્રુઆરી_માર્ચ_એપ્રિલ_મે_જૂન_જુલાઈ_ઑગસ્ટ_સપ્ટેમ્બર_ઑક્ટ્બર_નવેમ્બર_ડિસેમ્બર".split("_"),weekdaysShort:"રવિ_સોમ_મંગળ_બુધ્_ગુરુ_શુક્ર_શનિ".split("_"),monthsShort:"જાન્યુ._ફેબ્રુ._માર્ચ_એપ્રિ._મે_જૂન_જુલા._ઑગ._સપ્ટે._ઑક્ટ્._નવે._ડિસે.".split("_"),weekdaysMin:"ર_સો_મં_બુ_ગુ_શુ_શ".split("_"),ordinal:function(s){return s},formats:{LT:"A h:mm વાગ્યે",LTS:"A h:mm:ss વાગ્યે",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm વાગ્યે",LLLL:"dddd, D MMMM YYYY, A h:mm વાગ્યે"},relativeTime:{future:"%s મા",past:"%s પેહલા",s:"અમુક પળો",m:"એક મિનિટ",mm:"%d મિનિટ",h:"એક કલાક",hh:"%d કલાક",d:"એક દિવસ",dd:"%d દિવસ",M:"એક મહિનો",MM:"%d મહિનો",y:"એક વર્ષ",yy:"%d વર્ષ"}};return l.default.locale(f,null,!0),f})})(Lh);var kh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"kn",weekdays:"ಭಾನುವಾರ_ಸೋಮವಾರ_ಮಂಗಳವಾರ_ಬುಧವಾರ_ಗುರುವಾರ_ಶುಕ್ರವಾರ_ಶನಿವಾರ".split("_"),months:"ಜನವರಿ_ಫೆಬ್ರವರಿ_ಮಾರ್ಚ್_ಏಪ್ರಿಲ್_ಮೇ_ಜೂನ್_ಜುಲೈ_ಆಗಸ್ಟ್_ಸೆಪ್ಟೆಂಬರ್_ಅಕ್ಟೋಬರ್_ನವೆಂಬರ್_ಡಿಸೆಂಬರ್".split("_"),weekdaysShort:"ಭಾನು_ಸೋಮ_ಮಂಗಳ_ಬುಧ_ಗುರು_ಶುಕ್ರ_ಶನಿ".split("_"),monthsShort:"ಜನ_ಫೆಬ್ರ_ಮಾರ್ಚ್_ಏಪ್ರಿಲ್_ಮೇ_ಜೂನ್_ಜುಲೈ_ಆಗಸ್ಟ್_ಸೆಪ್ಟೆಂ_ಅಕ್ಟೋ_ನವೆಂ_ಡಿಸೆಂ".split("_"),weekdaysMin:"ಭಾ_ಸೋ_ಮಂ_ಬು_ಗು_ಶು_ಶ".split("_"),ordinal:function(s){return s},formats:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},relativeTime:{future:"%s ನಂತರ",past:"%s ಹಿಂದೆ",s:"ಕೆಲವು ಕ್ಷಣಗಳು",m:"ಒಂದು ನಿಮಿಷ",mm:"%d ನಿಮಿಷ",h:"ಒಂದು ಗಂಟೆ",hh:"%d ಗಂಟೆ",d:"ಒಂದು ದಿನ",dd:"%d ದಿನ",M:"ಒಂದು ತಿಂಗಳು",MM:"%d ತಿಂಗಳು",y:"ಒಂದು ವರ್ಷ",yy:"%d ವರ್ಷ"}};return l.default.locale(f,null,!0),f})})(kh);var Ah={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"ml",weekdays:"ഞായറാഴ്ച_തിങ്കളാഴ്ച_ചൊവ്വാഴ്ച_ബുധനാഴ്ച_വ്യാഴാഴ്ച_വെള്ളിയാഴ്ച_ശനിയാഴ്ച".split("_"),months:"ജനുവരി_ഫെബ്രുവരി_മാർച്ച്_ഏപ്രിൽ_മേയ്_ജൂൺ_ജൂലൈ_ഓഗസ്റ്റ്_സെപ്റ്റംബർ_ഒക്ടോബർ_നവംബർ_ഡിസംബർ".split("_"),weekdaysShort:"ഞായർ_തിങ്കൾ_ചൊവ്വ_ബുധൻ_വ്യാഴം_വെള്ളി_ശനി".split("_"),monthsShort:"ജനു._ഫെബ്രു._മാർ._ഏപ്രി._മേയ്_ജൂൺ_ജൂലൈ._ഓഗ._സെപ്റ്റ._ഒക്ടോ._നവം._ഡിസം.".split("_"),weekdaysMin:"ഞാ_തി_ചൊ_ബു_വ്യാ_വെ_ശ".split("_"),ordinal:function(s){return s},formats:{LT:"A h:mm -നു",LTS:"A h:mm:ss -നു",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm -നു",LLLL:"dddd, D MMMM YYYY, A h:mm -നു"},relativeTime:{future:"%s കഴിഞ്ഞ്",past:"%s മുൻപ്",s:"അൽപ നിമിഷങ്ങൾ",m:"ഒരു മിനിറ്റ്",mm:"%d മിനിറ്റ്",h:"ഒരു മണിക്കൂർ",hh:"%d മണിക്കൂർ",d:"ഒരു ദിവസം",dd:"%d ദിവസം",M:"ഒരു മാസം",MM:"%d മാസം",y:"ഒരു വർഷം",yy:"%d വർഷം"}};return l.default.locale(f,null,!0),f})})(Ah);var Rh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"si",weekdays:"ඉරිදා_සඳුදා_අඟහරුවාදා_බදාදා_බ්‍රහස්පතින්දා_සිකුරාදා_සෙනසුරාදා".split("_"),months:"දුරුතු_නවම්_මැදින්_බක්_වෙසක්_පොසොන්_ඇසළ_නිකිණි_බිනර_වප්_ඉල්_උඳුවප්".split("_"),weekdaysShort:"ඉරි_සඳු_අඟ_බදා_බ්‍රහ_සිකු_සෙන".split("_"),monthsShort:"දුරු_නව_මැදි_බක්_වෙස_පොසො_ඇස_නිකි_බින_වප්_ඉල්_උඳු".split("_"),weekdaysMin:"ඉ_ස_අ_බ_බ්‍ර_සි_සෙ".split("_"),ordinal:function(s){return s},formats:{LT:"a h:mm",LTS:"a h:mm:ss",L:"YYYY/MM/DD",LL:"YYYY MMMM D",LLL:"YYYY MMMM D, a h:mm",LLLL:"YYYY MMMM D [වැනි] dddd, a h:mm:ss"},relativeTime:{future:"%sකින්",past:"%sකට පෙර",s:"තත්පර කිහිපය",m:"විනාඩිය",mm:"විනාඩි %d",h:"පැය",hh:"පැය %d",d:"දිනය",dd:"දින %d",M:"මාසය",MM:"මාස %d",y:"වසර",yy:"වසර %d"}};return l.default.locale(f,null,!0),f})})(Rh);var Ch={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"ne",weekdays:"आइतबार_सोमबार_मङ्गलबार_बुधबार_बिहिबार_शुक्रबार_शनिबार".split("_"),weekdaysShort:"आइत._सोम._मङ्गल._बुध._बिहि._शुक्र._शनि.".split("_"),weekdaysMin:"आ._सो._मं._बु._बि._शु._श.".split("_"),months:"जनवरी_फेब्रुवरी_मार्च_अप्रिल_मे_जुन_जुलाई_अगष्ट_सेप्टेम्बर_अक्टोबर_नोभेम्बर_डिसेम्बर".split("_"),monthsShort:"जन._फेब्रु._मार्च_अप्रि._मई_जुन_जुलाई._अग._सेप्ट._अक्टो._नोभे._डिसे.".split("_"),relativeTime:{future:"%s पछि",past:"%s अघि",s:"सेकेन्ड",m:"एक मिनेट",mm:"%d मिनेट",h:"घन्टा",hh:"%d घन्टा",d:"एक दिन",dd:"%d दिन",M:"एक महिना",MM:"%d महिना",y:"एक वर्ष",yy:"%d वर्ष"},ordinal:function(s){return(""+s).replace(/\d/g,function(g){return"०१२३४५६७८९"[g]})},formats:{LT:"Aको h:mm बजे",LTS:"Aको h:mm:ss बजे",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, Aको h:mm बजे",LLLL:"dddd, D MMMM YYYY, Aको h:mm बजे"}};return l.default.locale(f,null,!0),f})})(Ch);var Dh={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"am",weekdays:"እሑድ_ሰኞ_ማክሰኞ_ረቡዕ_ሐሙስ_አርብ_ቅዳሜ".split("_"),weekdaysShort:"እሑድ_ሰኞ_ማክሰ_ረቡዕ_ሐሙስ_አርብ_ቅዳሜ".split("_"),weekdaysMin:"እሑ_ሰኞ_ማክ_ረቡ_ሐሙ_አር_ቅዳ".split("_"),months:"ጃንዋሪ_ፌብሯሪ_ማርች_ኤፕሪል_ሜይ_ጁን_ጁላይ_ኦገስት_ሴፕቴምበር_ኦክቶበር_ኖቬምበር_ዲሴምበር".split("_"),monthsShort:"ጃንዋ_ፌብሯ_ማርች_ኤፕሪ_ሜይ_ጁን_ጁላይ_ኦገስ_ሴፕቴ_ኦክቶ_ኖቬም_ዲሴም".split("_"),weekStart:1,yearStart:4,relativeTime:{future:"በ%s",past:"%s በፊት",s:"ጥቂት ሰከንዶች",m:"አንድ ደቂቃ",mm:"%d ደቂቃዎች",h:"አንድ ሰዓት",hh:"%d ሰዓታት",d:"አንድ ቀን",dd:"%d ቀናት",M:"አንድ ወር",MM:"%d ወራት",y:"አንድ ዓመት",yy:"%d ዓመታት"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"MMMM D ፣ YYYY",LLL:"MMMM D ፣ YYYY HH:mm",LLLL:"dddd ፣ MMMM D ፣ YYYY HH:mm"},ordinal:function(s){return s+"ኛ"}};return l.default.locale(f,null,!0),f})})(Dh);var Ih={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"sw",weekdays:"Jumapili_Jumatatu_Jumanne_Jumatano_Alhamisi_Ijumaa_Jumamosi".split("_"),weekdaysShort:"Jpl_Jtat_Jnne_Jtan_Alh_Ijm_Jmos".split("_"),weekdaysMin:"J2_J3_J4_J5_Al_Ij_J1".split("_"),months:"Januari_Februari_Machi_Aprili_Mei_Juni_Julai_Agosti_Septemba_Oktoba_Novemba_Desemba".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ago_Sep_Okt_Nov_Des".split("_"),weekStart:1,ordinal:function(s){return s},relativeTime:{future:"%s baadaye",past:"tokea %s",s:"hivi punde",m:"dakika moja",mm:"dakika %d",h:"saa limoja",hh:"masaa %d",d:"siku moja",dd:"masiku %d",M:"mwezi mmoja",MM:"miezi %d",y:"mwaka mmoja",yy:"miaka %d"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"}};return l.default.locale(f,null,!0),f})})(Ih);var Ph={exports:{}};(function(e,r){(function(i,o){e.exports=o(tt)})(Qe,function(i){function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var l=o(i),f={name:"yo",weekdays:"Àìkú_Ajé_Ìsẹ́gun_Ọjọ́rú_Ọjọ́bọ_Ẹtì_Àbámẹ́ta".split("_"),months:"Sẹ́rẹ́_Èrèlè_Ẹrẹ̀nà_Ìgbé_Èbibi_Òkùdu_Agẹmo_Ògún_Owewe_Ọ̀wàrà_Bélú_Ọ̀pẹ̀̀".split("_"),weekStart:1,weekdaysShort:"Àìk_Ajé_Ìsẹ́_Ọjr_Ọjb_Ẹtì_Àbá".split("_"),monthsShort:"Sẹ́r_Èrl_Ẹrn_Ìgb_Èbi_Òkù_Agẹ_Ògú_Owe_Ọ̀wà_Bél_Ọ̀pẹ̀̀".split("_"),weekdaysMin:"Àì_Aj_Ìs_Ọr_Ọb_Ẹt_Àb".split("_"),ordinal:function(s){return s},formats:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},relativeTime:{future:"ní %s",past:"%s kọjá",s:"ìsẹjú aayá die",m:"ìsẹjú kan",mm:"ìsẹjú %d",h:"wákati kan",hh:"wákati %d",d:"ọjọ́ kan",dd:"ọjọ́ %d",M:"osù kan",MM:"osù %d",y:"ọdún kan",yy:"ọdún %d"}};return l.default.locale(f,null,!0),f})})(Ph);En.extend(zf);En.extend($f);const Mn=({timeZone:e})=>{if(e)try{return En().tz(e)}catch{return En()}else return En()},Oh=({format:e,style:r,timeZone:i})=>{const[o,l]=I.useState(Mn({timeZone:i}));return I.useEffect(()=>{const f=setInterval(()=>{l(Mn({timeZone:i}))},1e3);return()=>{clearInterval(f)}},[i]),D.jsxs("div",{style:{...r},children:[" ",o.format(e)]})},Fh=({format:e,style:r,locale:i,timeZone:o})=>{const[l,f]=I.useState(Mn({timeZone:o}));return I.useEffect(()=>{f(Mn({timeZone:o}));const s=setInterval(()=>{f(Mn({timeZone:o}))},6e4);return()=>{clearInterval(s)}},[o]),D.jsx("div",{style:{...r},children:l.locale(i).format(e)})},Ro=e=>{const{cssClass:r,state:i,textFontSize:o,textColor:l,useAmPm:f,showSeconds:s,gap:g,showTime:p=!0,dateColor:d,dateFontSize:h,showDate:L,datePosition:_,locale:x="en",timeZone:T,fontFamily:b="Monaco,Lucida,Courier",boxReflect:M,staticDevMoveableRef:R,width:k,height:j,constraintsVertical:N,constraintsHorizontal:H,isStaticElement:G,left:V,top:J,right:Z,bottom:ee,index:ge,deltaCenterX:pe,deltaCenterY:Ee}=e,be=Pt(i,ge),Me=pt(Fe=>Fe.showBoundingBox),ce=nt({[`element_${e.type}`]:!0,[`${r}`]:r,showBoundingBox:Me,...be}),ve=Et(o),fe=Et(h),xe=l?{color:l}:{},we=d?{color:d}:{};let ye={hours:"HH",minutes:":mm",seconds:"",ampm:""};s&&(ye={...ye,seconds:":ss"}),f&&(ye={...ye,ampm:" A",hours:"hh"});const{hours:q,minutes:oe,seconds:ae,ampm:Re}=ye,Ce=q+oe+ae+Re,ke=yt({sizeObj:g,sizePropName:"gap"});let De="row";switch(_){case"before":De="row-reverse";break;case"top":De="column-reverse";break;case"bottom":De="column";break;default:De="row";break}const Ne=Xt(M),je=wt({width:k,height:j,constraintsVertical:N,constraintsHorizontal:H,isStaticElement:G,left:V,top:J,right:Z,bottom:ee,deltaCenterX:pe,deltaCenterY:Ee});return D.jsxs(Hf,{...e,ref:Fe=>{R&&(R.current=Fe)},style:{gap:"1em",...ke,flexFlow:De,...Ne,...je},className:ce,children:[p&&D.jsx(Oh,{timeZone:T,style:{...xe,...ve,fontFamily:b},format:Ce}),L?D.jsx(Fh,{timeZone:T,locale:x,style:{...we,...fe,fontFamily:b},format:"MMMM, DD"}):null]})};Ro.displayName="DateTimeWidget";function hs(e){try{const r=JSON.stringify(e);return window.getHash(JSON.stringify(r))}catch{return Yu(e)}}async function gs({varName:e,calculatedVariables:r,elementProps:i,states:o,parentArrayIndex:l,parentData:f}){var d;async function s(h){try{return JSON.parse(h),h}catch{const _=h.replace(/{|}/g,"");return await Bs(i==null?void 0:i.dataset,i==null?void 0:i.datasetPath,i==null?void 0:i.filter,_,null,i==null?void 0:i.attachedModificators,i==null?void 0:i.parentData,i==null?void 0:i.parentArrayIndex)}}async function g(h){return await Ln(h,l,f)}async function p(h){if(!h||h===void 0)return;let L=h.substring(1,h.length-1),_=L.replace(/#/g,"").split(","),x=[],T=[];for(const R of _){const[k,j]=R.split("=");k==="variableName"?x.push(j):k==="parameterName"&&T.push(j)}const b=x.map(async R=>{let k=r==null?void 0:r.find(j=>j.name===R);if(k){const{currentValue:j,defaultValue:N}=k;if(k.datasetID){let H=await Yi(k.datasetID.dataset,k.dynamicValue);L=L.replace(`<varString variableName="${R}"`,H)}else{let H=j===void 0?N:j;L=L.replace(`variableName=${R}`,H.toString())}}});await Promise.all(b);const M=T.map(async R=>{let k=await Ln("%"+R+"%",i.parentArrayIndex,i.parentData);k!=null&&(L=L.replace(`parameterName=${R}`,k.toString()))});if(await Promise.all(M),(L==null?void 0:L.length)>2&&L.startsWith("#")&&L.endsWith("#"))return L.substring(1,L.length-1).replace(/,/g,"");{let R=o==null?void 0:o.find(k=>k.name===L.replace(/,/g,""));return R==null?void 0:R.value}}if(e.startsWith("$")&&e.endsWith("$")){const h=e.replaceAll("$","");let L=r==null?void 0:r.find(_=>_.name===h);if(L){const{currentValue:_,defaultValue:x}=L;return L.datasetID?await Yi(L.datasetID.dataset,L.dynamicValue):_===void 0?x:_}}else return!((d=i==null?void 0:i.type)!=null&&d.includes("List"))&&e.startsWith("{")&&e.endsWith("}")?s(e):(e==null?void 0:e.length)>2&&e.startsWith("%")&&e.endsWith("%")?g(e):(e==null?void 0:e.length)>2&&e.startsWith("#")&&e.endsWith("#")?p(e):e}function Co({propsToFill:e,parentArrayIndex:r,parentId:i,parentData:o}){const l=zr(d=>d.calculatedVariables),f=si(d=>d.entries),[s,g]=I.useState(),p=I.useRef("");return I.useEffect(()=>{Array.isArray(e)?(async()=>{const h=await Promise.all(e.map(async _=>await Cr(_,T=>gs({elementProps:_,varName:T,calculatedVariables:l,states:f,parentArrayIndex:r,parentData:o})))),L=hs(h);L!==p.current&&(p.current=L,g(h))})():typeof e=="object"&&(async()=>{const h=await Cr(e,_=>gs({elementProps:e,varName:_,calculatedVariables:l,states:f,parentArrayIndex:r,parentData:o})),L=hs(h);L!==p.current&&(p.current=L,g(h))})()},[l,r,o,e,f]),s}function ua({background:e}){const r=Co({propsToFill:e}),[i,o]=I.useState(null),l=I.useCallback(f=>{o(s=>ra.isEqual(s,f)?s:f)},[]);return I.useEffect(()=>{if(r){const{useExternalUrl:f,externalUrl:s,imgId:g,customBackgroundImage:p,color:d,customBackgroundImageblur:h,customBackgroundImageOpacity:L,backgroundPosition:_="center",fillType:x="cover",backgroundSizeX:T,backgroundSizeY:b}=r;let M={},R=d??"";p?ia({imgId:g,useExternalUrl:f,externalUrl:s}).then(k=>{M={...M,backgroundImage:`url(${k})`}}).catch(()=>{}).finally(()=>{if(h!==void 0&&(M={...M,filter:`blur(${h}px)`}),L!==void 0&&(M={...M,opacity:L/100}),x==="fill")M={...M,backgroundSize:"auto"};else if(x==="custom"){const{value:k,unit:j="%"}=T??{},{value:N,unit:H="%"}=b??{},G=k===void 0?"auto":k+j,V=N===void 0?"auto":N+H;M={...M,backgroundSize:`${G} ${V}`}}else M={...M,backgroundSize:x};M={...M,backgroundPosition:_},p&&!(M!=null&&M.backgroundImage)&&(M={...M,backgroundImage:"none"}),l({backgroundColor:R,backgroundImageStyles:M})}):l({backgroundColor:R,backgroundImageStyles:{}})}else l({backgroundColor:"",backgroundImageStyles:{}})},[r,l]),i}const Nh=({parentId:e,pageId:r,envState:i})=>{if(!r)return!1;let o=!1;return i==="editor"?e?e===r?o=!0:o=!1:o=!0:o=!1,o},Yh=e=>{const{index:r,actions:i,modes:o,dataset:l,datasetPath:f,isDynamic:s,dynamic:g,filter:p,returningField:d,attachedModificators:h,left:L,top:_,right:x,bottom:T,constraintsHorizontal:b,constraintsVertical:M,isStaticElement:R,width:k,height:j,...N}=e;return{actions:i,propsInheritedByMode:N,noModeProps:{modes:o,dataset:l,datasetPath:f,isDynamic:s,dynamic:g,filter:p,returningField:d,attachedModificators:h,index:r,left:L,top:_,right:x,bottom:T,width:k,height:j,constraintsHorizontal:b,constraintsVertical:M,isStaticElement:R}}};function Bh(e,r){var l,f,s,g;r=String(r);const o=(((s=(f=(l=$t.getState().workingProject)==null?void 0:l.attributes)==null?void 0:f.modificators)==null?void 0:s.data)||[]).find(p=>p.attributes.uid===r);if(o&&o!==void 0&&((g=o==null?void 0:o.attributes)==null?void 0:g.function)!==void 0)try{const d=js(o.attributes.function)(e);if(typeof d=="number")return d}catch(p){console.log(p)}return e}function jh({propsToFill:e}){var i,o;const r=$t(l=>{var f,s,g;return(g=(s=(f=l.workingProject)==null?void 0:f.attributes)==null?void 0:s.modificators)==null?void 0:g.data})||[];if(e!=null&&"attachedFunctions"in e&&e.attachedFunctions!==void 0&&((i=e.attachedFunctions)==null?void 0:i.length)>0){const l={};for(const f of e.attachedFunctions)if(f.modificatorId&&f.modificatorId!==void 0&&f.name&&f.name!==void 0){const s=r.find(g=>g.attributes.uid===String(f.modificatorId));if(s&&s!==void 0&&((o=s==null?void 0:s.attributes)==null?void 0:o.function)!==void 0)try{const g=js(s.attributes.function);l[f.name]=g(e[f.name])}catch(g){console.log(g)}}return{...e,...l}}return e}const er=({property:e,element:r,distance:i,newValue:o})=>{if(o===void 0&&i===void 0)throw new Error("handleUpdateCssValue - no value or distance provided");if(o!==void 0){const l=typeof o=="number"?`${o}px`:o;r.style.setProperty(e,l)}else if(i!==void 0){const l=Number.parseFloat(r.style.getPropertyValue(e))||0;r.style.setProperty(e,`${l+i}px`)}},ms=({element:e,constraintsVertical:r="top",constraintsHorizontal:i="left",axis:o,distance:l,newSize:f,xEdge:s,yEdge:g})=>{o==="horizontal"?er(i==="both"?{element:e,property:s===1?"right":"left",distance:-l}:{element:e,property:"width",newValue:f}):o==="vertical"&&er(r==="both"?{element:e,property:g===1?"bottom":"top",distance:-l}:{element:e,property:"height",newValue:f})},ps=({element:e,constraintsVertical:r="top",constraintsHorizontal:i="left",axis:o,distance:l})=>{if(o==="horizontal")switch(i){case"center":er({element:e,property:"--elementDeltaCenterX",distance:l});break;case"left":er({element:e,property:"left",distance:l});break;case"right":er({element:e,property:"right",distance:-l});break;case"both":er({element:e,property:"left",distance:l}),er({element:e,property:"right",distance:-l});break}else if(o==="vertical")switch(r){case"center":er({element:e,property:"--elementDeltaCenterY",distance:l});break;case"top":er({element:e,property:"top",distance:l});break;case"bottom":er({element:e,property:"bottom",distance:-l});break;case"both":er({element:e,property:"top",distance:l}),er({element:e,property:"bottom",distance:-l});break}},vs=async({pageId:e,type:r,targetHtmlElement:i,moveableActionType:o})=>{const{left:l,top:f,right:s,bottom:g,width:p,height:d,deltaCenterX:h,deltaCenterY:L}=rc({targetHtmlElement:i}),{elementIndex:_,containerIndex:x,isGlobalContainer:T}=pt.getState().selectedMenuSection;if(_==null||x===void 0||x===null)return new Error("failed update element static position:elementIndex or containerIndex is null");let b={left:l+"px",right:s+"px",bottom:g+"px",top:f+"px",deltaCenterX:`${h}px`,deltaCenterY:`${L}px`,[r==="subpageList"?"listWidth":"width"]:{width:{value:p,unit:"px"}},[r==="subpageList"?"listHeight":"height"]:{height:{value:d,unit:"px"}}};if(o==="move"){const{width:M,height:R,...k}=b;b=k}return Us({action:"update",containerIndex:x,elementIndex:_,dataToUpdate:b,pageId:e,isGlobal:!!T,ignoreModeIndex:!0}).catch(M=>{console.error(M),Rs.error("Failed update element dimensions")})},Hh=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Uh=(e,r,i)=>{const l={ArrowUp:{deltaX:0,deltaY:-i},ArrowDown:{deltaX:0,deltaY:i},ArrowLeft:{deltaX:-i,deltaY:0},ArrowRight:{deltaX:i,deltaY:0}}[r];l&&e.request("draggable",l,!0)},zh=({moveableInstance:e})=>{I.useEffect(()=>{const r=i=>{const{key:o,metaKey:l,ctrlKey:f}=i;if(!Hh.includes(o)||!e.current)return;i.stopPropagation(),i.preventDefault();const s=l||f?10:1;Uh(e.current,o,s)};return window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)}},[e])};var Gh={visible:"universalElementWrapper_moveable_visible__1s96mf00",hidden:"universalElementWrapper_moveable_hidden__1s96mf01"},$h="universalElementWrapper_selectInformerBox__1s96mf02",Vh="universalElementWrapper_selectedElementType__1s96mf03",Wh="universalElementWrapper_activeElementMode__1s96mf04";const Kh=({type:e})=>{const r=$t(i=>{var o;return(o=i.workingProject)==null?void 0:o.attributes.theme.data.attributes.devColors.element})??"black";return D.jsx("div",{className:Vh,style:{backgroundColor:r},children:e})},Xh={name:"SelectInformerAble",props:["isModeExist","activeModeIndex","type"],events:[],render(e,r){const{isModeExist:i,activeModeIndex:o,type:l}=e.props;return D.jsxs("div",{className:`moveable-select-informer ${$h}`,children:[D.jsx(Kh,{type:l}),i&&D.jsx("div",{className:Wh,children:o})]},"select-informer")}},qh=et.memo(({children:e,isStaticPage:r,parentContainerElementsCount:i})=>{var De,Ne,je,Fe,ze,Ge,Ve,Xe;const o=I.useRef(null),{pageId:l}=An(),f=Lt(me=>me.envState),[s,g]=I.useState(!1),p=pt(me=>me.selectedMenuSection),d=pt(me=>me.showBoundingBox),{containerIndex:h,isGlobal:L,index:_,type:x}=e.props,T=I.useMemo(()=>{const{containerIndex:me,elementIndex:te,isGlobalContainer:de}=p;return me===h&&te===_&&!!de==!!L},[h,_,L,p]);let b=`container-${h}-element-${_}`;L&&(b=`globalContainer-${h}-element-${_}`);let M=Co({propsToFill:e.props});const R=!!(M!=null&&M.modes)&&M.modes.length>0;let k=(M==null?void 0:M.activeModeIndex)??0;if(((De=M==null?void 0:M.attachedFunctions)==null?void 0:De.find(me=>me.name==="activeModeIndex"))!==void 0){const me=(je=(Ne=M==null?void 0:M.attachedFunctions)==null?void 0:Ne.find(te=>te.name==="activeModeIndex"))==null?void 0:je.modificatorId;me!==void 0&&(k=Bh(k,String(me)))}if(T&&f==="editor"&&(k=p.modeIndex===void 0?0:p.modeIndex+1),k){let me;Vu(String(k))?me=(Fe=M==null?void 0:M.modes)==null?void 0:Fe[Number(k)-1]:me=(ze=M==null?void 0:M.modes)==null?void 0:ze.find(de=>de.name===k);const te=me==null?void 0:me.modeProps;if(me&&te){const de=me.isModeHasOwnActions,{noModeProps:Ae,actions:O}=Yh(M),{actions:U,...A}=te;M={...Ae,...A,actions:de?U:O}}else k=0}M=jh({propsToFill:M});const j=(Ge=e.props)==null?void 0:Ge.parentId,{constraintsVertical:N="top",constraintsHorizontal:H="left"}=e.props??{},G=(Ve=e.props)==null?void 0:Ve.isStaticElement,V=Nh({parentId:j,pageId:l,envState:f}),J=I.useCallback(()=>{var de;const me=["text","button"],te=(de=e.props)==null?void 0:de.type;if(me.includes(te)){const Ae=pt.getState().setMainMenuData;Ae({manualTextEditorOpen:!0})}},[(Xe=e.props)==null?void 0:Xe.type]),Z=I.useMemo(()=>{if(!M)return null;function me(A,S){var F;const{setPageContextMenu:P}=pt.getState();d&&(A.preventDefault(),A.stopPropagation(),P({event:A,containerIndex:h,isGlobal:L,elementIndex:S,subpageId:(F=e==null?void 0:e.props)==null?void 0:F.subpageId}))}function te(A){g(!0);const S={sourceContainerIndex:h,sourceElementIndex:_,sourceContainerType:L?"global":"normal"};A.dataTransfer.setData("draggedElement",JSON.stringify(S))}function de(){g(!1)}function Ae(A){A.stopPropagation(),A.preventDefault();const{setMainMenuData:S}=pt.getState();T&&ge(P=>!P),S({selectedMenuSection:{key:b,containerIndex:h,elementIndex:_,pageActionIndex:null,isGlobalContainer:!!L,isStaticContainer:!!G,selectedElementRef:o}})}let O={};if(V&&(O={onClick:A=>Ae(A),onDoubleClick:()=>J(),onContextMenu:A=>{me(A,_)},staticDevMoveableRef:o,"data-statickey":b,"data-containerindex":h,"data-elementindex":_,"data-iseditednow":T,"data-envstate":f,"data-activemodeindex":R?k:null,"data-isdragging":s},r||(O={...O,onDragStart:A=>te(A),onDragEnd:()=>de(),draggable:T})),R&&(f==="preview"||f==="live")){const A=pt.getState().setDevHoverData;O={...O,onPointerOver:()=>{A({activeModeIndex:k})},onPointerLeave:()=>{A(null)}}}return et.createElement(e.type,{...O,...M})},[M,V,R,f,e,d,h,L,_,b,G,T,k,s,r,J]),[ee,ge]=I.useState(!1),[pe,Ee]=I.useState(!1);I.useEffect(()=>{if(!T){ge(!1);return}const me=te=>{te.key==="Escape"&&ge(de=>de&&!1)};return document.addEventListener("keydown",me),()=>{document.removeEventListener("keydown",me)}},[T]);const be=me=>{if(!G)return;const{target:te,delta:[de,Ae]}=me;de!==0&&ps({element:te,constraintsVertical:N,constraintsHorizontal:H,distance:de,axis:"horizontal"}),Ae!==0&&ps({element:te,constraintsVertical:N,constraintsHorizontal:H,distance:Ae,axis:"vertical"})},Me=me=>{const{isDrag:te,target:de}=me;te&&vs({targetHtmlElement:de,pageId:l,type:x,moveableActionType:"move"})},ce=me=>{const te=me.inputEvent.shiftKey;Ee(de=>te!==de?te:de)},ve=me=>{const{width:te,height:de,delta:[Ae,O],direction:[U,A],target:S}=me;Ae!==0&&ms({element:S,constraintsVertical:N,constraintsHorizontal:H,axis:"horizontal",distance:Ae,newSize:te,xEdge:U,yEdge:A}),O!==0&&ms({element:S,constraintsVertical:N,constraintsHorizontal:H,axis:"vertical",distance:O,newSize:de,xEdge:U,yEdge:A})},fe=me=>{Ee(de=>de&&!1);const{target:te}=me;vs({targetHtmlElement:te,pageId:l,type:x,moveableActionType:"resize"})},xe=et.useRef(null),[we,ye]=I.useState(!0),q=Lt(me=>me.guiFrameWidth),oe=Lt(me=>me.guiFrameHeight),ae=Lt(me=>me.isEditorViewerAllowMouseDrag);I.useEffect(()=>{ye(!ae)},[ae]),I.useEffect(()=>{let me;return clearTimeout(me),ye(te=>te&&!1),me=setTimeout(()=>{ye(!0)},500),()=>{clearTimeout(me)}},[q,oe]),zh({moveableInstance:xe});const Re=I.useCallback(()=>{const me=[];for(let te=0;te<i;te++){if(te===_)continue;const de=`.container-0-element-${te}`;me.push(de)}return me},[i,_]);I.useEffect(()=>{var me;if(T){const te=(me=xe.current)==null?void 0:me.refTargets[0];if(!te){console.log("No selected element div");return}if(!(te instanceof Node)){console.log("Selected element is not a div");return}const Ae=te.parentElement;if(!Ae){console.log("No parent element");return}if(!(Ae instanceof Node)){console.log("ParentElement is not a div");return}const U=S=>{var F;console.log(`Transition ended on ${S.target}`),(F=xe.current)==null||F.updateRect()};te.addEventListener("transitionend",U);for(const S of Ae.children)S!==te&&S.addEventListener("transitionend",U);const A=new MutationObserver(()=>{var S;(S=xe.current)==null||S.updateRect()});return A.observe(te,{attributes:!0,attributeFilter:["style","class"]}),A.observe(Ae,{childList:!0,attributes:!0,subtree:!0}),()=>{te.removeEventListener("transitionend",U);for(const S of Ae.children)S!==te&&S.removeEventListener("transitionend",U);A.disconnect()}}},[T]);const{vertical:Ce=[],horizontal:ke=[]}=$t(me=>{var te;return(te=me.workingProject)==null?void 0:te.attributes.guides})??{};return f==="editor"&&T?D.jsxs(D.Fragment,{children:[Z,D.jsx(sc,{rootContainer:document.querySelector("#editorBody"),viewContainer:document.querySelector("#editorRenderFrame"),className:Gh[we?"visible":"hidden"],keepRatio:pe,hideDefaultLines:!1,linePadding:10,controlPadding:10,useAccuratePosition:!0,ref:xe,target:o,throttleDrag:0,draggable:!!G&&we,resizable:ee,edgeDraggable:!0,throttleResize:0,snappable:!0,isDisplaySnapDigit:!0,isDisplayInnerSnapDigit:!1,snapGap:!0,snapDirections:{top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0},elementSnapDirections:{top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0},snapThreshold:0,elementGuidelines:Re(),onDrag:be,onDragEnd:Me,onResizeStart:ce,onResize:ve,onResizeEnd:fe,verticalGuidelines:Ce,horizontalGuidelines:ke,ables:[Xh],props:{SelectInformerAble:!0,isModeExist:R,activeModeIndex:k,type:x}})]}):Z});function Jh(e){const{isDynamic:r,listWidth:i,listHeight:o,listState:l,listNumberOfItems:f,listPadding:s,listGap:g,listBackgroundColor:p,listBorder:d,listElementsFlow:h,listColumns:L,listRows:_,listVerticalPosition:x,listHorisontalPosition:T,width:b,staticListOverrides:M,cssClass:R,listForceFillHeight:k,listForceFillWidth:j,listEmptyText:N,name:H,parentData:G,parentArrayIndex:V,subpageId:J,inheritedParameters:Z,modes:ee,attachedFunctions:ge,activeModeIndex:pe,left:Ee,top:be,right:Me,bottom:ce}=e;return{listContainerProps:{isDynamic:r,listWidth:i,listHeight:o,listState:l,listNumberOfItems:f,listPadding:s,listGap:g,listBackgroundColor:p,listBorder:d,listElementsFlow:h,listColumns:L,listRows:_,listVerticalPosition:x,listHorisontalPosition:T,width:b,staticListOverrides:M,cssClass:R,listForceFillHeight:k,listForceFillWidth:j,listEmptyText:N,name:H,subpageId:J,modes:ee,activeModeIndex:pe,attachedFunctions:ge,left:Ee,top:be,right:Me,bottom:ce}}}const Zh=D.jsx("svg",{style:{opacity:.5},version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 226 226",children:D.jsxs("g",{fill:"none",fillRule:"nonzero",stroke:"none",strokeWidth:"1",strokeLinecap:"butt",strokeLinejoin:"miter",strokeMiterlimit:"10",strokeDasharray:"",strokeDashoffset:"0",fontFamily:"none",fontWeight:"none",fontSize:"none",textAnchor:"none",children:[D.jsx("path",{d:"M0,226v-226h226v226z",fill:"none"}),D.jsx("g",{fill:"#ffffff",children:D.jsx("path",{d:"M113,30.13333c-2.147,0 -4.18688,0.47401 -6.03255,1.28008l-71.97865,29.39766c-2.825,1.0848 -4.85547,3.77973 -4.85547,6.98893c0,3.2092 2.03047,5.90413 4.85547,6.98893l72.30235,29.54479c1.75526,0.7232 3.68238,1.13295 5.70885,1.13295c2.02647,0 3.96077,-0.40975 5.72357,-1.13295l72.30234,-29.54479c2.81747,-1.0848 4.84075,-3.77973 4.84075,-6.98893c0,-3.2092 -2.03047,-5.90413 -4.85547,-6.98893l-71.97865,-29.39766c-1.84567,-0.8136 -3.88555,-1.28008 -6.03255,-1.28008zM53.27773,98.53659l-18.28893,7.47448c-2.825,1.0848 -4.85547,3.77973 -4.85547,6.98893c0,3.2092 2.03047,5.90413 4.85547,6.98893l72.30235,29.54479c1.75526,0.7232 3.68238,1.13295 5.70885,1.13295c2.02647,0 3.96077,-0.40975 5.72357,-1.13295l72.30234,-29.54479c2.81747,-1.0848 4.84075,-3.77973 4.84075,-6.98893c0,-3.2092 -2.03047,-5.90413 -4.85547,-6.98893l-18.28894,-7.47448l-48.28984,19.73086c-3.6612,1.50667 -7.50755,2.26588 -11.43242,2.26588c-3.92487,0 -7.77911,-0.76675 -11.41771,-2.26588zM53.27773,143.73659l-18.28893,7.47448c-2.825,1.0848 -4.85547,3.77973 -4.85547,6.98893c0,3.2092 2.03047,5.90413 4.85547,6.98893l72.30235,29.54479c1.75526,0.7232 3.68238,1.13295 5.70885,1.13295c2.02647,0 3.96077,-0.40975 5.72357,-1.13295l72.30234,-29.54479c2.81747,-1.0848 4.84075,-3.77973 4.84075,-6.98893c0,-3.2092 -2.03047,-5.90413 -4.85547,-6.98893l-18.28894,-7.47448l-48.28984,19.73086c-3.6612,1.50667 -7.50755,2.26588 -11.43242,2.26588c-3.92487,0 -7.77911,-0.76675 -11.41771,-2.26588z"})})]})}),ca=et.memo(({containerData:e,isEditedNow:r,showBoundingBox:i,currentPageContainersFlow:o,containerIndex:l,isGlobal:f=!1,globalPosition:s,renderAsElement:g,style:p,parentArrayIndex:d,parentId:h,parentData:L,parameters:_,isStaticPage:x})=>{const T=Lt(te=>te.isLandscape),b=pt.getState().selectedMenuSection.containerIndex,M=pt.getState().selectedMenuSection.isGlobalContainer,R=b===l&&M===f,{setMainMenuData:k,setPageContextMenu:j}=pt.getState(),N=na(),H=e.useOrientation,G=I.useMemo(()=>H&&T?e.landscape:e.portrait,[e.landscape,e.portrait,H,T]),[V,J]=I.useState(null);I.useEffect(()=>{if(!G)return;const te=e.elements.map((de,Ae)=>{const O=Bu(),U={containerIndex:l,isGlobal:f,elementRenderId:O,parentArrayIndex:d,parentData:L,parentId:h,containerFlow:G==null?void 0:G.flow,index:Ae,currentPageContainersFlow:o,state:de.state,isLandscape:T,isStaticElement:!!(e!=null&&e.isStatic)};let A;switch(de.type){case"button":A=D.jsx(sa,{...U,...de});break;case"subpageList":{const{left:S,top:P,right:F,bottom:z,deltaCenterX:$,deltaCenterY:W,constraintsHorizontal:X,constraintsVertical:se,...ie}=de,re={...ie,type:"subpage",parentData:U.parentData,parentArrayIndex:U.parentArrayIndex,inheritedParameters:_},{listContainerProps:le}=Jh(re);A=D.jsx(_o,{...le,...U,left:S,top:P,right:F,bottom:z,deltaCenterX:$,deltaCenterY:W,constraintsHorizontal:X,constraintsVertical:se,data:re,type:"subpageList"});break}case"text":A=D.jsx(Ks,{...U,...de});break;case"keypad":A=D.jsx(ao,{...U,...de});break;case"input":A=D.jsx(Xs,{...U,...de});break;case"video":A=D.jsx(So,{...U,...de});break;case"htmlblock":A=D.jsx(Lo,{...U,...de});break;case"image":A=D.jsx(Wu,{...U,...de});break;case"spacer":A=D.jsx(qs,{...U,...de});break;case"switch":A=D.jsx(Js,{...U,...de});break;case"toggle":A=D.jsx(Eo,{...U,...de});break;case"shades":A=D.jsx(Mo,{...U,...de});break;case"circleSlider":A=D.jsx(wo,{...U,...de});break;case"checkbox":A=D.jsx(yo,{...U,...de});break;case"dpad":A=D.jsx(io,{...U,...de});break;case"subpage":A=I.createElement(la,{...U,...de,key:`subpage_${Ae}`});break;case"slider":A=I.createElement(no,{...U,...de,key:`slider_${Ae}`});break;case"clock":A=I.createElement(ho,{...U,...de,key:`clock_${Ae}`});break;case"dateTime":A=I.createElement(Ro,{...U,...de,key:`dateTime_${Ae}`});break;case"player":A=I.createElement(mo,{...U,...de,key:`player_${Ae}`});break;default:A=D.jsxs("div",{children:["unknown ",de.name]})}return D.jsx(qh,{parentContainerElementsCount:e.elements.length,isStaticPage:x,children:A},`element_${Ae}`)});J(te)},[e.elements,l,G,o,f,T,_,d,L,h]);const{backgroundColor:Z,backgroundImageStyles:ee}=ua({background:(G==null?void 0:G.background)??{}})??{},ge=I.useMemo(()=>{if(G){let te={};const{manualMode:de,value:Ae,unit:O}=G.size||{};if(de){if(f)(s==="top"||s==="bottom")&&(O==="px"?te={height:Ae+O,minHeight:Ae+O}:O==="%"&&(te={height:`${Ae}cqh`,minHeight:`${Ae}cqh`})),(s==="left"||s==="right")&&(O==="px"?te={width:Ae+O,minWidth:Ae+O}:O==="%"&&(te={width:`${Ae}cqw`,minWidth:`${Ae}cqw`}));else if(Ae!==void 0&&O)switch(o){case"column":te={height:Ae+O,minHeight:Ae+O};break;case"row":te={width:Ae+O,minWidth:Ae+O};break;default:te={};break}}else te={};let U={};const{useBorder:A,...S}=G.border||{};U=A?S:{};let P={};!g&&i&&r&&(P={outline:`1px ${f?"#ee00ff":"hsl(177, 100%, 57%)"} dashed !important`});let F={};return g&&i&&(F={pointerEvents:"none"}),{...U,...te,...P,...F}}return{}},[G,o,s,r,f,g,i]),{globalPadding:pe}=yt({sizeObj:G==null?void 0:G.padding,sizePropName:"globalPadding"}),Ee={paddingTop:pe,paddingRight:pe,paddingBottom:pe,paddingLeft:pe},be=yt({sizeObj:G==null?void 0:G.paddingTop,sizePropName:"paddingTop"}),Me=yt({sizeObj:G==null?void 0:G.paddingBottom,sizePropName:"paddingBottom"}),ce=yt({sizeObj:G==null?void 0:G.paddingLeft,sizePropName:"paddingLeft"}),ve=yt({sizeObj:G==null?void 0:G.paddingRight,sizePropName:"paddingRight"}),fe=yt({sizeObj:G.gap,sizePropName:"gap",defaultValue:{value:1,unit:"em"}}),xe=G.backgroundElementsBlur?{backdropFilter:`blur(${G.backgroundElementsBlur}px)`,WebkitBackdropFilter:`blur(${G.backgroundElementsBlur}px)`}:{},[we,ye]=I.useState(!1);I.useEffect(()=>{const te=setTimeout(()=>{ye(!0)},100);return()=>{clearTimeout(te)}},[N.pathname]);const q=I.useCallback(()=>{if(i){let te=`container-${l}-details`;f&&(te=`globalContainer-${l}-details`),k({selectedMenuSection:{isGlobalContainer:f||!1,isStaticContainer:!!(e!=null&&e.isStatic),key:te,containerIndex:l,elementIndex:null,pageActionIndex:null}})}},[e==null?void 0:e.isStatic,l,f,k,i]),oe=I.useRef(null),ae=I.useRef(null),[Re,Ce]=I.useState(!1),[ke,De]=I.useState(-1),Ne=I.useCallback(()=>{if(oe.current&&Re===!1){const te=oe.current.children,de={};for(let Ae=0;Ae<te.length;Ae++){const U=te[Ae].getBoundingClientRect();de[Ae]={boundingBox:U,positions:{topLeft:{x:U.left,y:U.top},topRight:{x:U.right,y:U.top},bottomRight:{x:U.right,y:U.bottom},bottomLeft:{x:U.left,y:U.bottom}}}}ae.current=de,Ce(!0)}},[Re]),je=I.useCallback(te=>{if(oe.current&&ae.current){const de=Lt.getState().editorZoom??1,Ae=te.clientX/de,O=te.clientY/de;let U={position:null,index:null},A=Number.MAX_VALUE;const S=ae.current;for(const[F,z]of Object.entries(S)){const $=z.positions;for(const[W,X]of Object.entries($)){const se=Math.sqrt((Ae-X.x)**2+(O-X.y)**2);se<A&&(A=se,U={position:W,index:Number.parseInt(F)})}}const P=G==null?void 0:G.flow;if(!P)return;P==="column"?De(F=>{const z=U.position.toLowerCase().includes("top")?U.index-1:U.index;return F===z?F:z}):P==="row"&&De(F=>{const z=U.position.toLowerCase().includes("left")?U.index-1:U.index;return F===z?F:z})}},[G==null?void 0:G.flow]),{pageId:Fe}=An(),ze=te=>{const de=te.dataTransfer.getData("draggedElement");try{const Ae=JSON.parse(de),O={destinationContainerIndex:l,destinationContainerType:f?"global":"normal",destinationElementPosition:ke+1};Fe&&oc({pageId:Fe,dragDestination:O,draggedElement:Ae})}catch(Ae){console.log(Ae)}console.log("onDrop fired in container"),Ce(!1),ae.current=null};if(V==null||f&&!V.length&&!i)return null;let Ge={};g||(Ge={container:"ContainerBox / inline-size"});const Ve=nt({dragIndicator:!0,containerRow:(G==null?void 0:G.flow)==="row"}),Xe=nt({container:!f,globalContainer:f,emptyDragOverGlobal:f&&V.length===0&&Re,[`${e.cssClass}`]:e.cssClass,showContainer:we,renderAsElement:!!g,staticContainer:!!x,selectedContainer:R});function me(te){const de=te.relatedTarget||document.elementFromPoint(te.clientX,te.clientY);return te.currentTarget.contains(de)}return G?D.jsx(D.Fragment,{children:D.jsxs(Tc,{isGlobal:f,backgroundImageStyles:ee,ref:oe,onDragEnter:Ne,onDragLeave:te=>{me(te)||(console.log("dragleave fired in container"),Ce(!1),ae.current=null)},onDragExit:()=>{console.log("dragexit fired in container"),Ce(!1),ae.current=null},onDrop:ze,onDragOver:te=>{te.preventDefault(),je(te)},onContextMenu:te=>{te.preventDefault(),j({event:te,containerIndex:l,isGlobal:f})},"data-container-index":l,"data-is-global":f,style:{...ge,flexFlow:G.flow,alignItems:G.align,justifyContent:G.distribution,...fe,...Ee,...be,...Me,...ce,...ve,...xe,...p,...Ge,backgroundColor:Z},onClick:()=>{q()},className:Xe,children:[V.length?D.jsx(D.Fragment,{children:V}):i&&!Re&&D.jsx(aa,{style:{},icon:Zh,title:"No elements"}),!g&&Re&&D.jsx("div",{style:{order:ke},className:Ve},ke)]})}):null});ca.displayName="Container";const Qh=e=>I.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 226 226",...e},I.createElement("g",{fill:"none",fillRule:"nonzero",stroke:"none",strokeWidth:1,strokeLinecap:"butt",strokeLinejoin:"miter",strokeMiterlimit:10,strokeDasharray:"",strokeDashoffset:0,fontFamily:"none",fontWeight:"none",fontSize:"none",textAnchor:"none"},I.createElement("path",{d:"M0,226v-226h226v226z",fill:"none"}),I.createElement("g",null,I.createElement("path",{d:"M157.14063,197.75h-123.59375c-3.00156,0 -5.29687,-2.29531 -5.29687,-5.29687v-123.59375c0,-3.00156 2.29531,-5.29687 5.29688,-5.29687c3.00156,0 5.29688,2.29531 5.29688,5.29688v118.29688h118.29688c3.00156,0 5.29688,2.29531 5.29688,5.29688c0,3.00156 -2.29531,5.29688 -5.29687,5.29688zM157.14063,171.26563c-3.00156,0 -5.29687,-2.29531 -5.29687,-5.29687v-91.8125h-91.8125c-3.00156,0 -5.29687,-2.29531 -5.29687,-5.29687c0,-3.00156 2.29531,-5.29687 5.29688,-5.29687h97.10938c3.00156,0 5.29688,2.29531 5.29688,5.29688v97.10938c0,3.00156 -2.29531,5.29688 -5.29687,5.29688z",fill:"#fff"}),I.createElement("path",{d:"M157.14063,197.75c-1.4125,0 -2.64844,-0.52969 -3.70781,-1.58906c-2.11875,-2.11875 -2.11875,-5.47344 0,-7.41563l33.72344,-33.72344v-116.17812h-118.29687c-3.00156,0 -5.29687,-2.29531 -5.29687,-5.29687c0,-3.00156 2.29531,-5.29687 5.29688,-5.29687h123.59375c3.00156,0 5.29688,2.29531 5.29688,5.29688v123.59375c0,1.4125 -0.52969,2.825 -1.58906,3.70781l-35.3125,35.3125c-1.05937,1.05938 -2.29531,1.58906 -3.70781,1.58906z",fill:"#fff"}),I.createElement("path",{d:"M157.14063,74.15625c-1.4125,0 -2.64844,-0.52969 -3.70781,-1.58906c-2.11875,-2.11875 -2.11875,-5.47344 0,-7.41563l17.65625,-17.65625c2.11875,-2.11875 5.47344,-2.11875 7.41563,0c2.11875,2.11875 2.11875,5.47344 0,7.41562l-17.65625,17.65625c-1.05938,1.05938 -2.29531,1.58906 -3.70781,1.58906zM33.54688,74.15625c-1.4125,0 -2.64844,-0.52969 -3.70781,-1.58906c-2.11875,-2.11875 -2.11875,-5.47344 0,-7.41563l35.3125,-35.3125c2.11875,-2.11875 5.47344,-2.11875 7.41563,0c2.11875,2.11875 2.11875,5.47344 0,7.41562l-35.3125,35.3125c-1.05938,1.05938 -2.29531,1.58906 -3.70781,1.58906z",fill:"#fff"})))),oi=et.createContext({calculatedParameters:[]}),Do=et.memo(({pageData:e,currentPageContainersFlow:r,renderAsElement:i})=>{var d;const o=pt(h=>h.showBoundingBox),l=pt(h=>h.selectedMenuSection),{containerIndex:f,elementIndex:s,isGlobalContainer:g}=l,p=I.useMemo(()=>{var h,L;return(L=(h=e.attributes)==null?void 0:h.containers)==null?void 0:L.map((_,x)=>{let T=!1;return!g&&f!==void 0&&f===x&&(T=!0),D.jsx(ca,{isStaticPage:e.attributes.isStatic,parentArrayIndex:e.listIndex,parentData:e.parentData,parentId:e.id,renderAsElement:i,currentPageContainersFlow:r,containerIndex:x,showBoundingBox:o,isEditedNow:T,selectedElementIndex:s,containerData:_,parameters:e.attributes.parameters},"container_"+x)})},[r,g,(d=e.attributes)==null?void 0:d.containers,e.attributes.isStatic,e.attributes.parameters,e.id,e.listIndex,e.parentData,i,f,s,o]);return e&&(p!=null&&p.length)?D.jsx(oi.Provider,{value:{calculatedParameters:e.attributes.parameters||[]},children:p}):D.jsx(aa,{icon:D.jsx(Qh,{}),title:"No containers created",text:e.attributes.name})});Do.displayName="PrintPageContainers";var Kn={boxFlex:!0,boxFlexGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0};function eg(e,r){return e+r.charAt(0).toUpperCase()+r.substring(1)}var tg=["Webkit","ms","Moz","O"];Object.keys(Kn).forEach(function(e){tg.forEach(function(r){Kn[eg(r,e)]=Kn[e]})});var rg={background:{backgroundImage:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundColor:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0}},ng={isUnitlessNumber:Kn,shorthandPropertyExpansions:rg},ig=ng,ag=/^ms-/,sg=/([A-Z])/g;function og(e){return e.replace(sg,"-$1").toLowerCase()}function lg(e){return og(e).replace(ag,"-ms-")}var ug=lg,cg=ig.isUnitlessNumber,dg=ug,fg=Array.isArray,_s=Object.keys,hg=/^(normal|none|(\b(url\([^)]*\)|chapter_counter|attr\([^)]*\)|(no-)?(open|close)-quote|inherit)((\b\s*)|$|\s+))+)$/;function ys(e,r){return!cg[e]&&typeof r=="number"?r=""+r+"px":e==="content"&&!hg.test(r)&&(r="'"+r.replace(/'/g,"\\'")+"'"),dg(e)+": "+r+";  "}function gg(e){var r="";if(!e||_s(e).length===0)return r;for(var i=_s(e),o=0,l=i.length;o<l;o++){var f=i[o],s=e[f];if(fg(s))for(var g=0,p=s.length;g<p;g++)r+=ys(f,s[g]);else r+=ys(f,s)}return r}var mg=gg;const pg=Or(mg),vg=ju(e=>({modalsData:{newElement:null},setNewElementModalData:r=>{e(()=>({modalsData:{newElement:r}}))}})),_g=Pr`
  from {
    transform: scale(0);
  }

  to {
    transform: scale(1);
  }
`,yg=ct.div`
  position: absolute;
  left: 0;
  top: 0;
  z-index: 10000;
  border-radius: 3px;
  padding: 10px;
  display: flex;
  flex-flow: column;
  gap: 10px;
  background-color: #ffffff;
  animation: ${_g} 100ms linear;
  border: 0.5px gray dashed;
  will-change: transform;
`,bg=()=>{const{pageId:e}=An(),r=Ps(),i=na(),{setCloneItemModal:o}=Hu(),l=pt(j=>j.pageContextMenu),f=pt(j=>j.selectedMenuSection),{setPageContextMenu:s}=pt.getState(),{event:{clientX:g,clientY:p},containerIndex:d,elementIndex:h,isGlobal:L,subpageId:_}=l||{event:{}},{setNewElementModalData:x}=vg.getState();I.useEffect(()=>{s(null)},[f,s]),I.useEffect(()=>{function j(){s(null)}function N(H){H.key==="Escape"&&j()}return document.addEventListener("click",j),document.addEventListener("keydown",N),()=>{document.removeEventListener("click",j),document.removeEventListener("keydown",N)}},[s]);function T(){var H;if(!_)return;const j=((H=i==null?void 0:i.pathname)==null?void 0:H.split("/"))||[];j!=null&&j.length&&(j[j.length-1]=_);const N=j.join("/");r(N)}const[b,M]=I.useState(null),[R,k]=I.useState({visibility:"hidden"});return I.useEffect(()=>{if(b&&g&&p){const{innerHeight:j,innerWidth:N}=window,H=Math.min(g,N-b.offsetWidth),G=Math.min(p,j-b.offsetHeight);k({left:H,top:G})}},[g,p,b]),l&&d!==void 0?Cs.createPortal(D.jsxs(yg,{ref:j=>{M(j)},style:{...R},children:[h!==void 0&&D.jsxs(D.Fragment,{children:[D.jsx(jn,{danger:!0,onClick:j=>{j.stopPropagation(),Us({containerIndex:d,elementIndex:h,isGlobal:L,pageId:e,action:"delete"}),s(null)},children:"Delete Element"}),_&&D.jsx(jn,{onClick:()=>{T()},children:"Edit Subpage"}),D.jsx(jn,{onClick:j=>{j.stopPropagation(),o({nodeType:"element",containerIndex:d,elementIndex:h,isGlobal:L}),s(null)},children:"Clone Element"}),D.jsx(Ga,{style:{margin:"5px 0"}})]}),D.jsx(jn,{onClick:j=>{var G;j.stopPropagation();const{clientX:N,clientY:H}=((G=pt.getState().pageContextMenu)==null?void 0:G.event)??{};x({containerIndex:d,isGlobal:!!L,clientX:N,clientY:H}),s(null)},children:"Add Element"}),D.jsx(Ga,{style:{margin:"5px 0"}}),D.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[D.jsx(Ti,{style:{margin:0},children:"cmd/ctrl + c"}),D.jsx("small",{style:{fontSize:10},children:"to copy"})]}),D.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[D.jsx(Ti,{style:{margin:0},children:"cmd/ctrl + v"}),D.jsx("small",{style:{fontSize:10},children:"to paste"})]}),D.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[D.jsx(Ti,{style:{margin:0},children:"del/backspace"}),D.jsx("small",{style:{fontSize:10},children:"to del"})]})]},g),document.body):null};async function Sg(e,r,i){if(i&&i!==void 0)return e;if((e==null?void 0:e.length)>1&&e.startsWith("%")&&e.endsWith("%")){const o=e.replace(/%/g,""),l=r.find(f=>f.name===o);return(l==null?void 0:l.currentValue)??(l==null?void 0:l.defaultValue)}else return e}async function Eg(e,r){if((e==null?void 0:e.length)>2&&e.startsWith("%")&&e.endsWith("%")){const i=e.replace(/%/g,""),o=r.find(l=>l.name===i);return(o==null?void 0:o.currentValue)!==void 0?o==null?void 0:o.currentValue:e}return e}const li=et.memo(({data:e,renderAsElement:r,listIndex:i,parentData:o,style:l})=>{const f=Lt(N=>N.isLandscape),[s,g]=I.useState(),p=e.attributes.parameters;I.useEffect(()=>{if(e.attributes.isSubpage&&p&&p.length){const N=structuredClone(e);Cr(N.attributes,H=>Sg(H,p,o)).then(H=>{Cr(H,G=>Eg(G,H.parameters)).then(G=>{N.attributes=G,N.listIndex=i;const V=structuredClone(o);o&&o!==void 0&&V!==void 0&&(V.parameters=p,N.parentData=V),g(N)})})}else g({...e,listIndex:i,parentData:o})},[e,i,p,o]);const d=nt({page:!0,[`${e.attributes.cssClass}`]:!!e.attributes.cssClass,renderAsElement:r}),h=e.attributes.useOrientationFlow,{portraitFlow:L="row",landscapeFlow:_="row",portraitAlign:x="center",landscapeAlign:T="center"}=e.attributes,b=I.useMemo(()=>h?f?{flexFlow:_,alignItems:T}:{flexFlow:L,alignItems:x}:{flexFlow:L,alignItems:x},[h,f,T,_,x,L]),M=pt(N=>N.showBoundingBox),R=ua({background:s==null?void 0:s.attributes.background});I.useEffect(()=>{const N=document.getElementById("GuiMainContainer"),H=document.getElementById("PageBackgroundImage");if(!r&&R){const{backgroundColor:G,backgroundImageStyles:V}=R;if(!N||!H)return;N.style.setProperty("--active-page-background-color",G||"transparent"),N.style.setProperty("--active-page-background-image",(V==null?void 0:V.backgroundImage)||"none"),N.style.setProperty("--active-page-background-filter",(V==null?void 0:V.filter)||"none"),N.style.setProperty("--active-page-background-opacity",String((V==null?void 0:V.opacity)??1)),N.style.setProperty("--active-page-background-backgroundSize",String((V==null?void 0:V.backgroundSize)||"cover")),N.style.setProperty("--active-page-background-backgroundPosition",String((V==null?void 0:V.backgroundPosition)||"center")),H.classList.add("animateActivePageBg")}return()=>{!r&&H&&H.classList.remove("animateActivePageBg")}},[R,r]);const{onLoadActions:k,onExitActions:j}=lr({actions:s==null?void 0:s.attributes.actions});return I.useEffect(()=>{if(k!=null&&k.length)for(const N of k)N()},[k]),I.useEffect(()=>()=>{if(j!=null&&j.length)for(const N of j)N()},[j]),s&&b&&R?D.jsxs(D.Fragment,{children:[M&&D.jsx(bg,{}),r?D.jsxs(D.Fragment,{children:[D.jsx("div",{className:"expand",style:{backgroundColor:(R==null?void 0:R.backgroundColor)||"",pointerEvents:"none"}}),D.jsx("div",{className:"expand",style:{...R==null?void 0:R.backgroundImageStyles,pointerEvents:"none"}})]}):null,D.jsx(yc,{style:{...l},className:d,inlineStyles:pg(b),children:D.jsx(Do,{renderAsElement:r,currentPageContainersFlow:b.flexFlow,pageData:s})},e.id)]}):null});li.displayName="Page";const xg=et.memo(()=>{const e=na(),{pageId:r}=An(),i=$t(b=>b.workingProject),o=i==null?void 0:i.attributes.pages.data,l=i==null?void 0:i.attributes.globalContainers,f=Lt(b=>b.isLandscape),s=Lt(b=>b.envState),g=pt(b=>b.showBoundingBox),p=pt(b=>b.selectedMenuSection),{containerIndex:d,elementIndex:h,isGlobalContainer:L}=p,[_,x]=I.useState([]);function T(b){return _.map((R,k)=>{if(f&&R.landscapePosition===b||!f&&R.portraitPosition===b){let j=!1;return L&&d===k&&(j=!0),D.jsx(ca,{isStaticPage:!1,parentId:r,style:R.isVisibleOnPage?{}:{display:"none"},containerIndex:k,isGlobal:!0,globalPosition:b,showBoundingBox:s!=="live"&&g||!1,isEditedNow:j,selectedElementIndex:h,containerData:R},`globalContainer_${b}_`+k)}else return null})}return I.useEffect(()=>{var R;let b="";if(r)b=r;else{const k=e.pathname.split("/"),j=k[k.length-1];b=((R=o==null?void 0:o.find(N=>Ni(N.attributes.name)===j))==null?void 0:R.id)||"no-name"}const M=[];if(l!=null&&l.length)for(const k of l){let j;k.visibleByDefault?j=!k.hiddenOnPages.includes(b):j=k.visibleOnPages.includes(b),M.push({...k,isVisibleOnPage:j})}M.length&&x(M)},[s,l,e.pathname,r,o]),D.jsxs(D.Fragment,{children:[D.jsx("div",{className:"globalslot top",children:T("top")}),D.jsx("div",{className:"globalslot left",children:T("left")}),D.jsx("div",{className:"globalslot right",children:T("right")}),D.jsx("div",{className:"globalslot bottom",children:T("bottom")})]})});let Tg={data:""},wg=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||Tg,Mg=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Lg=/\/\*[^]*?\*\/|  +/g,bs=/\n+/g,kr=(e,r)=>{let i="",o="",l="";for(let f in e){let s=e[f];f[0]=="@"?f[1]=="i"?i=f+" "+s+";":o+=f[1]=="f"?kr(s,f):f+"{"+kr(s,f[1]=="k"?"":r)+"}":typeof s=="object"?o+=kr(s,r?r.replace(/([^,])+/g,g=>f.replace(/(^:.*)|([^,])+/g,p=>/&/.test(p)?p.replace(/&/g,g):g?g+" "+p:p)):f):s!=null&&(f=/^--/.test(f)?f:f.replace(/[A-Z]/g,"-$&").toLowerCase(),l+=kr.p?kr.p(f,s):f+":"+s+";")}return i+(r&&l?r+"{"+l+"}":l)+o},Tr={},Io=e=>{if(typeof e=="object"){let r="";for(let i in e)r+=i+Io(e[i]);return r}return e},kg=(e,r,i,o,l)=>{let f=Io(e),s=Tr[f]||(Tr[f]=(p=>{let d=0,h=11;for(;d<p.length;)h=101*h+p.charCodeAt(d++)>>>0;return"go"+h})(f));if(!Tr[s]){let p=f!==e?e:(d=>{let h,L,_=[{}];for(;h=Mg.exec(d.replace(Lg,""));)h[4]?_.shift():h[3]?(L=h[3].replace(bs," ").trim(),_.unshift(_[0][L]=_[0][L]||{})):_[0][h[1]]=h[2].replace(bs," ").trim();return _[0]})(e);Tr[s]=kr(l?{["@keyframes "+s]:p}:p,i?"":"."+s)}let g=i&&Tr.g?Tr.g:null;return i&&(Tr.g=Tr[s]),((p,d,h,L)=>{L?d.data=d.data.replace(L,p):d.data.indexOf(p)===-1&&(d.data=h?p+d.data:d.data+p)})(Tr[s],r,o,g),s},Ag=(e,r,i)=>e.reduce((o,l,f)=>{let s=r[f];if(s&&s.call){let g=s(i),p=g&&g.props&&g.props.className||/^go/.test(g)&&g;s=p?"."+p:g&&typeof g=="object"?g.props?"":kr(g,""):g===!1?"":g}return o+l+(s??"")},"");function ui(e){let r=this||{},i=e.call?e(r.p):e;return kg(i.unshift?i.raw?Ag(i,[].slice.call(arguments,1),r.p):i.reduce((o,l)=>Object.assign(o,l&&l.call?l(r.p):l),{}):i,wg(r.target),r.g,r.o,r.k)}let Po,Xi,qi;ui.bind({g:1});let Mr=ui.bind({k:1});function Rg(e,r,i,o){kr.p=r,Po=e,Xi=i,qi=o}function Fr(e,r){let i=this||{};return function(){let o=arguments;function l(f,s){let g=Object.assign({},f),p=g.className||l.className;i.p=Object.assign({theme:Xi&&Xi()},g),i.o=/ *go\d+/.test(p),g.className=ui.apply(i,o)+(p?" "+p:"");let d=e;return e[0]&&(d=g.as||e,delete g.as),qi&&d[0]&&qi(g),Po(d,g)}return l}}var Cg=e=>typeof e=="function",ni=(e,r)=>Cg(e)?e(r):e,Dg=(()=>{let e=0;return()=>(++e).toString()})(),Oo=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let r=matchMedia("(prefers-reduced-motion: reduce)");e=!r||r.matches}return e}})(),Ig=20,Xn=new Map,Pg=1e3,Ss=e=>{if(Xn.has(e))return;let r=setTimeout(()=>{Xn.delete(e),Xr({type:4,toastId:e})},Pg);Xn.set(e,r)},Og=e=>{let r=Xn.get(e);r&&clearTimeout(r)},Ji=(e,r)=>{switch(r.type){case 0:return{...e,toasts:[r.toast,...e.toasts].slice(0,Ig)};case 1:return r.toast.id&&Og(r.toast.id),{...e,toasts:e.toasts.map(f=>f.id===r.toast.id?{...f,...r.toast}:f)};case 2:let{toast:i}=r;return e.toasts.find(f=>f.id===i.id)?Ji(e,{type:1,toast:i}):Ji(e,{type:0,toast:i});case 3:let{toastId:o}=r;return o?Ss(o):e.toasts.forEach(f=>{Ss(f.id)}),{...e,toasts:e.toasts.map(f=>f.id===o||o===void 0?{...f,visible:!1}:f)};case 4:return r.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(f=>f.id!==r.toastId)};case 5:return{...e,pausedAt:r.time};case 6:let l=r.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(f=>({...f,pauseDuration:f.pauseDuration+l}))}}},qn=[],Jn={toasts:[],pausedAt:void 0},Xr=e=>{Jn=Ji(Jn,e),qn.forEach(r=>{r(Jn)})},Fg={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Ng=(e={})=>{let[r,i]=I.useState(Jn);I.useEffect(()=>(qn.push(i),()=>{let l=qn.indexOf(i);l>-1&&qn.splice(l,1)}),[r]);let o=r.toasts.map(l=>{var f,s;return{...e,...e[l.type],...l,duration:l.duration||((f=e[l.type])==null?void 0:f.duration)||(e==null?void 0:e.duration)||Fg[l.type],style:{...e.style,...(s=e[l.type])==null?void 0:s.style,...l.style}}});return{...r,toasts:o}},Yg=(e,r="blank",i)=>({createdAt:Date.now(),visible:!0,type:r,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...i,id:(i==null?void 0:i.id)||Dg()}),Cn=e=>(r,i)=>{let o=Yg(r,e,i);return Xr({type:2,toast:o}),o.id},ar=(e,r)=>Cn("blank")(e,r);ar.error=Cn("error");ar.success=Cn("success");ar.loading=Cn("loading");ar.custom=Cn("custom");ar.dismiss=e=>{Xr({type:3,toastId:e})};ar.remove=e=>Xr({type:4,toastId:e});ar.promise=(e,r,i)=>{let o=ar.loading(r.loading,{...i,...i==null?void 0:i.loading});return e.then(l=>(ar.success(ni(r.success,l),{id:o,...i,...i==null?void 0:i.success}),l)).catch(l=>{ar.error(ni(r.error,l),{id:o,...i,...i==null?void 0:i.error})}),e};var Bg=(e,r)=>{Xr({type:1,toast:{id:e,height:r}})},jg=()=>{Xr({type:5,time:Date.now()})},Hg=e=>{let{toasts:r,pausedAt:i}=Ng(e);I.useEffect(()=>{if(i)return;let f=Date.now(),s=r.map(g=>{if(g.duration===1/0)return;let p=(g.duration||0)+g.pauseDuration-(f-g.createdAt);if(p<0){g.visible&&ar.dismiss(g.id);return}return setTimeout(()=>ar.dismiss(g.id),p)});return()=>{s.forEach(g=>g&&clearTimeout(g))}},[r,i]);let o=I.useCallback(()=>{i&&Xr({type:6,time:Date.now()})},[i]),l=I.useCallback((f,s)=>{let{reverseOrder:g=!1,gutter:p=8,defaultPosition:d}=s||{},h=r.filter(x=>(x.position||d)===(f.position||d)&&x.height),L=h.findIndex(x=>x.id===f.id),_=h.filter((x,T)=>T<L&&x.visible).length;return h.filter(x=>x.visible).slice(...g?[_+1]:[0,_]).reduce((x,T)=>x+(T.height||0)+p,0)},[r]);return{toasts:r,handlers:{updateHeight:Bg,startPause:jg,endPause:o,calculateOffset:l}}},Ug=Mr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,zg=Mr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Gg=Mr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,$g=Fr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Ug} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${zg} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Gg} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Vg=Mr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Wg=Fr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${Vg} 1s linear infinite;
`,Kg=Mr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Xg=Mr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,qg=Fr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Kg} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Xg} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Jg=Fr("div")`
  position: absolute;
`,Zg=Fr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Qg=Mr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,em=Fr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Qg} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,tm=({toast:e})=>{let{icon:r,type:i,iconTheme:o}=e;return r!==void 0?typeof r=="string"?I.createElement(em,null,r):r:i==="blank"?null:I.createElement(Zg,null,I.createElement(Wg,{...o}),i!=="loading"&&I.createElement(Jg,null,i==="error"?I.createElement($g,{...o}):I.createElement(qg,{...o})))},rm=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,nm=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,im="0%{opacity:0;} 100%{opacity:1;}",am="0%{opacity:1;} 100%{opacity:0;}",sm=Fr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,om=Fr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,lm=(e,r)=>{let i=e.includes("top")?1:-1,[o,l]=Oo()?[im,am]:[rm(i),nm(i)];return{animation:r?`${Mr(o)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Mr(l)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},um=I.memo(({toast:e,position:r,style:i,children:o})=>{let l=e.height?lm(e.position||r||"top-center",e.visible):{opacity:0},f=I.createElement(tm,{toast:e}),s=I.createElement(om,{...e.ariaProps},ni(e.message,e));return I.createElement(sm,{className:e.className,style:{...l,...i,...e.style}},typeof o=="function"?o({icon:f,message:s}):I.createElement(I.Fragment,null,f,s))});Rg(I.createElement);var cm=({id:e,className:r,style:i,onHeightUpdate:o,children:l})=>{let f=I.useCallback(s=>{if(s){let g=()=>{let p=s.getBoundingClientRect().height;o(e,p)};g(),new MutationObserver(g).observe(s,{subtree:!0,childList:!0,characterData:!0})}},[e,o]);return I.createElement("div",{ref:f,className:r,style:i},l)},dm=(e,r)=>{let i=e.includes("top"),o=i?{top:0}:{bottom:0},l=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Oo()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${r*(i?1:-1)}px)`,...o,...l}},fm=ui`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,zn=16,hm=({reverseOrder:e,position:r="top-center",toastOptions:i,gutter:o,children:l,containerStyle:f,containerClassName:s})=>{let{toasts:g,handlers:p}=Hg(i);return I.createElement("div",{style:{position:"fixed",zIndex:9999,top:zn,left:zn,right:zn,bottom:zn,pointerEvents:"none",...f},className:s,onMouseEnter:p.startPause,onMouseLeave:p.endPause},g.map(d=>{let h=d.position||r,L=p.calculateOffset(d,{reverseOrder:e,gutter:o,defaultPosition:r}),_=dm(h,L);return I.createElement(cm,{id:d.id,key:d.id,onHeightUpdate:p.updateHeight,className:d.visible?fm:"",style:_},d.type==="custom"?ni(d.message,d):l?l(d):I.createElement(um,{toast:d,position:h}))}))},gm=ar;const mm=ct.div`
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  width: 100%;
  height: 100%;
  z-index: 100;
`,pm=Pr`
 0% { opacity:0}
 100% { opacity:1}
`,Fo=ct.div`
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.54);
  will-change: opacity;
  transform: translateZ(0);
  animation-name: ${pm};
  animation-duration: 0.3s;
  animation-iteration-count: 1;
  z-index: 10;
`,No=Pr`
  from {
    transform: scale(0.5);
  }

  to {
    transform: scale(1);
  }
`,vm=ct.div`
  position: absolute;
  right: 0px;
  top: 0px;
  cursor: pointer;
  font-size: 35px;
  z-index: 1001;
  will-change: transform;
  animation: ${No} 0.3s linear;
  padding: 25px;
`,_m=ct.div`
  position: absolute;
  z-index: 11;
  border-style: solid;
  will-change: 'left, top, right, bottom, translate';
  animation: ${No} 0.15s ease-in;
`,ym=()=>{const e=sn.getState().setVisibleOverlayData;return D.jsx(vm,{onClick:()=>{e(null),console.log("Overlay closed by close button")},children:D.jsx(Du,{})})},Yo=({overlayAttachedSubpage:e,overlayAttachedSubpageName:r,overlayWidth:i,overlayHeight:o,overlayBackgroundColor:l,overlayBorder:f,absoluteCentering:s,overlayPlacement:g})=>{var b,M;const p=$t(R=>{var k;return(k=R.workingProject)==null?void 0:k.attributes.pages.data}),d=I.useMemo(()=>r?p==null?void 0:p.find(R=>R.attributes.name===r):e?p==null?void 0:p.find(R=>R.id===e):null,[p,e,r]),h=wt({width:{width:(b=d==null?void 0:d.attributes.width)==null?void 0:b.width},height:{height:(M=d==null?void 0:d.attributes.height)==null?void 0:M.height}}),L=wt({width:{width:i},height:{height:o},fallbackWidth:h==null?void 0:h.width,fallbackHeight:h==null?void 0:h.height}),{useBorder:_,...x}=f??{};let T={};if(s)T={left:"50%",top:"50%",translate:"-50% -50%"};else switch(g){case"top-start":T={left:"0",bottom:"100%"};break;case"top":T={left:"50%",bottom:"100%",translate:"-50% 0"};break;case"top-end":T={right:"0",bottom:"100%"};break;case"bottom-start":T={left:"0",top:"100%"};break;case"bottom":T={left:"50%",top:"100%",translate:"-50% 0"};break;case"bottom-end":T={right:"0",top:"100%"};break;case"right-start":T={left:"100%",top:"0"};break;case"right":T={left:"100%",top:"50%",translate:"0 -50%"};break;case"right-end":T={left:"100%",bottom:0};break;case"left-start":T={left:"auto",right:0,top:"0"};break;case"left":T={right:"100%",top:"50%",translate:"0 -50%"};break;case"left-end":T={right:"100%",bottom:0};break}return d?D.jsx(_m,{id:"overlayInnerContent",className:"overlayInnerContent",style:{...L,...T,backgroundColor:l,..._?x:null},children:D.jsx(li,{data:d,renderAsElement:!0})}):null},bm=et.memo(({children:e})=>{const r=document.getElementById("GuiMainContainer");return r?Iu.createPortal(e,r):null}),Sm=({actionData:e})=>{const{showMask:r,overlayMaskBackgroundColor:i,overlayBackgroundBlur:o,showCloseButton:l,overlayAttachedSubpage:f,overlayAttachedSubpageName:s,overlayWidth:g,overlayHeight:p,overlayBackgroundColor:d,overlayBorder:h}=e,L=r?{WebkitBackdropFilter:`blur(${o}px)`,backdropFilter:`blur(${o}px)`,backgroundColor:i}:{background:"transparent"};return D.jsx(bm,{children:D.jsxs(mm,{children:[D.jsx(Fo,{style:{...L}}),!!l&&D.jsx(ym,{}),D.jsx(Yo,{absoluteCentering:!0,overlayBorder:h,overlayBackgroundColor:d,overlayWidth:g,overlayHeight:p,overlayAttachedSubpage:f,overlayAttachedSubpageName:s})]})})},Zi=Math.min,cn=Math.max,ii=Math.round,Gn=Math.floor,Dr=e=>({x:e,y:e});function Em(e,r){return typeof e=="function"?e(r):e}function da(e){return e.split("-")[0]}function Bo(e){return e.split("-")[1]}function xm(e){return e==="x"?"y":"x"}function Tm(e){return e==="y"?"height":"width"}function fa(e){return["top","bottom"].includes(da(e))?"y":"x"}function wm(e){return xm(fa(e))}function jo(e){const{x:r,y:i,width:o,height:l}=e;return{width:o,height:l,top:i,left:r,right:r+o,bottom:i+l,x:r,y:i}}function Es(e,r,i){let{reference:o,floating:l}=e;const f=fa(r),s=wm(r),g=Tm(s),p=da(r),d=f==="y",h=o.x+o.width/2-l.width/2,L=o.y+o.height/2-l.height/2,_=o[g]/2-l[g]/2;let x;switch(p){case"top":x={x:h,y:o.y-l.height};break;case"bottom":x={x:h,y:o.y+o.height};break;case"right":x={x:o.x+o.width,y:L};break;case"left":x={x:o.x-l.width,y:L};break;default:x={x:o.x,y:o.y}}switch(Bo(r)){case"start":x[s]-=_*(i&&d?-1:1);break;case"end":x[s]+=_*(i&&d?-1:1);break}return x}const Mm=async(e,r,i)=>{const{placement:o="bottom",strategy:l="absolute",middleware:f=[],platform:s}=i,g=f.filter(Boolean),p=await(s.isRTL==null?void 0:s.isRTL(r));let d=await s.getElementRects({reference:e,floating:r,strategy:l}),{x:h,y:L}=Es(d,o,p),_=o,x={},T=0;for(let b=0;b<g.length;b++){const{name:M,fn:R}=g[b],{x:k,y:j,data:N,reset:H}=await R({x:h,y:L,initialPlacement:o,placement:_,strategy:l,middlewareData:x,rects:d,platform:s,elements:{reference:e,floating:r}});h=k??h,L=j??L,x={...x,[M]:{...x[M],...N}},H&&T<=50&&(T++,typeof H=="object"&&(H.placement&&(_=H.placement),H.rects&&(d=H.rects===!0?await s.getElementRects({reference:e,floating:r,strategy:l}):H.rects),{x:h,y:L}=Es(d,_,p)),b=-1)}return{x:h,y:L,placement:_,strategy:l,middlewareData:x}};async function Lm(e,r){const{placement:i,platform:o,elements:l}=e,f=await(o.isRTL==null?void 0:o.isRTL(l.floating)),s=da(i),g=Bo(i),p=fa(i)==="y",d=["left","top"].includes(s)?-1:1,h=f&&p?-1:1,L=Em(r,e);let{mainAxis:_,crossAxis:x,alignmentAxis:T}=typeof L=="number"?{mainAxis:L,crossAxis:0,alignmentAxis:null}:{mainAxis:L.mainAxis||0,crossAxis:L.crossAxis||0,alignmentAxis:L.alignmentAxis};return g&&typeof T=="number"&&(x=g==="end"?T*-1:T),p?{x:x*h,y:_*d}:{x:_*d,y:x*h}}const km=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(r){var i,o;const{x:l,y:f,placement:s,middlewareData:g}=r,p=await Lm(r,e);return s===((i=g.offset)==null?void 0:i.placement)&&(o=g.arrow)!=null&&o.alignmentOffset?{}:{x:l+p.x,y:f+p.y,data:{...p,placement:s}}}}};function ci(){return typeof window<"u"}function hn(e){return Ho(e)?(e.nodeName||"").toLowerCase():"#document"}function sr(e){var r;return(e==null||(r=e.ownerDocument)==null?void 0:r.defaultView)||window}function yr(e){var r;return(r=(Ho(e)?e.ownerDocument:e.document)||window.document)==null?void 0:r.documentElement}function Ho(e){return ci()?e instanceof Node||e instanceof sr(e).Node:!1}function hr(e){return ci()?e instanceof Element||e instanceof sr(e).Element:!1}function _r(e){return ci()?e instanceof HTMLElement||e instanceof sr(e).HTMLElement:!1}function xs(e){return!ci()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof sr(e).ShadowRoot}function Dn(e){const{overflow:r,overflowX:i,overflowY:o,display:l}=gr(e);return/auto|scroll|overlay|hidden|clip/.test(r+o+i)&&!["inline","contents"].includes(l)}function Am(e){return["table","td","th"].includes(hn(e))}function di(e){return[":popover-open",":modal"].some(r=>{try{return e.matches(r)}catch{return!1}})}function ha(e){const r=ga(),i=hr(e)?gr(e):e;return i.transform!=="none"||i.perspective!=="none"||(i.containerType?i.containerType!=="normal":!1)||!r&&(i.backdropFilter?i.backdropFilter!=="none":!1)||!r&&(i.filter?i.filter!=="none":!1)||["transform","perspective","filter"].some(o=>(i.willChange||"").includes(o))||["paint","layout","strict","content"].some(o=>(i.contain||"").includes(o))}function Rm(e){let r=Ir(e);for(;_r(r)&&!fn(r);){if(ha(r))return r;if(di(r))return null;r=Ir(r)}return null}function ga(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function fn(e){return["html","body","#document"].includes(hn(e))}function gr(e){return sr(e).getComputedStyle(e)}function fi(e){return hr(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ir(e){if(hn(e)==="html")return e;const r=e.assignedSlot||e.parentNode||xs(e)&&e.host||yr(e);return xs(r)?r.host:r}function Uo(e){const r=Ir(e);return fn(r)?e.ownerDocument?e.ownerDocument.body:e.body:_r(r)&&Dn(r)?r:Uo(r)}function kn(e,r,i){var o;r===void 0&&(r=[]),i===void 0&&(i=!0);const l=Uo(e),f=l===((o=e.ownerDocument)==null?void 0:o.body),s=sr(l);if(f){const g=Qi(s);return r.concat(s,s.visualViewport||[],Dn(l)?l:[],g&&i?kn(g):[])}return r.concat(l,kn(l,[],i))}function Qi(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function zo(e){const r=gr(e);let i=parseFloat(r.width)||0,o=parseFloat(r.height)||0;const l=_r(e),f=l?e.offsetWidth:i,s=l?e.offsetHeight:o,g=ii(i)!==f||ii(o)!==s;return g&&(i=f,o=s),{width:i,height:o,$:g}}function ma(e){return hr(e)?e:e.contextElement}function dn(e){const r=ma(e);if(!_r(r))return Dr(1);const i=r.getBoundingClientRect(),{width:o,height:l,$:f}=zo(r);let s=(f?ii(i.width):i.width)/o,g=(f?ii(i.height):i.height)/l;return(!s||!Number.isFinite(s))&&(s=1),(!g||!Number.isFinite(g))&&(g=1),{x:s,y:g}}const Cm=Dr(0);function Go(e){const r=sr(e);return!ga()||!r.visualViewport?Cm:{x:r.visualViewport.offsetLeft,y:r.visualViewport.offsetTop}}function Dm(e,r,i){return r===void 0&&(r=!1),!i||r&&i!==sr(e)?!1:r}function Gr(e,r,i,o){r===void 0&&(r=!1),i===void 0&&(i=!1);const l=e.getBoundingClientRect(),f=ma(e);let s=Dr(1);r&&(o?hr(o)&&(s=dn(o)):s=dn(e));const g=Dm(f,i,o)?Go(f):Dr(0);let p=(l.left+g.x)/s.x,d=(l.top+g.y)/s.y,h=l.width/s.x,L=l.height/s.y;if(f){const _=sr(f),x=o&&hr(o)?sr(o):o;let T=_,b=Qi(T);for(;b&&o&&x!==T;){const M=dn(b),R=b.getBoundingClientRect(),k=gr(b),j=R.left+(b.clientLeft+parseFloat(k.paddingLeft))*M.x,N=R.top+(b.clientTop+parseFloat(k.paddingTop))*M.y;p*=M.x,d*=M.y,h*=M.x,L*=M.y,p+=j,d+=N,T=sr(b),b=Qi(T)}}return jo({width:h,height:L,x:p,y:d})}function Im(e){let{elements:r,rect:i,offsetParent:o,strategy:l}=e;const f=l==="fixed",s=yr(o),g=r?di(r.floating):!1;if(o===s||g&&f)return i;let p={scrollLeft:0,scrollTop:0},d=Dr(1);const h=Dr(0),L=_r(o);if((L||!L&&!f)&&((hn(o)!=="body"||Dn(s))&&(p=fi(o)),_r(o))){const _=Gr(o);d=dn(o),h.x=_.x+o.clientLeft,h.y=_.y+o.clientTop}return{width:i.width*d.x,height:i.height*d.y,x:i.x*d.x-p.scrollLeft*d.x+h.x,y:i.y*d.y-p.scrollTop*d.y+h.y}}function Pm(e){return Array.from(e.getClientRects())}function ea(e,r){const i=fi(e).scrollLeft;return r?r.left+i:Gr(yr(e)).left+i}function Om(e){const r=yr(e),i=fi(e),o=e.ownerDocument.body,l=cn(r.scrollWidth,r.clientWidth,o.scrollWidth,o.clientWidth),f=cn(r.scrollHeight,r.clientHeight,o.scrollHeight,o.clientHeight);let s=-i.scrollLeft+ea(e);const g=-i.scrollTop;return gr(o).direction==="rtl"&&(s+=cn(r.clientWidth,o.clientWidth)-l),{width:l,height:f,x:s,y:g}}function Fm(e,r){const i=sr(e),o=yr(e),l=i.visualViewport;let f=o.clientWidth,s=o.clientHeight,g=0,p=0;if(l){f=l.width,s=l.height;const d=ga();(!d||d&&r==="fixed")&&(g=l.offsetLeft,p=l.offsetTop)}return{width:f,height:s,x:g,y:p}}function Nm(e,r){const i=Gr(e,!0,r==="fixed"),o=i.top+e.clientTop,l=i.left+e.clientLeft,f=_r(e)?dn(e):Dr(1),s=e.clientWidth*f.x,g=e.clientHeight*f.y,p=l*f.x,d=o*f.y;return{width:s,height:g,x:p,y:d}}function Ts(e,r,i){let o;if(r==="viewport")o=Fm(e,i);else if(r==="document")o=Om(yr(e));else if(hr(r))o=Nm(r,i);else{const l=Go(e);o={...r,x:r.x-l.x,y:r.y-l.y}}return jo(o)}function $o(e,r){const i=Ir(e);return i===r||!hr(i)||fn(i)?!1:gr(i).position==="fixed"||$o(i,r)}function Ym(e,r){const i=r.get(e);if(i)return i;let o=kn(e,[],!1).filter(g=>hr(g)&&hn(g)!=="body"),l=null;const f=gr(e).position==="fixed";let s=f?Ir(e):e;for(;hr(s)&&!fn(s);){const g=gr(s),p=ha(s);!p&&g.position==="fixed"&&(l=null),(f?!p&&!l:!p&&g.position==="static"&&!!l&&["absolute","fixed"].includes(l.position)||Dn(s)&&!p&&$o(e,s))?o=o.filter(h=>h!==s):l=g,s=Ir(s)}return r.set(e,o),o}function Bm(e){let{element:r,boundary:i,rootBoundary:o,strategy:l}=e;const s=[...i==="clippingAncestors"?di(r)?[]:Ym(r,this._c):[].concat(i),o],g=s[0],p=s.reduce((d,h)=>{const L=Ts(r,h,l);return d.top=cn(L.top,d.top),d.right=Zi(L.right,d.right),d.bottom=Zi(L.bottom,d.bottom),d.left=cn(L.left,d.left),d},Ts(r,g,l));return{width:p.right-p.left,height:p.bottom-p.top,x:p.left,y:p.top}}function jm(e){const{width:r,height:i}=zo(e);return{width:r,height:i}}function Hm(e,r,i){const o=_r(r),l=yr(r),f=i==="fixed",s=Gr(e,!0,f,r);let g={scrollLeft:0,scrollTop:0};const p=Dr(0);if(o||!o&&!f)if((hn(r)!=="body"||Dn(l))&&(g=fi(r)),o){const x=Gr(r,!0,f,r);p.x=x.x+r.clientLeft,p.y=x.y+r.clientTop}else l&&(p.x=ea(l));let d=0,h=0;if(l&&!o&&!f){const x=l.getBoundingClientRect();h=x.top+g.scrollTop,d=x.left+g.scrollLeft-ea(l,x)}const L=s.left+g.scrollLeft-p.x-d,_=s.top+g.scrollTop-p.y-h;return{x:L,y:_,width:s.width,height:s.height}}function Ii(e){return gr(e).position==="static"}function ws(e,r){if(!_r(e)||gr(e).position==="fixed")return null;if(r)return r(e);let i=e.offsetParent;return yr(e)===i&&(i=i.ownerDocument.body),i}function Vo(e,r){const i=sr(e);if(di(e))return i;if(!_r(e)){let l=Ir(e);for(;l&&!fn(l);){if(hr(l)&&!Ii(l))return l;l=Ir(l)}return i}let o=ws(e,r);for(;o&&Am(o)&&Ii(o);)o=ws(o,r);return o&&fn(o)&&Ii(o)&&!ha(o)?i:o||Rm(e)||i}const Um=async function(e){const r=this.getOffsetParent||Vo,i=this.getDimensions,o=await i(e.floating);return{reference:Hm(e.reference,await r(e.floating),e.strategy),floating:{x:0,y:0,width:o.width,height:o.height}}};function zm(e){return gr(e).direction==="rtl"}const Gm={convertOffsetParentRelativeRectToViewportRelativeRect:Im,getDocumentElement:yr,getClippingRect:Bm,getOffsetParent:Vo,getElementRects:Um,getClientRects:Pm,getDimensions:jm,getScale:dn,isElement:hr,isRTL:zm};function $m(e,r){let i=null,o;const l=yr(e);function f(){var g;clearTimeout(o),(g=i)==null||g.disconnect(),i=null}function s(g,p){g===void 0&&(g=!1),p===void 0&&(p=1),f();const{left:d,top:h,width:L,height:_}=e.getBoundingClientRect();if(g||r(),!L||!_)return;const x=Gn(h),T=Gn(l.clientWidth-(d+L)),b=Gn(l.clientHeight-(h+_)),M=Gn(d),k={rootMargin:-x+"px "+-T+"px "+-b+"px "+-M+"px",threshold:cn(0,Zi(1,p))||1};let j=!0;function N(H){const G=H[0].intersectionRatio;if(G!==p){if(!j)return s();G?s(!1,G):o=setTimeout(()=>{s(!1,1e-7)},1e3)}j=!1}try{i=new IntersectionObserver(N,{...k,root:l.ownerDocument})}catch{i=new IntersectionObserver(N,k)}i.observe(e)}return s(!0),f}function Vm(e,r,i,o){o===void 0&&(o={});const{ancestorScroll:l=!0,ancestorResize:f=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:g=typeof IntersectionObserver=="function",animationFrame:p=!1}=o,d=ma(e),h=l||f?[...d?kn(d):[],...kn(r)]:[];h.forEach(R=>{l&&R.addEventListener("scroll",i,{passive:!0}),f&&R.addEventListener("resize",i)});const L=d&&g?$m(d,i):null;let _=-1,x=null;s&&(x=new ResizeObserver(R=>{let[k]=R;k&&k.target===d&&x&&(x.unobserve(r),cancelAnimationFrame(_),_=requestAnimationFrame(()=>{var j;(j=x)==null||j.observe(r)})),i()}),d&&!p&&x.observe(d),x.observe(r));let T,b=p?Gr(e):null;p&&M();function M(){const R=Gr(e);b&&(R.x!==b.x||R.y!==b.y||R.width!==b.width||R.height!==b.height)&&i(),b=R,T=requestAnimationFrame(M)}return i(),()=>{var R;h.forEach(k=>{l&&k.removeEventListener("scroll",i),f&&k.removeEventListener("resize",i)}),L==null||L(),(R=x)==null||R.disconnect(),x=null,p&&cancelAnimationFrame(T)}}const Wm=km,Km=(e,r,i)=>{const o=new Map,l={platform:Gm,...i},f={...l.platform,_c:o};return Mm(e,r,{...l,platform:f})};var Zn=typeof document<"u"?I.useLayoutEffect:I.useEffect;function ai(e,r){if(e===r)return!0;if(typeof e!=typeof r)return!1;if(typeof e=="function"&&e.toString()===r.toString())return!0;let i,o,l;if(e&&r&&typeof e=="object"){if(Array.isArray(e)){if(i=e.length,i!==r.length)return!1;for(o=i;o--!==0;)if(!ai(e[o],r[o]))return!1;return!0}if(l=Object.keys(e),i=l.length,i!==Object.keys(r).length)return!1;for(o=i;o--!==0;)if(!{}.hasOwnProperty.call(r,l[o]))return!1;for(o=i;o--!==0;){const f=l[o];if(!(f==="_owner"&&e.$$typeof)&&!ai(e[f],r[f]))return!1}return!0}return e!==e&&r!==r}function Wo(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Ms(e,r){const i=Wo(e);return Math.round(r*i)/i}function Pi(e){const r=I.useRef(e);return Zn(()=>{r.current=e}),r}function Xm(e){e===void 0&&(e={});const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:l,elements:{reference:f,floating:s}={},transform:g=!0,whileElementsMounted:p,open:d}=e,[h,L]=I.useState({x:0,y:0,strategy:i,placement:r,middlewareData:{},isPositioned:!1}),[_,x]=I.useState(o);ai(_,o)||x(o);const[T,b]=I.useState(null),[M,R]=I.useState(null),k=I.useCallback(fe=>{fe!==G.current&&(G.current=fe,b(fe))},[]),j=I.useCallback(fe=>{fe!==V.current&&(V.current=fe,R(fe))},[]),N=f||T,H=s||M,G=I.useRef(null),V=I.useRef(null),J=I.useRef(h),Z=p!=null,ee=Pi(p),ge=Pi(l),pe=Pi(d),Ee=I.useCallback(()=>{if(!G.current||!V.current)return;const fe={placement:r,strategy:i,middleware:_};ge.current&&(fe.platform=ge.current),Km(G.current,V.current,fe).then(xe=>{const we={...xe,isPositioned:pe.current!==!1};be.current&&!ai(J.current,we)&&(J.current=we,Cs.flushSync(()=>{L(we)}))})},[_,r,i,ge,pe]);Zn(()=>{d===!1&&J.current.isPositioned&&(J.current.isPositioned=!1,L(fe=>({...fe,isPositioned:!1})))},[d]);const be=I.useRef(!1);Zn(()=>(be.current=!0,()=>{be.current=!1}),[]),Zn(()=>{if(N&&(G.current=N),H&&(V.current=H),N&&H){if(ee.current)return ee.current(N,H,Ee);Ee()}},[N,H,Ee,ee,Z]);const Me=I.useMemo(()=>({reference:G,floating:V,setReference:k,setFloating:j}),[k,j]),ce=I.useMemo(()=>({reference:N,floating:H}),[N,H]),ve=I.useMemo(()=>{const fe={position:i,left:0,top:0};if(!ce.floating)return fe;const xe=Ms(ce.floating,h.x),we=Ms(ce.floating,h.y);return g?{...fe,transform:"translate("+xe+"px, "+we+"px)",...Wo(ce.floating)>=1.5&&{willChange:"transform"}}:{position:i,left:xe,top:we}},[i,g,ce.floating,h.x,h.y]);return I.useMemo(()=>({...h,update:Ee,refs:Me,elements:ce,floatingStyles:ve}),[h,Ee,Me,ce,ve])}const qm=(e,r)=>({...Wm(e),options:[e,r]});var Ko=typeof document<"u"?I.useLayoutEffect:I.useEffect;let Oi=!1,Jm=0;const Ls=()=>"floating-ui-"+Jm++;function Zm(){const[e,r]=I.useState(()=>Oi?Ls():void 0);return Ko(()=>{e==null&&r(Ls())},[]),I.useEffect(()=>{Oi||(Oi=!0)},[]),e}const Qm=Ds.useId,ep=Qm||Zm;function tp(){const e=new Map;return{emit(r,i){var o;(o=e.get(r))==null||o.forEach(l=>l(i))},on(r,i){e.set(r,[...e.get(r)||[],i])},off(r,i){var o;e.set(r,((o=e.get(r))==null?void 0:o.filter(l=>l!==i))||[])}}}const rp=I.createContext(null),np=()=>I.useContext(rp);function ip(e){return(e==null?void 0:e.ownerDocument)||document}function ap(e){return ip(e).defaultView||window}function $n(e){return e?e instanceof Element||e instanceof ap(e).Element:!1}const sp=Ds.useInsertionEffect,op=sp||(e=>e());function lp(e){const r=I.useRef(()=>{});return op(()=>{r.current=e}),I.useCallback(function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return r.current==null?void 0:r.current(...o)},[])}function up(e){var r;e===void 0&&(e={});const{open:i=!1,onOpenChange:o,nodeId:l}=e,[f,s]=I.useState(null),g=((r=e.elements)==null?void 0:r.reference)||f,p=Xm(e),d=np(),h=lp((N,H)=>{N&&(_.current.openEvent=H),o==null||o(N,H)}),L=I.useRef(null),_=I.useRef({}),x=I.useState(()=>tp())[0],T=ep(),b=I.useCallback(N=>{const H=$n(N)?{getBoundingClientRect:()=>N.getBoundingClientRect(),contextElement:N}:N;p.refs.setReference(H)},[p.refs]),M=I.useCallback(N=>{($n(N)||N===null)&&(L.current=N,s(N)),($n(p.refs.reference.current)||p.refs.reference.current===null||N!==null&&!$n(N))&&p.refs.setReference(N)},[p.refs]),R=I.useMemo(()=>({...p.refs,setReference:M,setPositionReference:b,domReference:L}),[p.refs,M,b]),k=I.useMemo(()=>({...p.elements,domReference:g}),[p.elements,g]),j=I.useMemo(()=>({...p,refs:R,elements:k,dataRef:_,nodeId:l,floatingId:T,events:x,open:i,onOpenChange:h}),[p,l,T,x,i,h,R,k]);return Ko(()=>{const N=d==null?void 0:d.nodesRef.current.find(H=>H.id===l);N&&(N.context=j)}),I.useMemo(()=>({...p,context:j,refs:R,elements:k}),[p,R,k,j])}const cp=({triggerElementRef:e,actionData:r})=>{const{overlayOffset:i=0,overlayPlacement:o,overlayBorder:l,overlayBackgroundColor:f,overlayWidth:s,overlayHeight:g,overlayAttachedSubpage:p,overlayAttachedSubpageName:d,showMask:h,overlayBackgroundBlur:L,overlayMaskBackgroundColor:_}=r||{},{refs:x,floatingStyles:T}=up({elements:{reference:e==null?void 0:e.current},open:!!r,placement:o,middleware:[qm(i)],strategy:"fixed",whileElementsMounted:Vm}),b={WebkitBackdropFilter:`blur(${L}px)`,backdropFilter:`blur(${L}px)`,backgroundColor:_};return D.jsxs(D.Fragment,{children:[h&&D.jsx(Fo,{style:{...b}}),D.jsx("div",{ref:x.setFloating,style:{position:"fixed",zIndex:1e3,...T},children:D.jsx(Yo,{overlayPlacement:o,absoluteCentering:!1,overlayBorder:l,overlayBackgroundColor:f,overlayWidth:s,overlayHeight:g,overlayAttachedSubpage:p,overlayAttachedSubpageName:d})})]})},dp=et.memo(()=>{const e=sn(T=>T.visibleOverlayData),{triggerElementRef:r,actionData:i}=e||{},{anyClickClose:o,outsideClose:l,useOverlayTimer:f,overlayTimer:s=0,showMask:g,overlayBackgroundBlur:p=0,overlayPlacement:d="fullscreen"}=i||{},h=d==="fullscreen",L=Lt(T=>T.envState),{pageId:_}=An();I.useEffect(()=>{const{setVisibleOverlayData:T,visibleOverlayData:b}=sn.getState();b&&(console.log("Overlay reset, envstate or pageId changed"),T(null))},[L,_]),I.useEffect(()=>{const T=sn.getState().setVisibleOverlayData,b=document.getElementById("GuiMainContainer");function M(R){var j,N;if(o&&!((j=r==null?void 0:r.current)!=null&&j.contains(R.target))){T(null);return}const k=document.getElementById("overlayInnerContent");l&&!(k!=null&&k.contains(R.target))&&!((N=r==null?void 0:r.current)!=null&&N.contains(R.target))&&((g||p>0)&&(R.stopPropagation(),R.preventDefault()),T(null))}if(b&&(l||o))return b.addEventListener("pointerdown",M),()=>{b.removeEventListener("pointerdown",M)}},[o,l,p,g,r]);const x=I.useRef();if(I.useEffect(()=>{function T(){console.log("closed by timeout");const k=sn.getState().setVisibleOverlayData;k(null)}const b=()=>{x.current&&clearTimeout(x.current)},M=()=>{x.current=setTimeout(T,s*1e3)},R=document.getElementById("overlayInnerContent");return f&&R&&(x.current=setTimeout(T,s*1e3),R.addEventListener("pointerdown",b),R.addEventListener("pointerup",M)),()=>{x.current&&clearTimeout(x.current),R==null||R.removeEventListener("pointerdown",b),R==null||R.removeEventListener("pointerup",M)}},[s,f]),e&&i){if(h)return D.jsx(Sm,{actionData:i});if(i&&r)return D.jsx(cp,{actionData:i,triggerElementRef:r})}return null}),ta=e=>typeof e!="object"||e===null?e:Array.isArray(e)?e.map(ta):Object.fromEntries(Object.entries(e).filter(([,r])=>r!==void 0).map(([r,i])=>[r,ta(i)])),fp=et.memo(({pages:e})=>{nc();const r=Ps(),{setVariableNewValue:i}=zr.getState(),o=Lt(q=>q.envState),l=Lt(q=>q.dynamicBg),f=Lt.getState().updateEnvStore,[s,g]=Uu();I.useEffect(()=>{if(o!=="live")return;const q=s.get("token");q&&(zu(q),g({}))},[o,s,g]);const p=$t(q=>{var oe;return(oe=q.workingProject)==null?void 0:oe.attributes.variables}),d=$t(q=>{var oe;return((oe=q.workingProject)==null?void 0:oe.attributes.customCss)??""}),h=zr(q=>q.calculatedVariables),L=I.useRef(new Map([])),_=I.useMemo(()=>{const q=(p==null?void 0:p.filter(ae=>{var Re;return(Re=ae==null?void 0:ae.actions)==null?void 0:Re.length}))??[],oe=new Map([]);if(q.length)for(const ae of q)oe.set(ae.name,ae==null?void 0:ae.actions);return oe},[p]),x=Ku({actions:_});I.useEffect(()=>{x&&x.forEach((q,oe)=>{const ae=h.find(De=>De.name===oe);if(!ae)return;const{defaultValue:Re,currentValue:Ce}=ae,ke=Ce===void 0?Re:Ce;if(L.current.has(oe)){if(ke!==L.current.get(oe)){const De=(q==null?void 0:q.onChangeActions)??[];for(const Ne of De)Ne(ke);L.current.set(oe,ke)}}else L.current.set(oe,ke)})},[h,x]);const T=pt(q=>q.isSubpageEditor),{ref:b,width:M,height:R}=To();I.useEffect(()=>{if(o==="live"||o==="preview"){const q=oe=>{oe.preventDefault()};return document.addEventListener("contextmenu",q),()=>{document.removeEventListener("contextmenu",q)}}},[o]),I.useEffect(()=>{let q=null;M&&R&&(q=M>R),f({guiFrameWidth:M,guiFrameHeight:R,isLandscape:q})},[R,M,f]);const k=$t(q=>{var oe;return(oe=q.workingProject)==null?void 0:oe.attributes.background}),j=$t(q=>{var oe;return(oe=q.workingProject)==null?void 0:oe.attributes.theme.data.attributes}),N=$t(q=>{var oe;return ta(((oe=q.workingProject)==null?void 0:oe.attributes.themeOverrides)??{})}),{backgroundColor:H,backgroundImageStyles:G}=ua({background:k})||{};let V;try{V={...j,...N,colors:{...j==null?void 0:j.colors,...N==null?void 0:N.colors}}}catch(q){Rs.warning("No Theme Attached to Project"),console.log(q)}I.useEffect(()=>{const q=setTimeout(()=>{f({dynamicBg:null})},1e3);return()=>clearTimeout(q)},[l,f]);const{analogPageFlip_signal_a_fb:J,serialPageFlip_signal_s_fb:Z,notification_signal_s_fb:ee,refreshSingleDataSource_signal_s_fb:ge}=$t(q=>{var oe;return((oe=q.workingProject)==null?void 0:oe.attributes.globalJoins)??{}}),pe=or({signalName:ee}),Ee=or({signalName:Z}),be=or({signalName:ge});I.useEffect(()=>{be&&(console.log("DS updating ",be),lc(be).then(q=>{console.log("DS updated ",be,q);const oe=new Date().toISOString();i({name:"datasetUpdated",currentValue:oe})}))},[be]);const Me=Hr(J),ce=document.getElementsByClassName("toasterContainer");I.useEffect(()=>{pe&&(ce!=null&&ce[0])&&gm(pe)},[pe,ce==null?void 0:ce[0]]),I.useEffect(()=>{var q;if(Me){console.log("analogPageFlipFeedBack: ",Me);const oe=(q=$t.getState().workingProject)==null?void 0:q.attributes.pages.data,ae=oe==null?void 0:oe.find(Re=>{var Ce;return((Ce=Re.attributes.pageFlips)==null?void 0:Ce.analogPageFlipValue)===Me});if(ae){const Re=Ni(ae.attributes.name);Va({navigate:r,url:Re})}else console.info("No target page found for analog page flip")}},[Me,r]),I.useEffect(()=>{var q;if(Ee){console.log("serialPageFlipFeedBack: ",Ee);const oe=(q=$t.getState().workingProject)==null?void 0:q.attributes.pages.data;if(oe==null?void 0:oe.some(Re=>Re.attributes.name===Ee)){const Re=Ni(Ee);Va({navigate:r,url:Re})}else console.info("No target page found for serial page flip")}},[r,Ee]);const ve=sn(q=>q.visibleOverlayData),{overlayBackgroundBlur:fe,showMask:xe,overlayMaskBackgroundColor:we}=(ve==null?void 0:ve.actionData)??{},ye=nt({showMask:!!xe,isOverlayOpen:!!ve});return o&&V?D.jsx(Pu,{theme:V,children:D.jsxs(pc,{className:ye,ref:b,id:"GuiMainContainer",style:{backgroundColor:H||(j==null?void 0:j.backgroundColor),"--mask-bg-color":xe?we:"transparent","--overlay-background-blur":fe+"px"},inlineStyles:d+V.css,children:[D.jsx("div",{id:"ProjectBackgroundImage",style:{...G}}),D.jsx("div",{id:"PageBackgroundColor",className:"PageBackgroundColor"}),D.jsx("div",{id:"PageBackgroundImage",className:"PageBackgroundImage"}),D.jsx(vc,{dynamicBg:l}),D.jsxs(_c,{className:"page",children:[!T&&D.jsx(xg,{}),D.jsx("div",{className:"content",children:o==="build"||o==="live"?D.jsx(Gu,{}):D.jsx(li,{data:e==null?void 0:e[0]})})]}),D.jsx(dp,{}),D.jsx(hm,{containerClassName:"toasterContainer",position:"top-right",containerStyle:{position:"absolute",width:"calc(100% - 20px)",height:"calc(100% - 20px)",left:10,top:10}})]})}):null});fp.displayName="GuiBox";export{fp as G,Ct as H,li as P,dc as R,Yh as d,Md as k,vg as u};
