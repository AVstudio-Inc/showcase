"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[8827],{33490:(e,t,a)=>{a.d(t,{c:()=>l});var n=a(36373),r=a(41397);const l=(0,n.h)(((e,t)=>({calculatedVariables:[],setInitialVariablesArray:t=>e((()=>({calculatedVariables:t}))),setVariableNewValue:a=>{let{name:n,currentValue:r}=a;console.log("setVariableNewValue",n,r);let l=structuredClone(t().calculatedVariables);if(void 0===n||void 0===r)return void console.log("Variable name or currentValue is undefined");const i=l.findIndex((e=>e.name===n));if(i<0)return void console.log("Variable not found, update error");let o;if(o=void 0!==l[i].currentValue?l[i].currentValue:l[i].defaultValue,"boolean"===l[i].type)switch(r){case"true":case!0:o=!0;break;case"false":case!1:o=!1;break;case"toggle":o=!o}else o=r;return l[i].currentValue!==o&&(l[i]={...l[i],currentValue:o}),e((()=>({calculatedVariables:l})))}})),r.isEqual)},68513:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(44719);const r=e=>n.A.confirm({zIndex:3e3,...e})},83063:(e,t,a)=>{a.d(t,{A:()=>m});var n=a(84649),r=a(48538),l=a(77645),i=a(56952),o=a(92759),s=a(12916),c=a(9950),u=a(2260),d=a(41967),v=a(57560),f=a(24513),p=a(44414);const g=e=>{let{initialValue:t,saveInProgress:a,setIsEditing:o,setSaveInProgress:s,save:f,style:g}=e;const[m,b]=(0,c.useState)(t);switch(typeof t){case"boolean":return(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1em",...g},children:[a&&(0,p.jsx)(u.A,{}),(0,p.jsx)(n.A,{onChange:e=>{b("true"===e)},value:m?"true":"false",options:["true","false"]}),(0,p.jsxs)("div",{style:{display:"flex"},children:[(0,p.jsx)(r.A,{style:{marginRight:2},type:"dashed",children:(0,p.jsx)(d.A,{onClick:()=>f(m),style:{color:"var(--ant-primary-5)"}})}),(0,p.jsx)(r.A,{onClick:()=>{o(!1),s(!1)},type:"dashed",children:(0,p.jsx)(v.A,{style:{color:"gray"}})})]})]});case"string":return(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1em",...g},children:[a&&(0,p.jsx)(u.A,{}),(0,p.jsx)(l.A,{spellCheck:!1,autoFocus:!0,onPressEnter:()=>f(m),onBlur:()=>f(m),onChange:e=>{e.stopPropagation(),b(e.target.value)},value:m})]});case"number":case"object":return(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1em",...g},children:[a&&(0,p.jsx)(u.A,{}),(0,p.jsx)(i.A,{style:{width:"100%"},autoFocus:!0,onPressEnter:()=>f(m),onBlur:()=>f(m),onChange:e=>b(e),value:m})]});default:return null}},m=e=>{let{value:t,onChange:a,initialValue:n,validators:r,style:l}=e;const[i,u]=(0,c.useState)(!1),[d,v]=(0,c.useState)(!1);function m(e){v(!0),a(e).then((()=>{u(!1),v(!1)}))}return(0,c.useEffect)((()=>{const e=e=>{27===e.keyCode&&u(!1)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[n]),i?(0,p.jsx)(g,{initialValue:n,saveInProgress:d,setIsEditing:u,setSaveInProgress:v,save:function(e){if(e===n)return u(!1),void v(!1);if(null!==r&&void 0!==r&&r.length){let t=[];return r.forEach((a=>{t.push(a(e))})),Promise.all(t).then((()=>{m(e)})).catch((e=>{o.Ay.error(e.message)}))}m(e)},style:l}):(0,p.jsxs)("div",{style:{...l},children:["boolean"===typeof t?(0,p.jsx)(s.A,{style:{padding:"3px",lineHeight:"1em"},color:t?"green":"red",children:t?"true":"false"}):t,(0,p.jsx)(f.A,{style:{marginLeft:"0.3em",color:"var(--ant-primary-5)"},onClick:()=>{u(!0)}})]})}},7985:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(12916),r=a(44414);const l=e=>{let{type:t,style:a,sub:l,crestronLikeTypesNaming:i=!0}=e,o="",s=t;switch(t){case"d":case"boolean":o="blue",s="d";break;case"s":case"string":o="purple",s="s";break;case"a":case"number":o="orange",s="a";break;case"r":o="cyan";break;case"v":o="magenta";break;case"o":case"co":o="lime";break;default:o=""}let c=i?s:t;return c="co"===c?"close":c,(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.A,{color:o,style:{fontSize:10,padding:"2px 3px",lineHeight:"10px",marginLeft:5,minWidth:15,textAlign:"center",textTransform:"lowercase",...a},children:c}),l&&(0,r.jsx)(n.A,{style:{fontSize:10,padding:"2px 3px",lineHeight:"10px",minWidth:18,textAlign:"center",textTransform:"lowercase",...a,marginLeft:5},children:l})]})}},9418:(e,t,a)=>{a.d(t,{I7:()=>s,N6:()=>p,Pb:()=>v,S1:()=>c,aM:()=>u,l4:()=>f,rz:()=>d});var n=a(92759),r=a(48362),l=a(64983),i=a(33490),o=a(9950);async function s(e){var t;let{updatedVariable:a,projectId:i,pageId:o}=e;const s=null===(t=l.f.getState().workingProject)||void 0===t?void 0:t.attributes.variables;return new Promise((async function(e,t){let l=structuredClone(s);if(!l)return t("Variables are empty"),null;const o=null===l||void 0===l?void 0:l.findIndex((e=>e.name===a.name));return o<0?(t("No variable found by index"),null):(l[o]=a,i?(0,r.Qx)({projectId:i,inputData:{variables:l}}).then((()=>e("Ok"))).catch((e=>{var a,r;return"ValidationError"===(null===(a=e.response.data)||void 0===a||null===(r=a.error)||void 0===r?void 0:r.name)&&n.Ay.error("Name must be unique"),t(e)})):void t("No projectId"))}))}async function c(e){var t;let{variableName:a,projectId:n,pageId:i}=e;const o=null===(t=l.f.getState().workingProject)||void 0===t?void 0:t.attributes.variables;return new Promise((async function(e,t){let l=structuredClone(o);if(!l)return t("variables are empty"),null;l=i&&void 0!==i?l.filter((e=>e.pageId!==i||e.name!==a)):l.filter((e=>e.name!==a)),n?(0,r.Qx)({projectId:n,inputData:{variables:l}}).then((()=>{e("Ok")})).catch((e=>t(e))):t("No projectId")}))}async function u(e){var t;let{projectId:a,pageId:n}=e;const i=null===(t=l.f.getState().workingProject)||void 0===t?void 0:t.attributes.variables;return new Promise((async function(e,t){let l=structuredClone(i);if(!l)return t("variables are empty"),null;l=l.filter((e=>e.pageId!==n)),a?(0,r.Qx)({projectId:a,inputData:{variables:l}}).catch((e=>t(e))):t("No projectId")}))}async function d(e){let{newVariable:t,projectId:a}=e;const{workingProject:n}=l.f.getState();return new Promise((async function(e,l){if(!a)return void l("No projectId");if(!n)return void l("No workingProject");const i=n.attributes.variables;let o=structuredClone(i)||[];o=[...o,t],console.log(o),(0,r.Qx)({projectId:a,inputData:{variables:o}}).then((()=>e("Ok"))).catch((e=>l(e)))}))}function v(e){var t;const a=null===(t=l.f.getState().workingProject)||void 0===t?void 0:t.attributes.variables;return null===a||void 0===a?void 0:a.find((t=>t.name===e))}function f(e){const t=i.c.getState().calculatedVariables;return null===t||void 0===t?void 0:t.find((t=>t.name===e))}function p(e){const t=(0,i.c)((e=>e.calculatedVariables));let a=(0,o.useMemo)((()=>null===t||void 0===t?void 0:t.find((t=>t.name===e))),[t,e]);if(void 0===a)return;const{currentValue:n,defaultValue:r}=a;return{calculatedValue:void 0===n||""===n?r:n,targetVariable:a}}},8827:(e,t,a)=>{a.r(t),a.d(t,{default:()=>w});var n=a(22718),r=a(70171),l=a(92759),i=a(72429),o=a(35492),s=a(48538),c=a(9950),u=a(98485),d=a(2260),v=a(44070),f=a(28429),p=a(83063),g=a(68513),m=a(27379),b=a(27911),y=a(9418),x=a(7985),h=a(64983),j=a(44414);const V=(0,c.lazy)((()=>Promise.all([a.e(841),a.e(7926),a.e(5490),a.e(3072),a.e(6182),a.e(4169),a.e(5428)]).then(a.bind(a,75428)))),{Title:A}=n.A,I=[{title:"Name",dataIndex:"name"},{title:"Type",dataIndex:"type"},{title:"Default Value",dataIndex:"defaultValue"},{title:"Signal FB Setter",dataIndex:"joinValueSetter_signal_fb"},{title:(0,j.jsxs)(j.Fragment,{children:["Side Effect Actions",(0,j.jsx)(r.A,{placement:"top",title:"Variables reactivity",content:(0,j.jsx)("div",{style:{width:"250px"},children:"Run actions when variable value has been changed."}),trigger:"hover",children:(0,j.jsx)(u.A,{style:{marginLeft:7}})})]}),dataIndex:"sideEffects",className:"sideEffectsCell"},{title:"Controls",dataIndex:"controls",width:100}],w=()=>{const{setNewVariableModalVisible:e}=(0,f.KC)(),t=(0,h.f)((e=>e.workingProject)),{projectId:a}=(0,f.g)(),[n,r]=(0,c.useState)(null),u=(0,c.useCallback)((e=>{let{data:t}=e;switch(t.type){case"string":case"number":case"boolean":return(0,j.jsx)(p.A,{onChange:e=>(0,y.I7)({projectId:a,updatedVariable:{...t,defaultValue:e}}),initialValue:t.defaultValue,value:t.defaultValue});default:return null}}),[a]);return(0,c.useEffect)((()=>{var e;const n=(null===t||void 0===t||null===(e=t.attributes.variables)||void 0===e?void 0:e.filter((e=>void 0===e.pageId)))||[];if(n&&void 0!==n){let e=[];n.forEach((t=>{var n;e.push({key:"variable_"+t.name,name:t.name,type:(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(x.A,{crestronLikeTypesNaming:!1,style:{margin:1},type:t.type,sub:"boolean"===t.type&&null!==t&&void 0!==t&&t.waitForLoadingUi?" ui loader":""})}),defaultValue:(0,j.jsx)(u,{data:t}),joinValueSetter_signal_fb:(0,j.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,j.jsx)(x.A,{style:{margin:1},type:t.type,sub:"FB"}),(0,j.jsx)(p.A,{style:{marginLeft:".5em"},onChange:e=>(0,y.I7)({projectId:a,updatedVariable:{...t,joinValueSetter_signal_fb:e}}),initialValue:t.joinValueSetter_signal_fb,value:t.joinValueSetter_signal_fb,validators:[e=>(0,b.fp)(e).catch((e=>(l.Ay.error(e.message),Promise.reject())))]})]}),sideEffects:(0,j.jsx)(c.Suspense,{fallback:(0,j.jsx)(d.A,{}),children:(0,j.jsx)(V,{actionsArr:null!==(n=null===t||void 0===t?void 0:t.actions)&&void 0!==n?n:[],elementType:"variable",variableActionFor:t})}),controls:(0,j.jsx)(i.A.Button,{menu:{items:[{key:"removeVariable",danger:!0,icon:(0,j.jsx)(v.A,{}),label:"Delete Variable",onClick:()=>(0,g.A)({title:"Delete Variable?",icon:(0,j.jsx)(m.A,{}),content:"Are you sure? It cannot be undone.",okText:"Delete Variable",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>(0,y.S1)({variableName:t.name,projectId:a}),onCancel:()=>console.log("cancel variable delete")})}]}})})})),r(e)}}),[u,a,t]),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(A,{id:"Variables",style:{margin:"15px 0"},level:5,children:"Variables"}),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(o.A,{columns:I,dataSource:n||[],pagination:!1}),(0,j.jsx)(s.A,{style:{marginTop:15},type:"primary",onClick:()=>e(!0),children:"Create Variable"},"submit")]})]})}},44070:(e,t,a)=>{a.d(t,{A:()=>s});var n=a(89379),r=a(9950);const l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};var i=a(25085),o=function(e,t){return r.createElement(i.A,(0,n.A)((0,n.A)({},e),{},{ref:t,icon:l}))};const s=r.forwardRef(o)},70171:(e,t,a)=>{a.d(t,{A:()=>d});var n=a(58168),r=a(9950),l=function(e){return e?"function"===typeof e?e():e:null},i=a(49437),o=a(5741),s=a(81541),c=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(a[n[r]]=e[n[r]])}return a},u=function(e){var t=e.title,a=e.content,n=e.prefixCls;return r.createElement(r.Fragment,null,t&&r.createElement("div",{className:"".concat(n,"-title")},l(t)),r.createElement("div",{className:"".concat(n,"-inner-content")},l(a)))};const d=r.forwardRef((function(e,t){var a=e.prefixCls,l=e.title,d=e.content,v=e._overlay,f=e.placement,p=void 0===f?"top":f,g=e.trigger,m=void 0===g?"hover":g,b=e.mouseEnterDelay,y=void 0===b?.1:b,x=e.mouseLeaveDelay,h=void 0===x?.1:x,j=e.overlayStyle,V=void 0===j?{}:j,A=c(e,["prefixCls","title","content","_overlay","placement","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle"]),I=r.useContext(o.QO).getPrefixCls,w=I("popover",a),k=I(),C=r.useMemo((function(){return v||(l||d?r.createElement(u,{prefixCls:w,title:l,content:d}):null)}),[v,l,d,w]);return r.createElement(s.A,(0,n.A)({placement:p,trigger:m,mouseEnterDelay:y,mouseLeaveDelay:h,overlayStyle:V},A,{prefixCls:w,ref:t,overlay:C,transitionName:(0,i.by)(k,"zoom-big",A.transitionName)}))}))}}]);