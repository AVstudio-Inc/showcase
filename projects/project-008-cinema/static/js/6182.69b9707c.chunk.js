(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[6182],{57783:(t,e,i)=>{"use strict";i.d(e,{B:()=>r});const r=(0,i(19458).vt)(((t,e)=>({entries:[],addValueToStore:i=>{let{name:r,type:n,joinNumber:a,value:o,scope:l}=i;const d=structuredClone(e().entries);let u=-1,s=[t=>t.name===r,t=>t.type===n];l&&s.push((t=>t.scope===l)),a&&s.push((t=>t.joinNumber===a));u=d.findIndex((t=>s.every((e=>e(t))))),-1!==u?d[u].value!==o&&(d[u]={...d[u],value:o},t((()=>({entries:d})))):(d.push({name:r,type:n,value:o,joinNumber:a,scope:l}),t((()=>({entries:d})))),"s"===n&&a&&void 0!==a&&CrComLib.subscribeState("string",a.toString(),(i=>{let a=structuredClone(e().entries),o=t=>t.name===r&&t.type===n;if(l){let t=o;o=e=>t(e)&&e.scope===l}const d=a.find(o),u=a.findIndex(o);d&&-1!==u&&d.value!==i&&(d.value=i,a[u]={...a[u],value:i},t((()=>({entries:a}))))})),"a"===n&&a&&void 0!==a&&CrComLib.subscribeState("number",a.toString(),(i=>{let a=structuredClone(e().entries),o=t=>t.name===r&&t.type===n;if(l){let t=o;o=e=>t(e)&&e.scope===l}const d=a.find(o),u=a.findIndex(o);d&&-1!==u&&d.value!==i&&(d.value=i,a[u]={...a[u],value:i},t((()=>({entries:a}))))})),"d"===n&&a&&void 0!==a&&CrComLib.subscribeState("boolean",a.toString(),(i=>{let a=structuredClone(e().entries),o=t=>t.name===r&&t.type===n;if(l){let t=o;o=e=>t(e)&&e.scope===l}const d=a.find(o),u=a.findIndex(o);d&&-1!==u&&d.value!==i&&(d.value=i,a[u]={...a[u],value:i},t((()=>({entries:a}))))}))},getValueFromStore:(t,i,r)=>{var n;const a=e();let o=[e=>e.name===t];r&&o.push((t=>t.scope===r)),i&&o.push((t=>t.type===i));return null===(n=a.entries.find((t=>o.every((e=>e(t))))))||void 0===n?void 0:n.value},getScopeValuesFromStore:t=>{const i=e();return t?i.entries.filter((e=>e.scope===t)):[]}})))},3215:(t,e,i)=>{"use strict";i.d(e,{G:()=>l});var r=i(36373),n=i(11758),a=i(27623),o=i(41397);const l=(0,r.h)()((0,n.Zr)(((t,e)=>({current:[],setInitialDatasourceData:e=>t((()=>({current:e}))),addDatasourcesData:i=>{let r=structuredClone(e().current);if(void 0===i)return;if(null===r||0===r.length)return t((()=>({current:[i]})));const n=r.findIndex((t=>t.id===i.id&&t.hashedUrl===i.hashedUrl));return n<0?t((()=>({current:[...r,i]}))):(r[n].value!==i.value&&(r[n]={...r[n],value:i.value}),t((()=>({current:r}))))},updateOrCreateDatasourceData:i=>{let r=structuredClone(e().current);if(void 0===i)return;const n=r.findIndex((t=>t.uid===i.uid));return n<0?t((()=>({current:[...r,i]}))):(r[n]=i,t((()=>({current:r}))))}})),{name:"datasourceStore",storage:{getItem:a.Gq,setItem:a.SO,removeItem:a.Ai}}),o.isEqual)},44358:(t,e,i)=>{"use strict";i.d(e,{Al:()=>N,Cy:()=>V,Fd:()=>j,Fp:()=>W,I_:()=>O,MU:()=>B,Qo:()=>S,Re:()=>L,UN:()=>h,Yf:()=>J,Zd:()=>D,_J:()=>E,gy:()=>P,iT:()=>C,lT:()=>U,oo:()=>T,px:()=>w,t_:()=>F,uF:()=>q,wF:()=>k});var r=i(9418),n=i(41397),a=i(90841),o=i.n(a),l=i(18469),d=i(25879),u=i(64983),s=i(33490),c=i(3215),v=i(57783),f=i(9950);const{addValueToStore:p,getValueFromStore:b}=v.B.getState(),{setVariableNewValue:m}=s.c.getState(),h=()=>{let t=(s.c.getState().calculatedVariables||[]).map((t=>{let e=t.currentValue,i=t.defaultValue;return void 0===e&&(e=i),{[t.name]:e}}));return Object.assign({},...t)};function g(t,e){var i,r,n;const a=(null===(i=u.f.getState().workingProject)||void 0===i||null===(r=i.attributes)||void 0===r?void 0:r.variables)||[];return null===a||void 0===a||null===(n=a.find((e=>e.name===t)))||void 0===n?void 0:n.defaultValue}const y=(t,e)=>{const i=t.match(/const\s*(\w*)\s*=\s*\((.*)\)\s*=>/),r=t.match(/function\s*(\w*)\s*\(([^)]*)\)/);if(i){const r=i[2].split(",").map((t=>t.trim()));r.push(e),r.push("addValueToStore"),r.push("getValueFromStore"),r.push("setVariableNewValue");return t.replace("(".concat(i[2],")"),"(".concat(r.join(", "),")"))}if(r){const i=[...r[2].split(",").map((t=>t.trim())),e,"addValueToStore","getValueFromStore","setVariableNewValue"];return t.replace("(".concat(r[2],")"),"(".concat(i.join(", "),")"))}throw new Error("Invalid function string")},I=t=>{var e,i,r,n;const a=(null===(e=u.f.getState().workingProject)||void 0===e||null===(i=e.attributes)||void 0===i?void 0:i.variables)||[];let o=t.slice(1,-1),l=null===(r=a.find((t=>t.name===o)))||void 0===r?void 0:r.currentValue,d=null===(n=a.find((t=>t.name===o)))||void 0===n?void 0:n.defaultValue;return void 0===l?d:l};function V(t){let e=y(t,"variables"),i=o().transpile(e);return new Function("return ".concat(i))()}const O=(t,e,i,r)=>{let n=r;var a;e&&null!==i&&void 0!==i&&i.length&&(n=null===(a=i.find((t=>t.id===e)))||void 0===a?void 0:a.attributes.function);if(!n)return t;try{return V(n)(...t,h(),p,b,m)}catch(o){return t}},S=t=>{var e,i;return function(t,e){return t.replace(/{{(.+?)}}/g,((t,i)=>{var r;const n=e.find((t=>t.name===i.trim()));return n&&null!==(r=n.value)&&void 0!==r?r:t}))}(t,((null===(e=u.f.getState().workingProject)||void 0===e||null===(i=e.attributes)||void 0===i?void 0:i.variables)||[]).map((t=>{let e=t.currentValue,i=t.defaultValue;return void 0===e&&(e=i),{name:t.name,value:e}})))},j=async(t,e,i)=>new Promise((async(r,n)=>{let a="";let o=function(t){const e=t.match(/{{(.+?)}}/g);return e?e.map((t=>t.slice(2,-2).trim())):[]}(t);if(0===o.length)a=t;else{var d,s;let e=((null===(d=u.f.getState().workingProject)||void 0===d||null===(s=d.attributes)||void 0===s?void 0:s.variables)||[]).filter((t=>null!==t.datasetID&&void 0!==t.datasetID));if(0===e.length)a=S(t);else{let i=[];for(let t=0;t<o.length;t++){let r=o[t];e.forEach((t=>{t.name===r&&i.push(t)}))}if(0===i.length)a=S(t);else{let e=[];for(let t=0;t<i.length;t++){let r=i[t].currentValue,n=i[t].defaultValue;if(void 0===r&&(r=n),null!==i[t].datasetID&&void 0!==i[t].datasetID){let n=i[t].datasetID;if(null===n||void 0===n)return null;let a,o=await k(n.dataset);"JSON"===F(r)&&"string"===typeof r?(a=w(o,r.slice(1,-1)),void 0!==a&&(r=a)):i[t].dynamicValue&&void 0!==i[t].dynamicValue&&(a=w(o,i[t].dynamicValue.slice(1,-1)),void 0!==a&&(r=a)),e.push({name:i[t].name,value:r})}else e.push({name:i[t].name,value:r})}a=S(t)}}}if(a=S(t),!a)return void n("No URL specified");const c=e&&i?{headers:{[e]:i},timeout:5e3}:{timeout:5e3};l.A.get(a,c).then((t=>{200!==t.status?n("Error ".concat(t.status,": ").concat(t.statusText)):r(t.data)})).catch((t=>{n(t)}))}));function w(t,e){const i=e.split(".");let r=t;for(const l of i.slice(1))if(l.includes("[")){var n,a;const t=l.match(/\d+/)[0],e=l.substring(0,l.indexOf("["));r=null===(n=r)||void 0===n||null===(a=n[e])||void 0===a?void 0:a[t]}else{var o;r=null===(o=r)||void 0===o?void 0:o[l]}return r}function P(t,e){if(t&&e){var i;let r=null===(i=t.data.find((t=>t.attributes.uid===e)))||void 0===i?void 0:i.attributes.name;return r&&void 0!==r?r:"deleted"}return"deleted"}const k=async(t,e)=>{var i,r,n,a,o,l,d,s,v,f,p,b,m,h,g,y;const I=(null===(i=u.f.getState().workingProject)||void 0===i||null===(r=i.attributes)||void 0===r?void 0:r.datasources.data)||[],{addDatasourcesData:V}=c.G.getState();if(null===t||void 0===t)return null;const w=I.find((e=>e.attributes.uid===t));if(!w||"none"===w.attributes.production.storageType)return null;const P=c.G.getState().current;let k=!1;const x=null!==e&&void 0!==e?e:null===(n=u.f.getState().workingProject)||void 0===n||null===(a=n.attributes)||void 0===a?void 0:a.modificators;async function A(t,e,i){if("local"===t.attributes.production.storageType&&null!==t.attributes.production.sourceObject&&void 0!==t.attributes.production.sourceObject&&""!==t.attributes.production.sourceObject){let r;try{r=JSON.parse(t.attributes.production.sourceObject)}catch(l){console.log("Error parsing datasource",t.id,l)}return void 0!==r?e?O([JSON.parse(t.attributes.production.sourceObject)],t.attributes.production.modificatorId,null===i||void 0===i?void 0:i.data):JSON.parse(t.attributes.production.sourceObject):null}if("mixed"===t.attributes.production.storageType){var r,n;let a=S(t.attributes.production.sourceLink);t.attributes.production.useBaseUrl&&(a=N+a);let o=null!==(r=t.attributes.production.headerKey)&&void 0!==r?r:D,l=null!==(n=t.attributes.production.headerValue)&&void 0!==n?n:T;const d=t.attributes.production.sourceObject;j(a,o,l).then((r=>{var n;return V({id:t.id,hashedUrl:a,value:r,uid:t.attributes.uid,isImagePreloadSource:!(null===(n=t.attributes.production)||void 0===n||!n.isImagePreloadSource)}),e?O([r.data],t.attributes.production.modificatorId,null===i||void 0===i?void 0:i.data):r})).catch((r=>e?O([JSON.parse(d)],t.attributes.production.modificatorId,null===i||void 0===i?void 0:i.data):JSON.parse(d)))}if("remote"===t.attributes.production.storageType){var a,o;let r=S(t.attributes.production.sourceLink);t.attributes.production.useBaseUrl&&(r=N+r);let n=null!==(a=t.attributes.production.headerKey)&&void 0!==a?a:D,l=null!==(o=t.attributes.production.headerValue)&&void 0!==o?o:T;const d=await j(r,n,l);return d?e?O([d],t.attributes.production.modificatorId,null===i||void 0===i?void 0:i.data):d:null}}x&&void 0!==x&&w.attributes.production.modificatorId&&void 0!==w.attributes.production.modificatorId&&(k=!0);const N=null!==(o=null===(l=u.f.getState().workingProject)||void 0===l||null===(d=l.attributes)||void 0===d||null===(s=d.datasetOptions)||void 0===s?void 0:s.hostname)&&void 0!==o?o:"",D=null!==(v=null===(f=u.f.getState().workingProject)||void 0===f||null===(p=f.attributes)||void 0===p||null===(b=p.datasetOptions)||void 0===b?void 0:b.headerKey)&&void 0!==v?v:"",T=null!==(m=null===(h=u.f.getState().workingProject)||void 0===h||null===(g=h.attributes)||void 0===g||null===(y=g.datasetOptions)||void 0===y?void 0:y.headerValue)&&void 0!==m?m:"";if(!(P&&void 0!==P&&P.length>0)){let t=await A(w,k,x).catch((t=>{console.log("datasourceRetrievalLogic error",t)}));return t&&void 0!==t?t:null}if(void 0===(null===P||void 0===P?void 0:P.find((e=>e.uid===t)))){return await A(w,k,x).catch((t=>{console.log("datasourceRetrievalLogic error",t)}))}var F,C;if(null===w.attributes.production.sourceLink||void 0===w.attributes.production.sourceLink||""===w.attributes.production.sourceLink)return null!==(F=null===P||void 0===P||null===(C=P.find((e=>e.uid===t)))||void 0===C?void 0:C.value)&&void 0!==F?F:null;{var W,E,L,q;let e=S(w.attributes.production.sourceLink);w.attributes.production.useBaseUrl&&(e=N+e);const i=null!==(W=null===P||void 0===P||null===(E=P.find((i=>i.uid===t&&i.hashedUrl===e)))||void 0===E?void 0:E.value)&&void 0!==W?W:null;if(i&&void 0!==i)return i;let r=null!==(L=w.attributes.production.headerKey)&&void 0!==L?L:D,n=null!==(q=w.attributes.production.headerValue)&&void 0!==q?q:T;j(e,r,n).then((t=>{var i;return V({id:w.id,hashedUrl:e,value:t,uid:w.attributes.uid,isImagePreloadSource:!(null===(i=w.attributes.production)||void 0===i||!i.isImagePreloadSource)}),t})).catch((t=>{if(null!==w.attributes.production.sourceObject&&void 0!==w.attributes.production.sourceObject)try{return JSON.parse(w.attributes.production.sourceObject)}catch(e){return null}return null}))}};function x(t,e){const i=t.split(".");let r=e;for(const n of i){if(null===r||void 0===r)return;r=r[n]}return r}function A(t,e,i,r,a){var o,l;const d=null!==a&&void 0!==a?a:(null===(o=u.f.getState().workingProject)||void 0===o||null===(l=o.attributes)||void 0===l?void 0:l.variables)||[];let s=(0,n.cloneDeep)(t),c=[s];for(;c.length>0;){const t=c.pop();for(const n in t)if(t.hasOwnProperty(n)){const a=t[n];if(Array.isArray(a)&&a.every((t=>"object"===typeof t))&&(t[n]=a.map((t=>A(t,e,i,r)))),"object"!==typeof a||Array.isArray(a)){if("string"===typeof a&&void 0!==F(a))if("JSON"===F(a)){if(void 0!==x(a.slice(6,-1),e))t[n]=x(a.slice(6,-1),e);else{Object.values(e)[0]}}else if("variable"===F(a)){var v,f;const e=null===(v=d.find((t=>t.name===a.slice(11,-1))))||void 0===v?void 0:v.currentValue,i=null===(f=d.find((t=>t.name===a.slice(11,-1))))||void 0===f?void 0:f.defaultValue;t[n]=void 0===e?i:e}else"array"===F(a)&&(t[n]=e)}else c.push(a)}}if(i&&void 0!==i&&(0,n.isObject)(i)&&Object.keys(i).length>0)for(const n in i)if(s.hasOwnProperty(n))if("object"!==typeof s[n]||Array.isArray(s[n])){let t=O([s[n]],i[n],r);s[n]=t}else{let t=O([s[n].value],i[n],r);s[n].value=t}return s}async function N(t,e){var i,r;let a=t.parentData||{dataset:null,datasetPath:null,datasetFilter:null,datasetReturningField:null,parameters:t.inheritedParameters};if(!1===t.isDynamic||null===t.dataset||null===t.datasetPath||void 0===t.datasetPath)return[t];const o=null===t||void 0===t?void 0:t.dataset;if(!o||null===o||void 0===o)return[];let l=[];let d=!1;const s=null===(i=u.f.getState().workingProject)||void 0===i||null===(r=i.attributes)||void 0===r?void 0:r.modificators;s&&void 0!==s&&t.attachedModificators&&void 0!==t.attachedModificators&&(0,n.isObject)(t.attachedModificators)&&Object.keys(t.attachedModificators).length>0&&(d=!0);try{const i=await k(o,s);if(!i)return[];let r=w(i,t.datasetPath);if(t.filter&&void 0!==t.filter&&t.filter.length>0){let i=!1;t.hasOwnProperty("parentArrayIndex")&&void 0!==t.parentArrayIndex&&t.filter&&void 0!==t.filter&&t.filter.length>0&&t.filter.forEach((t=>{t.parameterId&&void 0!==t.parameterId&&(i=!0)})),r=await T(t.filter,r,t.parentArrayIndex,a,t,e,s)}if(!r)return[];let n=[];if(Array.isArray(r)&&0===r.length)r.forEach(((i,r)=>{d?n.push(A(t,i,t.attachedModificators,null===s||void 0===s?void 0:s.data,e)):n.push(A(t,i))}));else for(const a in r)r.hasOwnProperty(a)&&(d?n.push(A(t,r,t.attachedModificators,null===s||void 0===s?void 0:s.data,e)):n.push(A(t,r)));if((()=>{let i=!1;if(e&&void 0!==e&&e.length>0&&t.hasOwnProperty("subpageId")&&void 0!==t.subpageId){let r=e.filter((e=>e.pageId===t.subpageId));r&&void 0!==r&&r.length>0&&(l=r,i=!0)}return i})()){const e=structuredClone(n),i=[];return e.forEach((async(e,r)=>{const n={dataset:t.dataset,datasetPath:t.datasetPath,datasetFilter:t.filter,datasetReturningField:t.returningField};if(e.listIndex=r,e.parentData=n,t.inputParameters&&Array.isArray(t.inputParameters)&&t.inputParameters.length>0){const i=t.inputParameters.map((async e=>{if(void 0!==e.passedValue&&null!==e.passedValue&&"string"===typeof e.passedValue&&e.passedValue.startsWith("{")&&e.passedValue.endsWith("}")){const i=await L(t.dataset,t.datasetPath,t.filter,r,t.parentArrayIndex,a);return{parameterName:e.parameterName,passedValue:w(i,e.passedValue.slice(1,-1))}}return e})),n=await Promise.all(i);e.inputParameters=n}i.push(e)})),i}return n}catch(c){return console.log(c),[]}}const D=t=>{if(!t||void 0===t)return!1;if(!Array.isArray(t))return!1;if(0===t.length)return!1;for(const e of t)if("object"!==typeof e)return!1;return!0},T=async(t,e,i,n,a,o,l)=>{var c,f,p,b;let m=structuredClone(t);const h=null!==l&&void 0!==l?l:null===(c=u.f.getState().workingProject)||void 0===c||null===(f=c.attributes)||void 0===f?void 0:f.modificators,y=(null===(p=u.f.getState().workingProject)||void 0===p||null===(b=p.attributes)||void 0===b?void 0:b.variables)||[],I=null!==o&&void 0!==o?o:s.c.getState().calculatedVariables,V=v.B.getState().entries;function S(t,e){let i;if(""===t.variableId&&""!==t.variable&&void 0!==t.variable)return t.variable;if(""!==t.variableId){var n,a,o;let e=null!==(n=null===(a=(0,r.l4)(t.variableId))||void 0===a?void 0:a.currentValue)&&void 0!==n?n:null===(o=(0,r.l4)(t.variableId))||void 0===o?void 0:o.defaultValue;return i=null!==e&&void 0!==e?e:t.variable,i}if(""!==t.state&&void 0!==t.state&&null!==t.state){let r=t.state.split(","),n=[],a=[],o=t.state;for(const t of r){const[e,i]=t.split("=");"variableName"===e?n.push(i):"parameterName"===e&&a.push(i)}if(a.length>0&&a.forEach((t=>{let i;if(i=null!==e&&void 0!==e&&e.parameters&&void 0!==e.parameters?null===e||void 0===e?void 0:e.parameters.find((e=>e.name===t)):null===y||void 0===y?void 0:y.find((e=>e.name===t)),i){const{currentValue:e,defaultValue:r}=i;let n=void 0===e?r:e;o&&void 0!==o&&(o=o.replace("parameterName=".concat(t),n.toString()))}})),n.length>0&&n.forEach((t=>{let e=null===I||void 0===I?void 0:I.find((e=>e.name===t));if(e){const{currentValue:i,defaultValue:r}=e;let n=void 0===i?r:i;o&&void 0!==o&&(o=o.replace("variableName=".concat(t),n.toString()))}})),o&&void 0!==o){var l;let t=null===(l=V.find((t=>{var e;return t.name===(null===(e=o)||void 0===e?void 0:e.replace(/,/g,""))})))||void 0===l?void 0:l.value;return t||void 0}return i}var d,u;return""!==t.parameterId&&void 0!==t.parameterId&&null!==t.parameterId?(i=null===e||void 0===e||null===(d=e.parameters)||void 0===d||null===(u=d.find((e=>e.name===t.parameterId)))||void 0===u?void 0:u.currentValue,void 0!==i&&null!==i||(i=g(t.parameterId)),i):void 0}function j(t,e){const i=e.split(".").slice(1);let r=t;for(let n=0;n<i.length;n++){if(null==r[i[n]])return;r=r[i[n]]}return r}function w(t,e,i,r){const n=e.split(".").pop();if("equal"===r){if(n)return Object.fromEntries(Object.entries(t).filter((t=>{let[e,r]=t;return r&&"object"===typeof r&&r[n]===i})))}else if("not equal"===r){if(n)return Object.fromEntries(Object.entries(t).filter((t=>{let[e,r]=t;return r&&"object"===typeof r&&r[n]!==i})))}else if("contains"===r){if(n)return Object.fromEntries(Object.entries(t).filter((t=>{let[e,r]=t;return r&&"object"===typeof r&&r[n].includes(i)})))}else if("not contains"===r&&n)return Object.fromEntries(Object.entries(t).filter((t=>{let[e,r]=t;return r&&"object"===typeof r&&!r[n].includes(i)})))}if(!m||0===m.length)return e;let P=e;if(Array.isArray(e)&&e.length>0)for(const r of m)if(void 0===r.state&&(r.state=""),"is null"===r.condition)P=P.filter((t=>null==j(t,r.field)||""===j(t,r.field)||void 0===j(t,r.field)));else if("extract"===r.condition)P=j(P,r.field);else if("function"===r.condition)P=O([P],Number(r.field),null===h||void 0===h?void 0:h.data);else if("not null"===r.condition)P=P.filter((t=>null!=j(t,r.field)&&""!==j(t,r.field)&&void 0!==j(t,r.field)));else if("exists"===r.condition)P=P.filter((t=>void 0!==j(t,r.field)));else if("not exists"===r.condition)P=P.filter((t=>void 0===j(t,r.field)));else{let t=S(r,n);"equal"!==r.condition||""===r.variable&&""===r.variableId&&""===r.parameterId&&""===r.state?"not equal"!==r.condition||""===r.variable&&""===r.variableId&&""===r.parameterId&&""===r.state?"contains"!==r.condition||""===r.variable&&""===r.variableId&&""===r.parameterId&&""===r.state?"not contains"!==r.condition||""===r.variable&&""===r.variableId&&""===r.parameterId&&""===r.state||(P=P.filter((e=>{let i=j(e,r.field);if(null==i)return!1;const n="string"===typeof i?i:i.toString();return"string"===typeof t?!n.includes(t):"number"!==typeof t&&"boolean"!==typeof t||!n.includes(t.toString())}))):P=P.filter((e=>{let i=j(e,r.field);if(null==i)return!1;const n="string"===typeof i?i:i.toString();return"string"===typeof t?n.includes(t):("number"===typeof t||"boolean"===typeof t)&&n.includes(t.toString())})):P=P.filter((e=>j(e,r.field)!=t)):P&&void 0!==P&&"function"===typeof P.filter&&(P=P.filter((e=>j(e,r.field)==t)))}else P=await async function(t,e){let a={...t};for(const s of e)if("is null"===s.condition)null!=j(a,s.field)&&""!==j(a,s.field)&&void 0!==j(a,s.field)||delete a[s.field];else if("extract"===s.condition)a=j(a,s.field);else if("function"===s.condition)a=O([a],Number(s.field),null===h||void 0===h?void 0:h.data);else if("not null"===s.condition)null!=j(a,s.field)&&""!==j(a,s.field)&&void 0!==j(a,s.field)&&delete a[s.field];else if("exists"===s.condition)void 0===j(a,s.field)&&delete a[s.field];else if("not exists"===s.condition)void 0!==j(a,s.field)&&delete a[s.field];else{var o,l,u;let t=null!==(o=null===(l=(0,r.l4)(s.variableId))||void 0===l?void 0:l.currentValue)&&void 0!==o?o:null===(u=(0,r.l4)(s.variableId))||void 0===u?void 0:u.defaultValue,e=null!==t&&void 0!==t?t:s.variable;void 0!==s.parameterId&&""!==s.parameterId&&(e=await(0,d.gq)("%"+s.parameterId+"%",i,n,"datasourcetools applyFiltersToObject"),void 0===e&&(e=g(s.parameterId))),"equal"!==s.condition||""===s.variable&&""===s.variableId&&""===s.parameterId?"not equal"!==s.condition||""===s.variable&&""===s.variableId&&""===s.parameterId?"contains"!==s.condition||""===s.variable&&""===s.variableId&&""===s.parameterId?"not contains"!==s.condition||""===s.variable&&""===s.variableId&&""===s.parameterId||(a=w(a,s.field,e,"not contains"),delete a[s.field]):(a=w(a,s.field,e,"contains"),delete a[s.field]):(a=w(a,s.field,e,"not equal"),delete a[s.field]):(a=w(a,s.field,e,"equal"),delete a[s.field])}return a}(P,m);return P};function F(t){if("string"===typeof t){if(t.startsWith("{datasource.Iterate over array values")&&t.endsWith("}"))return"array";if(t.startsWith("{")&&t.endsWith("}"))return"JSON";if(t.startsWith("$")&&t.endsWith("$"))return"variable";if(t.startsWith("%")&&t.endsWith("%"))return"parameter";if(t.startsWith("#")&&t.endsWith("#"))return"state"}}async function C(t,e,i,r,n,a,o,l){if(null!==t&&void 0!==t&&null!==r&&void 0!==r)try{const a=await k(t);if(a&&void 0!==a){if(e&&void 0!==e&&""!==e){let t=w(a,e);var d;return i&&void 0!==i&&i.length>0&&(t=await T(i,t,l,o)),D(t)?null!==n&&void 0!==n?x(r.slice(5),null===(d=t)||void 0===d?void 0:d[n]):Array.isArray(t)?w(t,r):x(r.slice(5),t):null!==n&&void 0!==n?t[n]:Array.isArray(t)?function(t,e){const i=e.split(".");let r=t;for(const n of i)r=r[n];return r}(Object.values(t)[0],r.slice(5)):w(t,r)}return w(a,r)}return}catch(u){return}}async function W(t,e){if(null===t||void 0===t||null===e||void 0===e)return;let i=await k(t);return e&&void 0!==e&&""!==e?(i=w(i,e.slice(1,-1)),i):void 0}async function E(t){var e,i;const r=((null===(e=u.f.getState().workingProject)||void 0===e||null===(i=e.attributes)||void 0===i?void 0:i.variables)||[]).find((e=>e.name===t));if(void 0!==r&&r.dynamicValue&&void 0!==r.dynamicValue){if(null===r.datasetID||void 0===r.datasetID)return;return await W(r.datasetID.dataset,r.dynamicValue)}}async function L(t,e,i,r,n,a,o){if(null===t||void 0===t)return;let l=await k(t);var d,u;return e&&void 0!==e&&""!==e?(l=w(l,e),i&&void 0!==i&&i.length>0&&l&&void 0!==l&&(l=await T(i,l,n,a,o)),D(l)?null!==r&&void 0!==r?null===(d=l)||void 0===d?void 0:d[r]:void 0:r&&void 0!==r&&l&&Array.isArray(l)||0===r?r<(null===(u=l)||void 0===u?void 0:u.length)?l[r]:Object.values(l)[r]:void 0):l}function q(t,e,i){if(null===t||void 0===t)return;if(null===e||void 0===e||""===e)return;if(null===i||void 0===i)return;const r=["exists","not exists","is null","not null"];if(i.condition.conditionType&&i.condition.conditionOperandA){let n;n="field"===i.condition.conditionOperandAType?w(t,i.condition.conditionOperandA):I(i.condition.conditionOperandA);let a,o=w(t,e);if(i.alternativeField&&void 0!==i.alternativeField&&""!==i.alternativeField&&"string"===typeof i.alternativeField&&(a="field"===i.alternativeFieldType?w(t,i.alternativeField):I(i.alternativeField)),r.includes(i.condition.conditionType)){if("exists"===i.condition.conditionType)return void 0!==n?o:a;if("not exists"===i.condition.conditionType)return void 0===n?o:a;if("is null"===i.condition.conditionType)return null===n?o:a;if("not null"===i.condition.conditionType)return null!==n?o:a}else{let e;if("field"===i.condition.conditionOperandBType&&"string"===typeof i.condition.conditionOperandB?e=w(t,i.condition.conditionOperandB):"variable"===i.condition.conditionOperandBType&&"string"===typeof i.condition.conditionOperandB&&(e=I(i.condition.conditionOperandB)),"equal"===i.condition.conditionType)return n===e?o:a;if("not equal"===i.condition.conditionType)return n!==e?o:a;if("contains"===i.condition.conditionType)return n&&e&&"string"===typeof n&&"string"===typeof e&&n.includes(e)?o:a;if("not contains"===i.condition.conditionType)return n&&e&&"string"===typeof n&&"string"===typeof e&&!n.includes(e)?o:a}}}function B(t){if("string"!==typeof t||""!==t)return"string"!==typeof t||isNaN(Number(t))?t:Number(t)}const U=()=>{var t,e;const i=(0,u.f)((t=>{var e;return null===(e=t.workingProject)||void 0===e?void 0:e.attributes.datasetOptions})),r=(0,u.f)((t=>{var e,i;return null===(e=t.workingProject)||void 0===e||null===(i=e.attributes)||void 0===i?void 0:i.selectedEnv})),n=(0,u.f)((t=>{var e;return null===(e=t.workingProject)||void 0===e?void 0:e.attributes.env}));if(null===n||void 0===n||!n.length||!r)return i;const a=null!==(t=null===n||void 0===n||null===(e=n.find((t=>t.envId===r)))||void 0===e?void 0:e.datasetOptions)&&void 0!==t?t:{};return{...i,...a}},J=t=>{var e;let{data:i}=t;const{headerKey:r,headerValue:n,hostname:a}=null!==(e=U())&&void 0!==e?e:{};return(0,f.useMemo)((()=>{const{useBaseUrl:t,sourceLink:e,headerKey:o,headerValue:l}=i;return{headerKey:null!==o?o:r,headerValue:null!==l?l:n,sourceLink:t?a+e:e}}),[i,a,r,n])}},25879:(t,e,i)=>{"use strict";i.d(e,{BQ:()=>l,gq:()=>u});var r=i(33490),n=i(64983),a=i(44358),o=i(48362);const l=async(t,e,i,r,a)=>{if(!e||!t||!i||void 0===e)return;const l=n.f.getState().workingProject,d=(null===l||void 0===l?void 0:l.attributes.variables)||[];if(!d||0===d.length)return;let u=structuredClone(d);const s=null===u||void 0===u?void 0:u.findIndex((e=>e.name===t&&e.pageId===i));if(s<0||void 0===s)return;let c;c=a?{...structuredClone(u[s]),dynamicValue:r,datasetID:a}:{...structuredClone(u[s]),dynamicValue:r},u[s]=c,e&&(0,o.Qx)({projectId:e,inputData:{variables:u}}).catch((t=>{}))},d=(t,e,i,a)=>{var o;const l=(null===(o=n.f.getState().workingProject)||void 0===o?void 0:o.attributes.variables)||[];if(!l||0===l.length)return;let d=-1;if(d=i&&""!==i&&void 0!==i?null===l||void 0===l?void 0:l.findIndex((e=>e.name===t&&e.pageId===i)):null===l||void 0===l?void 0:l.findIndex((e=>e.name===t.slice(1,-1))),d<0||void 0===d)return;let u=l[d].dynamicValue;if(u&&void 0!==u){if(u.startsWith("$")&&u.endsWith("$")){let t=r.c.getState().calculatedVariables,e=null===t||void 0===t?void 0:t.find((t=>t.name===u.slice(1,-1)));if(void 0!==e){let t=e.currentValue,i=e.defaultValue;return void 0===t&&(t=i),t}return}return u}return e?l[d].defaultValue:void 0};async function u(t,e,i,r,o,l){var u;let s="";if(l&&void 0!==l)s=l;else if(o&&void 0!==o&&o.hasOwnProperty("parentData")){var c;let e=null===(c=o.parentData.parameters.find)||void 0===c?void 0:c.find((e=>e.name===t));var v;if(e&&void 0!==e)s=null!==(v=null===e||void 0===e?void 0:e.currentValue)&&void 0!==v?v:e.defaultValue}else s=d(t,!0,void 0,l);if(void 0===s||null===s)return;if("string"!==typeof s)return s;const f=(null===(u=n.f.getState().workingProject)||void 0===u?void 0:u.attributes.variables)||[];if(!f||0===f.length)return;let p=null===f||void 0===f?void 0:f.findIndex((e=>e.name===t.slice(1,-1)));if(s.startsWith("{")&&s.endsWith("}")&&p>=0&&void 0!==p&&void 0!==f&&void 0!==f[p]&&void 0!==f[p].datasetID){let t=f[p];if(void 0===t.datasetID)return;if(void 0!==e&&void 0!==i){return function(t,e){const i=e.split(".").slice(1);let r=t;for(let n=0;n<i.length;n++){if(null==r[i[n]])return;r=r[i[n]]}return r}(await(0,a.Re)(i.dataset,i.datasetPath,i.datasetFilter,e),s.slice(1,-1))}return(0,a.Fp)(t.datasetID.dataset,s)}if(!("string"===typeof s&&s.startsWith("%")&&s.endsWith("%")&&s.length>2))return s;if(i&&void 0!==i&&i.hasOwnProperty("parameters")&&void 0!==i.parameters){var b;let e=null===(b=i.parameters)||void 0===b?void 0:b.find((e=>e.name===t.slice(1,-1)));if(e&&void 0!==e)return e.currentValue}}},89387:t=>{function e(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=()=>[],e.resolve=e,e.id=89387,t.exports=e},530:()=>{},72615:()=>{},84021:()=>{},66247:()=>{},82202:()=>{},18641:()=>{},6732:()=>{},97664:()=>{}}]);