"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[408],{50408:(e,t,c)=>{c.r(t),c.d(t,{default:()=>x});var r=c(92759),n=c(81541),a=c(48538),s=c(89379),l=c(9950);const o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M793 242H366v-74c0-6.7-7.7-10.4-12.9-6.3l-142 112a8 8 0 000 12.6l142 112c5.2 4.1 12.9.4 12.9-6.3v-74h415v470H175c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h618c35.3 0 64-28.7 64-64V306c0-35.3-28.7-64-64-64z"}}]},name:"rollback",theme:"outlined"};var i=c(25085),d=function(e,t){return l.createElement(i.A,(0,s.A)((0,s.A)({},e),{},{ref:t,icon:o}))};const h=l.forwardRef(d);var f=c(13700);const u={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-12-12-28.3-18.7-45.3-18.7H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 176h256v112H384V176zm128 554c-79.5 0-144-64.5-144-144s64.5-144 144-144 144 64.5 144 144-64.5 144-144 144zm0-224c-44.2 0-80 35.8-80 80s35.8 80 80 80 80-35.8 80-80-35.8-80-80-80z"}}]},name:"save",theme:"filled"};var v=function(e,t){return l.createElement(i.A,(0,s.A)((0,s.A)({},e),{},{ref:t,icon:u}))};const p=l.forwardRef(v);var j=c(64983),g=c(28429),y=c(48362),A=c(27379),m=c(68513),k=c(44414);const x=()=>{const{pageId:e}=(0,g.g)(),{projectId:t}=(0,g.g)(),[c,s]=(0,l.useState)(!1),{workingProject:o}=(0,j.f)(),i=(0,j.f)((e=>e.currentProjectHash)),d=(0,j.f)((e=>e.savedProjectHash)),{pastPatches:u,futurePatches:v,undo:x,redo:w,fetchAndFill:b}=j.f.getState(),C=u.length>0,z=v.length>0,P=i===d,H=(0,l.useCallback)((()=>{o&&(s(!0),(0,y.$H)({projectData:o}).then((()=>{r.Ay.success("Project saved successfully")})).catch((e=>{console.error(e),r.Ay.error("Error while saving project")})).finally((()=>{s(!1)})))}),[o]);return(0,l.useEffect)((()=>{const e=e=>{(e.metaKey||e.ctrlKey)&&"s"===e.key&&(e.preventDefault(),H()),(e.metaKey||e.ctrlKey)&&"z"===e.key&&C&&(e.preventDefault(),x()),(e.metaKey||e.ctrlKey)&&e.shiftKey&&"z"===e.key&&z&&(e.preventDefault(),w())};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[z,C,H,w,x]),(0,k.jsxs)(k.Fragment,{children:[e&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(n.A,{title:"Undo [ctrl/cmd + z]",children:(0,k.jsx)(a.A,{onClick:()=>x(),disabled:!C,icon:(0,k.jsx)(h,{})})}),(0,k.jsx)(n.A,{title:"Redo [ctrl/cmd + shift + z]",children:(0,k.jsx)(a.A,{onClick:()=>w(),disabled:!z,icon:(0,k.jsx)(h,{style:{transform:"scaleX(-1)"}})})})]}),!e&&t&&(0,k.jsx)(n.A,{title:"Revert all project changes & clear history",children:(0,k.jsx)(a.A,{danger:!0,disabled:P,onClick:()=>{t&&(0,m.A)({icon:(0,k.jsx)(A.A,{}),title:"Revert all project changes",content:"All unsaved changes made for this project will be lost. Are you sure you want to proceed?",okButtonProps:{danger:!0},okText:"Proceed",cancelText:"Cancel",onOk:()=>{b(t)},onCancel:()=>{console.info("Clear process aborted.")}})},icon:(0,k.jsx)(f.A,{})})}),(0,k.jsx)(n.A,{placement:"left",title:"Save project [ctrl/cmd + s]",children:(0,k.jsx)(a.A,{icon:(0,k.jsx)(p,{}),loading:c,disabled:i===d||c,onClick:()=>{H()},type:"primary",children:"Save project"})})]})}}}]);