"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[7938],{68513:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(44719);const o=e=>a.A.confirm({zIndex:3e3,...e})},83063:(e,t,n)=>{n.d(t,{A:()=>p});var a=n(84649),o=n(48538),i=n(77645),r=n(56952),s=n(92759),c=n(12916),l=n(9950),d=n(2260),u=n(41967),f=n(57560),m=n(24513),g=n(44414);const h=e=>{let{initialValue:t,saveInProgress:n,setIsEditing:s,setSaveInProgress:c,save:m,style:h}=e;const[p,y]=(0,l.useState)(t);switch(typeof t){case"boolean":return(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1em",...h},children:[n&&(0,g.jsx)(d.A,{}),(0,g.jsx)(a.A,{onChange:e=>{y("true"===e)},value:p?"true":"false",options:["true","false"]}),(0,g.jsxs)("div",{style:{display:"flex"},children:[(0,g.jsx)(o.A,{style:{marginRight:2},type:"dashed",children:(0,g.jsx)(u.A,{onClick:()=>m(p),style:{color:"var(--ant-primary-5)"}})}),(0,g.jsx)(o.A,{onClick:()=>{s(!1),c(!1)},type:"dashed",children:(0,g.jsx)(f.A,{style:{color:"gray"}})})]})]});case"string":return(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1em",...h},children:[n&&(0,g.jsx)(d.A,{}),(0,g.jsx)(i.A,{spellCheck:!1,autoFocus:!0,onPressEnter:()=>m(p),onBlur:()=>m(p),onChange:e=>{e.stopPropagation(),y(e.target.value)},value:p})]});case"number":case"object":return(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1em",...h},children:[n&&(0,g.jsx)(d.A,{}),(0,g.jsx)(r.A,{style:{width:"100%"},autoFocus:!0,onPressEnter:()=>m(p),onBlur:()=>m(p),onChange:e=>y(e),value:p})]});default:return null}},p=e=>{let{value:t,onChange:n,initialValue:a,validators:o,style:i}=e;const[r,d]=(0,l.useState)(!1),[u,f]=(0,l.useState)(!1);function p(e){f(!0),n(e).then((()=>{d(!1),f(!1)}))}return(0,l.useEffect)((()=>{const e=e=>{27===e.keyCode&&d(!1)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[a]),r?(0,g.jsx)(h,{initialValue:a,saveInProgress:u,setIsEditing:d,setSaveInProgress:f,save:function(e){if(e===a)return d(!1),void f(!1);if(null!==o&&void 0!==o&&o.length){let t=[];return o.forEach((n=>{t.push(n(e))})),Promise.all(t).then((()=>{p(e)})).catch((e=>{s.Ay.error(e.message)}))}p(e)},style:i}):(0,g.jsxs)("div",{style:{...i},children:["boolean"===typeof t?(0,g.jsx)(c.A,{style:{padding:"3px",lineHeight:"1em"},color:t?"green":"red",children:t?"true":"false"}):t,(0,g.jsx)(m.A,{style:{marginLeft:"0.3em",color:"var(--ant-primary-5)"},onClick:()=>{d(!0)}})]})}},15791:(e,t,n)=>{n.d(t,{Df:()=>c,IR:()=>s,nU:()=>l});var a=n(13753),o=n(92759),i=n(89321),r=n(64983);const s=async(e,t)=>{const n={data:{project:e,...t}};await a.axiosInstance.post("/api/modificators",n,{headers:(0,i.A)()}).then((e=>{const{workingProject:t,updateProjectWithHistory:n}=r.f.getState();if(!t)return;let a=structuredClone(t.attributes.modificators.data);return a.push(e.data.data),n({modificators:{data:a}},!1)})).then((()=>{o.Ay.success("Function created")})).catch((e=>{console.log("An error occured during function creation:",e),o.Ay.error("Error adding new function")}))},c=async e=>{await a.axiosInstance.delete("/api/modificators/".concat(e),{headers:(0,i.A)()}).then((()=>{const{workingProject:t,updateProjectWithHistory:n}=r.f.getState();if(!t)return;let a=t.attributes.modificators.data;return a=a.filter((t=>t.id!==e)),n({modificators:{data:a}},!1)})).then((()=>{o.Ay.success("Function deleted")})).catch((e=>{console.log("An error occured during function removing:",e.response),o.Ay.error("Error deleting function")}))},l=async(e,t)=>await a.axiosInstance.put("/api/modificators/".concat(t),{data:e},{headers:(0,i.A)()}).then((e=>{var n;const{workingProject:a,updateProjectWithHistory:o}=r.f.getState();if(!a||null===e||void 0===e||null===(n=e.data)||void 0===n||!n.data)return;let i=structuredClone(a.attributes.modificators.data);return i.map((n=>(n.id===t&&(n.attributes=e.data.data.attributes),n))),o({modificators:{data:i}},!1)})).then((()=>{o.Ay.success("Function updated")})).catch((e=>{console.log("An error occured during function update:",e.response),o.Ay.error("Error updating function")}))},87938:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var a=n(22718),o=n(92759),i=n(72429),r=n(48538),s=n(20755),c=n(9950),l=n(28429),d=n(83063),u=n(59051),f=n.n(u),m=n(37571),g=n(44070),h=n(68513),p=n(15791),y=n(64983),A=n(44414);const v=()=>{const{projectId:e}=(0,l.g)(),t=(0,y.f)((e=>e.workingProject)),{setNewModificatorVisible:n,setEditModificator:u}=(0,l.KC)(),[v,x]=(0,c.useState)(),{Title:j}=a.A;return(0,c.useEffect)((()=>{var a,r;const s=null===t||void 0===t||null===(a=t.attributes)||void 0===a||null===(r=a.modificators)||void 0===r?void 0:r.data;function c(e){return null===s||void 0===s||!s.some((t=>t.attributes.name===e))||(o.Ay.error("Function's name must be unique"),!1)}if(e)if(s&&Array.isArray(s)){let t=[];s.forEach(((a,r)=>{t.push({key:"modificator_"+a.id,order:r+1,name:(0,A.jsx)(d.A,{onChange:t=>async function(t,n,a){return t===n?n:c(t)?t&&e?(0,p.nU)({name:t},a):void 0:(o.Ay.error("Function's name must be unique"),n)}(t,a.attributes.name,a.id),initialValue:a.attributes.name,value:(0,A.jsx)(A.Fragment,{children:a.attributes.name})}),updated:f()(a.attributes.updatedAt).format("MMM Do YYYY, h:mm a")||"",modificatorActions:(0,A.jsx)(i.A.Button,{onClick:()=>{n(a.id)},menu:{items:[{key:"copy",icon:(0,A.jsx)(m.A,{}),label:"Clone function",onClick:()=>function(t,n){const a=e=>c("".concat(e,"_clone"))?"".concat(e,"_clone"):a("".concat(e,"_clone"));if(!s)return null;let o={name:a(n),function:s[t].attributes.function};e&&(0,p.IR)(e,o)}(r,a.attributes.name)},{key:"delete",icon:(0,A.jsx)(g.A,{}),label:"Delete function",danger:!0,onClick:()=>(0,h.A)({title:"Delete function ".concat(a.attributes.name," ?"),content:"This will remove function ".concat(a.attributes.name," and all it's assignments. This action can not be undone."),okText:"Delete function",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>(0,p.Df)(a.id),onCancel:()=>console.log("cancel function delete")})}]},children:"Edit"})})})),x(t)}else x([])}),[e,u,t]),(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(j,{id:"Functions",style:{margin:"15px 0"},level:5,children:"Functions (".concat((null===v||void 0===v?void 0:v.length)||0,")")}),(0,A.jsx)(s.A,{columns:[{title:"Name",dataIndex:"name"},{title:"Updated",dataIndex:"updated"},{title:"Actions",width:"100px",dataIndex:"modificatorActions"}],dataSource:v,pagination:!1}),(0,A.jsx)(r.A,{style:{marginTop:15},type:"primary",onClick:()=>n(!0),children:"Add Function"},"submit")]})}}}]);