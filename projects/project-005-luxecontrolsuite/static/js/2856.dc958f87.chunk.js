"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[2856],{68513:(n,e,t)=>{t.d(e,{A:()=>o});var i=t(44719);const o=n=>i.A.confirm({zIndex:3e3,...n})},86945:(n,e,t)=>{t.d(e,{$4:()=>w,HQ:()=>k,Jy:()=>b,Qx:()=>y,Td:()=>S,VY:()=>A,Zp:()=>g,iq:()=>j,nb:()=>P,oS:()=>C,ze:()=>B});var i,o,l,a,r,s,d,c,u,p,x,m,h=t(57528),v=t(86006);const f=(0,v.i7)(i||(i=(0,h.A)(["\n  from {\nopacity: 0;\ntransform: scaleY(0.8) translateY(-100%);\nheight: 0;\n  }\n\n  to {\n   opacity: 1;\n   transform: scaleY(1) translateY(0);\n   height: auto;\n  }\n"]))),g=v.Ay.div(o||(o=(0,h.A)(["\n  position: relative;\n\n  display: flex;\n  flex-flow: column;\n\n  .ant-card-body {\n    flex: 1;\n  }\n\n  .ant-card-meta {\n    display: block;\n  }\n\n  .ant-table-tbody > tr:last-child > td {\n    border-bottom: 0;\n  }\n\n  .ant-table-tbody > tr {\n    overflow: hidden;\n    transition: 200ms;\n    animation-name: ",";\n    animation-timing-function: linear;\n    animation-duration: 300ms;\n  }\n\n  .ant-card-actions > li > span {\n    cursor: default;\n  }\n\n  .lastProjectLink {\n    color: var(--ant-primary-5);\n    cursor: pointer;\n  }\n\n  .projectCardActionsBox {\n    display: flex;\n    gap: 20px;\n  }\n"])),f),b=v.Ay.div(l||(l=(0,h.A)(["\n  position: absolute;\n  left: 2px;\n  top: 2px;\n  right: 2px;\n  height: 5px;\n  background-color: gray;\n  border-radius: 2px;\n"]))),j=v.Ay.div(a||(a=(0,h.A)(["\n  display: grid;\n  gap: 1vmax;\n  /* grid-template-columns: repeat(auto-fit, minmax(250px, 400px)); */\n  grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));\n"]))),y=v.Ay.div(r||(r=(0,h.A)(["\n  position: relative;\n  display: flex;\n  flex-flow: column;\n  user-select: none;\n  flex: 1;\n"]))),A=v.Ay.div(s||(s=(0,h.A)(["\n  position: relative;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 10px;\n\n  & > section {\n    flex: 1;\n    display: flex;\n    align-items: center;\n    gap: 5px;\n\n    &.center {\n      justify-content: center;\n    }\n    &.right {\n      justify-content: flex-end;\n    }\n  }\n"]))),w=v.Ay.div(d||(d=(0,h.A)(["\n  position: relative;\n  background-color: rgb(77 75 84);\n  display: flex;\n  align-items: stretch;\n\n  .tabsScroller {\n    width: 100%;\n    flex: 1;\n    align-items: stretch;\n    position: relative;\n\n    .inner {\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: 100%;\n      height: 100%;\n      overflow: hidden;\n      overflow-y: visible !important;\n      display: flex;\n    }\n  }\n"]))),k=v.Ay.button(c||(c=(0,h.A)(["\n  --tab-padding: 12px;\n\n  position: relative;\n  background-color: transparent;\n  border-width: 0;\n  padding: var(--tab-padding);\n  font-size: 13px;\n  border-radius: 0;\n  color: rgba(255, 255, 255, 0.65);\n  cursor: pointer;\n  transition: 200ms;\n  min-width: 100px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 5px;\n  min-width: min-content;\n\n  small {\n    position: absolute;\n    left: calc(var(--tab-padding) + 18px);\n    top: 5px;\n    font-size: 7px;\n    text-transform: uppercase;\n\n    color: rgb(223 164 255);\n  }\n\n  .tabText {\n    position: relative;\n    white-space: nowrap;\n    max-width: 200px;\n    min-height: fit-content;\n\n    .textOverflow {\n      position: relative;\n      width: 100%;\n      height: auto;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      line-height: 120%;\n    }\n\n    &::after {\n      content: '';\n      position: absolute;\n      right: -0.5em;\n      top: -0.2em;\n      width: 5px;\n      height: 5px;\n      border-radius: 50%;\n      background-color: #fc5d5d;\n      transition: 200ms;\n      scale: ",";\n    }\n  }\n\n  &::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    width: 100%;\n    height: 0.5px;\n    bottom: 2px;\n    transition: 200ms;\n  }\n\n  &::after {\n    content: '';\n    position: absolute;\n    left: 0;\n    width: 100%;\n    height: 2px;\n    bottom: 0;\n    transition: 200ms;\n  }\n\n  &.isActive {\n    background-color: rgba(0, 0, 0, 0.2);\n    &::after {\n      background-color: var(--ant-primary-5);\n    }\n    &::before {\n      background-color: rgba(255, 255, 255, 0.7);\n    }\n  }\n\n  .closeIco {\n    margin-left: 10px;\n    scale: 0;\n    will-change: scale;\n    transition: 200ms;\n    font-size: 0.9em;\n\n    &:hover {\n      color: #fff;\n    }\n  }\n\n  &:hover {\n    color: rgba(255, 255, 255, 0.9);\n    background-color: rgba(0, 0, 0, 0.2);\n\n    .closeIco {\n      scale: 1;\n    }\n  }\n"])),(n=>{let{$showDot:e}=n;return e?1:0})),C=v.Ay.div(u||(u=(0,h.A)(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  background-color: #262626;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),S=v.Ay.div(p||(p=(0,h.A)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  background-color: #fff;\n"]))),P=v.Ay.div(x||(x=(0,h.A)(["\n  position: fixed;\n  z-index: 100;\n  pointer-events: none;\n  transition: 200ms;\n  outline: 0.5px rgb(153, 255, 20) dashed;\n  outline-offset: 7px;\n  will-change: left, top, width, height, opacity;\n\n  .infoBar {\n    position: absolute;\n    left: -7.5px;\n    bottom: calc(100% + 10px);\n    display: flex;\n    gap: 2px;\n\n    & > div {\n      font-size: 11px;\n      padding: 0.3em;\n      border-radius: 2px;\n      width: fit-content;\n    }\n  }\n\n  .elementTypeName {\n    background-color: rgb(153, 255, 20);\n    color: #000;\n  }\n\n  .elementActiveModeIndex {\n    background-color: rgb(216, 20, 255);\n    color: #fff;\n  }\n"]))),B=v.Ay.div(m||(m=(0,h.A)(["\n  position: relative;\n  display: flex;\n  white-space: nowrap;\n  align-items: center;\n  gap: 5px;\n\n  .innerBox {\n    flex: 1;\n    position: relative;\n\n    .ant-input {\n      width: '100%';\n    }\n  }\n"])))},2856:(n,e,t)=>{t.r(e),t.d(e,{default:()=>J});var i=t(92759),o=t(81541),l=t(12916),a=t(72429),r=t(40895),s=t(35492),d=t(44719),c=t(48538),u=t(30904),p=t(70171),x=t(86945),m=t(31526),h=t(48362),v=t(59051),f=t.n(v),g=t(9950),b=t(36485),j=t(33046),y=t(46995),A=t(19826),w=t(44070),k=t(63222),C=t(41967),S=t(24513),P=t(37571),B=t(27379),D=t(5099),M=t(78077),I=t(591),N=t(66276),Y=t(24258),z=t(28429),F=t(68513),L=t(64983),E=t(71069),T=t(97592),R=t(15224),H=t(44414);function O(n,e){fetch(n,{headers:new Headers({Origin:window.location.origin}),mode:"cors",credentials:"include"}).then((n=>{if(200===n.status)return n.blob();i.Ay.error("Download build error.")})).then((n=>{if(n){!function(n,e){var t=document.createElement("a");t.download=e,t.href=n,document.body.appendChild(t),t.click(),t.remove()}(window.URL.createObjectURL(n),e)}})).catch((n=>console.error(n)))}const Q=g.memo((n=>{let{project:e,buildingNow:t}=n;const[i,d]=(0,g.useState)([]);(0,g.useEffect)((()=>{var n;const t=[...(null===(n=e.attributes.builds)||void 0===n?void 0:n.data)||[]];if(null!==t&&void 0!==t&&t.length){t.sort((function(n,e){return n.id<e.id?1:n.id>e.id?-1:0}));const n=[];t.forEach((t=>{let i="Default";try{var r;const n=JSON.parse(null!==(r=t.attributes.alternativeText)&&void 0!==r?r:""),e=null===n||void 0===n?void 0:n.envName;e&&(i=e)}catch(d){}var s;n.push({key:t.id,envName:(0,H.jsx)("div",{style:{textAlign:"right"},children:(0,H.jsx)(o.A,{placement:"topLeft",title:"Environment used for this build",arrowPointAtCenter:!0,children:(0,H.jsx)(l.A,{icon:(0,H.jsx)(b.A,{}),style:{marginLeft:5,lineHeight:"1em",padding:"2px 3px"},color:"Default"!==i?"purple":"",children:i})})}),filename:(0,H.jsxs)("div",{style:{whiteSpace:"nowrap"},children:[(0,H.jsx)(j.A,{})," ",t.attributes.name]}),fileSize:(0,H.jsxs)("div",{style:{whiteSpace:"nowrap"},children:[(0,H.jsx)(y.A,{})," ",(s=t.attributes.size,s<1024?s+" KB":(s/1024).toFixed(2)+" MB")]}),fileDate:(0,H.jsxs)("div",{style:{whiteSpace:"nowrap"},children:[(0,H.jsx)(A.A,{style:{marginRight:"0.5em"}}),f()(t.attributes.createdAt).format("MMMM Do YYYY, h:mm a")]}),fileControls:(0,H.jsxs)(a.A.Button,{onClick:()=>{O("http://api.avstudio.local"+t.attributes.url,t.attributes.name)},menu:{items:[{key:"remove",danger:!0,icon:(0,H.jsx)(w.A,{}),label:"Delete Build",onClick:()=>{(0,h.kA)({projectId:e.id,buildId:t.id})}}]},children:[(0,H.jsx)(k.A,{})," Download"]})})})),d(n)}else d([])}),[e]);return(0,H.jsxs)(H.Fragment,{children:[i.length?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(r.A,{style:{marginBottom:"0.8em"}}),(0,H.jsxs)(l.A,{style:{marginBottom:"1em"},children:["Builds count: ",i.length]})]}):null,(0,H.jsx)("div",{style:{maxHeight:250,overflow:"scroll"},children:i.length?(0,H.jsx)(s.A,{loading:t,showHeader:!1,pagination:!1,dataSource:i,columns:[{title:"File Name",width:"100%",dataIndex:"filename",key:"filename"},{title:"Environment",dataIndex:"envName",key:"envName"},{title:"File Size",dataIndex:"fileSize",key:"fileSize"},{title:"File Date",dataIndex:"fileDate",key:"fileDate"},{title:"File Controls",dataIndex:"fileControls",key:"fileControls"}]}):null},i.length)]})})),J=n=>{var e,t,o,s,v,y,k,J,U,Z,K,V,W,$;let{project:q,compact:_}=n;const{id:G,attributes:X}=q,nn=(0,z.Zp)(),{projectId:en}=(0,z.g)(),tn=(0,T.Q)((n=>n.projectBuildSelectedEnv)),on=(0,g.useMemo)((()=>{var n,e,t,i;const o=null===(n=q.attributes)||void 0===n?void 0:n.selectedEnv;if(o)return null===(e=q.attributes)||void 0===e||null===(t=e.env)||void 0===t||null===(i=t.find((n=>n.envId===o)))||void 0===i?void 0:i.envName}),[null===(e=q.attributes)||void 0===e?void 0:e.env,null===(t=q.attributes)||void 0===t?void 0:t.selectedEnv]),ln=(0,g.useMemo)((()=>{var n,e,t;if(tn)return null===(n=q.attributes)||void 0===n||null===(e=n.env)||void 0===e||null===(t=e.find((n=>n.envId===tn)))||void 0===t?void 0:t.envName}),[null===(o=q.attributes)||void 0===o?void 0:o.env,tn]),{setEditProjectModalId:an}=(0,z.KC)(),[rn,sn]=(0,g.useState)(!1);const dn=[(0,H.jsx)(c.A,{icon:(0,H.jsx)(S.A,{}),onClick:()=>nn("/projects/".concat(q.id)),block:!0,style:{width:"90%"},type:"text",children:"Edit"},"edit"),(0,H.jsx)(a.A,{menu:{items:[{key:"Clone Project",label:"Clone Project",icon:(0,H.jsx)(P.A,{}),onClick:()=>(0,h.BL)(G).then((n=>{en&&nn("/projects/".concat(n))}))},{key:"Delete Project",danger:!0,label:"Delete Project",icon:(0,H.jsx)(w.A,{}),onClick:()=>{(0,F.A)({icon:(0,H.jsx)(B.A,{}),title:"Remove Project?",content:'Please confirm removing project "'.concat(q.attributes.name,'"'),okText:"Delete",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:async()=>{await(0,h.xx)({projectId:G}).then((()=>{(0,E.F.getState().fillProjectsList)(),en&&nn("/projects")}))},onCancel:()=>{}})}}]},children:(0,H.jsx)(c.A,{icon:(0,H.jsx)(D.A,{}),block:!0,style:{width:"90%"},type:"text"},"more")},"clone")],cn=[(0,H.jsx)(a.A.Button,{className:"expandedDropdownButton",icon:(0,H.jsx)(b.A,{}),menu:{items:[{key:"Default",label:(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(b.A,{})," Default"]})},...(null===(s=q.attributes)||void 0===s||null===(v=s.env)||void 0===v?void 0:v.map((n=>({key:n.envId,label:(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(b.A,{})," ",n.envName]})}))))||[]],onClick:n=>{let{key:e}=n;var t;t=e,(0,L.f.getState().updateProjectWithHistory)({selectedEnv:t},!1)}},children:(0,H.jsxs)("a",{href:(0,h.zo)(),target:"_blank",rel:"noreferrer",style:{color:"inherit",display:"block"},children:[(0,H.jsx)(M.A,{})," Live",(0,H.jsx)(l.A,{icon:(0,H.jsx)(b.A,{style:{marginRight:-5}}),style:{marginLeft:5,lineHeight:"1em",padding:"2px 3px"},color:on?"purple":"",children:on||"Default"})]})},"live"),(0,H.jsxs)(a.A.Button,{loading:rn,className:"expandedDropdownButton",icon:(0,H.jsx)(j.A,{}),onClick:()=>function(n){var e,t,o;if(null===(e=q.attributes.permissions)||void 0===e||!e.canBuild)return void d.A.confirm({open:!0,title:"Activate unlimited builds for this project",zIndex:3e3,icon:(0,H.jsxs)("svg",{style:{color:" var(--ant-primary-5)"},xmlns:"http://www.w3.org/2000/svg",width:"2em",height:"2em",viewBox:"0 0 24 24",children:[(0,H.jsx)("title",{children:"Activate builds for this project"}),(0,H.jsxs)("g",{fill:"currentColor","stroke-width":"1.5",children:[(0,H.jsx)("path",{"fill-rule":"evenodd",d:"M5 6.25A2.75 2.75 0 0 0 2.25 9v9A2.75 2.75 0 0 0 5 20.75h14A2.75 2.75 0 0 0 21.75 18V9A2.75 2.75 0 0 0 19 6.25zm11.5 6a1.25 1.25 0 1 0 0 2.5a1.25 1.25 0 0 0 0-2.5","clip-rule":"evenodd"}),(0,H.jsx)("path",{d:"M16.485 3.069A2 2 0 0 1 19 5H9z"})]})]}),content:"Making project builds is a paid feature. Make a one-time payment for unlimited builds for this project.",okText:"Activate builds",cancelText:"Cancel",okButtonProps:{icon:(0,H.jsx)(C.A,{})},onOk:()=>{var n;const e=null===(n=R.k.getState().user)||void 0===n?void 0:n.id;if(e)return(0,h.fS)({user:e,productId:1,projectId:q.id});console.error("User not found")},onCancel:()=>console.log("cancel build activation")});const l=null===(t=L.f.getState().workingProject)||void 0===t||null===(o=t.attributes.pages.data)||void 0===o?void 0:o.filter((n=>!n.attributes.isSubpage));if(null===l||void 0===l||!l.length)return i.Ay.error("At least one page need to start build"),void sn(!1);const a=E.F.getState().fillProjectsList,r=L.f.getState().updateProjectWithHistory;sn(!0),(0,h.ay)(n).then((n=>{if(n){var e;let t=structuredClone((null===(e=L.f.getState().workingProject)||void 0===e?void 0:e.attributes.builds.data)||[]);t=[...t,n],_?a():r({builds:{data:t}},!1)}})).catch((()=>{i.Ay.error("Build error")})).finally((()=>{sn(!1)}))}(G),menu:{items:[{key:"Default",label:(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(b.A,{})," Default"]})},...(null===(y=q.attributes)||void 0===y||null===(k=y.env)||void 0===k?void 0:k.map((n=>({key:n.envId,label:(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(b.A,{})," ",n.envName]})}))))||[]],onClick:n=>{let{key:e}=n;var t;t=e,(0,T.Q.getState().updateEnvStore)({projectBuildSelectedEnv:t})}},children:[null!==(J=q.attributes.permissions)&&void 0!==J&&J.canBuild?(0,H.jsx)(j.A,{}):(0,H.jsx)(I.A,{}),"Build",(0,H.jsx)(l.A,{icon:(0,H.jsx)(b.A,{style:{marginRight:-5}}),style:{marginLeft:5,lineHeight:"1em",padding:"2px 3px"},color:ln?"purple":"",children:ln||"Default"})]},"build"),(0,H.jsx)(a.A,{menu:{items:[{key:"Project Settings",label:"Project Settings",icon:(0,H.jsx)(N.A,{}),onClick:()=>an(q.id)},{key:"Clone Project",label:"Clone Project",icon:(0,H.jsx)(P.A,{}),onClick:()=>(0,h.BL)(G).then((n=>{en&&nn("/projects/".concat(n))}))},{key:"Delete Project",danger:!0,label:"Delete Project",icon:(0,H.jsx)(w.A,{}),onClick:()=>{(0,F.A)({icon:(0,H.jsx)(B.A,{}),title:"Remove Project?",content:'Please confirm removing project "'.concat(q.attributes.name,'"'),okText:"Delete",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:async()=>{await(0,h.xx)({projectId:G}).then((()=>{(0,E.F.getState().fillProjectsList)(),en&&nn("/projects")}))},onCancel:()=>{}})}}]},children:(0,H.jsx)(c.A,{icon:(0,H.jsx)(D.A,{}),block:!0,type:"dashed"})},"settings")],[un,pn]=(0,g.useState)(null);return(0,g.useEffect)((()=>{var n;const e=null===(n=q.attributes.builds)||void 0===n?void 0:n.data;if(null!==e&&void 0!==e&&e.length){const n=Math.max.apply(Math,e.map((n=>n.id))),t=e.find((e=>e.id===n));t&&pn(t)}else pn(null)}),[q]),(0,H.jsxs)(x.Zp,{id:"Top",as:u.A,children:[(0,H.jsx)(m.A,{title:X.name,description:(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(x.Jy,{title:"Main Theme Colors",style:{background:(null===(U=q.attributes.theme)||void 0===U||null===(Z=U.data)||void 0===Z||null===(K=Z.attributes)||void 0===K?void 0:K.colorsPreview)||"gray"}}),(0,H.jsxs)("div",{children:[(0,H.jsx)(Y.A,{style:{marginRight:"0.3em"}}),null===(V=X.theme)||void 0===V||null===(W=V.data)||void 0===W||null===($=W.attributes)||void 0===$?void 0:$.name]}),(0,H.jsxs)("div",{children:[(0,H.jsx)(A.A,{style:{marginRight:"0.3em"}}),f()(X.updatedAt).format("MMMM Do YYYY, h:mm a")]}),_&&(0,H.jsxs)("div",{children:[(0,H.jsx)(j.A,{style:{marginRight:"0.3em"}}),"Last Build:"," ",un?(0,H.jsx)(p.A,{content:(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(A.A,{style:{marginRight:"0.5em"}}),f()(un.attributes.createdAt).format("MMMM Do YYYY, h:mm a")]}),children:(0,H.jsx)("span",{onClick:()=>{O("http://api.avstudio.local"+un.attributes.url,un.attributes.name)},className:"lastProjectLink",children:un.attributes.name})}):"none"]}),!_&&(0,H.jsx)(Q,{project:q,buildingNow:rn})]})}),(0,H.jsx)(r.A,{}),(0,H.jsx)("div",{className:"projectCardActionsBox",children:en?cn:dn})]},G)}}}]);