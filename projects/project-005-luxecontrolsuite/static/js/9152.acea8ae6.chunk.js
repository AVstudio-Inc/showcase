"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[9152],{49152:(e,t,a)=>{a.r(t),a.d(t,{default:()=>A});var i=a(22718),s=a(35492),n=a(48538),r=a(92759),l=a(72429),d=a(12916),o=a(15369),u=a(59051),p=a.n(u),c=a(9950),g=a(16977),b=a(37571),m=a(44070),h=a(28429),v=a(83063),x=a(27911),f=a(64983),w=a(35865),y=a(6317),j=a(44414);const{Title:C}=i.A,I=[{title:(0,j.jsx)(y.A,{searchType:"subPages"}),dataIndex:"name",sorter:(e,t)=>{const a=e.name.props.initialValue.toLowerCase(),i=t.name.props.initialValue.toLowerCase();return a<i?-1:a>i?1:0}},{title:"Updated",dataIndex:"updated"},s.A.EXPAND_COLUMN,{title:"Where Used",dataIndex:"used"},{title:"Actions",dataIndex:"actions",width:100}],A=()=>{const e=(0,h.Zp)(),t=(0,f.f)((e=>e.workingProject)),{projectId:a}=(0,h.g)(),i=(0,w.x)((e=>e.subPageSearchString)),{setNewPageModalVisible:u}=(0,h.KC)(),[y,A]=(0,c.useState)(null);function S(a){var i;const s=null===t||void 0===t?void 0:t.attributes.pages.data.find((e=>e.id===a));if(!s)return null;const r=[];return null===(i=s.attributes.containers)||void 0===i||i.forEach((e=>{e.elements.forEach((e=>{"subpage"!==e.type&&"subpageList"!==e.type||r.push(e.subpageId)}))})),(0,j.jsx)("div",{style:{display:"flex",gap:5,marginTop:10,flexWrap:"wrap"},children:r.map((a=>{var i;const s=null===t||void 0===t||null===(i=t.attributes.pages.data.find((e=>e.id===a)))||void 0===i?void 0:i.attributes.name,r=!s;return(0,j.jsx)(n.A,{onClick:t=>!r&&(0,o.I$)({pageId:a,navigate:e,evt:t}),type:"dashed",size:"small",danger:r,children:s||"Deleted"},a)}))})}return(0,c.useEffect)((()=>{var s,d;let u=(null===t||void 0===t||null===(s=t.attributes.pages.data)||void 0===s?void 0:s.filter((e=>e.attributes.isSubpage)))||[];const c=(null===t||void 0===t||null===(d=t.attributes.pages.data)||void 0===d?void 0:d.filter((e=>!e.attributes.isSubpage)))||[];function h(t){const a=[];return[...c||[]].forEach(((i,s)=>{const r=i.attributes.containers;null===r||void 0===r||r.forEach(((r,l)=>{r.elements.filter((e=>"subpage"===e.type)).some((e=>e.subpageId===t))&&a.push((0,j.jsx)(n.A,{onClick:t=>(0,o.I$)({pageId:i.id,navigate:e,evt:t}),type:"dashed",size:"small",children:i.attributes.name},i.id+"_source_"+s+l))}))})),a}function f(e){var t,a;return!!(null===(t=u.find((t=>t.id===e)))||void 0===t||null===(a=t.attributes.containers)||void 0===a?void 0:a.some((e=>e.elements.some((e=>"subpage"===e.type||"subpageList"===e.type)))))}if(u){i&&(u=u.filter((e=>{const t=e.attributes.name;if(!t)return!1;const a=t.trim().toLowerCase(),s=i.trim().toLowerCase();return a.includes(s)})));const t=[];u.forEach((i=>{t.push({pageID:i.id,key:"subpage_"+i.id,name:(0,j.jsx)(v.A,{style:{whiteSpace:"nowrap"},onChange:e=>e&&a&&(0,o.gw)({projectId:a,pageId:i.id,inputData:{name:e}}),initialValue:i.attributes.name,value:i.attributes.name,validators:[e=>(0,x.Gl)({input:e,searchArray:u||[],searchKey:["attributes","name"]}).catch((e=>(r.Ay.error(e.message),Promise.reject())))]}),updated:(0,j.jsx)("div",{style:{minWidth:150},children:p()(i.attributes.updatedAt).format("MMM Do YYYY, h:mm a")}),used:(0,j.jsx)("div",{style:{display:"flex",gap:5,flexWrap:"wrap"},children:h(i.id)}),nestedSubs:f(i.id),actions:(0,j.jsxs)(l.A.Button,{onClick:t=>(0,o.I$)({pageId:i.id,navigate:e,evt:t}),menu:{items:[{key:"clonePage",icon:(0,j.jsx)(b.A,{}),label:"Clone SubPage",onClick:()=>a&&(0,o.BG)({pageCloneData:i})},{key:"remove",danger:!0,icon:(0,j.jsx)(m.A,{}),label:"Delete SubPage",onClick:()=>a&&(0,g.A)({pageId:i.id,projectId:a,isSubpage:i.attributes.isSubpage,name:i.attributes.name})}]},children:[(0,j.jsx)("svg",{style:{marginRight:3,marginBottom:-2},xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{fill:"currentColor",d:"M6 2c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-1.9l10-10V8l-6-6zm7 1.5L18.5 9H13zm7.1 9.5c-.1 0-.3.1-.4.2l-1 1l2.1 2.1l1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-2 1.8L12 20.9V23h2.1l6.1-6.1z"})}),"Open in Editor"]})})})),A(t)}}),[e,a,i,t]),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(C,{id:"SubPages",style:{margin:"15px 0"},level:5,children:"SubPages"}),y?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(s.A,{expandable:{expandedRowRender:e=>(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(d.A,{color:"geekblue",children:"1st level nested subpages"}),S(e.pageID)]}),rowExpandable:e=>e.nestedSubs},showSorterTooltip:!1,columns:I,dataSource:y,pagination:!1}),(0,j.jsx)(n.A,{style:{marginTop:15},type:"primary",onClick:()=>u("subpage"),children:"Create New SubPage"})]}):null]})}}}]);