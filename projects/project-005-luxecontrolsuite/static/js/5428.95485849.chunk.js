"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[5428],{55393:(e,n,t)=>{t.d(n,{c:()=>c,A:()=>u});var l,i=t(77645),a=t(98979),o=t(9950),r=t(57528);const s=t(86006).Ay.div(l||(l=(0,r.A)(["\n  position: relative;\n\n  .ant-input-group > *:first-child {\n    width: 40px;\n    cursor: pointer;\n  }\n"])));var d=t(44414);function c(e){const{r:n,g:t,b:l,a:i}=e.rgb;return"rgba(".concat(n,",").concat(t,",").concat(l,",").concat(i.toFixed(2),")")}const u=e=>{let{initialColorState:n,updater:t,disableAlpha:l}=e;const[r,u]=(0,o.useState)(n);return(0,o.useEffect)((()=>{const e=setTimeout((()=>{n!==r&&t(r)}),300);return()=>{clearTimeout(e)}}),[r,n]),(0,d.jsx)(s,{placeholder:"Default color",allowClear:!0,as:i.A,onChange:e=>{u(e.target.value)},spellCheck:!1,style:{marginBottom:15,textAlign:"center"},addonBefore:(0,d.jsx)(a.i,{disableAlpha:l,popup:!0,blockStyles:{border:0,boxShadow:"none",position:"absolute",left:0,top:0,width:"100%",height:"100%",borderRadius:"2px 0 0 2px"},picker:"SketchPicker",value:r,onChange:e=>{let n=c(e);u(n)}}),value:r})}},39165:(e,n,t)=>{t.d(n,{A:()=>a,I:()=>i});var l=t(64983);const i=e=>{var n;let{pageId:t}=e;return null===(n=l.f.getState().workingProject)||void 0===n?void 0:n.attributes.pages.data.find((e=>String(e.id)===String(t)))},a=e=>{let{pageId:n}=e;return(0,l.f)((e=>{var t;return null===(t=e.workingProject)||void 0===t?void 0:t.attributes.pages.data.find((e=>String(e.id)===String(n)))}))}},88210:(e,n,t)=>{function l(e){const n={};for(const t in e)if("object"===typeof e[t]&&null!==e[t]){const l=Object.keys(e[t]);for(const i of l)n[i]=e[t][i]}else n[t]=e[t];return n}function i(e,n){if("object"!==typeof e||null===e)return n;for(const t in e)if(e.hasOwnProperty(t)){const l=e[t];"object"===typeof l&&null!==l?n[t]=i(l,n[t]||{}):("string"===typeof l||"number"===typeof l||"boolean"===typeof l)&&(n[t]=l)}return n}function a(e,n){const t={};if(Array.isArray(e)){for(const n of e)i(n,t);return t}if(n&&void 0!==n){return function(e){for(const n in e)"object"===typeof e[n]&&null!==e[n]&&delete e[n];return e}(l(e))}return l(e)}t.d(n,{x:()=>a})},58128:(e,n,t)=>{t.d(n,{EM:()=>v,L5:()=>x,TT:()=>f,l4:()=>m,nG:()=>g,vE:()=>y});var l,i,a,o,r,s,d,c,u,p=t(57528),h=t(86006);h.Ay.div(l||(l=(0,p.A)(["\n  position: relative;\n  display: flex;\n  gap: 5px;\n"]))),h.Ay.div(i||(i=(0,p.A)(["\n  position: relative;\n  display: grid;\n  width: 100%;\n  height: 100%;\n  min-height: 0;\n  max-height: 100%;\n  overflow: hidden;\n  grid-template-columns: 300px 1fr 300px auto;\n  grid-template-rows: 1fr;\n  gap: 0px 0px;\n  grid-auto-flow: row;\n  grid-template-areas: 'navigate preview options console';\n\n  .navigate {\n    grid-area: navigate;\n    position: relative;\n\n    .overflow {\n      padding-bottom: 40px;\n    }\n\n    &:after {\n      box-shadow: inset -58px 0px 81px -35px rgba(0, 0, 0, 0.75);\n      border-right: 0.5px transparent solid;\n    }\n  }\n\n  .preview {\n    position: relative;\n    grid-area: preview;\n    background-color: #202123;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    overflow: hidden;\n\n    iframe {\n      position: relative;\n      width: 100%;\n      height: 100%;\n    }\n  }\n\n  .options {\n    grid-area: options;\n    position: relative;\n\n    &:after {\n      box-shadow: inset 58px 0px 81px -35px rgba(0, 0, 0, 0.75);\n      border-left: 0.5px transparent solid;\n    }\n\n    .overflow {\n      padding: 15px;\n      display: flex;\n      flex-flow: column;\n    }\n  }\n\n  .navigate,\n  .options {\n    .overflow {\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: 100%;\n      height: 100%;\n      overflow-y: scroll;\n      &::-webkit-scrollbar {\n        display: none;\n      }\n    }\n\n    &:after {\n      content: '';\n      position: absolute;\n      left: 0;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      pointer-events: none;\n      background-color: rgba(21, 18, 28, 0.2);\n      z-index: 10;\n      transition: 200ms;\n      backdrop-filter: blur(10px) saturate(200%);\n      opacity: 1;\n      display: none;\n    }\n    &.showBoundingBox {\n      &:after {\n        opacity: 0;\n      }\n    }\n\n    &:hover {\n      &:after {\n        opacity: 0;\n      }\n    }\n  }\n\n  .console {\n    position: relative;\n    background-color: #202124;\n    overflow-y: auto;\n    transition: 200ms;\n    will-change: all;\n    width: 0px;\n    transition-delay: 300ms;\n\n    .consoleMenu {\n      display: flex;\n      gap: 5px;\n      padding: 5px;\n      color: gray;\n      position: sticky;\n      top: 0;\n      width: 100%;\n      z-index: 10;\n      background-color: #202124;\n      margin-bottom: 10px;\n\n      button {\n        border-width: 0.5px;\n      }\n    }\n\n    .emptyConsole {\n      color: rgba(255, 255, 255, 0.46);\n      position: relative;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      text-transform: uppercase;\n      font-size: 10px;\n    }\n\n    .consoleLog {\n      width: 300px;\n      transform: translateX(300px);\n      transition: 200ms;\n    }\n\n    &.showConsole {\n      width: 300px;\n      .consoleLog {\n        transform: translateX(0);\n      }\n    }\n  }\n"])));const m=h.Ay.div(a||(a=(0,p.A)(["\n  width: 100%;\n  max-width: 100%;\n  min-width: 0;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  position: absolute;\n  left: 0;\n  top: 0;\n  padding-right: 30px;\n  padding-left: 48px;\n\n  .dragIcon {\n    margin-right: 10px;\n  }\n\n  .label {\n    flex: 1;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    min-width: 0;\n    position: relative;\n    z-index: 1;\n  }\n\n  &.elementMenu {\n    padding-left: 70px;\n    padding-right: 11px;\n    padding-top: 7px;\n\n    .label {\n      position: relative;\n      .tag {\n        font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande',\n          'Lucida Sans Unicode', Geneva, Verdana, sans-serif;\n        position: absolute;\n        top: 0;\n        font-size: 8px;\n        padding: 1px;\n        line-height: 1em;\n      }\n    }\n  }\n"]))),v=h.Ay.div(o||(o=(0,p.A)(["\n  display: flex;\n  align-items: center;\n  font-size: 16px;\n  margin: 5px 0 0 0;\n\n  .ant-form-item {\n    margin-bottom: 10px;\n  }\n\n  .ant-form-item-row {\n    flex-flow: row-reverse;\n    gap: 0.5em;\n  }\n"]))),x=h.Ay.div(r||(r=(0,p.A)(["\n  position: relative;\n  height: 1em;\n  width: 20px;\n  display: inline-block;\n  text-align: center;\n"]))),g=h.Ay.div(s||(s=(0,p.A)(["\n  position: relative;\n  display: flex;\n  justify-content: space-between;\n  gap: 10px;\n  margin-bottom: 15px;\n\n  .ant-input-number {\n    width: auto;\n  }\n"]))),y=h.Ay.div(d||(d=(0,p.A)(["\n  position: relative;\n  &:not(:last-child) {\n    border-bottom: 1px #d9d9d9 dotted;\n  }\n  &:last-child {\n    margin-bottom: 20px;\n  }\n\n  &.ant-collapse-item-active {\n    background-color: #f5f5f5 !important;\n  }\n\n  &.panelWithTag {\n    padding-top: 8px;\n    .tag {\n      position: absolute;\n      top: 0;\n      transform: translateY(-100%);\n      font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande',\n        'Lucida Sans Unicode', Geneva, Verdana, sans-serif;\n      font-size: 8px;\n      padding: 1px;\n      line-height: 1em;\n    }\n  }\n\n  p {\n    padding-bottom: 10px;\n  }\n"]))),f=h.Ay.div(c||(c=(0,p.A)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  max-height: 100%;\n  display: grid;\n  grid-template-rows: 1fr max-content;\n  gap: 1vmax;\n"])));h.Ay.div(u||(u=(0,p.A)(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  border: 1px #424242 solid;\n  border-width: 0 0.5px;\n  background-color: #1e1e1e;\n  display: flex;\n  flex-flow: column;\n\n  & > section {\n    height: calc(100vh - 113px) !important;\n  }\n\n  .fullScreenEditorButton {\n    padding: 5px;\n    button {\n      border-width: 0.5px;\n    }\n  }\n"])))},75428:(e,n,t)=>{t.r(n),t.d(n,{CreateNewElementAction:()=>X,RenderExistingActionsAccordeon:()=>Y,default:()=>Q});var l=t(1578),i=t(98412),a=t(12916),o=t(70171),r=t(87827),s=t(92759),d=t(17811),c=t(25933),u=t(56952),p=t(84649),h=t(44719),m=t(48538),v=t(77645),x=t(72429),g=t(99985),y=t(81541),f=t(40895),b=t(7985),j=t(93072),A=t(9950),w=t(99083),T=t(82278),C=t(27379),S=t(24513),F=t(44070),O=t(72906),k=t(3911),I=t(9964),V=t(14017),B=t(87998),E=t(58128),D=t(28429),P=t(27911),N=t(83063),L=t(9418),q=t(53088),R=t(44358),M=t(64983),G=t(39165),z=t(33490),W=t(35865),U=t(44414);const{Option:K}=l.A,{Panel:H}=i.A,$=()=>(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{className:"ghostTag",children:"value"}),(0,U.jsx)(a.A,{color:"geekblue",style:{margin:0,display:"flex",width:"100%",alignItems:"center",justifyContent:"center",minHeight:31},icon:(0,U.jsx)(w.A,{}),children:"Use onChange element value"})]}),_=[{label:(0,U.jsxs)(U.Fragment,{children:["True",(0,U.jsx)(o.A,{content:(0,U.jsxs)(U.Fragment,{children:["Send ",(0,U.jsx)(a.A,{color:"green",children:"TRUE"})]}),trigger:"hover",children:(0,U.jsx)(T.A,{style:{marginLeft:"5px"}})})]}),value:!0},{label:(0,U.jsxs)(U.Fragment,{children:["False",(0,U.jsx)(o.A,{content:(0,U.jsxs)(U.Fragment,{children:["Send ",(0,U.jsx)(a.A,{color:"red",children:"FALSE"})]}),trigger:"hover",children:(0,U.jsx)(T.A,{style:{marginLeft:"5px"}})})]}),value:!1},{label:(0,U.jsxs)(U.Fragment,{children:["Pulse",(0,U.jsx)(o.A,{content:(0,U.jsxs)(U.Fragment,{children:["Send ",(0,U.jsx)(a.A,{color:"green",children:"TRUE"}),"then ",(0,U.jsx)(a.A,{color:"red",children:"FALSE"})]}),trigger:"hover",children:(0,U.jsx)(T.A,{style:{marginLeft:"5px"}})})]}),value:"pulse"},{label:(0,U.jsxs)(U.Fragment,{children:["Momentarily",(0,U.jsx)(o.A,{content:(0,U.jsxs)("div",{style:{width:"300px"},children:["Immediately send ",(0,U.jsx)(a.A,{color:"green",children:"TRUE"}),"when event fired without waiting for any other events then send"," ",(0,U.jsx)(a.A,{color:"red",children:"FALSE"})," after touch end"]}),trigger:"hover",children:(0,U.jsx)(T.A,{style:{marginLeft:"5px"}})})]}),value:"momentarily"},{label:(0,U.jsxs)(U.Fragment,{children:["Toggle",(0,U.jsx)(o.A,{content:(0,U.jsx)(U.Fragment,{children:"Send toggled value of current signal Feedback"}),trigger:"hover",children:(0,U.jsx)(T.A,{style:{marginLeft:"5px"}})})]}),value:"toggle"}];const J=e=>{let{currentElementData:n,containerIndex:t,elementIndex:l,isGlobalContainer:i,pageId:a,value:o,onChange:r,placeholder:s,forceToNumber:d,disabled:c}=e;return(0,U.jsx)(q.A,{disabled:c,style:{width:"100%"},element:n,elementKeyProp:"Signal name",elementKeyPropName:"Signal name",dynamicContainerIndex:t,dynamicElementIndex:l,dynamicIsGlobalContainer:i,dynamicPageId:a,onChange:e=>{let n;d?n=(0,R.MU)(e):e&&(n=String(e)),r&&r(n)},value:o,allowClear:!0,placeholder:s})},X=e=>{var n,t,i,a,x;let{setNewElementActionModalOpen:g,activePageData:y,containerIndex:f,elementIndex:w,isGlobalContainer:C,staticListElementIndex:S,elementType:F,changeElementActionModalOpen:O,variableActionFor:k}=e;const I="object"===typeof O;let V,B;I&&(V=O.editActionData,B=O.editActionUpdater);const{pageId:E}=(0,D.g)(),[N]=r.A.useForm(),q=()=>{N.submit()},R=(0,M.f)((e=>e.workingProject)),[G,W]=(0,A.useState)();(0,A.useEffect)((()=>{let e;if(void 0!==f&&void 0!==w){var n,t,l;if(C)e=null===R||void 0===R||null===(n=R.attributes)||void 0===n||null===(t=n.globalContainers)||void 0===t?void 0:t[f].elements[w];else e=null===y||void 0===y||null===(l=y.attributes.containers)||void 0===l?void 0:l[f].elements[w];W(e)}}),[y,R,f,w,C]);const[H,$]=(0,A.useState)(!1);(0,A.useEffect)((()=>{var e;null!==G&&void 0!==G&&null!==(e=G.type)&&void 0!==e&&e.includes("List")&&void 0===S?$(!0):$(!1)}),[G,S]);const X=(null===R||void 0===R||null===(n=R.attributes.pages.data)||void 0===n?void 0:n.filter((e=>e.attributes.isSubpage)))||[],[Y,Q]=(0,A.useState)(!1),Z=function(e){const n=[{title:"Tap",behaviour:"tap"},{title:"Hold",behaviour:"hold"},{title:"Double Tap",behaviour:"dbTap"}],t=[{title:"On Change",behaviour:"onChange"},{title:"Before Change",behaviour:"beforeChange"},{title:"After Change",behaviour:"afterChange"}],l=[{title:"On Change",behaviour:"onChange"}];let i=[];return i="page"===e?[{title:"On Load",behaviour:"onload"},{title:"On Exit",behaviour:"onexit"}].map((e=>(0,U.jsx)(K,{value:e.behaviour,children:e.title},e.behaviour))):"variable"===e?l.map((e=>(0,U.jsx)(K,{value:e.behaviour,children:e.title},e.behaviour))):"slider"===e||"input"===e||"checkbox"===e||"switch"===e||"toggle"===e||"shades"===e||"circleSlider"===e?t.map((e=>(0,U.jsx)(K,{value:e.behaviour,children:e.title},e.behaviour))):n.map((e=>(0,U.jsx)(K,{value:e.behaviour,children:e.title},e.behaviour))),i}(F),ee=(0,z.c)((e=>e.calculatedVariables)),ne=(null===R||void 0===R?void 0:R.attributes.modificators.data)||[],te=r.A.useWatch("type",N),le=r.A.useWatch("behaviour",N),ie=r.A.useWatch("digitalPushData",N),ae=r.A.useWatch("attachedStateType",N),oe=r.A.useWatch("attachedVariableName",N),re=r.A.useWatch("onChangeActionUseCustomValue",N),se=r.A.useWatch("isOverlayCloser",N),de=null===le||void 0===le||null===(t=le.toLowerCase())||void 0===t?void 0:t.includes("change"),ce=null===le||void 0===le||null===(i=le.toLowerCase())||void 0===i?void 0:i.includes("dbtap"),[ue,pe]=(0,A.useState)(),he=(0,A.useMemo)((()=>ee&&ee.length>0?ee.filter((e=>void 0===e.pageId)):[]),[ee]),me=I?{pulseDelay:50,...V}:{type:"d",digitalPushData:"pulse",name:"New ".concat(F," action"),behaviour:Z[0].key,pulseDelay:50};(0,A.useEffect)((()=>{if("v"===te&&oe){let e=(0,L.Pb)(oe);e&&pe(e)}}),[ee,te,oe]),(0,A.useEffect)((()=>{I||(N.setFieldValue("signalName_signal",""),N.setFieldValue("value",""),N.setFieldValue("onChangeActionUseCustomValue",!1),N.setFieldValue("attachedVariableName",void 0),pe(void 0))}),[N,I,te]),(0,A.useEffect)((()=>{var e;const n=null===(e=V)||void 0===e?void 0:e.value;"boolean"===(null===ue||void 0===ue?void 0:ue.type)&&N.setFieldValue("value",null!==n&&void 0!==n?n:"true"),"string"===(null===ue||void 0===ue?void 0:ue.type)&&N.setFieldValue("value",null!==n&&void 0!==n?n:""),"number"===(null===ue||void 0===ue?void 0:ue.type)&&N.setFieldValue("value",null!==n&&void 0!==n?n:null)}),[null===(a=V)||void 0===a?void 0:a.value,N,ue]);const{projectId:ve}=(0,D.g)(),xe=(0,A.useMemo)((()=>{var e;return null===R||void 0===R||null===(e=R.attributes.pages.data)||void 0===e?void 0:e.filter((e=>!e.attributes.isSubpage))}),[null===R||void 0===R?void 0:R.attributes.pages.data]),[ge,ye]=(0,A.useState)([]),fe=[{value:"/",label:"Start Page"},{value:"-1",label:"Go Back"}];(0,A.useEffect)((()=>{if(null!==xe&&void 0!==xe&&xe.length){let e=[];xe.forEach((n=>{e.push({value:n.id,label:n.attributes.name||"no_name"})})),ye(e)}}),[xe]);const be=e=>{let{customValueFields:n}=e;return de?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(r.A.Item,{colon:!1,name:"onChangeActionUseCustomValue",label:" ",children:(0,U.jsx)(d.Ay.Group,{options:[{label:"Push onChange Value",value:!1},{label:"Push custom Value",value:!0}]})},"onchange data push val"),re&&n]}):(0,U.jsx)(U.Fragment,{children:n})},je=()=>{const[e,n]=(0,A.useState)(!1);return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(r.A.Item,{colon:!1,name:"",label:" ",style:{marginBottom:0},children:(0,U.jsxs)("div",{style:{marginBottom:15,marginTop:5},className:"switchRow",children:[(0,U.jsx)(c.A,{size:"small",checked:e,onChange:e=>{n(e)}}),"Enter the page name manually"]})}),e?(0,U.jsx)(r.A.Item,{colon:!1,name:"pageFlipTargetByName",label:"Target page name",rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(J,{placeholder:"Page name",currentElementData:G,isGlobalContainer:C,elementIndex:w,containerIndex:f,pageId:E})},"route val"):(0,U.jsx)(r.A.Item,{colon:!1,name:"pageFlipTarget",label:"Target page",rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(l.A,{showSearch:!0,placeholder:"Select page",optionFilterProp:"children",filterOption:(e,n)=>{var t;return(null!==(t=null===n||void 0===n?void 0:n.label)&&void 0!==t?t:"").toLowerCase().includes(e.toLowerCase())},options:[{label:"Project Pages",options:null!==ge&&void 0!==ge&&ge.length?ge:[{label:"No pages...",disabled:!0}]},{label:"Predefined Routes",options:[...fe]}]})},"route val")]})},Ae=()=>(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(r.A.Item,{colon:!1,name:"signalName_signal",label:(0,U.jsxs)(U.Fragment,{children:["Signal Name",(0,U.jsx)("span",{style:{marginLeft:"5px"},children:(0,U.jsx)(b.A,{style:{margin:0},type:te})})]}),rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(J,{placeholder:"Signal Name",currentElementData:G,isGlobalContainer:C,elementIndex:w,containerIndex:f,pageId:E})},"signalName val"),(0,U.jsx)(be,{customValueFields:(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(r.A.Item,{name:"digitalPushData",colon:!1,label:(0,U.jsxs)(U.Fragment,{children:["Push data",(0,U.jsx)("span",{style:{marginLeft:"5px"},children:(0,U.jsx)(b.A,{style:{margin:0},type:te})})]}),rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(d.Ay.Group,{style:{display:"flex",flexFlow:"column",gap:"5px",marginTop:"7px"},options:de||ce?_.filter((e=>"momentarily"!==e.value)):_})},"digital data push val"),"pulse"===ie&&(0,U.jsx)(r.A.Item,{colon:!1,required:!1,name:"pulseDelay",label:"Pulse Delay",children:(0,U.jsx)(u.A,{placeholder:"50",style:{width:"100%"},addonAfter:"ms",type:"number"})})]})},te)]}),we=()=>(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(r.A.Item,{colon:!1,name:"signalName_signal",label:(0,U.jsxs)(U.Fragment,{children:["Signal Name",(0,U.jsx)("span",{style:{marginLeft:"5px"},children:(0,U.jsx)(b.A,{style:{margin:0},type:te})})]}),rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(J,{placeholder:"Signal Name",currentElementData:G,isGlobalContainer:C,elementIndex:w,containerIndex:f,pageId:E})},"signalName val"),(0,U.jsx)(be,{customValueFields:(0,U.jsx)(r.A.Item,{colon:!1,name:"value",label:"Value",rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(J,{placeholder:"Value",currentElementData:G,isGlobalContainer:C,elementIndex:w,containerIndex:f,pageId:E})})},te)]}),Te=()=>(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(r.A.Item,{colon:!1,name:"attachedFunctionToRun",label:"Select Function",rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(l.A,{showSearch:!0,placeholder:"Select function",options:[...ne.map((e=>({value:e.id,label:(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(b.A,{style:{margin:5},type:"f"}),e.attributes.name]})})))]})}),(0,U.jsx)(be,{customValueFields:(0,U.jsx)(r.A.Item,{colon:!1,name:"value",label:"Value",rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(J,{placeholder:"Value",currentElementData:G,isGlobalContainer:C,elementIndex:w,containerIndex:f,pageId:E})})},te)]}),Ce=()=>(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(r.A.Item,{colon:!1,name:"signalName_signal",label:(0,U.jsxs)(U.Fragment,{children:["Signal Name",(0,U.jsx)("span",{style:{marginLeft:"5px"},children:(0,U.jsx)(b.A,{style:{margin:0},type:te})})]}),rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(J,{placeholder:"Signal Name",currentElementData:G,isGlobalContainer:C,elementIndex:w,containerIndex:f,pageId:E})},"signalName val"),(0,U.jsx)(be,{customValueFields:(0,U.jsx)(r.A.Item,{colon:!1,name:"value",label:"Value",rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(J,{placeholder:"Value",currentElementData:G,isGlobalContainer:C,elementIndex:w,containerIndex:f,pageId:E})})},te)]}),Se=()=>(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(r.A.Item,{colon:!1,name:"attachedVariableName",label:"Select Variable",rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(l.A,{showSearch:!0,placeholder:"Select variable",options:[...he.map((e=>({value:e.name,label:(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(b.A,{style:{margin:5},type:e.type}),e.name]})})))]})}),"number"===(null===ue||void 0===ue?void 0:ue.type)&&(0,U.jsx)(r.A.Item,{colon:!1,name:"value",label:"Set Value",rules:[{required:!0,message:"This field is required."},()=>({validator:(e,n)=>Promise.all([(0,P.mC)(n)])})],children:(0,U.jsx)(J,{forceToNumber:!0,placeholder:"Value",currentElementData:G,isGlobalContainer:C,elementIndex:w,containerIndex:f,pageId:E})}),"string"===(null===ue||void 0===ue?void 0:ue.type)&&(0,U.jsx)(r.A.Item,{colon:!1,name:"value",label:"Set Value",rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(J,{placeholder:"Value",currentElementData:G,isGlobalContainer:C,elementIndex:w,containerIndex:f,pageId:E})}),"boolean"===(null===ue||void 0===ue?void 0:ue.type)&&(0,U.jsx)(r.A.Item,{colon:!1,name:"value",label:"Set Value",rules:[{required:!1,message:"This field is required."}],children:(0,U.jsx)(p.A,{block:!0,options:["true","false","toggle"]})})]}),Fe=()=>{const e=!!N.getFieldValue("overlayAttachedSubpageName"),[n,t]=(0,A.useState)(e);return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(r.A.Item,{colon:!1,name:"isOverlayCloser",label:" ",children:(0,U.jsx)(p.A,{block:!0,options:[{label:"Open new",value:"false"},{label:"Close active",value:"true"}]})}),"true"!==se?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(r.A.Item,{colon:!1,name:"",label:" ",style:{marginBottom:0},children:(0,U.jsxs)("div",{style:{marginBottom:15,marginTop:5},className:"switchRow",children:[(0,U.jsx)(c.A,{size:"small",checked:n,onChange:e=>{t(e)}}),"Open overlay dynamically by Subpage name"]})}),n?(0,U.jsx)(r.A.Item,{preserve:!1,colon:!1,name:"overlayAttachedSubpageName",label:"Overlay SubPage name",rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(J,{placeholder:"SubPage name",currentElementData:G,isGlobalContainer:C,elementIndex:w,containerIndex:f,pageId:E})},"route val"):(0,U.jsx)(r.A.Item,{colon:!1,name:"overlayAttachedSubpage",label:"Attach SubPage",rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(l.A,{showSearch:!0,placeholder:"Attach SubPage",filterOption:(e,n)=>{var t;return(null!==(t=null===n||void 0===n?void 0:n.label)&&void 0!==t?t:"").toLowerCase().includes(e.toLowerCase())},options:[...X.map((e=>({value:e.id,label:e.attributes.name})))]})})]}):null]})},Oe=()=>(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(r.A.Item,{colon:!1,name:"attachedStateType",label:"Select type",rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(l.A,{showSearch:!0,placeholder:"Select state type",options:[...[{name:"Boolean",type:"boolean"},{name:"Number",type:"number"},{name:"String",type:"string"},{name:"Digital join",type:"d"},{name:"Analog join",type:"a"},{name:"Serial join",type:"s"}].map((e=>({value:e.type,label:(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(b.A,{style:{margin:5},type:e.type}),e.name]})})))]})}),""!==ae&&(0,U.jsx)(r.A.Item,{colon:!1,name:"stateId",label:"Set Name",rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(J,{placeholder:"State name",currentElementData:G,isGlobalContainer:C,elementIndex:w,containerIndex:f,pageId:E})}),"number"!==ae&&"string"!==ae&&"boolean"!==ae&&""!==ae&&(0,U.jsx)(r.A.Item,{colon:!1,name:"stateValue",label:"Set Signal",rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(J,{forceToNumber:!0,placeholder:"Signal number",currentElementData:G,isGlobalContainer:C,elementIndex:w,containerIndex:f,pageId:E})}),"number"===ae&&(0,U.jsx)(r.A.Item,{colon:!1,name:"stateValue",label:"Set Value",rules:[{required:!0,message:"This field is required."},()=>({validator:(e,n)=>Promise.all([(0,P.mC)(n)])})],children:(0,U.jsx)(J,{forceToNumber:!0,placeholder:"Value",currentElementData:G,isGlobalContainer:C,elementIndex:w,containerIndex:f,pageId:E})}),"string"===ae&&(0,U.jsx)(r.A.Item,{colon:!1,name:"stateValue",label:"Set Value",rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(J,{placeholder:"Value",currentElementData:G,isGlobalContainer:C,elementIndex:w,containerIndex:f,pageId:E})}),"boolean"===ae&&(0,U.jsx)(r.A.Item,{colon:!1,name:"stateValue",label:"Set Value",rules:[{required:!1,message:"This field is required."}],children:(0,U.jsx)(p.A,{block:!0,options:["true","false","toggle"]})})]});let ke=[{value:"d",label:"Digital"},{value:"a",label:"Analog"},{value:"s",label:"Serial"},{value:"r",label:"Routing (Page flip)"},{value:"v",label:"Variable"},{value:"o",label:"Overlay"},{value:"st",label:"State"},{value:"f",label:"Run Function"}];return"page"===F&&(ke=ke.filter((e=>"o"!==e.value&&"r"!==e.value))),"variable"===F&&(ke=ke.filter((e=>"o"!==e.value))),(0,U.jsx)("div",{onKeyUp:e=>{"Enter"===e.key&&q()},children:(0,U.jsx)(h.A,{width:"min(750px, 90%)",forceRender:!0,destroyOnClose:!0,afterClose:()=>N.resetFields(),maskClosable:!1,title:I?"Edit: ".concat(null===(x=V)||void 0===x?void 0:x.name):"New ".concat(F," action"),open:!0,onOk:q,onCancel:()=>g(!1),footer:[(0,U.jsx)(m.A,{onClick:()=>g(!1),children:"Cancel"},"back"),(0,U.jsx)(m.A,{loading:Y,type:"primary",onClick:q,children:I?"Save Action":"Add Action"},"submit")],children:(0,U.jsxs)(r.A,{onValuesChange:e=>{Object.keys(e).some((e=>"type"===e||"behaviour"===e))&&N.setFieldValue("onChangeActionUseCustomValue",!1)},initialValues:me,labelCol:{xs:{span:8}},wrapperCol:{xs:{span:12}},form:N,onFinish:e=>{var n,t,l,i,a;if(Q(!0),"true"===(null===(n=e)||void 0===n?void 0:n.isOverlayCloser)&&(delete e.isOverlayCloser,e.type="co"),"variable"===F&&k){var o;const n=null!==(o=null===k||void 0===k?void 0:k.actions)&&void 0!==o?o:[];if(I){var r;null===(r=B(e))||void 0===r||r.then((()=>g(!1)))}else{const t=[...n,e];(0,L.I7)({projectId:ve,updatedVariable:{...k,actions:t}}).then((()=>g(!1))).finally((()=>Q(!1)))}return}if("page"===F){if(!y)return;let n=structuredClone(y.attributes.actions||[]);var d;if(I)null===(d=B(e))||void 0===d||d.then((()=>g(!1)));else(0,j.yd)({pageId:E,newPageAttributes:{actions:[...n,e]}}).then((()=>g(!1))).finally((()=>Q(!1)));return}let c=[],u=[];var p,h;G&&(c=[...(null===G||void 0===G?void 0:G.actions)||[]]||[],void 0!==S&&(u=(null===G||void 0===G||null===(p=G.staticListOverrides)||void 0===p||null===(h=p[S])||void 0===h?void 0:h.actions)||[]));const{behaviour:m,type:v}=e,x=(null===(t=c)||void 0===t||null===(l=t.filter((e=>e.behaviour===m)))||void 0===l?void 0:l.some((e=>"o"===e.type||"co"===e.type)))||(null===(i=u)||void 0===i||null===(a=i.filter((e=>e.behaviour===m)))||void 0===a?void 0:a.some((e=>"o"===e.type||"co"===e.type)));if(("o"===v||"co"===v)&&x&&!I)return void s.Ay.error("Overlay action already exist. Element can handle only one overlay action at a time.");"o"===v&&(e={...e,showMask:!0,showCloseButton:!0,outsideClose:!0,overlayPlacement:"fullscreen"});let b=[];var A;(console.log("newAction",e),b=void 0===S?[...c,e]:[...u||[],e],void 0!==f)&&(I?null===(A=B(e))||void 0===A||A.then((()=>g(!1))):(0,j.ld)({action:"update",containerIndex:f,elementIndex:w,dataToUpdate:{actions:b},pageId:E,isGlobal:C,staticListElementIndex:S}).then((()=>g(!1))).finally((()=>Q(!1))))},scrollToFirstError:!0,children:[(0,U.jsx)(r.A.Item,{colon:!1,required:!1,name:"name",label:"Name",rules:[{required:!0,message:"This field is required."}],children:(0,U.jsx)(v.A,{})}),(0,U.jsx)(r.A.Item,{colon:!1,required:!0,rules:[{required:!0,message:"This field is required."}],name:"behaviour",label:"Behaviour",children:(0,U.jsx)(l.A,{placeholder:"Action trigger",style:{width:"100%"},children:Z})}),"tap"===le?(0,U.jsx)(r.A.Item,{colon:!1,label:(0,U.jsxs)(U.Fragment,{children:["Force Tap Execution",(0,U.jsx)(o.A,{content:(0,U.jsx)("div",{style:{maxWidth:200},children:"When enabled action fired immediately on touch without waiting for hold/momentarily events"}),trigger:"hover",children:(0,U.jsx)(T.A,{style:{marginLeft:"5px"}})})]}),preserve:!1,name:"forceExecution",valuePropName:"checked",children:(0,U.jsx)(c.A,{})}):null,(0,U.jsx)(r.A.Item,{colon:!1,required:!1,name:"type",label:"Type",children:(0,U.jsx)(l.A,{style:{width:"100%"},children:ke.map((e=>(0,U.jsx)(K,{value:e.value,children:e.label},e.value)))})}),(0,U.jsx)(r.A.Item,{colon:!1,required:!1,name:"delay",label:"Execution Delay",children:(0,U.jsx)(u.A,{placeholder:"No delay",style:{width:"100%"},addonAfter:"ms",type:"number"})}),"r"===te&&(0,U.jsx)(je,{}),"s"===te&&(0,U.jsx)(we,{}),"a"===te&&(0,U.jsx)(Ce,{}),"d"===te&&(0,U.jsx)(Ae,{}),"v"===te&&(0,U.jsx)(Se,{}),"o"===te&&(0,U.jsx)(Fe,{}),"st"===te&&(0,U.jsx)(Oe,{}),"f"===te&&(0,U.jsx)(Te,{}),H&&("a"===te||"d"===te||"s"===te)&&(0,U.jsx)(r.A.Item,{initialValue:1,extra:"Works only for numeric signal name",colon:!1,required:!1,name:"listSignalStep",label:"List Signal Step",children:(0,U.jsx)(u.A,{placeholder:"List Signal Step",min:0,style:{width:"100%"}})})]})})})},Y=e=>{let{actionsArr:n,containerIndex:t,elementIndex:l,isGlobalContainer:o,staticListElementIndex:r,elementType:d,variableActionFor:c}=e;const u=(0,M.f)((e=>e.workingProject)),p=(null===u||void 0===u?void 0:u.attributes.modificators.data)||[],{pageId:v}=(0,D.g)(),{projectId:w}=(0,D.g)(),T=(0,G.A)({pageId:v});function q(e,i,a){let s=structuredClone(n);return s[e]={...s[e],...i},"page"===a?(0,j.yd)({pageId:v,newPageAttributes:{actions:s}}):"variable"===a?c?(0,L.I7)({projectId:w,updatedVariable:{...c,actions:s}}):Promise.reject("Variable not found"):void 0===t?void console.log("containerIndex undef"):(0,j.ld)({staticListElementIndex:r,action:"update",containerIndex:t,elementIndex:l,dataToUpdate:{actions:s},pageId:v,isGlobal:o})}const R=e=>{h.A.confirm({title:"Delete Action?",zIndex:3e3,icon:(0,U.jsx)(C.A,{}),content:"Are you sure to delete action? It cannot be undone.",okText:"Delete action",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>function(e){if("page"===d){let n=structuredClone(null===T||void 0===T?void 0:T.attributes.actions);return n&&null!==n&&void 0!==n&&n.length?(n.splice(e,1),(0,j.yd)({pageId:v,newPageAttributes:{actions:n}})):void console.log("Cannot delete action - empty array")}if("variable"===d){var n;let t=structuredClone(null!==(n=null===c||void 0===c?void 0:c.actions)&&void 0!==n?n:[]);return t&&null!==t&&void 0!==t&&t.length?(t.splice(e,1),c?(0,L.I7)({projectId:w,updatedVariable:{...c,actions:t}}):Promise.reject("Variable not found")):void console.log("Cannot delete action - empty array")}{var i,a,s,p,h,m,x,g;if(void 0===t)return void console.log("containerIndex undef");if(void 0===l)return void console.log("containerIndex undef");const n=null===(i=W.x.getState().selectedMenuSection)||void 0===i?void 0:i.modeIndex;let d;var y,f;d=o?null===u||void 0===u?void 0:u.attributes.globalContainers[t].elements[l]:null===T||void 0===T||null===(y=T.attributes)||void 0===y||null===(f=y.containers)||void 0===f?void 0:f[t].elements[l];const c=n&&n>0?null!==(a=null===(s=d)||void 0===s||null===(p=s.modes)||void 0===p||null===(h=p[n])||void 0===h||null===(m=h.modeProps)||void 0===m?void 0:m.actions)&&void 0!==a?a:[]:null!==(x=null===(g=d)||void 0===g?void 0:g.actions)&&void 0!==x?x:[];if(null===c||void 0===c||!c.length)return void console.log("Cannot delete action - no targer element ections");const b=c.slice(0,e).concat(c.slice(e+1));(0,j.ld)({staticListElementIndex:r,action:"update",containerIndex:t,elementIndex:l,dataToUpdate:{actions:b},pageId:v,isGlobal:o})}}(e),onCancel:()=>console.log("cancel action delete")})},z=e=>[{key:"Edit action",icon:(0,U.jsx)(S.A,{}),label:(0,U.jsx)("div",{onClick:t=>{t.stopPropagation(),t.preventDefault(),ce({editActionData:n[e],editActionUpdater:n=>q(e,n,d)})},children:"Edit action"})},{key:"Delete action",icon:(0,U.jsx)(F.A,{}),danger:!0,label:(0,U.jsx)("div",{onClick:n=>{n.stopPropagation(),n.preventDefault(),R(e)},children:"Delete action"})}],K=e=>(0,U.jsx)(x.A,{menu:{items:z(e)},placement:"bottomRight",children:(0,U.jsx)(m.A,{size:"small",type:"link",shape:"circle",icon:(0,U.jsx)(O.A,{})})}),[_,J]=(0,A.useState)(""),Y=(0,A.useMemo)((()=>{var e;return(null===u||void 0===u||null===(e=u.attributes.pages.data)||void 0===e?void 0:e.filter((e=>!e.attributes.isSubpage)))||[]}),[u]),Q=(0,A.useMemo)((()=>{var e;return(null===u||void 0===u||null===(e=u.attributes.pages.data)||void 0===e?void 0:e.filter((e=>e.attributes.isSubpage)))||[]}),[u]),[Z,ee]=(0,A.useState)([]);(0,A.useEffect)((()=>{if(null!==Y&&void 0!==Y&&Y.length){let e=[];Y.forEach((n=>{e.push({value:n.id,label:n.attributes.name||"no_name"})})),ee(e)}}),[Y]);const ne=e=>{let{elementAction:n,i:t}=e,l="";if(n.pageFlipTargetByName)l=n.pageFlipTargetByName;else{var i;let e=n.pageFlipTarget||n.signalName_signal;"/"===e&&(e="=> load start page"),"-1"===e&&(e="<= go back"),l=(null===(i=Z.find((n=>n.value===e)))||void 0===i?void 0:i.label)||e}return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{className:"ghostTag",children:"target page name"}),l]})},te=e=>{let{elementAction:n,i:t}=e;const l=()=>!n.behaviour.toLowerCase().includes("change")||null!==n&&void 0!==n&&n.onChangeActionUseCustomValue?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{className:"ghostTag",children:"value"}),(0,U.jsx)("p",{children:n.value})]}):(0,U.jsx)($,{});return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{className:"ghostTag",children:"signal name"}),(0,U.jsx)("p",{children:n.signalName_signal}),(0,U.jsx)(l,{})]})},le=e=>{let{elementAction:n,i:t}=e;const l=()=>!n.behaviour.toLowerCase().includes("change")||null!==n&&void 0!==n&&n.onChangeActionUseCustomValue?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{className:"ghostTag",children:"value"}),(0,U.jsx)("p",{children:Number(n.value)})]}):(0,U.jsx)($,{});return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{className:"ghostTag",children:"signal name"}),(0,U.jsx)("p",{children:n.signalName_signal}),(0,U.jsx)(l,{})]})},ie=e=>{let{elementAction:n,i:t}=e;const l=()=>{const e="pulse"===n.digitalPushData||void 0===n.digitalPushData;var t,l;return!n.behaviour.toLowerCase().includes("change")||null!==n&&void 0!==n&&n.onChangeActionUseCustomValue?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{className:"ghostTag",children:"digital push data"}),(0,U.jsx)("p",{children:null!==(t=String(n.digitalPushData))&&void 0!==t?t:"pulse"}),e&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{className:"ghostTag",children:"pulse delay"}),(0,U.jsxs)("p",{children:[null!==(l=n.pulseDelay)&&void 0!==l?l:50,"ms"]})]})]}):(0,U.jsx)($,{})};return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{className:"ghostTag",children:"signal name"}),(0,U.jsx)("p",{children:n.signalName_signal}),(0,U.jsx)(l,{})]})},ae=e=>{let{elementAction:n,i:t}=e;const l=(0,L.Pb)(n.attachedVariableName||"");return l?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{className:"ghostTag",children:"selected variable"}),(0,U.jsxs)("div",{style:{marginBottom:10},children:[(0,U.jsx)(b.A,{style:{margin:0,marginRight:5},type:l.type,crestronLikeTypesNaming:!1}),l.name]}),(0,U.jsx)("div",{className:"ghostTag",children:"set value"}),"string"===(null===l||void 0===l?void 0:l.type)&&(0,U.jsx)("p",{children:n.value}),"number"===(null===l||void 0===l?void 0:l.type)&&(0,U.jsx)("p",{children:Number(n.value)}),"boolean"===(null===l||void 0===l?void 0:l.type)&&(0,U.jsx)("p",{children:n.value})]}):(0,U.jsx)(g.A,{message:"Variable {".concat(n.attachedVariableName,"} was deleted"),type:"error"})},oe=e=>{var n,t;let{elementAction:l,i:i}=e;const a=null!==(n=null===(t=Q.find((e=>e.id===l.overlayAttachedSubpage)))||void 0===t?void 0:t.attributes.name)&&void 0!==n?n:"No subpage";return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{className:"ghostTag",children:"attached subpage"}),(0,U.jsx)("p",{children:a})]})},re=e=>{var n,t;let{elementAction:l,i:i}=e;const a=()=>!l.behaviour.toLowerCase().includes("change")||null!==l&&void 0!==l&&l.onChangeActionUseCustomValue?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{className:"ghostTag",children:"value"}),(0,U.jsx)("p",{children:l.value})]}):(0,U.jsx)($,{}),o=null!==(n=null===(t=p.find((e=>e.id===l.attachedFunctionToRun)))||void 0===t?void 0:t.attributes.name)&&void 0!==n?n:l.attachedFunctionToRun;return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{className:"ghostTag",children:"Attached Function"}),(0,U.jsx)("p",{children:o}),(0,U.jsx)(a,{})]})};let se=null===n||void 0===n?void 0:n.map(((e,n)=>{var t;return(0,U.jsxs)(E.vE,{className:"panelWithTag",as:H,extra:(0,U.jsx)("div",{onClick:e=>{e.stopPropagation()},children:K(n)}),header:(0,U.jsxs)(E.l4,{style:{top:13,paddingLeft:38},children:[(0,U.jsxs)(a.A,{className:"tag",children:[e.behaviour,null!==e&&void 0!==e&&e.forceExecution?" forced":""]}),(0,U.jsx)("div",{className:"label",children:e.name}),null!==e&&void 0!==e&&e.delay?(0,U.jsx)(y.A,{title:"Delay: ".concat(null===e||void 0===e?void 0:e.delay,"ms"),children:(0,U.jsx)(k.A,{style:{color:"var(--ant-primary-5)"}})}):null,(0,U.jsx)(b.A,{type:e.type})]}),children:[(0,U.jsx)("div",{className:"ghostTag",children:"behaviour"}),(0,U.jsxs)("p",{children:[e.behaviour,null!==e&&void 0!==e&&e.forceExecution?" [forced]":""]}),(0,U.jsx)("div",{className:"ghostTag",children:"execution delay"}),(0,U.jsxs)("p",{children:[null!==(t=null===e||void 0===e?void 0:e.delay)&&void 0!==t?t:0,"ms"]}),"r"===e.type&&(0,U.jsx)(ne,{elementAction:e,i:n}),"s"===e.type&&(0,U.jsx)(te,{elementAction:e,i:n}),"f"===e.type&&(0,U.jsx)(re,{elementAction:e,i:n}),"a"===e.type&&(0,U.jsx)(le,{elementAction:e,i:n}),"d"===e.type&&(0,U.jsx)(ie,{elementAction:e,i:n}),"v"===e.type&&(0,U.jsx)(ae,{elementAction:e,i:n}),"o"===e.type&&(0,U.jsx)(oe,{elementAction:e,i:n}),d.includes("List")&&void 0===r&&("a"===e.type||"d"===e.type||"s"===e.type)&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{className:"ghostTag",children:"list signal step"}),(0,U.jsx)(N.A,{style:{marginBottom:15},onChange:e=>q(n,{listSignalStep:e},d),initialValue:(null===e||void 0===e?void 0:e.listSignalStep)||0,value:(null===e||void 0===e?void 0:e.listSignalStep)||0,validators:[e=>(0,P.WE)(e).catch((e=>(s.Ay.error(e.message),Promise.reject())))]})]})]},"elementAction_"+n)}));const[de,ce]=(0,A.useState)(!1),ue=(0,W.x)((e=>{var n;return null===(n=e.selectedMenuSection)||void 0===n?void 0:n.modeIndex})),pe=(0,W.x)((e=>{var n;return null===(n=e.selectedMenuSection)||void 0===n?void 0:n.isModeHasOwnActions}));return void 0===ue||pe||"page"===d||"variable"===d?(0,U.jsxs)(U.Fragment,{children:[se&&se.length?(0,U.jsx)(i.A,{activeKey:_,onChange:e=>J(e),accordion:!0,style:{margin:"0 -15px -15px -15px",userSelect:"none"},expandIcon:e=>{let{isActive:n}=e;return n?(0,U.jsx)(I.A,{style:{marginTop:6},rotate:90}):(0,U.jsx)(V.A,{style:{marginTop:6}})},ghost:!0,children:se}):(0,U.jsx)("div",{style:{opacity:.5,fontSize:14,marginTop:15},children:"No actions yet..."}),"variable"!==d&&(0,U.jsx)(f.A,{}),(0,U.jsx)("div",{className:"addActionButton",children:(0,U.jsxs)(m.A,{size:"variable"===d?"small":"middle",style:{marginBottom:10,marginTop:"variable"===d?10:0},onClick:()=>{ce(!0)},type:"dashed",block:"variable"!==d,icon:(0,U.jsx)(B.A,{}),children:["Add ",d," action"]})}),de&&(0,U.jsx)(X,{variableActionFor:c,changeElementActionModalOpen:de,elementType:d,staticListElementIndex:r,containerIndex:t,elementIndex:l,activePageData:T,isGlobalContainer:o,setNewElementActionModalOpen:ce})]}):(0,U.jsx)(a.A,{children:"Default actions used for this mode"})},Q=Y},23989:(e,n,t)=>{t.d(n,{A:()=>W});var l=t(57528),i=t(87827),a=t(77645),o=t(17811),r=t(84649),s=t(12916),d=t(81541),c=t(48538),u=t(72429),p=t(1578),h=t(40895),m=t(35492),v=t(44719),x=t(62863),g=t(44070),y=t(50430),f=t(33626),b=t(9950),j=t(20735),A=t(26762),w=t(53387),T=t(88210),C=t(7985),S=t(44358),F=t(44414);const O=e=>{let{operandType:n,setFilter:t,prevFilter:l,setFilteringInterfaceModalOpen:i,selectedArray:a}=e;const[o,r]=(0,b.useState)([]),[s,d]=(0,b.useState)(null);(0,b.useEffect)((()=>{function e(e){let{title:n,...t}=e;return(0,F.jsx)("span",{...t,style:{fontSize:"16px"},children:n})}function n(e){let{title:n,...t}=e;return(0,F.jsx)("span",{...t,style:{fontSize:"14px",color:"#D2D2D2"},children:n})}function t(e){let{title:n,value:t,...l}=e,i="string"===typeof t?"string":"number"===typeof t?"number":"boolean";return(0,F.jsxs)("div",{...l,style:{fontSize:"14px",display:"flex",flexFlow:"row",alignItems:"baseline",color:"var(--ant-primary-5)"},children:[(0,F.jsx)(j.A,{style:{marginRight:5}}),'"',n,'" :'," ",(0,F.jsx)(C.A,{crestronLikeTypesNaming:!1,style:{marginLeft:10},type:i}),(0,F.jsx)("span",{style:{color:"#CB4B15",marginLeft:5},children:t})]})}a&&r([function l(i){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"main";const o=[];for(const e in i)if(i.hasOwnProperty(e)){const r=i[e];let s;if("object"===typeof r)if(Array.isArray(r)){const t=r.map(((n,t)=>l(n,"".concat(a,".").concat(e,"[").concat(t,"]"))));s={title:(0,F.jsx)(n,{title:"".concat(e," [...]")}),key:"".concat(a,".").concat(e),selectable:!1,children:t}}else s={title:(0,F.jsx)(n,{title:"".concat(e," {...}")}),selectable:!1,key:"".concat(a,".").concat(e,".object"),children:[l(r,"".concat(a,".").concat(e))]};else s={title:(0,F.jsx)(t,{title:"".concat(e),value:r}),key:"".concat(a,".").concat(e),selectable:!0};o.push(s)}return"main"===a?{title:(0,F.jsx)(e,{title:"Datasource"}),selectable:!1,key:a,children:o}:{title:(0,F.jsx)(n,{title:"Object {...}"}),selectable:!1,key:a,children:o}}((0,T.x)(a))])}),[a]);return(0,F.jsx)(v.A,{title:(0,F.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,F.jsx)("div",{children:"Field selection"})}),open:!0,forceRender:!0,destroyOnClose:!0,maskClosable:!1,centered:!0,width:"70vw",bodyStyle:{height:"60vh",position:"relative",display:"flex",flexFlow:"column"},onCancel:()=>{i(!1)},footer:[(0,F.jsx)(c.A,{onClick:()=>{d(null),i(!1)},children:"Cancel"},"cancelFilter"),(0,F.jsx)(c.A,{type:"primary",disabled:null===s,onClick:()=>{s&&l&&("alternativeField"===n&&t({...l,alternativeField:s.field,alternativeFieldValue:s.value,alternativeFieldType:"field"}),"conditionOperandA"===n&&(l.condition?t({...l,condition:{...l.condition,conditionOperandA:s.field,conditionOperandAValue:s.value,conditionOperandAType:"field"}}):t({...l,condition:{conditionOperandA:s.field,conditionOperandAType:"field",conditionOperandAValue:s.value,conditionType:null,conditionOperandB:null,conditionOperandBType:null,conditionOperandBValue:null}})),"conditionOperandB"===n&&(l.condition?t({...l,condition:{...l.condition,conditionOperandB:s.field,conditionOperandBValue:s.value,conditionOperandBType:"field"}}):t({...l,condition:{conditionOperandB:s.field,conditionOperandBType:"field",conditionOperandBValue:s.value,conditionType:null,conditionOperandA:null,conditionOperandAType:null,conditionOperandAValue:null}}))),d(null),i(!1)},children:"Save changes"},"setFilter")],children:(0,F.jsx)("div",{style:{position:"relative",flex:1,height:"100%",width:"100%",overflow:"scroll"},children:(0,F.jsx)(y.A,{showLine:!0,showIcon:!0,defaultExpandedKeys:["datasource"],onSelect:(e,n)=>{d({field:n.node.key,value:n.node.title.props.value})},treeData:[{title:"Fields",key:"datasource",children:o}]})})})};var k=t(64983);const I=e=>{let{operandType:n,disabledTypes:t,setFilter:l,prevFilter:i,setOpenVariableSelectionModal:a}=e;const[o,r]=(0,b.useState)([]),[s,d]=(0,b.useState)(null),u=(0,k.f)((e=>e.workingProject)),p=null===u||void 0===u?void 0:u.attributes.variables;(0,b.useEffect)((()=>{if(p&&p.length>0){const e=p.map((e=>{let l=!t||"alternativeField"!==n||!t.includes(e.type);return{title:(0,F.jsxs)("div",{children:[(0,F.jsx)("span",{style:{marginLeft:5,color:"black"},children:e.name}),(0,F.jsx)(C.A,{crestronLikeTypesNaming:!1,style:{marginLeft:10},type:e.type})]}),key:e.name,selectable:l}}));r(e)}}),[t,n,p]);return(0,F.jsx)(v.A,{title:(0,F.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,F.jsx)("div",{children:"Field selection"})}),open:!0,forceRender:!0,destroyOnClose:!0,maskClosable:!1,centered:!0,width:"70vw",bodyStyle:{height:"60vh",position:"relative",display:"flex",flexFlow:"column"},onCancel:()=>{a(!1)},footer:[(0,F.jsx)(c.A,{onClick:()=>{d(null),a(!1)},children:"Cancel"},"cancelFilter"),(0,F.jsx)(c.A,{type:"primary",disabled:null===s,onClick:()=>{s&&i&&("alternativeField"===n&&l({...i,alternativeField:s.field,alternativeFieldValue:s.value,alternativeFieldType:"variable"}),"conditionOperandA"===n&&(i.condition?l({...i,condition:{...i.condition,conditionOperandA:s.field,conditionOperandAValue:s.value,conditionOperandAType:"variable"}}):l({...i,condition:{conditionOperandA:s.field,conditionOperandAType:"variable",conditionOperandAValue:s.value,conditionType:null,conditionOperandB:null,conditionOperandBType:null,conditionOperandBValue:null}})),"conditionOperandB"===n&&(i.condition?l({...i,condition:{...i.condition,conditionOperandB:s.field,conditionOperandBValue:s.value,conditionOperandBType:"variable"}}):l({...i,condition:{conditionOperandB:s.field,conditionOperandBType:"variable",conditionOperandBValue:s.value,conditionType:null,conditionOperandA:null,conditionOperandAType:null,conditionOperandAValue:null}}))),d(null),a(!1)},children:"Save changes"},"setFilter")],children:(0,F.jsx)("div",{style:{position:"relative",flex:1,height:"100%",width:"100%",overflow:"scroll"},children:(0,F.jsx)(y.A,{showLine:!0,showIcon:!0,defaultExpandedKeys:["variables"],onSelect:(e,n)=>{const t=n.node.key;d({field:"$".concat(t,"$"),value:"$".concat(t,"$")})},treeData:[{title:"Variables",key:"variables",children:o}]})})})};var V=t(68513);const B=e=>{let{operandType:n,setFilter:t,prevFilter:l,setFilteringInterfaceModalOpen:i,selectedDataset:a}=e;const[o,r]=(0,b.useState)([]),[s,d]=(0,b.useState)(null);(0,b.useEffect)((()=>{function e(e){let{title:n,...t}=e;return(0,F.jsx)("span",{...t,style:{fontSize:"16px"},children:n})}function n(e){let{title:n,...t}=e;return(0,F.jsx)("span",{...t,style:{fontSize:"14px",color:"#D2D2D2"},children:n})}function t(e){let{title:n,value:t,...l}=e,i="string"===typeof t?"string":"number"===typeof t?"number":"boolean";return(0,F.jsxs)("div",{...l,style:{fontSize:"14px",display:"flex",flexFlow:"row",alignItems:"baseline",color:"var(--ant-primary-5)"},children:[(0,F.jsx)(j.A,{style:{marginRight:5}}),'"',n,'" :'," ",(0,F.jsx)(C.A,{crestronLikeTypesNaming:!1,style:{marginLeft:10},type:i}),(0,F.jsx)("span",{style:{color:"#CB4B15",marginLeft:5},children:t})]})}a&&r([function l(i){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"main";const o=[];for(const e in i)if(i.hasOwnProperty(e)){const r=i[e];let s;if("object"===typeof r)if(Array.isArray(r)){const t=r.map(((n,t)=>l(n,"".concat(a,".").concat(e,"[").concat(t,"]"))));s={title:(0,F.jsx)(n,{title:"".concat(e," [...]")}),key:"".concat(a,".").concat(e),selectable:!1,children:t}}else s={title:(0,F.jsx)(n,{title:"".concat(e," {...}")}),selectable:!1,key:"".concat(a,".").concat(e,".object"),children:[l(r,"".concat(a,".").concat(e))]};else s={title:(0,F.jsx)(t,{title:"".concat(e),value:r}),key:"".concat(a,".").concat(e),selectable:!0};o.push(s)}return"main"===a?{title:(0,F.jsx)(e,{title:"Datasource"}),selectable:!1,key:a,children:o}:{title:(0,F.jsx)(n,{title:"Object {...}"}),selectable:!1,key:a,children:o}}(a)])}),[a]);return(0,F.jsx)(v.A,{title:(0,F.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,F.jsx)("div",{children:"Field selection"})}),open:!0,forceRender:!0,destroyOnClose:!0,maskClosable:!1,centered:!0,width:"70vw",bodyStyle:{height:"60vh",position:"relative",display:"flex",flexFlow:"column"},onCancel:()=>{i(!1)},footer:[(0,F.jsx)(c.A,{onClick:()=>{d(null),i(!1)},children:"Cancel"},"cancelFilter"),(0,F.jsx)(c.A,{type:"primary",disabled:null===s,onClick:()=>{s&&l&&("alternativeField"===n&&t({...l,alternativeField:s.field,alternativeFieldValue:s.value,alternativeFieldType:"field"}),"conditionOperandA"===n&&(l.condition?t({...l,condition:{...l.condition,conditionOperandA:s.field,conditionOperandAValue:s.value,conditionOperandAType:"field"}}):t({...l,condition:{conditionOperandA:s.field,conditionOperandAType:"field",conditionOperandAValue:s.value,conditionType:null,conditionOperandB:null,conditionOperandBType:null,conditionOperandBValue:null}})),"conditionOperandB"===n&&(l.condition?t({...l,condition:{...l.condition,conditionOperandB:s.field,conditionOperandBValue:s.value,conditionOperandBType:"field"}}):t({...l,condition:{conditionOperandB:s.field,conditionOperandBType:"field",conditionOperandBValue:s.value,conditionType:null,conditionOperandA:null,conditionOperandAType:null,conditionOperandAValue:null}}))),d(null),i(!1)},children:"Save changes"},"setFilter")],children:(0,F.jsx)("div",{style:{position:"relative",flex:1,height:"100%",width:"100%",overflow:"scroll"},children:(0,F.jsx)(y.A,{showLine:!0,showIcon:!0,defaultExpandedKeys:["datasource"],onSelect:(e,n)=>{d({field:n.node.key,value:n.node.title.props.value})},treeData:[{title:"Fields",key:"datasource",children:o}]})})})};var E,D=t(83063),P=t(28429),N=t(27911),L=t(86006),q=t(9418),R=t(93072),M=t(35865);const G=(0,L.Ay)(i.A)(E||(E=(0,l.A)(["\n  padding-right: 25px;\n  display: flex;\n  gap: 0px 2em;\n  justify-content: space-between;\n  flex-wrap: wrap;\n\n  & > * {\n    flex: 1;\n  }\n"]))),z=b.memo((e=>{let{parameters:n,disabledTypes:t,setSelected:l,initialNewParameterName:s,setParameterDataToCreate:d}=e;const[c]=i.A.useForm(),[u,p]=(0,b.useState)(!0),h=i.A.useWatch("type",c),m=i.A.useWatch("name",c),v=i.A.useWatch("defaultValue",c),x=(0,b.useMemo)((()=>["boolean","number","string"].filter((e=>!t.includes(e)))),[t]),g=x[0];return(0,b.useEffect)((()=>{if(u){d({name:m,type:h,defaultValue:v}),l({key:"%".concat(m,"%"),title:m,value:"%".concat(m,"%")})}else l(null),d(void 0)}),[v,m,h,u,d,l]),(0,b.useEffect)((()=>{c.validateFields().then((()=>{p(!0)})).catch((e=>{var n;null!==e&&void 0!==e&&null!==(n=e.errorFields)&&void 0!==n&&n.length&&p(!1)}))}),[c,v,m,h]),(0,b.useEffect)((()=>{h||c.setFieldValue("type",null===x||void 0===x?void 0:x[0])}),[x,c,h]),g?(0,F.jsxs)(G,{form:c,layout:"vertical",scrollToFirstError:!0,children:[(0,F.jsx)(i.A.Item,{initialValue:s,colon:!1,name:"name",label:"Name",rules:[{required:!0,message:"This field is required."},()=>({validator:(e,t)=>Promise.all([(0,N.Gl)({input:t,searchArray:n||[],searchKey:"name"}),(0,N.fp)(t),(0,N.cv)(t),(0,N.Ld)(t||"")])})],children:(0,F.jsx)(a.A,{spellCheck:!1})}),(0,F.jsx)(i.A.Item,{initialValue:g,colon:!1,name:"type",label:"Type",rules:[{required:!1}],children:(0,F.jsxs)(o.Ay.Group,{className:"radioFullWidth",buttonStyle:"solid",children:[(0,F.jsx)(o.Ay.Button,{disabled:t.includes("boolean"),value:"boolean",children:"Boolean"}),(0,F.jsx)(o.Ay.Button,{disabled:t.includes("string"),value:"string",children:"String"}),(0,F.jsx)(o.Ay.Button,{disabled:t.includes("number"),value:"number",children:"Number"})]})}),"string"===h&&(0,F.jsx)(i.A.Item,{colon:!1,name:"defaultValue",label:"Default Value",children:(0,F.jsx)(a.A,{spellCheck:!1})}),"boolean"===h&&(0,F.jsx)(i.A.Item,{colon:!1,name:"defaultValue",label:"Default Value",children:(0,F.jsx)(r.A,{block:!0,options:["true","false"]})}),"number"===h&&(0,F.jsx)(i.A.Item,{colon:!1,name:"defaultValue",initialValue:0,label:"Default Value",rules:[()=>({validator:(e,n)=>Promise.all([(0,N.z2)(n),(0,N.mC)(n)])})],children:(0,F.jsx)(a.A,{style:{width:"100%"}})})]}):null})),W=e=>{let{setNewSelectDatasetEntityModalOpen:n,selectedElement:t,selectedProperty:l,setCurrentInputValue:i,disabledTypes:o,hideSourceTabs:r=[]}=e;const{pageId:E}=(0,P.g)(),{projectId:N}=(0,P.g)();let L="";L=null!==t&&void 0!==t&&t.hasOwnProperty("name")?((null===t||void 0===t?void 0:t.name)||"element")+" "+l:"page "+l,L=function(e){return e.replace(/[^\x00-\x7F]/g,"").split(" ").map(((e,n)=>0===n?e.toLowerCase():e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join("")}(L);const G=(0,M.x)((e=>e.isSubpageEditor)),[W,U]=(0,b.useState)([]),[K,H]=(0,b.useState)({returningField:"",alternativeField:null,alternativeFieldType:"value",alternativeFieldValue:null,condition:{conditionOperandB:null,conditionOperandBType:null,conditionOperandAValue:null,conditionType:null,conditionOperandA:null,conditionOperandAType:null,conditionOperandBValue:null}}),[$,_]=(0,b.useState)({showIfStatement:!1,showElseStatement:!1}),[J,X]=(0,b.useState)(!1),[Y,Q]=(0,b.useState)(!1),[Z,ee]=(0,b.useState)(!1),[ne,te]=(0,b.useState)(null),[le,ie]=(0,b.useState)(null),[,ae]=(0,b.useState)(null),[,oe]=(0,b.useState)(null),[re,se]=(0,b.useState)(!1),[de,ce]=(0,b.useState)(null),[ue,pe]=(0,b.useState)(!1),[he,me]=(0,b.useState)([]),[ve,xe]=(0,b.useState)(null),[ge,ye]=(0,b.useState)([]),[fe,be]=(0,b.useState)([]),je=(0,k.f)((e=>e.workingProject)),Ae=(0,k.f)((e=>{var n,t;return(null===(n=e.workingProject)||void 0===n||null===(t=n.attributes)||void 0===t?void 0:t.variables)||[]})),[we,Te]=(0,b.useState)(),Ce=Ae.filter((e=>!(null!==o&&void 0!==o&&o.includes(e.type))&&e.pageId===E)),[Se,Fe]=(0,b.useState)(),[Oe,ke]=(0,b.useState)(),Ie=(0,b.useCallback)((e=>/^\$.*\$$/.test(e)),[]),Ve=(0,b.useMemo)((()=>{var e,n;return(null===(e=k.f.getState().workingProject)||void 0===e||null===(n=e.attributes)||void 0===n?void 0:n.variables)||[]}),[]),Be=(0,b.useMemo)((()=>e=>{const n=Ve.find((n=>n.name===e));return n?n.type:"string"}),[Ve]),[Ee,De]=(0,b.useState)("");function Pe(e){let{title:n,...t}=e;return(0,F.jsx)("span",{...t,style:{fontSize:"16px"},children:n})}function Ne(e){let{title:n,...t}=e;return(0,F.jsx)("span",{...t,style:{fontSize:"14px",color:"#D2D2D2"},children:n})}function Le(e){let{title:n,value:t,...l}=e,i="string"===typeof t?"string":"number"===typeof t?"number":"boolean",a=null===o||void 0===o?void 0:o.includes(i);return(0,F.jsxs)("div",{...l,style:{fontSize:"14px",display:"flex",flexFlow:"row",alignItems:"baseline",color:a?"#D2D2D2":"var(--ant-primary-5)"},children:[(0,F.jsx)(j.A,{style:{marginRight:5}}),'"',n,'" :'," ",(0,F.jsx)(C.A,{crestronLikeTypesNaming:!1,style:{marginLeft:10},type:i}),(0,F.jsx)("span",{style:{color:"#CB4B15",marginLeft:5},children:t})]})}const qe=(0,b.useCallback)((e=>{let n=!1,t="string";return"conditionOperandA"===e&&(n="variable"===K.condition.conditionOperandAType,t=n&&K.condition.conditionOperandA?Be(K.condition.conditionOperandA.slice(1,-1)):"string"===typeof K.condition.conditionOperandAValue?"string":"number"===typeof K.condition.conditionOperandAValue?"number":"boolean"),"conditionOperandB"===e&&(n="variable"===K.condition.conditionOperandBType,t=n&&K.condition.conditionOperandB&&"string"===typeof K.condition.conditionOperandB?Be(K.condition.conditionOperandB.slice(1,-1)):"string"===typeof K.condition.conditionOperandBValue?"string":"number"===typeof K.condition.conditionOperandBValue?"number":"boolean"),"alternativeField"===e&&(n="variable"===K.alternativeFieldType,t=n&&K.alternativeFieldType&&"string"===typeof K.alternativeFieldType?Be(K.alternativeFieldType.slice(1,-1)):"string"===typeof K.alternativeFieldValue?"string":"number"===typeof K.alternativeFieldValue?"number":"boolean"),n?(0,F.jsxs)("div",{style:{display:"flex"},children:[(0,F.jsx)("div",{children:(0,F.jsx)(s.A,{color:"green",style:{fontSize:10,padding:"2px 3px",lineHeight:"10px",marginLeft:5,minWidth:15,textAlign:"center",textTransform:"lowercase"},children:"variable"})}),(0,F.jsx)("div",{children:(0,F.jsx)(C.A,{crestronLikeTypesNaming:!1,type:t})})]}):(0,F.jsxs)("div",{style:{display:"flex"},children:[(0,F.jsx)("div",{children:(0,F.jsx)(s.A,{color:"cyan",style:{fontSize:10,padding:"2px 3px",lineHeight:"10px",marginLeft:5,minWidth:15,textAlign:"center",textTransform:"lowercase"},children:"field"})}),(0,F.jsx)("div",{children:(0,F.jsx)(C.A,{crestronLikeTypesNaming:!1,type:t})})]})}),[Be,K.alternativeFieldType,K.alternativeFieldValue,K.condition.conditionOperandA,K.condition.conditionOperandAType,K.condition.conditionOperandAValue,K.condition.conditionOperandB,K.condition.conditionOperandBType,K.condition.conditionOperandBValue]),Re=(0,b.useCallback)((e=>{let n="",t="",l=!1;"conditionOperandA"===e&&("field"===K.condition.conditionOperandAType&&(l=!0),n=K.condition.conditionOperandA?K.condition.conditionOperandA:"",t=n),"conditionOperandB"===e&&("field"===K.condition.conditionOperandBType&&(l=!0),"string"===typeof K.condition.conditionOperandB&&(n=K.condition.conditionOperandB?K.condition.conditionOperandB:"",t=n)),"alternativeField"===e&&("field"===K.alternativeFieldType&&(l=!0),"string"===typeof K.alternativeField&&(n=K.alternativeField?K.alternativeField:"",t=n));const i=n.lastIndexOf(".");return l?(n=n.substring(i+1),(0,F.jsx)(d.A,{title:t,children:(0,F.jsx)("div",{style:{color:"#CB4B15",marginLeft:5,marginRight:15},children:n})})):(0,F.jsx)("div",{style:{color:"#CB4B15",marginLeft:5,marginRight:15},children:n.slice(1,-1)})}),[K]),Me=(0,b.useCallback)((()=>!(!K.condition.conditionOperandA||!K.condition.conditionType)&&("exists"===K.condition.conditionType||"not exists"===K.condition.conditionType||"is null"===K.condition.conditionType||"not null"===K.condition.conditionType||!(!K.condition.conditionOperandB||!K.condition.conditionType||"exists"===K.condition.conditionType||"not exists"===K.condition.conditionType||"is null"===K.condition.conditionType||"not null"===K.condition.conditionType))),[K]);(0,b.useEffect)((()=>{pe(!0),async function(){if(je&&0!==je.attributes.datasources.data.length){let e=je.attributes.datasources.data.find((e=>e.attributes.uid===(null===t||void 0===t?void 0:t.dataset)));if(e&&"none"!==e.attributes.production.storageType){De(e.attributes.name),"local"===e.attributes.production.storageType&&(null!==t&&void 0!==t&&t.datasetPath?xe((0,S.px)(JSON.parse(e.attributes.production.sourceObject),null===t||void 0===t?void 0:t.datasetPath)):xe(JSON.parse(e.attributes.production.sourceObject)));let n=await(0,S.wF)(e.attributes.uid);void 0===n?se(!0):null!==t&&void 0!==t&&t.datasetPath?xe((0,S.px)(n,null===t||void 0===t?void 0:t.datasetPath)):xe(n)}else se(!0)}else se(!0)}().then((()=>{pe(!1)}))}),[je,t]),(0,b.useEffect)((()=>{function e(n){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"main";const l=[];for(const i in n)if(n.hasOwnProperty(i)){const a=n[i];let r;if("object"===typeof a)if(Array.isArray(a)){const n=a.map(((n,l)=>e(n,"".concat(t,".").concat(i,"[").concat(l,"]"))));r={title:(0,F.jsx)(Ne,{title:"".concat(i," {...}")}),key:"".concat(t,".").concat(i),selectable:!1,children:n}}else r={title:(0,F.jsx)(Ne,{title:"".concat(i," {...}")}),selectable:!1,key:"".concat(t,".").concat(i,".object"),children:[e(a,"".concat(t,".").concat(i))]};else r={title:(0,F.jsx)(Le,{title:"".concat(i),value:a}),key:"".concat(t,".").concat(i),selectable:"string"===typeof a?!(null!==o&&void 0!==o&&o.includes("string")):"number"===typeof a?!(null!==o&&void 0!==o&&o.includes("number")):!(null!==o&&void 0!==o&&o.includes("boolean"))};l.push(r)}return"main"===t?{title:(0,F.jsx)(Pe,{title:Ee}),selectable:!1,key:t,children:l}:{title:(0,F.jsx)(Ne,{title:"Object {...}"}),selectable:!1,key:t,children:l}}!async function(){if(ve&&!1===re&&t){const n=await(0,S.oo)(t.filter,ve,t.parentArrayIndex,t.parentData);"subpageList"===(null===t||void 0===t?void 0:t.type)?ye([e((0,T.x)(n))]):me([e(n)])}}()}),[ve,re,t]),(0,b.useEffect)((()=>{if(Ve&&Ve.length>0){const e=Ve.filter((e=>void 0===e.pageId)).map((e=>{let n=!o||!o.includes(e.type);return{title:(0,F.jsxs)("div",{children:[(0,F.jsx)("span",{style:{marginLeft:5,color:n?"black":"gray"},children:e.name}),(0,F.jsx)(C.A,{crestronLikeTypesNaming:!1,style:{marginLeft:10},type:e.type})]}),key:e.name,selectable:n}}));be(e)}}),[o,Ve]),(0,b.useEffect)((()=>{if(ve&&ve.length>0&&de){let e=[],n=[],l=0,i=null===de||void 0===de?void 0:de.key.slice(1,-1);for(i.endsWith(".object")&&(i=i.slice(0,-7));l<ve.length;){let a=(0,S.Re)(null===t||void 0===t?void 0:t.dataset,null===t||void 0===t?void 0:t.datasetPath,null===t||void 0===t?void 0:t.filter,l),o=(0,S.iT)(null===t||void 0===t?void 0:t.dataset,null===t||void 0===t?void 0:t.datasetPath,null===t||void 0===t?void 0:t.filter,i,l);Me()&&(o=(0,S.uF)(a,i,K)),"object"===typeof o&&(e.push({key:JSON.stringify(o),value:typeof o}),n.push(o)),"undefined"===typeof o?e.push({key:"undefined",value:typeof o}):"object"!==typeof o&&e.push({key:o,value:typeof o}),l++}oe(e)}}),[Me,de,null===t||void 0===t?void 0:t.dataset,null===t||void 0===t?void 0:t.datasetPath,null===t||void 0===t?void 0:t.filter,ve,K,K.alternativeField,K.condition.conditionOperandA,K.condition.conditionOperandB,K.condition.conditionType]),(0,b.useEffect)((()=>{if(de){var e;let n=null===de||void 0===de?void 0:de.key.slice(1,-1);n.endsWith(".object")&&(n=n.slice(0,-7));let l="string"===typeof de.value?"string":"number"===typeof de.value?"number":"boolean";Ie(de.key)&&(l=Be(de.key.slice(1,-1)));let i=!o||!o.includes(l)?"#D2D2D2":"var(--ant-primary-5)",a=n.slice(n.lastIndexOf(".")+1),r=de.key.endsWith(".object}")&&"{...}"===de.value;ae((0,F.jsx)("div",{style:{fontSize:"14px",display:"flex",flexFlow:"row",alignItems:"center",color:i},children:r?(0,F.jsx)("div",{children:(0,F.jsxs)("div",{style:{display:"flex"},children:[(0,F.jsx)("svg",{style:{width:18,height:18,marginRight:5,color:"3230b2"},xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,F.jsx)("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M8 12h.009m3.986 0h.01m3.986 0H16m2 9c1.232 0 2.231-1.151 2.231-2.571c0-2.248-.1-3.742 1.442-5.52c.436-.502.436-1.316 0-1.818c-1.542-1.777-1.442-3.272-1.442-5.52C20.231 4.151 19.232 3 18 3M6 21c-1.232 0-2.231-1.151-2.231-2.571c0-2.248.1-3.742-1.442-5.52c-.436-.502-.436-1.316 0-1.818C3.835 9.353 3.769 7.84 3.769 5.57C3.769 4.151 4.768 3 6 3",color:"currentColor"})}),(0,F.jsx)("span",{style:{color:"#CB4B15",marginLeft:2,fontWeight:800},children:a})]})}):(0,F.jsxs)("div",{style:{display:"flex"},children:[(0,F.jsx)("div",{children:(0,F.jsx)("svg",{style:{width:18,height:18,marginRight:5,color:"3230b2"},xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,F.jsxs)("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",children:[(0,F.jsx)("path",{d:"M5 4C2.5 9 2.5 14 5 20M19 4c2.5 5 2.5 10 0 16M9 9h1c1 0 1 1 2.016 3.527C13 15 13 16 14 16h1"}),(0,F.jsx)("path",{d:"M8 16c1.5 0 3-2 4-3.5S14.5 9 16 9"})]})})}),(0,F.jsx)("span",{style:{color:"#CB4B15",marginLeft:2,fontWeight:800},children:a})]})}));let s=!1;K.condition.conditionType&&"exists"!==K.condition.conditionType&&"not exists"!==K.condition.conditionType&&"is null"!==K.condition.conditionType&&"not null"!==K.condition.conditionType&&(s=!0),ie((0,F.jsxs)("div",{style:{display:"flex",flexFlow:"column"},children:[(0,F.jsxs)("div",{style:{fontSize:"14px",display:"flex",flexFlow:"row",alignItems:"center",color:i},children:[(0,F.jsxs)("div",{style:{display:"flex"},children:[(0,F.jsx)("span",{style:{color:"#CB4B15",marginRight:5,fontWeight:600},children:"return"}),(0,F.jsx)("div",{children:(0,F.jsx)(C.A,{crestronLikeTypesNaming:!1,type:l})}),(0,F.jsx)("span",{style:{color:"#CB4B15",marginLeft:5},children:a})]}),(0,F.jsx)(c.A,{disabled:Ie(de.key),type:"dashed",style:{marginLeft:15,display:$.showIfStatement?"none":"inline"},onClick:()=>_({...$,showIfStatement:!0}),children:"add condition"})]}),(0,F.jsxs)("div",{style:{justifyContent:"space-between",alignItems:"center",marginTop:5,display:$.showIfStatement?"flex":"none"},children:[(0,F.jsxs)("div",{style:{fontSize:"14px",display:"flex",flexFlow:"row",alignItems:"center",color:i},children:[(0,F.jsx)("span",{style:{color:"#CB4B15",marginRight:5,fontWeight:600},children:"if"}),K.condition&&K.condition.conditionOperandA?(0,F.jsxs)("div",{style:{display:"flex",flexFlow:"row",alignItems:"center"},children:[qe("conditionOperandA"),Re("conditionOperandA"),(0,F.jsx)(c.A,{type:"dashed",onClick:()=>H({...K,condition:{...K.condition,conditionOperandA:null,conditionOperandAType:null,conditionOperandAValue:null}}),children:(0,F.jsx)(g.A,{})})]}):(0,F.jsx)(u.A.Button,{onClick:()=>{te("conditionOperandA"),null!==t&&void 0!==t&&t.datasetPath?Q(!0):X(!0)},menu:{items:[{key:"variable",label:"Select variable",onClick:()=>{te("conditionOperandA"),ee(!0)}}]},children:"Select field"}),(0,F.jsx)(p.A,{style:{minWidth:"150px",marginLeft:15,marginRight:15},placeholder:"Select condition",options:[{value:"equal",label:"equals"},{value:"not equal",label:"not equals"},{value:"contains",label:"contains"},{value:"not contains",label:"not contains"},{value:"exists",label:"exists"},{value:"not exists",label:"not exists"},{value:"is null",label:"is null or empty"},{value:"not null",label:"not null or empty"}],onChange:e=>{H((n=>({...n,condition:{...n.condition,conditionType:e}})))},value:null===(e=K.condition)||void 0===e?void 0:e.conditionType}),K.condition&&K.condition.conditionOperandB?(0,F.jsxs)("div",{style:{display:"flex",flexFlow:"row",alignItems:"center"},children:[qe("conditionOperandB"),Re("conditionOperandB"),(0,F.jsx)(c.A,{type:"dashed",onClick:()=>H({...K,condition:{...K.condition,conditionOperandB:null,conditionOperandBType:null,conditionOperandBValue:null}}),children:(0,F.jsx)(g.A,{})})]}):(0,F.jsx)(u.A.Button,{onClick:()=>{te("conditionOperandB"),null!==t&&void 0!==t&&t.datasetPath?Q(!0):X(!0)},disabled:!s,menu:{items:[{key:"variable",label:"Select variable",onClick:()=>{te("conditionOperandB"),ee(!0)}}]},children:"Select field"})]}),(0,F.jsx)("div",{style:{display:$.showElseStatement?"none":"flex",marginLeft:15},children:(0,F.jsx)(u.A.Button,{onClick:()=>{H({...K,alternativeField:null,alternativeFieldType:"value",alternativeFieldValue:null,condition:{conditionOperandB:null,conditionOperandBType:null,conditionOperandAValue:null,conditionType:null,conditionOperandA:null,conditionOperandAType:null,conditionOperandBValue:null}}),_({...$,showIfStatement:!1,showElseStatement:!1})},menu:{items:[{key:"showElseStatement",label:"Add condition",onClick:()=>_({...$,showIfStatement:!0,showElseStatement:!0})}]},children:"remove condition"})})]}),(0,F.jsxs)("div",{style:{alignItems:"center",marginTop:5,display:$.showIfStatement&&$.showElseStatement?"flex":"none"},children:[(0,F.jsx)("span",{style:{color:"#CB4B15",marginRight:5,fontWeight:600},children:"else return"}),(0,F.jsx)("div",{style:{fontSize:"14px",flexFlow:"row",alignItems:"baseline",color:i},children:K.condition&&K.alternativeField?(0,F.jsxs)("div",{style:{display:"flex",flexFlow:"row",alignItems:"center"},children:[qe("alternativeField"),Re("alternativeField"),(0,F.jsx)(c.A,{type:"dashed",onClick:()=>H({...K,alternativeField:null,alternativeFieldType:null,alternativeFieldValue:null}),children:(0,F.jsx)(g.A,{})})]}):(0,F.jsx)(u.A.Button,{onClick:()=>{te("alternativeField"),null!==t&&void 0!==t&&t.datasetPath?Q(!0):X(!0)},menu:{items:[{key:"variable",label:"Select variable",onClick:()=>{te("alternativeField"),ee(!0)}}]},children:"Select field"})}),(0,F.jsx)("div",{children:(0,F.jsx)(c.A,{type:"dashed",style:{marginLeft:15},onClick:()=>{H({...K,alternativeField:null,alternativeFieldType:"value",alternativeFieldValue:null}),_({...$,showElseStatement:!1})},children:"remove condition"})})]})]}))}else ie(null)}),[o,Be,Ie,Re,qe,de,null===t||void 0===t?void 0:t.datasetPath,$,K]);const Ge=(e,n)=>{const t=n.node.key,l=t.split(".");!1===n.selected?(ce(null),U([]),_({showIfStatement:!1,showElseStatement:!1}),H({...K,alternativeField:null,alternativeFieldType:"value",alternativeFieldValue:null,condition:{conditionOperandB:null,conditionOperandBType:null,conditionOperandAValue:null,conditionType:null,conditionOperandA:null,conditionOperandAType:null,conditionOperandBValue:null}})):(U([t]),ce({key:"{".concat(t,"}"),title:l[l.length-1],value:n.node.title.props.value}))},ze=(e,n)=>{const t=n.node.key,l=t.split(".");!1===n.selected?(U([]),ce(null),_({showIfStatement:!1,showElseStatement:!1}),H({...K,alternativeField:null,alternativeFieldType:"value",alternativeFieldValue:null,condition:{conditionOperandB:null,conditionOperandBType:null,conditionOperandAValue:null,conditionType:null,conditionOperandA:null,conditionOperandAType:null,conditionOperandBValue:null}})):K.alternativeField||K.condition.conditionType||K.condition.conditionOperandA||K.condition.conditionOperandB?(0,V.A)({title:"Confirm changes",content:"By selecting a variable for the current element, any assigned filters will be removed. Please note that this action is irreversible.",okText:"Confirm",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>{H({...K,alternativeField:null,alternativeFieldType:"value",alternativeFieldValue:null,condition:{conditionOperandB:null,conditionOperandBType:null,conditionOperandAValue:null,conditionType:null,conditionOperandA:null,conditionOperandAType:null,conditionOperandBValue:null}}),U([t]),ce({key:"$".concat(t,"$"),title:l[l.length-1],value:"$".concat(t,"$")})},onCancel:()=>console.log("cancel datasource changing")}):(H({...K,alternativeField:null,alternativeFieldType:"value",alternativeFieldValue:null,condition:{conditionOperandB:null,conditionOperandBType:null,conditionOperandAValue:null,conditionType:null,conditionOperandA:null,conditionOperandAType:null,conditionOperandBValue:null}}),U([t]),ce({key:"$".concat(t,"$"),title:l[l.length-1],value:"$".concat(t,"$")}))},We=()=>{const{name:e}=Se||{};function t(){let e="".concat(null===de||void 0===de?void 0:de.key);i(e),n(!1)}if("newParameter"===e&&Oe){let e={...Oe,pageId:E};(0,q.rz)({newVariable:e,projectId:N}).then((()=>{(0,R.yd)({newPageAttributes:{parameters:[...Ae||[],Oe]},pageId:E}).then((()=>t()))}))}else t()};(0,b.useEffect)((()=>{"parameter"===we?Se&&"newParameter"!==Se.name?ce({key:"%".concat(Se.name,"%"),title:Se.name,value:"%".concat(Se.name,"%")}):ce(null):(ce(null),Fe(void 0))}),[we,Se]);return(0,F.jsxs)("div",{children:[(0,F.jsx)(v.A,{title:(0,F.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,F.jsxs)("div",{children:[(0,F.jsx)(s.A,{color:"blue",children:l}),"Pick dynamic value"]}),(0,F.jsx)("div",{style:{marginRight:20},children:de&&(0,F.jsxs)(s.A,{color:"green",children:["Selected: ",de.title]})})]}),open:!0,onOk:We,forceRender:!0,destroyOnClose:!0,maskClosable:!1,centered:!0,width:"70vw",bodyStyle:{height:"60vh",position:"relative",display:"flex",flexFlow:"column"},onCancel:()=>n(!1),footer:[(0,F.jsx)(c.A,{onClick:()=>n(!1),children:"Cancel"},"back"),(0,F.jsx)(c.A,{type:"primary",disabled:!de,onClick:We,children:"Save changes"},"submit")],children:(0,F.jsx)("div",{style:{position:"relative",flex:1,height:"100%",width:"100%",overflow:"scroll"},children:(0,F.jsx)(x.A,{activeKey:we,onChange:e=>Te(e),tabBarStyle:{marginBottom:5,border:"none"},items:(()=>{let e=[],n=["json","variables","parameter","state"];const l={label:"Datasource",key:n[0],children:ue?(0,F.jsx)("div",{style:{maxHeight:"50vh",minHeight:"50vh",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,F.jsx)(f.A,{})}):(0,F.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,F.jsx)("div",{style:{maxHeight:"50vh",minHeight:"50vh",overflowY:"auto"},children:re?(0,F.jsx)("p",{children:"There was an error getting the data"}):"subpageList"===(null===t||void 0===t?void 0:t.type)?(0,F.jsx)(y.A,{showLine:!0,showIcon:!0,defaultExpandedKeys:["datasource"],onSelect:Ge,selectedKeys:de?W:[],treeData:[{title:"Fields",key:"datasource",children:ge,selectable:!1}]}):(0,F.jsx)(y.A,{treeData:[{title:"Object",key:"datasource",children:he,selectable:!1}],onSelect:Ge,selectedKeys:de?W:[],showLine:!0,defaultExpandedKeys:["main"],switcherIcon:(0,F.jsx)(A.A,{})})})," "]})},i={label:"Project variables",key:n[1],children:(0,F.jsx)(y.A,{showLine:!0,showIcon:!0,defaultExpandedKeys:["variables"],onSelect:ze,selectedKeys:de?W:[],treeData:[{title:"Variables",key:"variables",children:fe,selectable:!1}]})},s=[{title:null,className:"hiddenTableHeader",dataIndex:"newParameter",key:"newParameter",onCell:(e,n)=>({colSpan:0===n?4:0}),render:e=>(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(w.A,{style:{color:"#5ea101"}})," ",e,"newParameter"===(null===Se||void 0===Se?void 0:Se.key)&&(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(h.A,{}),(0,F.jsx)(z,{setParameterDataToCreate:ke,initialNewParameterName:L,setSelected:ce,disabledTypes:o||[],parameters:Ae})]})]})},{title:"Name",dataIndex:"name",key:"name",onCell:(e,n)=>({colSpan:0===n?0:1})},{title:"Type",dataIndex:"type",key:"type",onCell:(e,n)=>({colSpan:0===n?0:1}),render:e=>(0,F.jsx)(C.A,{crestronLikeTypesNaming:!1,style:{margin:1},type:e})},{title:"Default Value",dataIndex:"defaultValue",key:"defaultValue",onCell:(e,n)=>({colSpan:0===n?0:1}),render:(e,n,t)=>(0,F.jsx)(D.A,{onChange:e=>async function(e,n){return new Promise((t=>{let l=null===Ve||void 0===Ve?void 0:Ve.find((n=>n.name===e&&n.pageId===E));l&&(l={...l,...n},(0,q.I7)({projectId:N,updatedVariable:l}).then((()=>{(0,R.yd)({newPageAttributes:{parameters:null===Ae||void 0===Ae?void 0:Ae.map((t=>t.name===e?{...t,...n}:t))},pageId:E}).then((()=>t("Ok")))})))}))}(n.name,{defaultValue:e}),initialValue:e,value:e})}];let d=Ce.map((e=>({key:e.name,name:e.name,type:e.type,defaultValue:e.defaultValue})));d.unshift({key:"newParameter",name:"newParameter",newParameter:"Create new parameter"});const c={label:"Subpage parameter",key:n[2],children:(0,F.jsx)(F.Fragment,{children:(0,F.jsx)(m.A,{rowSelection:{selectedRowKeys:[(null===Se||void 0===Se?void 0:Se.key)||""],type:"radio",onChange:(e,n)=>{Fe(n[0])},getCheckboxProps:e=>({disabled:"Disabled User"===e.name,name:e.name})},size:"small",pagination:!1,columns:s,dataSource:d})})},u={label:"State entry",key:n[3],children:(0,F.jsx)(F.Fragment,{children:(0,F.jsx)(a.A,{style:{width:"100%",marginBottom:15},placeholder:"Enter state name",onChange:e=>ce({key:"#"+e.target.value+"#",title:"#"+e.target.value+"#",value:"#"+e.target.value+"#"})})})};return null!==r&&void 0!==r&&r.includes("json")||null===t||void 0===t||!t.isDynamic||e.push(l),null!==r&&void 0!==r&&r.includes("variables")||e.push(i),!G||null!==r&&void 0!==r&&r.includes("parameter")||e.push(c),null!==r&&void 0!==r&&r.includes("state")||e.push(u),e.length&&!we&&Te(e[0].key),e})()},String(null===t||void 0===t?void 0:t.isDynamic))})}),Y&&(0,F.jsx)(O,{operandType:ne,prevFilter:K,setFilter:H,setFilteringInterfaceModalOpen:Q,selectedArray:ve,disabledTypes:o}),J&&(0,F.jsx)(B,{operandType:ne,prevFilter:K,setFilter:H,setFilteringInterfaceModalOpen:X,selectedDataset:ve,disabledTypes:o}),!0===Z&&(0,F.jsx)(I,{operandType:ne,prevFilter:K,setFilter:H,disabledTypes:o,setOpenVariableSelectionModal:ee})]})}},53088:(e,n,t)=>{t.d(n,{A:()=>A});var l=t(9950),i=t(72429),a=t(81541),o=t(1578),r=t(48538),s=t(77645),d=t(4169),c=t(44358),u=t(24513),p=t(44070),h=t(98979),m=t(55393),v=t(23989),x=t(79721),g=t(64983),y=t(44414);const f=l.memo((e=>{let{onChange:n,setNewSelectDatasetEntityModalOpen:t,isDynamicMode:l,isDynamicHasValue:o,checkDynamicValueTypeResult:r}=e;const s=[{key:"edit ds val",icon:(0,y.jsx)(u.A,{}),onClick:()=>{t(!0)},label:"Edit value"},{key:"clear ds val",icon:(0,y.jsx)(p.A,{}),danger:!0,onClick:()=>{n(void 0)},label:"Clear value"}];return l&&o||r?(0,y.jsx)(i.A,{menu:{items:s},placement:"bottomLeft",arrow:{pointAtCenter:!0},children:(0,y.jsx)(d.A,{style:{width:16,height:16,marginTop:4,color:"5E32EF",cursor:"pointer"},icon:"TbCodeDots"})}):(0,y.jsx)(a.A,{title:"Assign dynamic value",placement:"left",children:(0,y.jsx)("div",{onClick:()=>{t(!0)},children:(0,y.jsx)(d.A,{style:{width:16,height:16,marginTop:4,color:"262626",cursor:"pointer"},icon:"TbCodeDots"})})})})),b=l.memo((e=>{let{onFunctionAttach:n,isDynamicMode:t,isDynamicHasValue:s,checkDynamicValueTypeResult:c,hasAttachedFunction:u}=e;const[p,h]=(0,l.useState)(!1),[m,v]=(0,l.useState)(void 0);(0,l.useEffect)((()=>{p||v(void 0)}),[p]);const x=(0,g.f)((e=>{var n,t,l;return null===(n=e.workingProject)||void 0===n||null===(t=n.attributes)||void 0===t||null===(l=t.modificators)||void 0===l?void 0:l.data}))||[];let f=[];if(x&&x.length>0){let e=[];x.forEach((n=>{e.push({value:n.id.toString(),label:n.attributes.name})})),f=e}const b=[{key:"select function",label:(0,y.jsxs)("div",{style:{display:"flex",flexFlow:"row",gap:3},children:[(0,y.jsx)(o.A,{style:{width:"100%",minWidth:"250px"},placeholder:"Select post-processing function",showSearch:!0,filterOption:(e,n)=>n.label.toLowerCase().includes(e.toLowerCase()),onChange:e=>{v(e)},value:m||(u||void 0),options:f}),!!m&&(0,y.jsx)(a.A,{title:"Assign function",placement:"bottomLeft",children:(0,y.jsx)(r.A,{ghost:!0,type:"primary",style:{width:"100%"},disabled:!m,onClick:()=>{m&&n(m),h(!1)},children:(0,y.jsx)(d.A,{style:{width:16,height:16,marginTop:4,color:"inherit",cursor:"pointer"},icon:"IoCheckmarkCircleOutline"})})}),u&&(0,y.jsx)(a.A,{title:"Clear function",placement:"bottomLeft",children:(0,y.jsx)(r.A,{type:"dashed",danger:!0,style:{width:"100%"},onClick:()=>{n(void 0),h(!1)},children:(0,y.jsx)(d.A,{style:{width:16,height:16,marginTop:4,color:"red",cursor:"pointer"},icon:"AiOutlineCloseCircle"})})})]})}];return(0,y.jsx)(a.A,{destroyTooltipOnHide:!0,title:"Assign post-processing function",placement:"topLeft",children:(0,y.jsx)(i.A,{menu:{items:b},placement:"bottomLeft",arrow:{pointAtCenter:!0},trigger:["click"],open:p,onOpenChange:h,children:(0,y.jsx)(d.A,{style:{width:16,height:16,color:u?"#fff":"inherit",background:u?"var(--ant-primary-5)":"transparent",cursor:"pointer",borderRadius:2,outline:u?"2px var(--ant-primary-5) solid":"none"},icon:"AiOutlineFunction"})})})})),j=l.memo((e=>{let{addColorPicker:n,isDisabled:t,addonBefore:i,value:a,onChange:o,addonAfter:r,checkDynamicValueTypeResult:c,...u}=e;const[p,v]=(0,l.useState)(a),[g,f]=(0,l.useState)("store");(0,l.useEffect)((()=>{"store"===g&&v(a)}),[a,g]),(0,l.useEffect)((()=>{const e=setTimeout((()=>{"state"===g&&o(p)}),300);return()=>clearTimeout(e)}),[p,o,g]),(0,l.useEffect)((()=>{const e=()=>{console.log("Undo event received"),f("store")};return x.R.on("undo",e),x.R.on("redo",e),()=>{x.R.off("undo",e),x.R.off("redo",e)}}),[]);let b=null;return n&&!c&&(b=(0,y.jsxs)("div",{style:{width:15},children:[(0,y.jsx)(d.A,{style:{marginTop:5},icon:"MdColorize"}),(0,y.jsx)(h.i,{disableAlpha:!1,popup:!0,blockStyles:{cursor:"pointer",border:0,boxShadow:"none",position:"absolute",left:0,top:0,width:"100%",height:"100%",borderRadius:" 0 2px 2px 0 0"},picker:"SketchPicker",value:p,onChange:e=>{let n=(0,m.c)(e);f("store"),v(n),o(n)}})]})),(0,y.jsx)(s.A,{onBlur:()=>{f("store")},onFocus:()=>{f("state")},disabled:t,addonBefore:i,addonAfter:b||r,value:p,onChange:e=>{v(e.target.value)},...u})})),A=l.memo((e=>{let{element:n=null,elementKeyProp:t=null,elementKeyPropName:i=null,dynamicContainerIndex:a=null,dynamicElementIndex:o=null,dynamicIsGlobalContainer:r=null,dynamicPageId:s=null,value:d,disabledTypes:u=["boolean"],onChange:p,onFunctionAttach:h,hideSourceTabs:m=[],addColorPicker:x,addonAfter:g,...A}=e;const w=(0,c.t_)(d);let T=(()=>{let e=n;var l,i;if(e&&e.attachedFunctions&&void 0!==e.attachedFunctions&&e.attachedFunctions.length>0)return null===(l=e.attachedFunctions.filter((e=>e.name===t&&void 0!==e.modificatorId)))||void 0===l||null===(i=l[0])||void 0===i?void 0:i.modificatorId})();const C=(null===n||void 0===n?void 0:n.isDynamic)&&null!==a&&null!==o&&null!==r,S=Boolean(t&&(null===n||void 0===n?void 0:n.dataset)&&void 0!==w),[F,O]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{"JSON"!==(0,c.t_)(d)||null!==n&&void 0!==n&&n.dataset||p(void 0)}),[null===n||void 0===n?void 0:n.dataset,p,d]),(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(j,{checkDynamicValueTypeResult:w,addColorPicker:x,value:d,addonBefore:(0,y.jsx)(f,{checkDynamicValueTypeResult:w,onChange:p,value:d,setNewSelectDatasetEntityModalOpen:O,isDynamicMode:C,isDynamicHasValue:S}),addonAfter:(0,y.jsxs)("div",{style:{display:"flex",flexFlow:"row"},children:[g&&h&&(0,y.jsx)("div",{style:{marginRight:"25px"},children:g}),g&&!h&&(0,y.jsx)("div",{children:g}),h&&(0,y.jsx)(b,{checkDynamicValueTypeResult:w,onFunctionAttach:h,value:d,setNewSelectDatasetEntityModalOpen:O,isDynamicMode:C,isDynamicHasValue:S,hasAttachedFunction:T})]}),onChange:p,isDisabled:!!w,...A}),F&&(0,y.jsx)(v.A,{hideSourceTabs:m,selectedElement:n,selectedProperty:i,elementKeyProp:t,setCurrentInputValue:p,disabledTypes:u,setNewSelectDatasetEntityModalOpen:O})]})}))}}]);