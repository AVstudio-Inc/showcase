"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[2936],{83063:(e,t,a)=>{a.d(t,{A:()=>x});var s=a(84649),n=a(48538),r=a(77645),o=a(56952),i=a(92759),l=a(12916),c=a(9950),u=a(2260),d=a(41967),p=a(57560),m=a(24513),g=a(44414);const y=e=>{let{initialValue:t,saveInProgress:a,setIsEditing:i,setSaveInProgress:l,save:m,style:y}=e;const[x,h]=(0,c.useState)(t);switch(typeof t){case"boolean":return(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1em",...y},children:[a&&(0,g.jsx)(u.A,{}),(0,g.jsx)(s.A,{onChange:e=>{h("true"===e)},value:x?"true":"false",options:["true","false"]}),(0,g.jsxs)("div",{style:{display:"flex"},children:[(0,g.jsx)(n.A,{style:{marginRight:2},type:"dashed",children:(0,g.jsx)(d.A,{onClick:()=>m(x),style:{color:"var(--ant-primary-5)"}})}),(0,g.jsx)(n.A,{onClick:()=>{i(!1),l(!1)},type:"dashed",children:(0,g.jsx)(p.A,{style:{color:"gray"}})})]})]});case"string":return(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1em",...y},children:[a&&(0,g.jsx)(u.A,{}),(0,g.jsx)(r.A,{spellCheck:!1,autoFocus:!0,onPressEnter:()=>m(x),onBlur:()=>m(x),onChange:e=>{e.stopPropagation(),h(e.target.value)},value:x})]});case"number":case"object":return(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1em",...y},children:[a&&(0,g.jsx)(u.A,{}),(0,g.jsx)(o.A,{style:{width:"100%"},autoFocus:!0,onPressEnter:()=>m(x),onBlur:()=>m(x),onChange:e=>h(e),value:x})]});default:return null}},x=e=>{let{value:t,onChange:a,initialValue:s,validators:n,style:r}=e;const[o,u]=(0,c.useState)(!1),[d,p]=(0,c.useState)(!1);function x(e){p(!0),a(e).then((()=>{u(!1),p(!1)}))}return(0,c.useEffect)((()=>{const e=e=>{27===e.keyCode&&u(!1)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[s]),o?(0,g.jsx)(y,{initialValue:s,saveInProgress:d,setIsEditing:u,setSaveInProgress:p,save:function(e){if(e===s)return u(!1),void p(!1);if(null!==n&&void 0!==n&&n.length){let t=[];return n.forEach((a=>{t.push(a(e))})),Promise.all(t).then((()=>{x(e)})).catch((e=>{i.Ay.error(e.message)}))}x(e)},style:r}):(0,g.jsxs)("div",{style:{...r},children:["boolean"===typeof t?(0,g.jsx)(l.A,{style:{padding:"3px",lineHeight:"1em"},color:t?"green":"red",children:t?"true":"false"}):t,(0,g.jsx)(m.A,{style:{marginLeft:"0.3em",color:"var(--ant-primary-5)"},onClick:()=>{u(!0)}})]})}},92936:(e,t,a)=>{a.r(t),a.d(t,{default:()=>w});var s=a(22718),n=a(92759),r=a(70171),o=a(74947),i=a(72429),l=a(35492),c=a(48538),u=a(68513),d=a(9950),p=a(28429),m=a(83063),g=a(25928),y=a(37571),x=a(44070),h=a(581),v=a(59051),f=a.n(v),A=a(64983),j=a(67956),b=a(44414);const{Title:k}=s.A,C=[{title:"Name",dataIndex:"name"},{title:"Updated",dataIndex:"updated"},{title:"Source",dataIndex:"storageType"},{title:"Actions",width:"100px",dataIndex:"datasourcesActions"}],w=()=>{const{projectId:e}=(0,p.g)(),t=(0,A.f)((e=>e.workingProject)),a=(0,d.useMemo)((()=>{var e,a;return(null===t||void 0===t||null===(e=t.attributes)||void 0===e||null===(a=e.datasources)||void 0===a?void 0:a.data)||[]}),[t]),{setNewDatasourceVisible:s}=(0,p.KC)(),[v,w]=(0,d.useState)();return(0,d.useEffect)((()=>{function t(e){return!a||!a.some((t=>t.attributes.name===e))||(n.Ay.error("Datasource's name must be unique"),!1)}if(e)if(a&&Array.isArray(a)){let l=[];a.forEach(((c,d)=>{l.push({key:"datasource_"+c.id,order:d+1,name:(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5em"},children:[c.attributes.production.isImagePreloadSource?(0,b.jsx)(r.A,{placement:"topLeft",title:"Datasource for Image preloading",content:"URLs array will be used to preload & cache images",trigger:"hover",arrowPointAtCenter:!0,children:(0,b.jsx)(g.A,{})}):null,(0,b.jsx)(m.A,{onChange:a=>async function(a,s,r){return a===s?s:t(a)?a&&e?(0,h.r$)({name:a},r):void 0:(n.Ay.error("Datasource's name must be unique"),s)}(a,c.attributes.name,c.id),initialValue:c.attributes.name,value:(0,b.jsx)(b.Fragment,{children:c.attributes.name})})]}),updated:f()(c.attributes.updatedAt).format("MMM Do YYYY, h:mm a")||"",storageType:(0,b.jsx)("div",{children:(0,b.jsx)(o.A,{status:"none"===c.attributes.production.storageType?"error":"success",text:c.attributes.production.storageType})}),datasourcesActions:(0,b.jsx)(i.A.Button,{onClick:()=>{s(c.id)},menu:{items:[{key:"copy",icon:(0,b.jsx)(y.A,{}),label:"Clone datasource",onClick:()=>function(s,n){const r=e=>t("".concat(e,"_clone"))?"".concat(e,"_clone"):r("".concat(e,"_clone"));if(!a)return null;let o={name:r(n),production:a[s].attributes.production,uid:(0,j.A)()};e&&(0,h.G4)(e,o)}(d,c.attributes.name)},{key:"delete",icon:(0,b.jsx)(x.A,{}),label:"Delete datasource",danger:!0,onClick:()=>(0,u.A)({title:"Delete datasource ".concat(c.attributes.name," ?"),content:"This will remove datasource ".concat(c.attributes.name," and all it's assignments. This action can not be undone."),okText:"Delete datasource",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>(0,h.Nf)(c.id),onCancel:()=>console.log("cancel datasource delete")})}]},children:"Edit"})})})),w(l)}else w([])}),[e,a,s]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k,{id:"Data sources",style:{margin:"15px 0"},level:5,children:"Data sources (".concat((null===v||void 0===v?void 0:v.length)||0,")")}),(0,b.jsx)(l.A,{columns:C,dataSource:v,pagination:!1}),(0,b.jsx)(c.A,{style:{marginTop:15},type:"primary",onClick:()=>s(!0),children:"Add Datasource"},"submit")]})}}}]);